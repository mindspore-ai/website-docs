

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>mindspore.train &mdash; MindSpore r0.5 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../../" src="../../../_static/documentation_options.js"></script>
        <script src="../../../_static/jquery.js"></script>
        <script src="../../../_static/underscore.js"></script>
        <script src="../../../_static/doctools.js"></script>
        <script src="../../../_static/language_data.js"></script>
        <script async="async" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/latest.js?config=TeX-AMS-MML_HTMLorMML"></script>
    
    <script type="text/javascript" src="../../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="mindspore.dataset" href="mindspore.dataset.html" />
    <link rel="prev" title="mindspore.parallel" href="mindspore.parallel.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../../index.html" class="icon icon-home"> MindSpore
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Python API</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="mindspore.html">mindspore</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindspore.dtype.html">mindspore.dtype</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindspore.common.initializer.html">mindspore.common.initializer</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindspore.communication.html">mindspore.communication</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindspore.context.html">mindspore.context</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindspore.nn.html">mindspore.nn</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindspore.nn.dynamic_lr.html">mindspore.nn.dynamic_lr</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindspore.ops.html">mindspore.ops</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindspore.ops.composite.html">mindspore.ops.composite</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindspore.ops.operations.html">mindspore.ops.operations</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindspore.parallel.html">mindspore.parallel</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">mindspore.train</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-mindspore.train.summary">mindspore.train.summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-mindspore.train.callback">mindspore.train.callback</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-mindspore.train.serialization">mindspore.train.serialization</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-mindspore.train.amp">mindspore.train.amp</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-mindspore.train.loss_scale_manager">mindspore.train.loss_scale_manager</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-mindspore.train.quant">mindspore.train.quant</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="mindspore.dataset.html">mindspore.dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindspore.dataset.text.transforms.html">mindspore.dataset.text.transforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindspore.dataset.text.utils.html">mindspore.dataset.text.utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindspore.dataset.transforms.c_transforms.html">mindspore.dataset.transforms.c_transforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindspore.dataset.transforms.vision.c_transforms.html">mindspore.dataset.transforms.vision.c_transforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindspore.dataset.transforms.py_transforms.html">mindspore.dataset.transforms.py_transforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindspore.dataset.transforms.vision.py_transforms.html">mindspore.dataset.transforms.vision.py_transforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindspore.mindrecord.html">mindspore.mindrecord</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mindinsight/mindinsight.lineagemgr.html">mindinsight.lineagemgr</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mindinsight/mindinsight.profiler.html">mindinsight.profiler</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mindarmour/mindarmour.html">mindarmour</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mindarmour/mindarmour.utils.html">mindarmour.utils</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mindarmour/mindarmour.evaluations.html">mindarmour.evaluations</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mindarmour/mindarmour.detectors.html">mindarmour.detectors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mindarmour/mindarmour.attacks.html">mindarmour.attacks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mindarmour/mindarmour.defenses.html">mindarmour.defenses</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mindarmour/mindarmour.fuzzing.html">mindarmour.fuzzing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mindarmour/mindarmour.diff_privacy.html">mindarmour.diff_privacy</a></li>
</ul>
<p class="caption"><span class="caption-text">C++ API</span></p>
<ul>
<li class="toctree-l1"><a class="reference external" href="https://www.mindspore.cn/apicc/zh-CN/r0.5/predict/namespacemembers.html">predict</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../index.html">MindSpore</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../../index.html">Docs</a> &raquo;</li>
        
      <li>mindspore.train</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../../_sources/api/python/mindspore/mindspore.train.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="mindspore-train">
<h1>mindspore.train<a class="headerlink" href="#mindspore-train" title="Permalink to this headline">¶</a></h1>
<div class="section" id="module-mindspore.train.summary">
<span id="mindspore-train-summary"></span><h2>mindspore.train.summary<a class="headerlink" href="#module-mindspore.train.summary" title="Permalink to this headline">¶</a></h2>
<p>SummaryRecord.</p>
<p>User can use SummaryRecord to dump the summary data, the summary is a series of operations
to collect data for analysis and visualization.</p>
<dl class="class">
<dt id="mindspore.train.summary.SummaryRecord">
<em class="property">class </em><code class="sig-prename descclassname">mindspore.train.summary.</code><code class="sig-name descname">SummaryRecord</code><span class="sig-paren">(</span><em class="sig-param">log_dir</em>, <em class="sig-param">queue_max_size=0</em>, <em class="sig-param">flush_time=120</em>, <em class="sig-param">file_prefix='events'</em>, <em class="sig-param">file_suffix='_MS'</em>, <em class="sig-param">network=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/mindspore/train/summary/summary_record.html#SummaryRecord"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore.train.summary.SummaryRecord" title="Permalink to this definition">¶</a></dt>
<dd><p>SummaryRecord is used to record the summary data and lineage data.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The API will create a summary file and a lineage file lazily in a given directory and writes data to them.
It writes the data to files by executing the record method. In addition to record the data bubbled up from
the network by defining the summary operators, SummaryRecord also supports to record extra data which
can be added by calling add_value. Finally, make sure to close the SummaryRecord object at the end.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>log_dir</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – The log_dir is a directory location to save the summary.</p></li>
<li><p><strong>queue_max_size</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The capacity of event queue.(reserved). Default: 0.</p></li>
<li><p><strong>flush_time</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Frequency to flush the summaries to disk, the unit is second. Default: 120.</p></li>
<li><p><strong>file_prefix</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – The prefix of file. Default: “events”.</p></li>
<li><p><strong>file_suffix</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – The suffix of file. Default: “_MS”.</p></li>
<li><p><strong>network</strong> (<a class="reference internal" href="mindspore.nn.html#mindspore.nn.Cell" title="mindspore.nn.Cell"><em>Cell</em></a>) – Obtain a pipeline through network for saving graph summary. Default: None.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/library/exceptions.html#TypeError" title="(in Python v3.8)"><strong>TypeError</strong></a> – If <cite>queue_max_size</cite> and <cite>flush_time</cite> is not int, or <cite>file_prefix</cite> and <cite>file_suffix</cite> is not str.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/library/exceptions.html#RuntimeError" title="(in Python v3.8)"><strong>RuntimeError</strong></a> – If the log_dir can not be resolved to a canonicalized absolute pathname.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">SummaryRecord</span><span class="p">(</span><span class="n">log_dir</span><span class="o">=</span><span class="s2">&quot;/opt/log&quot;</span><span class="p">,</span> <span class="n">file_prefix</span><span class="o">=</span><span class="s2">&quot;xxx_&quot;</span><span class="p">,</span> <span class="n">file_suffix</span><span class="o">=</span><span class="s2">&quot;_yyy&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">summary_record</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">pass</span>
</pre></div>
</div>
<dl class="method">
<dt id="mindspore.train.summary.SummaryRecord.add_value">
<code class="sig-name descname">add_value</code><span class="sig-paren">(</span><em class="sig-param">plugin</em>, <em class="sig-param">name</em>, <em class="sig-param">value</em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/mindspore/train/summary/summary_record.html#SummaryRecord.add_value"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore.train.summary.SummaryRecord.add_value" title="Permalink to this definition">¶</a></dt>
<dd><p>Add value to be record later on.</p>
<p>When the plugin is ‘tensor’, ‘scalar’, ‘image’ or ‘histogram’,
the name should be the tag name, and the value should be a Tensor.</p>
<p>When the plugin plugin is ‘graph’, the value should be a GraphProto.</p>
<p>When the plugin ‘dataset_graph’, ‘train_lineage’, ‘eval_lineage’,
or ‘custom_lineage_data’, the value should be a proto message.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>plugin</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – The plugin for the value.</p></li>
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – The name for the value.</p></li>
<li><p><strong>value</strong> (<em>Union</em><em>[</em><a class="reference internal" href="mindspore.html#mindspore.Tensor" title="mindspore.Tensor"><em>Tensor</em></a><em>, </em><em>GraphProto</em><em>, </em><em>TrainLineage</em><em>, </em><em>EvaluationLineage</em><em>, </em><em>DatasetGraph</em><em>, </em><em>UserDefinedInfo</em><em>]</em>) – <p>The value to store.</p>
<ul>
<li><p>GraphProto: The ‘value’ should be a serialized string this type when the plugin is ‘graph’.</p></li>
<li><p>Tensor: The ‘value’ should be this type when the plugin is ‘scalar’, ‘image’, ‘tensor’ or ‘histogram’.</p></li>
<li><p>TrainLineage: The ‘value’ should be this type when the plugin is ‘train_lineage’.</p></li>
<li><p>EvaluationLineage: The ‘value’ should be this type when the plugin is ‘eval_lineage’.</p></li>
<li><p>DatasetGraph: The ‘value’ should be this type when the plugin is ‘dataset_graph’.</p></li>
<li><p>UserDefinedInfo: The ‘value’ should be this type when the plugin is ‘custom_lineage_data’.</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/library/exceptions.html#ValueError" title="(in Python v3.8)"><strong>ValueError</strong></a> – When the name is not valid.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/library/exceptions.html#TypeError" title="(in Python v3.8)"><strong>TypeError</strong></a> – When the value is not a Tensor.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">SummaryRecord</span><span class="p">(</span><span class="n">log_dir</span><span class="o">=</span><span class="s2">&quot;/opt/log&quot;</span><span class="p">,</span> <span class="n">file_prefix</span><span class="o">=</span><span class="s2">&quot;xxx_&quot;</span><span class="p">,</span> <span class="n">file_suffix</span><span class="o">=</span><span class="s2">&quot;_yyy&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">summary_record</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">summary_record</span><span class="o">.</span><span class="n">add_value</span><span class="p">(</span><span class="s1">&#39;scalar&#39;</span><span class="p">,</span> <span class="s1">&#39;loss&#39;</span><span class="p">,</span> <span class="n">Tensor</span><span class="p">(</span><span class="mf">0.1</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="mindspore.train.summary.SummaryRecord.close">
<code class="sig-name descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/mindspore/train/summary/summary_record.html#SummaryRecord.close"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore.train.summary.SummaryRecord.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Flush all events and close summary records. Please use with statement to autoclose.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">SummaryRecord</span><span class="p">(</span><span class="n">log_dir</span><span class="o">=</span><span class="s2">&quot;/opt/log&quot;</span><span class="p">,</span> <span class="n">file_prefix</span><span class="o">=</span><span class="s2">&quot;xxx_&quot;</span><span class="p">,</span> <span class="n">file_suffix</span><span class="o">=</span><span class="s2">&quot;_yyy&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">summary_record</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">pass</span> <span class="c1"># summary_record autoclosed</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="mindspore.train.summary.SummaryRecord.flush">
<code class="sig-name descname">flush</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/mindspore/train/summary/summary_record.html#SummaryRecord.flush"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore.train.summary.SummaryRecord.flush" title="Permalink to this definition">¶</a></dt>
<dd><p>Flush the event file to disk.</p>
<p>Call it to make sure that all pending events have been written to disk.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">SummaryRecord</span><span class="p">(</span><span class="n">log_dir</span><span class="o">=</span><span class="s2">&quot;/opt/log&quot;</span><span class="p">,</span> <span class="n">file_prefix</span><span class="o">=</span><span class="s2">&quot;xxx_&quot;</span><span class="p">,</span> <span class="n">file_suffix</span><span class="o">=</span><span class="s2">&quot;_yyy&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">summary_record</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">summary_record</span><span class="o">.</span><span class="n">flush</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="mindspore.train.summary.SummaryRecord.log_dir">
<em class="property">property </em><code class="sig-name descname">log_dir</code><a class="headerlink" href="#mindspore.train.summary.SummaryRecord.log_dir" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the full path of the log file.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>str, the full path of log file.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">SummaryRecord</span><span class="p">(</span><span class="n">log_dir</span><span class="o">=</span><span class="s2">&quot;/opt/log&quot;</span><span class="p">,</span> <span class="n">file_prefix</span><span class="o">=</span><span class="s2">&quot;xxx_&quot;</span><span class="p">,</span> <span class="n">file_suffix</span><span class="o">=</span><span class="s2">&quot;_yyy&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">summary_record</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="nb">print</span><span class="p">(</span><span class="n">summary_record</span><span class="o">.</span><span class="n">log_dir</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="mindspore.train.summary.SummaryRecord.record">
<code class="sig-name descname">record</code><span class="sig-paren">(</span><em class="sig-param">step</em>, <em class="sig-param">train_network=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/mindspore/train/summary/summary_record.html#SummaryRecord.record"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore.train.summary.SummaryRecord.record" title="Permalink to this definition">¶</a></dt>
<dd><p>Record the summary.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>step</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Represents training step number.</p></li>
<li><p><strong>train_network</strong> (<a class="reference internal" href="mindspore.nn.html#mindspore.nn.Cell" title="mindspore.nn.Cell"><em>Cell</em></a>) – The network that called the callback.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>bool, whether the record process is successful or not.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">SummaryRecord</span><span class="p">(</span><span class="n">log_dir</span><span class="o">=</span><span class="s2">&quot;/opt/log&quot;</span><span class="p">,</span> <span class="n">file_prefix</span><span class="o">=</span><span class="s2">&quot;xxx_&quot;</span><span class="p">,</span> <span class="n">file_suffix</span><span class="o">=</span><span class="s2">&quot;_yyy&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">summary_record</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">summary_record</span><span class="o">.</span><span class="n">record</span><span class="p">(</span><span class="n">step</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="mindspore.train.summary.SummaryRecord.set_mode">
<code class="sig-name descname">set_mode</code><span class="sig-paren">(</span><em class="sig-param">mode</em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/mindspore/train/summary/summary_record.html#SummaryRecord.set_mode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore.train.summary.SummaryRecord.set_mode" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the mode for the recorder to be aware. The mode is set ‘train’ by default.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – The mode to set, which should be ‘train’ or ‘eval’.</p>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/library/exceptions.html#ValueError" title="(in Python v3.8)"><strong>ValueError</strong></a> – When the mode is not recognized.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">with</span> <span class="n">SummaryRecord</span><span class="p">(</span><span class="n">log_dir</span><span class="o">=</span><span class="s2">&quot;/opt/log&quot;</span><span class="p">,</span> <span class="n">file_prefix</span><span class="o">=</span><span class="s2">&quot;xxx_&quot;</span><span class="p">,</span> <span class="n">file_suffix</span><span class="o">=</span><span class="s2">&quot;_yyy&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">summary_record</span><span class="p">:</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">summary_record</span><span class="o">.</span><span class="n">set_mode</span><span class="p">(</span><span class="s1">&#39;eval&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-mindspore.train.callback">
<span id="mindspore-train-callback"></span><h2>mindspore.train.callback<a class="headerlink" href="#module-mindspore.train.callback" title="Permalink to this headline">¶</a></h2>
<p>Callback related classes and functions.</p>
<dl class="class">
<dt id="mindspore.train.callback.Callback">
<em class="property">class </em><code class="sig-prename descclassname">mindspore.train.callback.</code><code class="sig-name descname">Callback</code><a class="reference internal" href="../../../_modules/mindspore/train/callback/_callback.html#Callback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore.train.callback.Callback" title="Permalink to this definition">¶</a></dt>
<dd><p>Abstract base class used to build a callback class. Callbacks are context managers
which will be entered and exited when passing into the Model.
You can leverage this mechanism to init and release resources automatically.</p>
<p>Callback function will execution some operating to the current step or epoch.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Print_info</span><span class="p">(</span><span class="n">Callback</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">def</span> <span class="nf">step_end</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">run_context</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="n">cb_params</span> <span class="o">=</span> <span class="n">run_context</span><span class="o">.</span><span class="n">original_args</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="nb">print</span><span class="p">(</span><span class="n">cb_params</span><span class="o">.</span><span class="n">cur_epoch_num</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="nb">print</span><span class="p">(</span><span class="n">cb_params</span><span class="o">.</span><span class="n">cur_step_num</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">print_cb</span> <span class="o">=</span> <span class="n">Print_info</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">epoch</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">callbacks</span><span class="o">=</span><span class="n">print_cb</span><span class="p">)</span>
</pre></div>
</div>
<dl class="method">
<dt id="mindspore.train.callback.Callback.begin">
<code class="sig-name descname">begin</code><span class="sig-paren">(</span><em class="sig-param">run_context</em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/mindspore/train/callback/_callback.html#Callback.begin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore.train.callback.Callback.begin" title="Permalink to this definition">¶</a></dt>
<dd><p>Called once before the network executing.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>run_context</strong> (<a class="reference internal" href="#mindspore.train.callback.RunContext" title="mindspore.train.callback.RunContext"><em>RunContext</em></a>) – Include some information of the model.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore.train.callback.Callback.end">
<code class="sig-name descname">end</code><span class="sig-paren">(</span><em class="sig-param">run_context</em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/mindspore/train/callback/_callback.html#Callback.end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore.train.callback.Callback.end" title="Permalink to this definition">¶</a></dt>
<dd><p>Called once after network training.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>run_context</strong> (<a class="reference internal" href="#mindspore.train.callback.RunContext" title="mindspore.train.callback.RunContext"><em>RunContext</em></a>) – Include some information of the model.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore.train.callback.Callback.epoch_begin">
<code class="sig-name descname">epoch_begin</code><span class="sig-paren">(</span><em class="sig-param">run_context</em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/mindspore/train/callback/_callback.html#Callback.epoch_begin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore.train.callback.Callback.epoch_begin" title="Permalink to this definition">¶</a></dt>
<dd><p>Called before each epoch beginning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>run_context</strong> (<a class="reference internal" href="#mindspore.train.callback.RunContext" title="mindspore.train.callback.RunContext"><em>RunContext</em></a>) – Include some information of the model.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore.train.callback.Callback.epoch_end">
<code class="sig-name descname">epoch_end</code><span class="sig-paren">(</span><em class="sig-param">run_context</em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/mindspore/train/callback/_callback.html#Callback.epoch_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore.train.callback.Callback.epoch_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Called after each epoch finished.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>run_context</strong> (<a class="reference internal" href="#mindspore.train.callback.RunContext" title="mindspore.train.callback.RunContext"><em>RunContext</em></a>) – Include some information of the model.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore.train.callback.Callback.step_begin">
<code class="sig-name descname">step_begin</code><span class="sig-paren">(</span><em class="sig-param">run_context</em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/mindspore/train/callback/_callback.html#Callback.step_begin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore.train.callback.Callback.step_begin" title="Permalink to this definition">¶</a></dt>
<dd><p>Called before each epoch beginning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>run_context</strong> (<a class="reference internal" href="#mindspore.train.callback.RunContext" title="mindspore.train.callback.RunContext"><em>RunContext</em></a>) – Include some information of the model.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore.train.callback.Callback.step_end">
<code class="sig-name descname">step_end</code><span class="sig-paren">(</span><em class="sig-param">run_context</em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/mindspore/train/callback/_callback.html#Callback.step_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore.train.callback.Callback.step_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Called after each step finished.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>run_context</strong> (<a class="reference internal" href="#mindspore.train.callback.RunContext" title="mindspore.train.callback.RunContext"><em>RunContext</em></a>) – Include some information of the model.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mindspore.train.callback.LossMonitor">
<em class="property">class </em><code class="sig-prename descclassname">mindspore.train.callback.</code><code class="sig-name descname">LossMonitor</code><span class="sig-paren">(</span><em class="sig-param">per_print_times=1</em>, <em class="sig-param">lr_init=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/mindspore/train/callback/_loss_monitor.html#LossMonitor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore.train.callback.LossMonitor" title="Permalink to this definition">¶</a></dt>
<dd><p>Monitor the loss in training.</p>
<p>If the loss is NAN or INF, it will terminate training.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If per_print_times is 0 do not print loss.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>per_print_times</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Print loss every times. Default: 1.</p></li>
<li><p><strong>lr_init</strong> (<em>numpy array</em>) – train learning rate. Default: None.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/library/exceptions.html#ValueError" title="(in Python v3.8)"><strong>ValueError</strong></a> – If print_step is not int or less than zero.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">LossMonitor</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">lr_init</span><span class="o">=</span><span class="n">Tensor</span><span class="p">([</span><span class="mf">0.05</span><span class="p">]</span><span class="o">*</span><span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">asnumpy</span><span class="p">())</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="mindspore.train.callback.TimeMonitor">
<em class="property">class </em><code class="sig-prename descclassname">mindspore.train.callback.</code><code class="sig-name descname">TimeMonitor</code><span class="sig-paren">(</span><em class="sig-param">data_size</em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/mindspore/train/callback/_time_monitor.html#TimeMonitor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore.train.callback.TimeMonitor" title="Permalink to this definition">¶</a></dt>
<dd><p>Time Monitor.</p>
</dd></dl>

<dl class="class">
<dt id="mindspore.train.callback.ModelCheckpoint">
<em class="property">class </em><code class="sig-prename descclassname">mindspore.train.callback.</code><code class="sig-name descname">ModelCheckpoint</code><span class="sig-paren">(</span><em class="sig-param">prefix='CKP'</em>, <em class="sig-param">directory=None</em>, <em class="sig-param">config=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/mindspore/train/callback/_checkpoint.html#ModelCheckpoint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore.train.callback.ModelCheckpoint" title="Permalink to this definition">¶</a></dt>
<dd><p>The checkpoint callback class.</p>
<p>It is called to combine with train process and save the model and network parameters after traning.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>prefix</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – Checkpoint files names prefix. Default: “CKP”.</p></li>
<li><p><strong>directory</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – Folder path into which checkpoint files will be saved. Default: None.</p></li>
<li><p><strong>config</strong> (<a class="reference internal" href="#mindspore.train.callback.CheckpointConfig" title="mindspore.train.callback.CheckpointConfig"><em>CheckpointConfig</em></a>) – Checkpoint strategy config. Default: None.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/library/exceptions.html#ValueError" title="(in Python v3.8)"><strong>ValueError</strong></a> – If the prefix is invalid.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/library/exceptions.html#TypeError" title="(in Python v3.8)"><strong>TypeError</strong></a> – If the config is not CheckpointConfig type.</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="mindspore.train.callback.ModelCheckpoint.end">
<code class="sig-name descname">end</code><span class="sig-paren">(</span><em class="sig-param">run_context</em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/mindspore/train/callback/_checkpoint.html#ModelCheckpoint.end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore.train.callback.ModelCheckpoint.end" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the last checkpoint after training finished.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>run_context</strong> (<a class="reference internal" href="#mindspore.train.callback.RunContext" title="mindspore.train.callback.RunContext"><em>RunContext</em></a>) – Context of the train running.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore.train.callback.ModelCheckpoint.latest_ckpt_file_name">
<em class="property">property </em><code class="sig-name descname">latest_ckpt_file_name</code><a class="headerlink" href="#mindspore.train.callback.ModelCheckpoint.latest_ckpt_file_name" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the latest checkpoint path and file name.</p>
</dd></dl>

<dl class="method">
<dt id="mindspore.train.callback.ModelCheckpoint.step_end">
<code class="sig-name descname">step_end</code><span class="sig-paren">(</span><em class="sig-param">run_context</em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/mindspore/train/callback/_checkpoint.html#ModelCheckpoint.step_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore.train.callback.ModelCheckpoint.step_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the checkpoint at the end of step.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>run_context</strong> (<a class="reference internal" href="#mindspore.train.callback.RunContext" title="mindspore.train.callback.RunContext"><em>RunContext</em></a>) – Context of the train running.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mindspore.train.callback.SummaryCollector">
<em class="property">class </em><code class="sig-prename descclassname">mindspore.train.callback.</code><code class="sig-name descname">SummaryCollector</code><span class="sig-paren">(</span><em class="sig-param">summary_dir</em>, <em class="sig-param">collect_freq=10</em>, <em class="sig-param">collect_specified_data=None</em>, <em class="sig-param">keep_default_action=True</em>, <em class="sig-param">custom_lineage_data=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/mindspore/train/callback/_summary_collector.html#SummaryCollector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore.train.callback.SummaryCollector" title="Permalink to this definition">¶</a></dt>
<dd><p>SummaryCollector can help you to collect some common information.</p>
<p>It can help you to collect loss, learning late, computational graph and so on.
SummaryCollector also persists data collected by the summary operator into a summary file.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<ol class="arabic simple">
<li><p>Multiple SummaryCollector instances in callback list are not allowed.</p></li>
<li><p>Not all information is collected at the training phase or at the eval phase.</p></li>
<li><p>SummaryCollector always record the data collected by the summary operator.</p></li>
</ol>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>summary_dir</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – The collected data will be persisted to this directory.
If the directory does not exist, it will be created automatically.</p></li>
<li><p><strong>collect_freq</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Set the frequency of data collection, it should be greater then zero,
and the unit is <cite>step</cite>. Default: 10. The first step will be recorded at any time.
It is important to note that if the data sink mode is used, the unit will become the <cite>epoch</cite>.
It is not recommended to collect data too frequently, which can affect performance.</p></li>
<li><p><strong>collect_specified_data</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/library/constants.html#None" title="(in Python v3.8)"><em>None</em></a><em>, </em><a class="reference external" href="https://docs.python.org/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a><em>]</em>) – <p>Perform custom operations on the collected data. Default: None.
By default, if set to None, all data is collected as the default behavior.
If you want to customize the data collected, you can do so with a dictionary.
Examples,you can set {‘collect_metric’: False} to control not collecting metrics.
The data that supports control is shown below.</p>
<ul>
<li><p>collect_metric: Whether to collect training metrics, currently only loss is collected.
Optional: True/False. Default: True.</p></li>
<li><p>collect_graph: Whether to collect computational graph, currently only
training computational graph is collected. Optional: True/False. Default: True.</p></li>
<li><p>collect_train_lineage: Whether to collect lineage data for the training phase,
this field will be displayed on the lineage page of Mindinsight. Optional: True/False. Default: True.</p></li>
<li><p>collect_eval_lineage: Whether to collect lineage data for the eval phase,
this field will be displayed on the lineage page of Mindinsight. Optional: True/False. Default: True.</p></li>
<li><p>collect_input_data: Whether to collect dataset for each training. Currently only image data is supported.
Optional: True/False. Default: True.</p></li>
<li><p>collect_dataset_graph: Whether to collect dataset graph for the training phase.
Optional: True/False. Default: True.</p></li>
<li><p>histogram_regular: Collect weight and bias for parameter distribution page display in MindInsight.
This field allows regular strings to control which parameters to collect.
Default: None, it means only the first five parameters are collected.
It is not recommended to collect too many parameters at once, as it can affect performance.
Note that if you collect too many parameters and run out of memory, the training will fail.</p></li>
</ul>
</p></li>
<li><p><strong>keep_default_action</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – This field affects the collection behavior of the ‘collect_specified_data’ field.
Optional: True/False, Default: True.
True: means that after specified data is set, non-specified data is collected as the default behavior.
False: means that after specified data is set, only the specified data is collected,
and the others are not collected.</p></li>
<li><p><strong>custom_lineage_data</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a><em>, </em><a class="reference external" href="https://docs.python.org/library/constants.html#None" title="(in Python v3.8)"><em>None</em></a><em>]</em>) – Allows you to customize the data and present it on the MingInsight
lineage page. In the custom data, the key type support str, and the value type support str/int/float.
Default: None, it means there is no custom data.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/library/exceptions.html#ValueError" title="(in Python v3.8)"><strong>ValueError</strong></a> – If the parameter value is not expected.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/library/exceptions.html#TypeError" title="(in Python v3.8)"><strong>TypeError</strong></a> – If the parameter type is not expected.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/library/exceptions.html#RuntimeError" title="(in Python v3.8)"><strong>RuntimeError</strong></a> – If an error occurs during data collection.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="c1"># Simple usage:</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">summary_collector</span> <span class="o">=</span> <span class="n">SummaryCollector</span><span class="p">(</span><span class="n">summary_dir</span><span class="o">=</span><span class="s1">&#39;./summary_dir&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">epoch</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">callbacks</span><span class="o">=</span><span class="n">summary_collector</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Do not collect metric and collect the first layer parameter, others are collected by default</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">specified</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;collect_metric&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">,</span> <span class="s1">&#39;histogram_regular&#39;</span><span class="p">:</span> <span class="s1">&#39;^conv1.*&#39;</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">summary_collector</span> <span class="o">=</span> <span class="n">SummaryCollector</span><span class="p">(</span><span class="n">summary_dir</span><span class="o">=</span><span class="s1">&#39;./summary_dir&#39;</span><span class="p">,</span> <span class="n">collect_specified_data</span><span class="o">=</span><span class="n">specified</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">epoch</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">callbacks</span><span class="o">=</span><span class="n">summary_collector</span><span class="p">)</span>
<span class="go">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Only collect metric, custom lineage data and record data that collected by the summary operator,</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># others are not collected</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">specified</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;collect_metric&#39;</span><span class="p">:</span><span class="kc">True</span><span class="p">,</span> <span class="s1">&#39;custom_lineage_data&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;version&#39;</span><span class="p">:</span> <span class="s1">&#39;resnet50_v1&#39;</span><span class="p">}}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">summary_collector</span> <span class="o">=</span> <span class="n">SummaryCollector</span><span class="p">(</span><span class="s1">&#39;./summary_dir&#39;</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                     <span class="n">collect_specified_data</span><span class="o">=</span><span class="n">specified</span><span class="p">,</span>
<span class="gp">&gt;&gt;&gt; </span>                                     <span class="n">keep_default_action</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">epoch</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">callbacks</span><span class="o">=</span><span class="n">summary_collector</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="mindspore.train.callback.CheckpointConfig">
<em class="property">class </em><code class="sig-prename descclassname">mindspore.train.callback.</code><code class="sig-name descname">CheckpointConfig</code><span class="sig-paren">(</span><em class="sig-param">save_checkpoint_steps=1</em>, <em class="sig-param">save_checkpoint_seconds=0</em>, <em class="sig-param">keep_checkpoint_max=5</em>, <em class="sig-param">keep_checkpoint_per_n_minutes=0</em>, <em class="sig-param">integrated_save=True</em>, <em class="sig-param">model_type='normal'</em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/mindspore/train/callback/_checkpoint.html#CheckpointConfig"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore.train.callback.CheckpointConfig" title="Permalink to this definition">¶</a></dt>
<dd><p>The config for model checkpoint.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>During the training process, if dataset is transmitted through the data channel,
suggest set save_checkpoint_steps be an integer multiple of loop_size.
Otherwise there may be deviation in the timing of saving checkpoint.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_checkpoint_steps</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Steps to save checkpoint. Default: 1.</p></li>
<li><p><strong>save_checkpoint_seconds</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Seconds to save checkpoint. Default: 0.
Can’t be used with save_checkpoint_steps at the same time.</p></li>
<li><p><strong>keep_checkpoint_max</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Maximum step to save checkpoint. Default: 5.</p></li>
<li><p><strong>keep_checkpoint_per_n_minutes</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Keep one checkpoint every n minutes. Default: 0.
Can’t be used with keep_checkpoint_max at the same time.</p></li>
<li><p><strong>integrated_save</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Whether to intergrated save in automatic model parallel scene. Default: True.
Integrated save function is only supported in automatic parallel scene, not supported in manual parallel.</p></li>
<li><p><strong>model_type</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – Model type in <cite>normal</cite>, <cite>fusion</cite> or <cite>quant</cite>. Default: “normal”.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/library/exceptions.html#ValueError" title="(in Python v3.8)"><strong>ValueError</strong></a> – If the input_param is None or 0.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">config</span> <span class="o">=</span> <span class="n">CheckpointConfig</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ckpoint_cb</span> <span class="o">=</span> <span class="n">ModelCheckpoint</span><span class="p">(</span><span class="n">prefix</span><span class="o">=</span><span class="s2">&quot;ck_prefix&quot;</span><span class="p">,</span> <span class="n">directory</span><span class="o">=</span><span class="s1">&#39;./&#39;</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="n">config</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">callbacks</span><span class="o">=</span><span class="n">ckpoint_cb</span><span class="p">)</span>
</pre></div>
</div>
<dl class="method">
<dt id="mindspore.train.callback.CheckpointConfig.get_checkpoint_policy">
<code class="sig-name descname">get_checkpoint_policy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/mindspore/train/callback/_checkpoint.html#CheckpointConfig.get_checkpoint_policy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore.train.callback.CheckpointConfig.get_checkpoint_policy" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the policy of checkpoint.</p>
</dd></dl>

<dl class="method">
<dt id="mindspore.train.callback.CheckpointConfig.integrated_save">
<em class="property">property </em><code class="sig-name descname">integrated_save</code><a class="headerlink" href="#mindspore.train.callback.CheckpointConfig.integrated_save" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the value of _integrated_save.</p>
</dd></dl>

<dl class="method">
<dt id="mindspore.train.callback.CheckpointConfig.keep_checkpoint_max">
<em class="property">property </em><code class="sig-name descname">keep_checkpoint_max</code><a class="headerlink" href="#mindspore.train.callback.CheckpointConfig.keep_checkpoint_max" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the value of _keep_checkpoint_max.</p>
</dd></dl>

<dl class="method">
<dt id="mindspore.train.callback.CheckpointConfig.keep_checkpoint_per_n_minutes">
<em class="property">property </em><code class="sig-name descname">keep_checkpoint_per_n_minutes</code><a class="headerlink" href="#mindspore.train.callback.CheckpointConfig.keep_checkpoint_per_n_minutes" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the value of _keep_checkpoint_per_n_minutes.</p>
</dd></dl>

<dl class="method">
<dt id="mindspore.train.callback.CheckpointConfig.model_type">
<em class="property">property </em><code class="sig-name descname">model_type</code><a class="headerlink" href="#mindspore.train.callback.CheckpointConfig.model_type" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the value of model_type.</p>
</dd></dl>

<dl class="method">
<dt id="mindspore.train.callback.CheckpointConfig.save_checkpoint_seconds">
<em class="property">property </em><code class="sig-name descname">save_checkpoint_seconds</code><a class="headerlink" href="#mindspore.train.callback.CheckpointConfig.save_checkpoint_seconds" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the value of _save_checkpoint_seconds.</p>
</dd></dl>

<dl class="method">
<dt id="mindspore.train.callback.CheckpointConfig.save_checkpoint_steps">
<em class="property">property </em><code class="sig-name descname">save_checkpoint_steps</code><a class="headerlink" href="#mindspore.train.callback.CheckpointConfig.save_checkpoint_steps" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the value of _save_checkpoint_steps.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mindspore.train.callback.RunContext">
<em class="property">class </em><code class="sig-prename descclassname">mindspore.train.callback.</code><code class="sig-name descname">RunContext</code><span class="sig-paren">(</span><em class="sig-param">original_args</em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/mindspore/train/callback/_callback.html#RunContext"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore.train.callback.RunContext" title="Permalink to this definition">¶</a></dt>
<dd><p>Provides information about the model.</p>
<p>Run call being made. Provides information about original request to model function.
callback objects can stop the loop by calling request_stop() of run_context.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>original_args</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – Holding the related information of model etc.</p>
</dd>
</dl>
<dl class="method">
<dt id="mindspore.train.callback.RunContext.get_stop_requested">
<code class="sig-name descname">get_stop_requested</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/mindspore/train/callback/_callback.html#RunContext.get_stop_requested"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore.train.callback.RunContext.get_stop_requested" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns whether a stop is requested or not.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>bool, if true, model.train() stops iterations.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore.train.callback.RunContext.original_args">
<code class="sig-name descname">original_args</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/mindspore/train/callback/_callback.html#RunContext.original_args"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore.train.callback.RunContext.original_args" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the _original_args object.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Dict, a object holding the original arguments of model.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore.train.callback.RunContext.request_stop">
<code class="sig-name descname">request_stop</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/mindspore/train/callback/_callback.html#RunContext.request_stop"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore.train.callback.RunContext.request_stop" title="Permalink to this definition">¶</a></dt>
<dd><p>Sets stop requested during training.</p>
<p>Callbacks can use this function to request stop of iterations.
model.train() checks whether this is called or not.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-mindspore.train.serialization">
<span id="mindspore-train-serialization"></span><h2>mindspore.train.serialization<a class="headerlink" href="#module-mindspore.train.serialization" title="Permalink to this headline">¶</a></h2>
<p>Model and parameters serialization.</p>
<dl class="function">
<dt id="mindspore.train.serialization.save_checkpoint">
<code class="sig-prename descclassname">mindspore.train.serialization.</code><code class="sig-name descname">save_checkpoint</code><span class="sig-paren">(</span><em class="sig-param">parameter_list</em>, <em class="sig-param">ckpt_file_name</em>, <em class="sig-param">model_type='normal'</em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/mindspore/train/serialization.html#save_checkpoint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore.train.serialization.save_checkpoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Saves checkpoint info to a specified file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>parameter_list</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a>) – Parameters list, each element is a dict
like {“name”:xx, “type”:xx, “shape”:xx, “data”:xx}.</p></li>
<li><p><strong>ckpt_file_name</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – Checkpoint file name.</p></li>
<li><p><strong>model_type</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – The name of model type. Default: “normal”.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/library/exceptions.html#RuntimeError" title="(in Python v3.8)"><strong>RuntimeError</strong></a> – Failed to save the Checkpoint file.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mindspore.train.serialization.load_checkpoint">
<code class="sig-prename descclassname">mindspore.train.serialization.</code><code class="sig-name descname">load_checkpoint</code><span class="sig-paren">(</span><em class="sig-param">ckpt_file_name</em>, <em class="sig-param">model_type='normal'</em>, <em class="sig-param">net=None</em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/mindspore/train/serialization.html#load_checkpoint"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore.train.serialization.load_checkpoint" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads checkpoint info from a specified file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ckpt_file_name</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – Checkpoint file name.</p></li>
<li><p><strong>model_type</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – The name of model type in <cite>normal</cite>, <cite>fusion</cite> or <cite>quant</cite>. Default: “normal”.</p></li>
<li><p><strong>net</strong> (<a class="reference internal" href="mindspore.nn.html#mindspore.nn.Cell" title="mindspore.nn.Cell"><em>Cell</em></a>) – Cell network. Default: None</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Dict, key is parameter name, value is a Parameter.</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/library/exceptions.html#ValueError" title="(in Python v3.8)"><strong>ValueError</strong></a> – Checkpoint file is incorrect.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mindspore.train.serialization.load_param_into_net">
<code class="sig-prename descclassname">mindspore.train.serialization.</code><code class="sig-name descname">load_param_into_net</code><span class="sig-paren">(</span><em class="sig-param">net</em>, <em class="sig-param">parameter_dict</em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/mindspore/train/serialization.html#load_param_into_net"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore.train.serialization.load_param_into_net" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads parameters into network.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>net</strong> (<a class="reference internal" href="mindspore.nn.html#mindspore.nn.Cell" title="mindspore.nn.Cell"><em>Cell</em></a>) – Cell network.</p></li>
<li><p><strong>parameter_dict</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – Parameter dict.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/library/exceptions.html#TypeError" title="(in Python v3.8)"><strong>TypeError</strong></a> – Argument is not a Cell, or parameter_dict is not a Parameter dict.</p>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mindspore.train.serialization.export">
<code class="sig-prename descclassname">mindspore.train.serialization.</code><code class="sig-name descname">export</code><span class="sig-paren">(</span><em class="sig-param">net</em>, <em class="sig-param">*inputs</em>, <em class="sig-param">file_name</em>, <em class="sig-param">file_format='GEIR'</em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/mindspore/train/serialization.html#export"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore.train.serialization.export" title="Permalink to this definition">¶</a></dt>
<dd><p>Exports MindSpore predict model to file in specified format.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>net</strong> (<a class="reference internal" href="mindspore.nn.html#mindspore.nn.Cell" title="mindspore.nn.Cell"><em>Cell</em></a>) – MindSpore network.</p></li>
<li><p><strong>inputs</strong> (<a class="reference internal" href="mindspore.html#mindspore.Tensor" title="mindspore.Tensor"><em>Tensor</em></a>) – Inputs of the <cite>net</cite>.</p></li>
<li><p><strong>file_name</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – File name of model to export.</p></li>
<li><p><strong>file_format</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – <p>MindSpore currently supports ‘GEIR’, ‘ONNX’ ‘LITE’ and ‘BINARY’ format for exported model.</p>
<ul>
<li><p>GEIR: Graph Engine Intermidiate Representation. An intermidiate representation format of
Ascend model.</p></li>
<li><p>ONNX: Open Neural Network eXchange. An open format built to represent machine learning models.</p></li>
<li><p>BINARY: Binary format for model. An intermidiate representation format for models.</p></li>
</ul>
</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="function">
<dt id="mindspore.train.serialization.parse_print">
<code class="sig-prename descclassname">mindspore.train.serialization.</code><code class="sig-name descname">parse_print</code><span class="sig-paren">(</span><em class="sig-param">print_file_name</em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/mindspore/train/serialization.html#parse_print"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore.train.serialization.parse_print" title="Permalink to this definition">¶</a></dt>
<dd><p>Loads Print data from a specified file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>print_file_name</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – The file name of save print data.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>List, element of list is Tensor.</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/library/exceptions.html#ValueError" title="(in Python v3.8)"><strong>ValueError</strong></a> – Print file is incorrect.</p>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-mindspore.train.amp">
<span id="mindspore-train-amp"></span><h2>mindspore.train.amp<a class="headerlink" href="#module-mindspore.train.amp" title="Permalink to this headline">¶</a></h2>
<p>Auto mixed precision.</p>
<dl class="function">
<dt id="mindspore.train.amp.build_train_network">
<code class="sig-prename descclassname">mindspore.train.amp.</code><code class="sig-name descname">build_train_network</code><span class="sig-paren">(</span><em class="sig-param">network</em>, <em class="sig-param">optimizer</em>, <em class="sig-param">loss_fn=None</em>, <em class="sig-param">level='O0'</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/mindspore/train/amp.html#build_train_network"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore.train.amp.build_train_network" title="Permalink to this definition">¶</a></dt>
<dd><p>Build the mixed precision training cell automatically.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>network</strong> (<a class="reference internal" href="mindspore.nn.html#mindspore.nn.Cell" title="mindspore.nn.Cell"><em>Cell</em></a>) – Definition of the network.</p></li>
<li><p><strong>loss_fn</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/library/constants.html#None" title="(in Python v3.8)"><em>None</em></a><em>, </em><a class="reference internal" href="mindspore.nn.html#mindspore.nn.Cell" title="mindspore.nn.Cell"><em>Cell</em></a><em>]</em>) – Definition of the loss_fn. If None, the <cite>network</cite> should have the loss inside.
Default: None.</p></li>
<li><p><strong>optimizer</strong> (<a class="reference internal" href="mindspore.nn.html#mindspore.nn.Optimizer" title="mindspore.nn.Optimizer"><em>Optimizer</em></a>) – Optimizer to update the Parameter.</p></li>
<li><p><strong>level</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – <p>Supports [O0, O2, O3]. Default: “O0”.</p>
<ul>
<li><p>O0: Do not change.</p></li>
<li><p>O2: Cast network to float16, keep batchnorm and <cite>loss_fn</cite> (if set) run in float32,
using dynamic loss scale.</p></li>
<li><p>O3: Cast network to float16, with additional property ‘keep_batchnorm_fp32=False’.</p></li>
</ul>
<p>O2 is recommended on GPU, O3 is recommended on Ascend.</p>
</p></li>
<li><p><strong>cast_model_type</strong> (<a class="reference internal" href="mindspore.dtype.html#mindspore.dtype" title="mindspore.dtype"><code class="xref py py-class docutils literal notranslate"><span class="pre">mindspore.dtype</span></code></a>) – Supports <cite>mstype.float16</cite> or <cite>mstype.float32</cite>.
If set to <cite>mstype.float16</cite>, use <cite>float16</cite> mode to train. If set, overwrite the level setting.</p></li>
<li><p><strong>keep_batchnorm_fp32</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Keep Batchnorm run in <cite>float32</cite>. If set, overwrite the level setting.</p></li>
<li><p><strong>loss_scale_manager</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/library/constants.html#None" title="(in Python v3.8)"><em>None</em></a><em>, </em><a class="reference internal" href="#mindspore.train.loss_scale_manager.LossScaleManager" title="mindspore.train.loss_scale_manager.LossScaleManager"><em>LossScaleManager</em></a><em>]</em>) – If None, not scale the loss, or else
scale the loss by LossScaleManager. If set, overwrite the level setting.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</div>
<div class="section" id="module-mindspore.train.loss_scale_manager">
<span id="mindspore-train-loss-scale-manager"></span><h2>mindspore.train.loss_scale_manager<a class="headerlink" href="#module-mindspore.train.loss_scale_manager" title="Permalink to this headline">¶</a></h2>
<p>Loss scale manager abstract class.</p>
<dl class="class">
<dt id="mindspore.train.loss_scale_manager.LossScaleManager">
<em class="property">class </em><code class="sig-prename descclassname">mindspore.train.loss_scale_manager.</code><code class="sig-name descname">LossScaleManager</code><a class="reference internal" href="../../../_modules/mindspore/train/loss_scale_manager.html#LossScaleManager"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore.train.loss_scale_manager.LossScaleManager" title="Permalink to this definition">¶</a></dt>
<dd><p>Loss scale manager abstract class.</p>
<dl class="method">
<dt id="mindspore.train.loss_scale_manager.LossScaleManager.get_loss_scale">
<code class="sig-name descname">get_loss_scale</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/mindspore/train/loss_scale_manager.html#LossScaleManager.get_loss_scale"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore.train.loss_scale_manager.LossScaleManager.get_loss_scale" title="Permalink to this definition">¶</a></dt>
<dd><p>Get loss scale value.</p>
</dd></dl>

<dl class="method">
<dt id="mindspore.train.loss_scale_manager.LossScaleManager.get_update_cell">
<code class="sig-name descname">get_update_cell</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/mindspore/train/loss_scale_manager.html#LossScaleManager.get_update_cell"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore.train.loss_scale_manager.LossScaleManager.get_update_cell" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the loss scaling update logic cell.</p>
</dd></dl>

<dl class="method">
<dt id="mindspore.train.loss_scale_manager.LossScaleManager.update_loss_scale">
<code class="sig-name descname">update_loss_scale</code><span class="sig-paren">(</span><em class="sig-param">overflow</em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/mindspore/train/loss_scale_manager.html#LossScaleManager.update_loss_scale"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore.train.loss_scale_manager.LossScaleManager.update_loss_scale" title="Permalink to this definition">¶</a></dt>
<dd><p>Update loss scale value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>overflow</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Whether it overflows.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mindspore.train.loss_scale_manager.FixedLossScaleManager">
<em class="property">class </em><code class="sig-prename descclassname">mindspore.train.loss_scale_manager.</code><code class="sig-name descname">FixedLossScaleManager</code><span class="sig-paren">(</span><em class="sig-param">loss_scale=128.0</em>, <em class="sig-param">drop_overflow_update=True</em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/mindspore/train/loss_scale_manager.html#FixedLossScaleManager"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore.train.loss_scale_manager.FixedLossScaleManager" title="Permalink to this definition">¶</a></dt>
<dd><p>Fixed loss-scale manager.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>loss_scale</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – Loss scale. Default: 128.0.</p></li>
<li><p><strong>drop_overflow_update</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – whether to do optimizer if there is overflow. Default: True.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">loss_scale_manager</span> <span class="o">=</span> <span class="n">FixedLossScaleManager</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="n">loss_scale_manager</span><span class="o">=</span><span class="n">loss_scale_manager</span><span class="p">)</span>
</pre></div>
</div>
<dl class="method">
<dt id="mindspore.train.loss_scale_manager.FixedLossScaleManager.get_drop_overflow_update">
<code class="sig-name descname">get_drop_overflow_update</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/mindspore/train/loss_scale_manager.html#FixedLossScaleManager.get_drop_overflow_update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore.train.loss_scale_manager.FixedLossScaleManager.get_drop_overflow_update" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the flag whether to drop optimizer update when there is overflow happened</p>
</dd></dl>

<dl class="method">
<dt id="mindspore.train.loss_scale_manager.FixedLossScaleManager.get_loss_scale">
<code class="sig-name descname">get_loss_scale</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/mindspore/train/loss_scale_manager.html#FixedLossScaleManager.get_loss_scale"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore.train.loss_scale_manager.FixedLossScaleManager.get_loss_scale" title="Permalink to this definition">¶</a></dt>
<dd><p>Get loss scale value.</p>
</dd></dl>

<dl class="method">
<dt id="mindspore.train.loss_scale_manager.FixedLossScaleManager.get_update_cell">
<code class="sig-name descname">get_update_cell</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/mindspore/train/loss_scale_manager.html#FixedLossScaleManager.get_update_cell"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore.train.loss_scale_manager.FixedLossScaleManager.get_update_cell" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the cell for <cite>TrainOneStepWithLossScaleCell</cite></p>
</dd></dl>

<dl class="method">
<dt id="mindspore.train.loss_scale_manager.FixedLossScaleManager.update_loss_scale">
<code class="sig-name descname">update_loss_scale</code><span class="sig-paren">(</span><em class="sig-param">overflow</em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/mindspore/train/loss_scale_manager.html#FixedLossScaleManager.update_loss_scale"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore.train.loss_scale_manager.FixedLossScaleManager.update_loss_scale" title="Permalink to this definition">¶</a></dt>
<dd><p>Update loss scale value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>overflow</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Whether it overflows.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mindspore.train.loss_scale_manager.DynamicLossScaleManager">
<em class="property">class </em><code class="sig-prename descclassname">mindspore.train.loss_scale_manager.</code><code class="sig-name descname">DynamicLossScaleManager</code><span class="sig-paren">(</span><em class="sig-param">init_loss_scale=16777216</em>, <em class="sig-param">scale_factor=2</em>, <em class="sig-param">scale_window=2000</em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/mindspore/train/loss_scale_manager.html#DynamicLossScaleManager"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore.train.loss_scale_manager.DynamicLossScaleManager" title="Permalink to this definition">¶</a></dt>
<dd><p>Dynamic loss-scale manager.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>init_loss_scale</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – Init loss scale. Default: 2**24.</p></li>
<li><p><strong>scale_factor</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Coefficient of increase and decrease. Default: 2.</p></li>
<li><p><strong>scale_window</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Maximum continuous normal steps when there is no overflow. Default: 2000.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">loss_scale_manager</span> <span class="o">=</span> <span class="n">DynamicLossScaleManager</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="n">loss_scale_manager</span><span class="o">=</span><span class="n">loss_scale_manager</span><span class="p">)</span>
</pre></div>
</div>
<dl class="method">
<dt id="mindspore.train.loss_scale_manager.DynamicLossScaleManager.get_drop_overflow_update">
<code class="sig-name descname">get_drop_overflow_update</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/mindspore/train/loss_scale_manager.html#DynamicLossScaleManager.get_drop_overflow_update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore.train.loss_scale_manager.DynamicLossScaleManager.get_drop_overflow_update" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the flag whether to drop optimizer update when there is overflow happened</p>
</dd></dl>

<dl class="method">
<dt id="mindspore.train.loss_scale_manager.DynamicLossScaleManager.get_loss_scale">
<code class="sig-name descname">get_loss_scale</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/mindspore/train/loss_scale_manager.html#DynamicLossScaleManager.get_loss_scale"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore.train.loss_scale_manager.DynamicLossScaleManager.get_loss_scale" title="Permalink to this definition">¶</a></dt>
<dd><p>Get loss scale value.</p>
</dd></dl>

<dl class="method">
<dt id="mindspore.train.loss_scale_manager.DynamicLossScaleManager.get_update_cell">
<code class="sig-name descname">get_update_cell</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/mindspore/train/loss_scale_manager.html#DynamicLossScaleManager.get_update_cell"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore.train.loss_scale_manager.DynamicLossScaleManager.get_update_cell" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the cell for <cite>TrainOneStepWithLossScaleCell</cite></p>
</dd></dl>

<dl class="method">
<dt id="mindspore.train.loss_scale_manager.DynamicLossScaleManager.update_loss_scale">
<code class="sig-name descname">update_loss_scale</code><span class="sig-paren">(</span><em class="sig-param">overflow</em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/mindspore/train/loss_scale_manager.html#DynamicLossScaleManager.update_loss_scale"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore.train.loss_scale_manager.DynamicLossScaleManager.update_loss_scale" title="Permalink to this definition">¶</a></dt>
<dd><p>Update loss scale value.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>overflow</strong> – Boolean. Whether it overflows.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-mindspore.train.quant">
<span id="mindspore-train-quant"></span><h2>mindspore.train.quant<a class="headerlink" href="#module-mindspore.train.quant" title="Permalink to this headline">¶</a></h2>
<p>quantization.</p>
<p>User can use aware quantization to train a model. Mindspore supports quantization aware training,
which models quantization errors in both the forward and backward passes using fake-quantization
ops. Note that the entire computation is carried out in floating point. At the end of quantization
aware training, Mindspore provides conversion functions to convert the trained model into lower precision.</p>
<dl class="function">
<dt id="mindspore.train.quant.convert_quant_network">
<code class="sig-prename descclassname">mindspore.train.quant.</code><code class="sig-name descname">convert_quant_network</code><span class="sig-paren">(</span><em class="sig-param">network</em>, <em class="sig-param">bn_fold=False</em>, <em class="sig-param">freeze_bn=0</em>, <em class="sig-param">quant_delay=(0</em>, <em class="sig-param">0)</em>, <em class="sig-param">num_bits=(8</em>, <em class="sig-param">8)</em>, <em class="sig-param">per_channel=(False</em>, <em class="sig-param">False)</em>, <em class="sig-param">symmetric=(False</em>, <em class="sig-param">False)</em>, <em class="sig-param">narrow_range=(False</em>, <em class="sig-param">False)</em><span class="sig-paren">)</span><a class="reference internal" href="../../../_modules/mindspore/train/quant/quant.html#convert_quant_network"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore.train.quant.convert_quant_network" title="Permalink to this definition">¶</a></dt>
<dd><p>Create quantization aware training network.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>network</strong> (<a class="reference internal" href="mindspore.nn.html#mindspore.nn.Cell" title="mindspore.nn.Cell"><em>Cell</em></a>) – Obtain a pipeline through network for saving graph summary.</p></li>
<li><p><strong>bn_fold</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Flag to used bn fold ops for simulation inference operation. Default: False.</p></li>
<li><p><strong>freeze_bn</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Number of steps after which BatchNorm OP parameters used total mean and variance. Default: 0.</p></li>
<li><p><strong>quant_delay</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em> or </em><a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a>) – Number of steps after which weights and activations are quantized during
eval. The first element represent weights and second element represent data flow. Default: (0, 0)</p></li>
<li><p><strong>num_bits</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em> or </em><a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a>) – Number of bits to use for quantizing weights and activations. The first
element represent weights and second element represent data flow. Default: (8, 8)</p></li>
<li><p><strong>per_channel</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a><em>, </em><a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em> or </em><a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a>) – Quantization granularity based on layer or on channel. If <cite>True</cite>
then base on per channel otherwise base on per layer. The first element represent weights
and second element represent data flow. Default: (False, False)</p></li>
<li><p><strong>symmetric</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a><em>, </em><a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em> or </em><a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a>) – Quantization algorithm use symmetric or not. If <cite>True</cite> then base on
symmetric otherwise base on asymmetric. The first element represent weights and second
element represent data flow. Default: (False, False)</p></li>
<li><p><strong>narrow_range</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a><em>, </em><a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em> or </em><a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a>) – Quantization algorithm use narrow range or not. If <cite>True</cite> then base
on narrow range otherwise base on off narrow range. The first element represent weights and
second element represent data flow. Default: (False, False)</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Cell, Network which has change to quantization aware training network cell.</p>
</dd>
</dl>
</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="mindspore.dataset.html" class="btn btn-neutral float-right" title="mindspore.dataset" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="mindspore.parallel.html" class="btn btn-neutral float-left" title="mindspore.parallel" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, MindSpore

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>