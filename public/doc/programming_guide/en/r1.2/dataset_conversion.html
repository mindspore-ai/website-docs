<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>MindSpore Data Format Conversion &mdash; MindSpore master documentation</title><script>;(()=>{const e=localStorage.getItem("ms-theme"),t=window.matchMedia("(prefers-color-scheme: dark)").matches;(e?"dark"===e:t)&&document.documentElement.setAttribute("data-o-theme","dark")})();</script><link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script><script src="_static/jquery.js"></script>
        <script src="_static/js/theme.js"></script><script src="_static/underscore.js"></script><script src="_static/doctools.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Auto Augmentation" href="auto_augmentation.html" />
    <link rel="prev" title="Tokenizer" href="tokenizer.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> MindSpore
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="api_structure.html">MindSpore API Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="data_type.html">Data Type</a></li>
<li class="toctree-l1"><a class="reference internal" href="compute_component.html">Compute Component</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="data_pipeline.html">Data Pipeline</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="dataset_loading.html">Loading Dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="sampler.html">Sampler</a></li>
<li class="toctree-l2"><a class="reference internal" href="pipeline.html">Processing Data</a></li>
<li class="toctree-l2"><a class="reference internal" href="augmentation.html">Data Augmentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="tokenizer.html">Tokenizer</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">MindSpore Data Format Conversion</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="#converting-non-standard-dataset-to-mindrecord">Converting Non-Standard Dataset to MindRecord</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#converting-cv-dataset">Converting CV Dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="#converting-nlp-dataset">Converting NLP Dataset</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#converting-common-dataset-to-mindrecord">Converting Common Dataset to MindRecord</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#converting-the-cifar-10-dataset">Converting the CIFAR-10 Dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="#converting-the-imagenet-dataset">Converting the ImageNet Dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="#converting-csv-dataset">Converting CSV Dataset</a></li>
<li class="toctree-l4"><a class="reference internal" href="#converting-tfrecord-dataset">Converting TFRecord Dataset</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="auto_augmentation.html">Auto Augmentation</a></li>
<li class="toctree-l2"><a class="reference internal" href="cache.html">Single-Node Tensor Cache</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="execution_management.html">Execution Management</a></li>
<li class="toctree-l1"><a class="reference internal" href="auto_parallel.html">Parallel Distributed Training</a></li>
<li class="toctree-l1"><a class="reference internal" href="advanced_usage.html">Advanced Usage</a></li>
<li class="toctree-l1"><a class="reference internal" href="network_list.html">Network List</a></li>
<li class="toctree-l1"><a class="reference internal" href="operator_list.html">Operator List</a></li>
<li class="toctree-l1"><a class="reference internal" href="syntax_list.html">Syntax list</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">MindSpore</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="data_pipeline.html">Data Pipeline</a> &raquo;</li>
      <li>MindSpore Data Format Conversion</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/dataset_conversion.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="mindspore-data-format-conversion">
<h1>MindSpore Data Format Conversion<a class="headerlink" href="#mindspore-data-format-conversion" title="Permalink to this headline"></a></h1>
<p><a class="reference external" href="https://gitee.com/mindspore/docs/blob/r1.2/docs/programming_guide/source_en/dataset_conversion.md"><img alt="View Source On Gitee" src="_images/logo_source.png" /></a></p>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline"></a></h2>
<p>You can convert non-standard datasets and common datasets into the MindSpore data format (that is, MindRecord) to easily load the datasets to MindSpore for training. In addition, the performance of MindSpore is optimized in some scenarios. You can use MindRecord to achieve better performance.</p>
</section>
<section id="converting-non-standard-dataset-to-mindrecord">
<h2>Converting Non-Standard Dataset to MindRecord<a class="headerlink" href="#converting-non-standard-dataset-to-mindrecord" title="Permalink to this headline"></a></h2>
<p>The following describes how to convert CV and NLP data into MindRecord and read the MindRecord file through <code class="docutils literal notranslate"><span class="pre">MindDataset</span></code>.</p>
<section id="converting-cv-dataset">
<h3>Converting CV Dataset<a class="headerlink" href="#converting-cv-dataset" title="Permalink to this headline"></a></h3>
<p>This example describes how to convert a CV dataset into MindRecord and use <code class="docutils literal notranslate"><span class="pre">MindDataset</span></code> to load the dataset.</p>
<p>Create a MindRecord file containing 100 records, whose samples include the <code class="docutils literal notranslate"><span class="pre">file_name</span></code> (string), <code class="docutils literal notranslate"><span class="pre">label</span></code> (integer), and <code class="docutils literal notranslate"><span class="pre">data</span></code> (binary) fields. Use <code class="docutils literal notranslate"><span class="pre">MindDataset</span></code> to read the MindRecord file.</p>
<ol class="arabic">
<li><p>Import related modules.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">BytesIO</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">mindspore.dataset</span> <span class="k">as</span> <span class="nn">ds</span>
<span class="kn">from</span> <span class="nn">mindspore.mindrecord</span> <span class="kn">import</span> <span class="n">FileWriter</span>
<span class="kn">import</span> <span class="nn">mindspore.dataset.vision.c_transforms</span> <span class="k">as</span> <span class="nn">vision</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
</pre></div>
</div>
</li>
<li><p>Generate 100 images and convert them to MindRecord.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">MINDRECORD_FILE</span> <span class="o">=</span> <span class="s2">&quot;test.mindrecord&quot;</span>

<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">MINDRECORD_FILE</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">MINDRECORD_FILE</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">MINDRECORD_FILE</span> <span class="o">+</span> <span class="s2">&quot;.db&quot;</span><span class="p">)</span>

<span class="n">writer</span> <span class="o">=</span> <span class="n">FileWriter</span><span class="p">(</span><span class="n">file_name</span><span class="o">=</span><span class="n">MINDRECORD_FILE</span><span class="p">,</span> <span class="n">shard_num</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">cv_schema</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;file_name&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;string&quot;</span><span class="p">},</span> <span class="s2">&quot;label&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;int32&quot;</span><span class="p">},</span> <span class="s2">&quot;data&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;bytes&quot;</span><span class="p">}}</span>
<span class="n">writer</span><span class="o">.</span><span class="n">add_schema</span><span class="p">(</span><span class="n">cv_schema</span><span class="p">,</span> <span class="s2">&quot;it is a cv dataset&quot;</span><span class="p">)</span>

<span class="n">writer</span><span class="o">.</span><span class="n">add_index</span><span class="p">([</span><span class="s2">&quot;file_name&quot;</span><span class="p">,</span> <span class="s2">&quot;label&quot;</span><span class="p">])</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="n">sample</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="n">white_io</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">()</span>
    <span class="n">Image</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;RGB&#39;</span><span class="p">,</span> <span class="p">(</span><span class="n">i</span><span class="o">*</span><span class="mi">10</span><span class="p">,</span> <span class="n">i</span><span class="o">*</span><span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">))</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">white_io</span><span class="p">,</span> <span class="s1">&#39;JPEG&#39;</span><span class="p">)</span>
    <span class="n">image_bytes</span> <span class="o">=</span> <span class="n">white_io</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>
    <span class="n">sample</span><span class="p">[</span><span class="s1">&#39;file_name&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;.jpg&quot;</span>
    <span class="n">sample</span><span class="p">[</span><span class="s1">&#39;label&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">i</span>
    <span class="n">sample</span><span class="p">[</span><span class="s1">&#39;data&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">white_io</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>

    <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">writer</span><span class="o">.</span><span class="n">write_raw_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">if</span> <span class="n">data</span><span class="p">:</span>
    <span class="n">writer</span><span class="o">.</span><span class="n">write_raw_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="n">writer</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>MSRStatus.SUCCESS
</pre></div>
</div>
<p><strong>Parameter description:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">MINDRECORD_FILE</span></code>: path of the output MindRecord file.</p></li>
</ul>
</li>
<li><p>Read MindRecord using <code class="docutils literal notranslate"><span class="pre">MindDataset</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">data_set</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">MindDataset</span><span class="p">(</span><span class="n">dataset_file</span><span class="o">=</span><span class="n">MINDRECORD_FILE</span><span class="p">)</span>
<span class="n">decode_op</span> <span class="o">=</span> <span class="n">vision</span><span class="o">.</span><span class="n">Decode</span><span class="p">()</span>
<span class="n">data_set</span> <span class="o">=</span> <span class="n">data_set</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">operations</span><span class="o">=</span><span class="n">decode_op</span><span class="p">,</span> <span class="n">input_columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">],</span> <span class="n">num_parallel_workers</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">data_set</span><span class="o">.</span><span class="n">create_dict_iterator</span><span class="p">(</span><span class="n">output_numpy</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Got </span><span class="si">{}</span><span class="s2"> samples&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">count</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Got 100 samples
</pre></div>
</div>
</li>
</ol>
</section>
<section id="converting-nlp-dataset">
<h3>Converting NLP Dataset<a class="headerlink" href="#converting-nlp-dataset" title="Permalink to this headline"></a></h3>
<p>This example describes how to convert an NLP dataset into MindRecord and use <code class="docutils literal notranslate"><span class="pre">MindDataset</span></code> to load the dataset. The process of converting the text into the lexicographic order is omitted in this example.</p>
<p>Create a MindRecord file containing 100 records, whose samples include eight fields of the integer type. Use <code class="docutils literal notranslate"><span class="pre">MindDataset</span></code> to read the MindRecord file.</p>
<ol class="arabic">
<li><p>Import related modules.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">mindspore.dataset</span> <span class="k">as</span> <span class="nn">ds</span>
<span class="kn">from</span> <span class="nn">mindspore.mindrecord</span> <span class="kn">import</span> <span class="n">FileWriter</span>
</pre></div>
</div>
</li>
<li><p>Generate 100 text samples and convert them to MindRecord.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">MINDRECORD_FILE</span> <span class="o">=</span> <span class="s2">&quot;test.mindrecord&quot;</span>

<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">MINDRECORD_FILE</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">MINDRECORD_FILE</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">MINDRECORD_FILE</span> <span class="o">+</span> <span class="s2">&quot;.db&quot;</span><span class="p">)</span>

<span class="n">writer</span> <span class="o">=</span> <span class="n">FileWriter</span><span class="p">(</span><span class="n">file_name</span><span class="o">=</span><span class="n">MINDRECORD_FILE</span><span class="p">,</span> <span class="n">shard_num</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">nlp_schema</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;source_sos_ids&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;int64&quot;</span><span class="p">,</span> <span class="s2">&quot;shape&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]},</span>
            <span class="s2">&quot;source_sos_mask&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;int64&quot;</span><span class="p">,</span> <span class="s2">&quot;shape&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]},</span>
            <span class="s2">&quot;source_eos_ids&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;int64&quot;</span><span class="p">,</span> <span class="s2">&quot;shape&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]},</span>
            <span class="s2">&quot;source_eos_mask&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;int64&quot;</span><span class="p">,</span> <span class="s2">&quot;shape&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]},</span>
            <span class="s2">&quot;target_sos_ids&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;int64&quot;</span><span class="p">,</span> <span class="s2">&quot;shape&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]},</span>
            <span class="s2">&quot;target_sos_mask&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;int64&quot;</span><span class="p">,</span> <span class="s2">&quot;shape&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]},</span>
            <span class="s2">&quot;target_eos_ids&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;int64&quot;</span><span class="p">,</span> <span class="s2">&quot;shape&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]},</span>
            <span class="s2">&quot;target_eos_mask&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;int64&quot;</span><span class="p">,</span> <span class="s2">&quot;shape&quot;</span><span class="p">:</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]}}</span>
<span class="n">writer</span><span class="o">.</span><span class="n">add_schema</span><span class="p">(</span><span class="n">nlp_schema</span><span class="p">,</span> <span class="s2">&quot;it is a preprocessed nlp dataset&quot;</span><span class="p">)</span>

<span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">100</span><span class="p">):</span>
    <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>

    <span class="n">sample</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;source_sos_ids&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">2</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">3</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">4</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">),</span>
            <span class="s2">&quot;source_sos_mask&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">i</span> <span class="o">*</span> <span class="mi">1</span><span class="p">,</span> <span class="n">i</span> <span class="o">*</span> <span class="mi">2</span><span class="p">,</span> <span class="n">i</span> <span class="o">*</span> <span class="mi">3</span><span class="p">,</span> <span class="n">i</span> <span class="o">*</span> <span class="mi">4</span><span class="p">,</span> <span class="n">i</span> <span class="o">*</span> <span class="mi">5</span><span class="p">,</span> <span class="n">i</span> <span class="o">*</span> <span class="mi">6</span><span class="p">,</span> <span class="n">i</span> <span class="o">*</span> <span class="mi">7</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">),</span>
            <span class="s2">&quot;source_eos_ids&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">i</span> <span class="o">+</span> <span class="mi">5</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">6</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">7</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">8</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">9</span><span class="p">,</span> <span class="n">i</span> <span class="o">+</span> <span class="mi">10</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">),</span>
            <span class="s2">&quot;source_eos_mask&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">19</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="mi">21</span><span class="p">,</span> <span class="mi">22</span><span class="p">,</span> <span class="mi">23</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">25</span><span class="p">,</span> <span class="mi">26</span><span class="p">,</span> <span class="mi">27</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">),</span>
            <span class="s2">&quot;target_sos_ids&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">28</span><span class="p">,</span> <span class="mi">29</span><span class="p">,</span> <span class="mi">30</span><span class="p">,</span> <span class="mi">31</span><span class="p">,</span> <span class="mi">32</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">),</span>
            <span class="s2">&quot;target_sos_mask&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">33</span><span class="p">,</span> <span class="mi">34</span><span class="p">,</span> <span class="mi">35</span><span class="p">,</span> <span class="mi">36</span><span class="p">,</span> <span class="mi">37</span><span class="p">,</span> <span class="mi">38</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">),</span>
            <span class="s2">&quot;target_eos_ids&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">39</span><span class="p">,</span> <span class="mi">40</span><span class="p">,</span> <span class="mi">41</span><span class="p">,</span> <span class="mi">42</span><span class="p">,</span> <span class="mi">43</span><span class="p">,</span> <span class="mi">44</span><span class="p">,</span> <span class="mi">45</span><span class="p">,</span> <span class="mi">46</span><span class="p">,</span> <span class="mi">47</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">),</span>
            <span class="s2">&quot;target_eos_mask&quot;</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">48</span><span class="p">,</span> <span class="mi">49</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">51</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int64</span><span class="p">)}</span>

    <span class="n">data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">sample</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">writer</span><span class="o">.</span><span class="n">write_raw_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
        <span class="n">data</span> <span class="o">=</span> <span class="p">[]</span>

<span class="k">if</span> <span class="n">data</span><span class="p">:</span>
    <span class="n">writer</span><span class="o">.</span><span class="n">write_raw_data</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>

<span class="n">writer</span><span class="o">.</span><span class="n">commit</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>MSRStatus.SUCCESS
</pre></div>
</div>
<p><strong>Parameter description:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">MINDRECORD_FILE</span></code>: path of the output MindRecord file.</p></li>
</ul>
</li>
<li><p>Read MindRecord using <code class="docutils literal notranslate"><span class="pre">MindDataset</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">data_set</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">MindDataset</span><span class="p">(</span><span class="n">dataset_file</span><span class="o">=</span><span class="n">MINDRECORD_FILE</span><span class="p">)</span>
<span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">data_set</span><span class="o">.</span><span class="n">create_dict_iterator</span><span class="p">():</span>
    <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Got </span><span class="si">{}</span><span class="s2"> samples&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">count</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Got 100 samples
</pre></div>
</div>
</li>
</ol>
</section>
</section>
<section id="converting-common-dataset-to-mindrecord">
<h2>Converting Common Dataset to MindRecord<a class="headerlink" href="#converting-common-dataset-to-mindrecord" title="Permalink to this headline"></a></h2>
<p>MindSpore provides tool classes for converting common datasets to MindRecord. The following table lists part of common datasets and their corresponding tool classes.</p>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Dataset</p></th>
<th class="head"><p>Tool Class</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>CIFAR-10</p></td>
<td><p>Cifar10ToMR</p></td>
</tr>
<tr class="row-odd"><td><p>ImageNet</p></td>
<td><p>ImageNetToMR</p></td>
</tr>
<tr class="row-even"><td><p>TFRecord</p></td>
<td><p>TFRecordToMR</p></td>
</tr>
<tr class="row-odd"><td><p>CSV File</p></td>
<td><p>CsvToMR</p></td>
</tr>
</tbody>
</table>
<p>For details about dataset conversion, see <a class="reference external" href="https://www.mindspore.cn/doc/api_python/en/r1.2/mindspore/mindspore.mindrecord.html">MindSpore API</a>.</p>
<section id="converting-the-cifar-10-dataset">
<h3>Converting the CIFAR-10 Dataset<a class="headerlink" href="#converting-the-cifar-10-dataset" title="Permalink to this headline"></a></h3>
<p>You can use the <code class="docutils literal notranslate"><span class="pre">Cifar10ToMR</span></code> class to convert the original CIFAR-10 data to MindRecord and use <code class="docutils literal notranslate"><span class="pre">MindDataset</span></code> to load the data.</p>
<ol class="arabic">
<li><p>Download and decompress the <a class="reference external" href="https://www.cs.toronto.edu/~kriz/cifar-10-python.tar.gz">CIFAR-10 dataset</a>. Execute the following command:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>!wget<span class="w"> </span>-N<span class="w"> </span>https://mindspore-website.obs.cn-north-4.myhuaweicloud.com/notebook/datasets/cifar-10-python.tar.gz
!mkdir<span class="w"> </span>-p<span class="w"> </span>datasets
!tar<span class="w"> </span>-xzf<span class="w"> </span>cifar-10-python.tar.gz<span class="w"> </span>-C<span class="w"> </span>datasets
!tree<span class="w"> </span>./datasets/cifar-10-batches-py
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>./datasets/cifar-10-batches-py
├── batches.meta
├── data_batch_1
├── data_batch_2
├── data_batch_3
├── data_batch_4
├── data_batch_5
├── readme.html
└── test_batch

0 directories, 8 files
</pre></div>
</div>
</li>
<li><p>Import related modules.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">mindspore.dataset</span> <span class="k">as</span> <span class="nn">ds</span>
<span class="kn">import</span> <span class="nn">mindspore.dataset.vision.c_transforms</span> <span class="k">as</span> <span class="nn">vision</span>
<span class="kn">from</span> <span class="nn">mindspore.mindrecord</span> <span class="kn">import</span> <span class="n">Cifar10ToMR</span>
</pre></div>
</div>
</li>
<li><p>Create the <code class="docutils literal notranslate"><span class="pre">Cifar10ToMR</span></code> object and call the <code class="docutils literal notranslate"><span class="pre">transform</span></code> API to convert the CIFAR-10 dataset to MindRecord.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ds_target_path</span> <span class="o">=</span> <span class="s2">&quot;./datasets/mindspore_dataset_conversion/&quot;</span>
<span class="c1"># clean old run files</span>
<span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;rm -f </span><span class="si">{}</span><span class="s2">*&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ds_target_path</span><span class="p">))</span>
<span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s2">&quot;mkdir -p </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ds_target_path</span><span class="p">))</span>

<span class="n">CIFAR10_DIR</span> <span class="o">=</span> <span class="s2">&quot;./datasets/cifar-10-batches-py&quot;</span>
<span class="n">MINDRECORD_FILE</span> <span class="o">=</span> <span class="s2">&quot;./datasets/mindspore_dataset_conversion/cifar10.mindrecord&quot;</span>
<span class="n">cifar10_transformer</span> <span class="o">=</span> <span class="n">Cifar10ToMR</span><span class="p">(</span><span class="n">CIFAR10_DIR</span><span class="p">,</span> <span class="n">MINDRECORD_FILE</span><span class="p">)</span>
<span class="n">cifar10_transformer</span><span class="o">.</span><span class="n">transform</span><span class="p">([</span><span class="s1">&#39;label&#39;</span><span class="p">])</span>
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>MSRStatus.SUCCESS
</pre></div>
</div>
<p><strong>Parameter description:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CIFAR10_DIR</span></code>: path of the CIFAR-10 dataset folder.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">MINDRECORD_FILE</span></code>: path of the output MindRecord file.</p></li>
</ul>
</li>
<li><p>Read MindRecord using <code class="docutils literal notranslate"><span class="pre">MindDataset</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">data_set</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">MindDataset</span><span class="p">(</span><span class="n">dataset_file</span><span class="o">=</span><span class="n">MINDRECORD_FILE</span><span class="p">)</span>
<span class="n">decode_op</span> <span class="o">=</span> <span class="n">vision</span><span class="o">.</span><span class="n">Decode</span><span class="p">()</span>
<span class="n">data_set</span> <span class="o">=</span> <span class="n">data_set</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">operations</span><span class="o">=</span><span class="n">decode_op</span><span class="p">,</span> <span class="n">input_columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">],</span> <span class="n">num_parallel_workers</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">data_set</span><span class="o">.</span><span class="n">create_dict_iterator</span><span class="p">(</span><span class="n">output_numpy</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Got </span><span class="si">{}</span><span class="s2"> samples&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">count</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Got 50000 samples
</pre></div>
</div>
</li>
</ol>
</section>
<section id="converting-the-imagenet-dataset">
<h3>Converting the ImageNet Dataset<a class="headerlink" href="#converting-the-imagenet-dataset" title="Permalink to this headline"></a></h3>
<p>You can use the <code class="docutils literal notranslate"><span class="pre">ImageNetToMR</span></code> class to convert the original ImageNet data (images and annotations) to MindRecord and use <code class="docutils literal notranslate"><span class="pre">MindDataset</span></code> to load the data.</p>
<ol class="arabic">
<li><p>Download the <a class="reference external" href="http://image-net.org/download">ImageNet dataset</a>, save all images in the <code class="docutils literal notranslate"><span class="pre">images/</span></code> folder, and use a mapping file <code class="docutils literal notranslate"><span class="pre">labels_map.txt</span></code> to record the mapping between images and labels. The mapping file contains two columns, which are the directory and label ID of each type of images. The two columns are separated by spaces. The following is an example of the mapping file:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>n01440760 0
n01443537 1
n01484850 2
n01491361 3
n01494475 4
n01496331 5
</pre></div>
</div>
<p>The file directory structure is as follows:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>├─ labels_map.txt
└─ images
    └─ ......
</pre></div>
</div>
</li>
<li><p>Import the dataset conversion tool class <code class="docutils literal notranslate"><span class="pre">ImageNetToMR</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mindspore.dataset</span> <span class="k">as</span> <span class="nn">ds</span>
<span class="kn">import</span> <span class="nn">mindspore.dataset.vision.c_transforms</span> <span class="k">as</span> <span class="nn">vision</span>
<span class="kn">from</span> <span class="nn">mindspore.mindrecord</span> <span class="kn">import</span> <span class="n">ImageNetToMR</span>
</pre></div>
</div>
</li>
<li><p>Create the <code class="docutils literal notranslate"><span class="pre">ImageNetToMR</span></code> object and call the <code class="docutils literal notranslate"><span class="pre">transform</span></code> API to convert the dataset to MindRecord.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">IMAGENET_MAP_FILE</span> <span class="o">=</span> <span class="s2">&quot;./labels_map.txt&quot;</span>
<span class="n">IMAGENET_IMAGE_DIR</span> <span class="o">=</span> <span class="s2">&quot;./images&quot;</span>
<span class="n">MINDRECORD_FILE</span> <span class="o">=</span> <span class="s2">&quot;./imagenet.mindrecord&quot;</span>
<span class="n">imagenet_transformer</span> <span class="o">=</span> <span class="n">ImageNetToMR</span><span class="p">(</span><span class="n">IMAGENET_MAP_FILE</span><span class="p">,</span> <span class="n">IMAGENET_IMAGE_DIR</span><span class="p">,</span> <span class="n">MINDRECORD_FILE</span><span class="p">,</span> <span class="n">partition_number</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">imagenet_transformer</span><span class="o">.</span><span class="n">transform</span><span class="p">()</span>
</pre></div>
</div>
<p><strong>Parameter description:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">IMAGENET_MAP_FILE</span></code>: path of the label mapping file of the ImageNet dataset.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">IMAGENET_IMAGE_DIR</span></code>: path of the folder where all ImageNet images are stored.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">MINDRECORD_FILE</span></code>: path of the output MindRecord file.</p></li>
</ul>
</li>
<li><p>Read MindRecord using <code class="docutils literal notranslate"><span class="pre">MindDataset</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">data_set</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">MindDataset</span><span class="p">(</span><span class="n">dataset_file</span><span class="o">=</span><span class="n">MINDRECORD_FILE</span><span class="p">)</span>
<span class="n">decode_op</span> <span class="o">=</span> <span class="n">vision</span><span class="o">.</span><span class="n">Decode</span><span class="p">()</span>
<span class="n">data_set</span> <span class="o">=</span> <span class="n">data_set</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">operations</span><span class="o">=</span><span class="n">decode_op</span><span class="p">,</span> <span class="n">input_columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;image&quot;</span><span class="p">],</span> <span class="n">num_parallel_workers</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">data_set</span><span class="o">.</span><span class="n">create_dict_iterator</span><span class="p">(</span><span class="n">output_numpy</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Got </span><span class="si">{}</span><span class="s2"> samples&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">count</span><span class="p">))</span>
</pre></div>
</div>
</li>
</ol>
</section>
<section id="converting-csv-dataset">
<h3>Converting CSV Dataset<a class="headerlink" href="#converting-csv-dataset" title="Permalink to this headline"></a></h3>
<p>Create a CSV file containing 5 records, convert the CSV file to MindRecord using the <code class="docutils literal notranslate"><span class="pre">CsvToMR</span></code> tool class, and then read the MindRecord file using <code class="docutils literal notranslate"><span class="pre">MindDataset</span></code>.</p>
<ol class="arabic">
<li><p>Import related modules.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">csv</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">mindspore.dataset</span> <span class="k">as</span> <span class="nn">ds</span>
<span class="kn">from</span> <span class="nn">mindspore.mindrecord</span> <span class="kn">import</span> <span class="n">CsvToMR</span>
</pre></div>
</div>
</li>
<li><p>Generate a CSV file and convert it to MindRecord.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">CSV_FILE</span> <span class="o">=</span> <span class="s2">&quot;test.csv&quot;</span>
<span class="n">MINDRECORD_FILE</span> <span class="o">=</span> <span class="s2">&quot;test.mindrecord&quot;</span>

<span class="k">def</span> <span class="nf">generate_csv</span><span class="p">():</span>
    <span class="n">headers</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;id&quot;</span><span class="p">,</span> <span class="s2">&quot;name&quot;</span><span class="p">,</span> <span class="s2">&quot;math&quot;</span><span class="p">,</span> <span class="s2">&quot;english&quot;</span><span class="p">]</span>
    <span class="n">rows</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">1</span><span class="p">,</span> <span class="s2">&quot;Lily&quot;</span><span class="p">,</span> <span class="mf">78.5</span><span class="p">,</span> <span class="mi">90</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="s2">&quot;Lucy&quot;</span><span class="p">,</span> <span class="mi">99</span><span class="p">,</span> <span class="mf">85.2</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="s2">&quot;Mike&quot;</span><span class="p">,</span> <span class="mi">65</span><span class="p">,</span> <span class="mi">71</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="s2">&quot;Tom&quot;</span><span class="p">,</span> <span class="mi">95</span><span class="p">,</span> <span class="mi">99</span><span class="p">),</span>
            <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="s2">&quot;Jeff&quot;</span><span class="p">,</span> <span class="mi">85</span><span class="p">,</span> <span class="mf">78.5</span><span class="p">)]</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">CSV_FILE</span><span class="p">,</span> <span class="s1">&#39;w&#39;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="n">writer</span> <span class="o">=</span> <span class="n">csv</span><span class="o">.</span><span class="n">writer</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="n">writer</span><span class="o">.</span><span class="n">writerow</span><span class="p">(</span><span class="n">headers</span><span class="p">)</span>
        <span class="n">writer</span><span class="o">.</span><span class="n">writerows</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span>

<span class="n">generate_csv</span><span class="p">()</span>

<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">MINDRECORD_FILE</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">MINDRECORD_FILE</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">MINDRECORD_FILE</span> <span class="o">+</span> <span class="s2">&quot;.db&quot;</span><span class="p">)</span>

<span class="n">csv_transformer</span> <span class="o">=</span> <span class="n">CsvToMR</span><span class="p">(</span><span class="n">CSV_FILE</span><span class="p">,</span> <span class="n">MINDRECORD_FILE</span><span class="p">,</span> <span class="n">partition_number</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="n">csv_transformer</span><span class="o">.</span><span class="n">transform</span><span class="p">()</span>

<span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">MINDRECORD_FILE</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">MINDRECORD_FILE</span> <span class="o">+</span> <span class="s2">&quot;.db&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><strong>Parameter description:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">CSV_FILE</span></code>: path of the CSV file.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">MINDRECORD_FILE</span></code>: path of the output MindRecord file.</p></li>
</ul>
</li>
<li><p>Read MindRecord using <code class="docutils literal notranslate"><span class="pre">MindDataset</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">data_set</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">MindDataset</span><span class="p">(</span><span class="n">dataset_file</span><span class="o">=</span><span class="n">MINDRECORD_FILE</span><span class="p">)</span>
<span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">data_set</span><span class="o">.</span><span class="n">create_dict_iterator</span><span class="p">(</span><span class="n">output_numpy</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Got </span><span class="si">{}</span><span class="s2"> samples&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">count</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Got 5 samples
</pre></div>
</div>
</li>
</ol>
</section>
<section id="converting-tfrecord-dataset">
<h3>Converting TFRecord Dataset<a class="headerlink" href="#converting-tfrecord-dataset" title="Permalink to this headline"></a></h3>
<blockquote>
<div><p>Currently, only TensorFlow 1.13.0-rc1 and later versions are supported.</p>
</div></blockquote>
<p>In this part of the example, TensorFlow needs to be installed in advance. If it is not installed, execute the following command to install it. For example, when this document is running as a Notebook, after the installation is complete, you need to restart the kernel to execute the subsequent code.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s1">&#39;pip install tensorflow&#39;</span><span class="p">)</span> <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">system</span><span class="p">(</span><span class="s1">&#39;python -c &quot;import tensorflow&quot;&#39;</span><span class="p">)</span> <span class="k">else</span> <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;TensorFlow installed&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>0
</pre></div>
</div>
<p>Use TensorFlow to create a TFRecord file and convert the file to MindRecord using the <code class="docutils literal notranslate"><span class="pre">TFRecordToMR</span></code> tool class. Read the file using <code class="docutils literal notranslate"><span class="pre">MindDataset</span></code> and decode the <code class="docutils literal notranslate"><span class="pre">image_bytes</span></code> field using the <code class="docutils literal notranslate"><span class="pre">Decode</span></code> operator.</p>
<ol class="arabic">
<li><p>Import related modules.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">collections</span>
<span class="kn">from</span> <span class="nn">io</span> <span class="kn">import</span> <span class="n">BytesIO</span>
<span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">mindspore.dataset</span> <span class="k">as</span> <span class="nn">ds</span>
<span class="kn">from</span> <span class="nn">mindspore.mindrecord</span> <span class="kn">import</span> <span class="n">TFRecordToMR</span>
<span class="kn">import</span> <span class="nn">mindspore.dataset.vision.c_transforms</span> <span class="k">as</span> <span class="nn">vision</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">import</span> <span class="nn">tensorflow</span> <span class="k">as</span> <span class="nn">tf</span>
</pre></div>
</div>
</li>
<li><p>Generate a TFRecord file.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">TFRECORD_FILE</span> <span class="o">=</span> <span class="s2">&quot;test.tfrecord&quot;</span>
<span class="n">MINDRECORD_FILE</span> <span class="o">=</span> <span class="s2">&quot;test.mindrecord&quot;</span>

<span class="k">def</span> <span class="nf">generate_tfrecord</span><span class="p">():</span>
    <span class="k">def</span> <span class="nf">create_int_feature</span><span class="p">(</span><span class="n">values</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">feature</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">Feature</span><span class="p">(</span><span class="n">int64_list</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">Int64List</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">values</span><span class="p">)))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">feature</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">Feature</span><span class="p">(</span><span class="n">int64_list</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">Int64List</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="p">[</span><span class="n">values</span><span class="p">]))</span>
        <span class="k">return</span> <span class="n">feature</span>

    <span class="k">def</span> <span class="nf">create_float_feature</span><span class="p">(</span><span class="n">values</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="nb">list</span><span class="p">):</span>
            <span class="n">feature</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">Feature</span><span class="p">(</span><span class="n">float_list</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">FloatList</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="n">values</span><span class="p">)))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">feature</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">Feature</span><span class="p">(</span><span class="n">float_list</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">FloatList</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="p">[</span><span class="n">values</span><span class="p">]))</span>
        <span class="k">return</span> <span class="n">feature</span>

    <span class="k">def</span> <span class="nf">create_bytes_feature</span><span class="p">(</span><span class="n">values</span><span class="p">):</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="nb">bytes</span><span class="p">):</span>
            <span class="n">white_io</span> <span class="o">=</span> <span class="n">BytesIO</span><span class="p">()</span>
            <span class="n">Image</span><span class="o">.</span><span class="n">new</span><span class="p">(</span><span class="s1">&#39;RGB&#39;</span><span class="p">,</span> <span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span> <span class="p">(</span><span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="mi">255</span><span class="p">))</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">white_io</span><span class="p">,</span> <span class="s1">&#39;JPEG&#39;</span><span class="p">)</span>
            <span class="n">image_bytes</span> <span class="o">=</span> <span class="n">white_io</span><span class="o">.</span><span class="n">getvalue</span><span class="p">()</span>
            <span class="n">feature</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">Feature</span><span class="p">(</span><span class="n">bytes_list</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">BytesList</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="p">[</span><span class="n">image_bytes</span><span class="p">]))</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">feature</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">Feature</span><span class="p">(</span><span class="n">bytes_list</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">BytesList</span><span class="p">(</span><span class="n">value</span><span class="o">=</span><span class="p">[</span><span class="nb">bytes</span><span class="p">(</span><span class="n">values</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s1">&#39;utf-8&#39;</span><span class="p">)]))</span>
        <span class="k">return</span> <span class="n">feature</span>

    <span class="n">writer</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">TFRecordWriter</span><span class="p">(</span><span class="n">TFRECORD_FILE</span><span class="p">)</span>

    <span class="n">example_count</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
        <span class="n">file_name</span> <span class="o">=</span> <span class="s2">&quot;000&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">+</span> <span class="s2">&quot;.jpg&quot;</span>
        <span class="n">image_bytes</span> <span class="o">=</span> <span class="nb">bytes</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="s2">&quot;aaaabbbbcccc&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)),</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span>
        <span class="n">int64_scalar</span> <span class="o">=</span> <span class="n">i</span>
        <span class="n">float_scalar</span> <span class="o">=</span> <span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">int64_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">3</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">4</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1234567890</span><span class="p">]</span>
        <span class="n">float_list</span> <span class="o">=</span> <span class="p">[</span><span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mf">2.8</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mf">3.2</span><span class="p">),</span>
                    <span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mf">4.4</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mf">123456.9</span><span class="p">),</span> <span class="nb">float</span><span class="p">(</span><span class="n">i</span><span class="o">+</span><span class="mf">98765432.1</span><span class="p">)]</span>

        <span class="n">features</span> <span class="o">=</span> <span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">()</span>
        <span class="n">features</span><span class="p">[</span><span class="s2">&quot;file_name&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">create_bytes_feature</span><span class="p">(</span><span class="n">file_name</span><span class="p">)</span>
        <span class="n">features</span><span class="p">[</span><span class="s2">&quot;image_bytes&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">create_bytes_feature</span><span class="p">(</span><span class="n">image_bytes</span><span class="p">)</span>
        <span class="n">features</span><span class="p">[</span><span class="s2">&quot;int64_scalar&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">create_int_feature</span><span class="p">(</span><span class="n">int64_scalar</span><span class="p">)</span>
        <span class="n">features</span><span class="p">[</span><span class="s2">&quot;float_scalar&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">create_float_feature</span><span class="p">(</span><span class="n">float_scalar</span><span class="p">)</span>
        <span class="n">features</span><span class="p">[</span><span class="s2">&quot;int64_list&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">create_int_feature</span><span class="p">(</span><span class="n">int64_list</span><span class="p">)</span>
        <span class="n">features</span><span class="p">[</span><span class="s2">&quot;float_list&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">create_float_feature</span><span class="p">(</span><span class="n">float_list</span><span class="p">)</span>

        <span class="n">tf_example</span> <span class="o">=</span> <span class="n">tf</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">Example</span><span class="p">(</span><span class="n">features</span><span class="o">=</span><span class="n">tf</span><span class="o">.</span><span class="n">train</span><span class="o">.</span><span class="n">Features</span><span class="p">(</span><span class="n">feature</span><span class="o">=</span><span class="n">features</span><span class="p">))</span>
        <span class="n">writer</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">tf_example</span><span class="o">.</span><span class="n">SerializeToString</span><span class="p">())</span>
        <span class="n">example_count</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="n">writer</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Write </span><span class="si">{}</span><span class="s2"> rows in tfrecord.&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">example_count</span><span class="p">))</span>

<span class="n">generate_tfrecord</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Write 10 rows in tfrecord.
</pre></div>
</div>
<p><strong>Parameter description:</strong></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">TFRECORD_FILE</span></code>: path of the TFRecord file.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">MINDRECORD_FILE</span></code>: path of the output MindRecord file.</p></li>
</ul>
</li>
<li><p>Convert the TFRecord to MindRecord.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">feature_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;file_name&quot;</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">FixedLenFeature</span><span class="p">([],</span> <span class="n">tf</span><span class="o">.</span><span class="n">string</span><span class="p">),</span>
                <span class="s2">&quot;image_bytes&quot;</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">FixedLenFeature</span><span class="p">([],</span> <span class="n">tf</span><span class="o">.</span><span class="n">string</span><span class="p">),</span>
                <span class="s2">&quot;int64_scalar&quot;</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">FixedLenFeature</span><span class="p">([],</span> <span class="n">tf</span><span class="o">.</span><span class="n">int64</span><span class="p">),</span>
                <span class="s2">&quot;float_scalar&quot;</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">FixedLenFeature</span><span class="p">([],</span> <span class="n">tf</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span>
                <span class="s2">&quot;int64_list&quot;</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">FixedLenFeature</span><span class="p">([</span><span class="mi">6</span><span class="p">],</span> <span class="n">tf</span><span class="o">.</span><span class="n">int64</span><span class="p">),</span>
                <span class="s2">&quot;float_list&quot;</span><span class="p">:</span> <span class="n">tf</span><span class="o">.</span><span class="n">io</span><span class="o">.</span><span class="n">FixedLenFeature</span><span class="p">([</span><span class="mi">7</span><span class="p">],</span> <span class="n">tf</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span>
                <span class="p">}</span>

<span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">MINDRECORD_FILE</span><span class="p">):</span>
    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">MINDRECORD_FILE</span><span class="p">)</span>
    <span class="n">os</span><span class="o">.</span><span class="n">remove</span><span class="p">(</span><span class="n">MINDRECORD_FILE</span> <span class="o">+</span> <span class="s2">&quot;.db&quot;</span><span class="p">)</span>

<span class="n">tfrecord_transformer</span> <span class="o">=</span> <span class="n">TFRecordToMR</span><span class="p">(</span><span class="n">TFRECORD_FILE</span><span class="p">,</span> <span class="n">MINDRECORD_FILE</span><span class="p">,</span> <span class="n">feature_dict</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;image_bytes&quot;</span><span class="p">])</span>
<span class="n">tfrecord_transformer</span><span class="o">.</span><span class="n">transform</span><span class="p">()</span>

<span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">MINDRECORD_FILE</span><span class="p">)</span>
<span class="k">assert</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">MINDRECORD_FILE</span> <span class="o">+</span> <span class="s2">&quot;.db&quot;</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Read MindRecord using <code class="docutils literal notranslate"><span class="pre">MindDataset</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">data_set</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">MindDataset</span><span class="p">(</span><span class="n">dataset_file</span><span class="o">=</span><span class="n">MINDRECORD_FILE</span><span class="p">)</span>
<span class="n">decode_op</span> <span class="o">=</span> <span class="n">vision</span><span class="o">.</span><span class="n">Decode</span><span class="p">()</span>
<span class="n">data_set</span> <span class="o">=</span> <span class="n">data_set</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">operations</span><span class="o">=</span><span class="n">decode_op</span><span class="p">,</span> <span class="n">input_columns</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;image_bytes&quot;</span><span class="p">],</span> <span class="n">num_parallel_workers</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">count</span> <span class="o">=</span> <span class="mi">0</span>
<span class="k">for</span> <span class="n">item</span> <span class="ow">in</span> <span class="n">data_set</span><span class="o">.</span><span class="n">create_dict_iterator</span><span class="p">(</span><span class="n">output_numpy</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="n">count</span> <span class="o">+=</span> <span class="mi">1</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Got </span><span class="si">{}</span><span class="s2"> samples&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">count</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Got 10 samples
</pre></div>
</div>
</li>
</ol>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="tokenizer.html" class="btn btn-neutral float-left" title="Tokenizer" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="auto_augmentation.html" class="btn btn-neutral float-right" title="Auto Augmentation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright MindSpore.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 
</body>
</html>