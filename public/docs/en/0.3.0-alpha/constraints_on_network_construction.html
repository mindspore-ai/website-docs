

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Constraints on Network Construction Using Python &mdash; MindSpore 0.3.0-alpha documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Glossary" href="glossary.html" />
    <link rel="prev" title="Operator List" href="operator_list.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home"> MindSpore
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="architecture.html">Overall Architecture</a></li>
<li class="toctree-l1"><a class="reference internal" href="roadmap.html">RoadMap</a></li>
<li class="toctree-l1"><a class="reference internal" href="benchmark.html">Benchmarks</a></li>
<li class="toctree-l1"><a class="reference internal" href="network_list.html">Network List</a></li>
<li class="toctree-l1"><a class="reference internal" href="operator_list.html">Operator List</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Constraints on Network Construction Using Python</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#syntax-constraints">Syntax Constraints</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#supported-python-data-types">Supported Python Data Types</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mindspore-extended-data-type">MindSpore Extended Data Type</a></li>
<li class="toctree-l3"><a class="reference internal" href="#expression-types">Expression Types</a></li>
<li class="toctree-l3"><a class="reference internal" href="#statement-types">Statement Types</a></li>
<li class="toctree-l3"><a class="reference internal" href="#system-functions">System Functions</a></li>
<li class="toctree-l3"><a class="reference internal" href="#function-parameters">Function Parameters</a></li>
<li class="toctree-l3"><a class="reference internal" href="#operators">Operators</a></li>
<li class="toctree-l3"><a class="reference internal" href="#index-operation">Index operation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#unsupported-syntax">Unsupported Syntax</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#network-definition-constraints">Network Definition Constraints</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#instance-types-on-the-entire-network">Instance Types on the Entire Network</a></li>
<li class="toctree-l3"><a class="reference internal" href="#network-input-type">Network Input Type</a></li>
<li class="toctree-l3"><a class="reference internal" href="#network-graph-optimization">Network Graph Optimization</a></li>
<li class="toctree-l3"><a class="reference internal" href="#network-construction-components">Network Construction Components</a></li>
<li class="toctree-l3"><a class="reference internal" href="#other-constraints">Other Constraints</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="community.html">Community</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">MindSpore</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html">Docs</a> &raquo;</li>
        
      <li>Constraints on Network Construction Using Python</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/constraints_on_network_construction.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="constraints-on-network-construction-using-python">
<h1>Constraints on Network Construction Using Python<a class="headerlink" href="#constraints-on-network-construction-using-python" title="Permalink to this headline">¶</a></h1>
<!-- TOC --><ul class="simple">
<li><p><a class="reference external" href="#constraints-on-network-construction-using-python">Constraints on Network Construction Using Python</a></p>
<ul>
<li><p><a class="reference external" href="#overview">Overview</a></p></li>
<li><p><a class="reference external" href="#syntax-constraints">Syntax Constraints</a></p>
<ul>
<li><p><a class="reference external" href="#supported-python-data-types">Supported Python Data Types</a></p></li>
<li><p><a class="reference external" href="#mindspore-extended-data-type">MindSpore Extended Data Type</a></p></li>
<li><p><a class="reference external" href="#expression-types">Expression Types</a></p></li>
<li><p><a class="reference external" href="#statement-types">Statement Types</a></p></li>
<li><p><a class="reference external" href="#system-functions">System Functions</a></p></li>
<li><p><a class="reference external" href="#function-parameters">Function Parameters</a></p></li>
<li><p><a class="reference external" href="#operators">Operators</a></p></li>
<li><p><a class="reference external" href="#index-operation">Index operation</a></p></li>
<li><p><a class="reference external" href="#unsupported-syntax">Unsupported Syntax</a></p></li>
</ul>
</li>
<li><p><a class="reference external" href="#network-definition-constraints">Network Definition Constraints</a></p>
<ul>
<li><p><a class="reference external" href="#instance-types-on-the-entire-network">Instance Types on the Entire Network</a></p></li>
<li><p><a class="reference external" href="#network-input-type">Network Input Type</a></p></li>
<li><p><a class="reference external" href="#network-graph-optimization">Network Graph Optimization</a></p></li>
<li><p><a class="reference external" href="#network-construction-components">Network Construction Components</a></p></li>
<li><p><a class="reference external" href="#other-constraints">Other Constraints</a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- /TOC --><p><a href="https://gitee.com/mindspore/docs/blob/r0.3/docs/source_en/constraints_on_network_construction.md" target="_blank"><img src="./_static/logo_source.png"></a></p>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>MindSpore can compile user source code based on the Python syntax into computational graphs, and can convert common functions or instances inherited from nn.Cell into computational graphs. Currently, MindSpore does not support conversion of any Python source code into computational graphs. Therefore, there are constraints on source code compilation, including syntax constraints and network definition constraints. As MindSpore evolves, the constraints may change.</p>
</div>
<div class="section" id="syntax-constraints">
<h2>Syntax Constraints<a class="headerlink" href="#syntax-constraints" title="Permalink to this headline">¶</a></h2>
<div class="section" id="supported-python-data-types">
<h3>Supported Python Data Types<a class="headerlink" href="#supported-python-data-types" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Number: supports <code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>, and <code class="docutils literal notranslate"><span class="pre">bool</span></code>. Complex numbers are not supported.</p></li>
<li><p>String</p></li>
<li><p>List: supports the append method only. Updating a list will generate a new list.</p></li>
<li><p>Tuple</p></li>
<li><p>Dictionary: The type of key should be String.</p></li>
</ul>
</div>
<div class="section" id="mindspore-extended-data-type">
<h3>MindSpore Extended Data Type<a class="headerlink" href="#mindspore-extended-data-type" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Tensor: Tensor variables must be defined instances.</p></li>
</ul>
</div>
<div class="section" id="expression-types">
<h3>Expression Types<a class="headerlink" href="#expression-types" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<thead>
<tr>
<th align="left">Operation</th>
<th align="left">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left">Unary operator</td>
<td align="left"><code>+</code>,<code>-</code>, and<code>not</code>. The operator <code>+</code> supports only scalars.</td>
</tr>
<tr>
<td align="left">Binary operator</td>
<td align="left"><code>+</code>, <code>-</code>, <code>*</code>, <code>/</code>, <code>%</code>, <code>**</code> and <code>//</code></td>
</tr>
<tr>
<td align="left"><code>if</code> expression</td>
<td align="left">For example, <code>a = x if x &lt; y else y</code>.</td>
</tr>
<tr>
<td align="left">Comparison expression</td>
<td align="left"><code>&gt;</code>, <code>&gt;=</code>, <code>&lt;</code>, <code>&lt;=</code>, <code>==</code>, and <code>! =</code>.</td>
</tr>
<tr>
<td align="left">Logical expression</td>
<td align="left"><code>and</code> and <code>or</code>.</td>
</tr>
<tr>
<td align="left"><code>lambda</code> expression</td>
<td align="left">For example, <code>lambda x, y: x + y</code>.</td>
</tr>
<tr>
<td align="left">Reserved keyword type</td>
<td align="left"><code>True</code>, <code>False</code>, and <code>None</code>.</td>
</tr>
</tbody>
</table></div>
<div class="section" id="statement-types">
<h3>Statement Types<a class="headerlink" href="#statement-types" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<thead>
<tr>
<th align="left">Statement</th>
<th align="left">Compared with Python</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>for</code></td>
<td align="left">Nested for loops are partially supported. Iteration sequences must be tuples or lists.</td>
</tr>
<tr>
<td align="left"><code>while</code></td>
<td align="left">Nested while loops are partially supported.</td>
</tr>
<tr>
<td align="left"><code>if</code></td>
<td align="left">Same as that in Python. The input of the <code>if</code> condition must be a constant.</td>
</tr>
<tr>
<td align="left"><code>def</code></td>
<td align="left">Same as that in Python.</td>
</tr>
<tr>
<td align="left"><code>in</code></td>
<td align="left">Only support Dictionary.</td>
</tr>
<tr>
<td align="left"><code>not in</code></td>
<td align="left">Only support Dictionary.</td>
</tr>
<tr>
<td align="left">Assignment statement</td>
<td align="left">Accessed multiple subscripts of lists and dictionaries cannot be used as l-value.</td>
</tr>
</tbody>
</table></div>
<div class="section" id="system-functions">
<h3>System Functions<a class="headerlink" href="#system-functions" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>len</p></li>
<li><p>partial</p></li>
<li><p>map</p></li>
<li><p>zip</p></li>
<li><p>range</p></li>
</ul>
</div>
<div class="section" id="function-parameters">
<h3>Function Parameters<a class="headerlink" href="#function-parameters" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Default parameter value: The data types <code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>, <code class="docutils literal notranslate"><span class="pre">bool</span></code>, <code class="docutils literal notranslate"><span class="pre">None</span></code>, <code class="docutils literal notranslate"><span class="pre">str</span></code>, <code class="docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="docutils literal notranslate"><span class="pre">list</span></code>, and <code class="docutils literal notranslate"><span class="pre">dict</span></code> are supported, whereas <code class="docutils literal notranslate"><span class="pre">Tensor</span></code> is not supported.</p></li>
<li><p>Variable parameter: Functions with variable arguments is supported for training and inference.</p></li>
<li><p>Key-value pair parameter: Functions with key-value pair parameters cannot be used for backward propagation on computational graphs.</p></li>
<li><p>Variable key-value pair parameter: Functions with variable key-value pairs cannot be used for backward propagation on computational graphs.</p></li>
</ul>
</div>
<div class="section" id="operators">
<h3>Operators<a class="headerlink" href="#operators" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<thead>
<tr>
<th align="left">Operator</th>
<th align="left">Supported Type</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>+</code></td>
<td align="left">Scalar, <code>Tensor</code>, <code>tuple</code> and <code>string</code></td>
</tr>
<tr>
<td align="left"><code>-</code></td>
<td align="left">Scalar and <code>Tensor</code></td>
</tr>
<tr>
<td align="left"><code>*</code></td>
<td align="left">Scalar and <code>Tensor</code></td>
</tr>
<tr>
<td align="left"><code>/</code></td>
<td align="left">Scalar and <code>Tensor</code></td>
</tr>
<tr>
<td align="left"><code>**</code></td>
<td align="left">Scalar and <code>Tensor</code></td>
</tr>
<tr>
<td align="left"><code>//</code></td>
<td align="left">Scalar and <code>Tensor</code></td>
</tr>
<tr>
<td align="left"><code>%</code></td>
<td align="left">Scalar and <code>Tensor</code></td>
</tr>
<tr>
<td align="left"><code>[]</code></td>
<td align="left">The operation object type can be <code>list</code>, <code>tuple</code>, or <code>Tensor</code>. Accessed multiple subscripts of lists and dictionaries can be used as r-values instead of l-values. The index type cannot be Tensor. For details about access constraints for the tuple and Tensor types, see the description of slicing operations.</td>
</tr>
</tbody>
</table></div>
<div class="section" id="index-operation">
<h3>Index operation<a class="headerlink" href="#index-operation" title="Permalink to this headline">¶</a></h3>
<p>The index operation includes <code class="docutils literal notranslate"><span class="pre">tuple</span></code> and<code class="docutils literal notranslate"> <span class="pre">Tensor</span></code>. The following focuses on the index value assignment and assignment operation of <code class="docutils literal notranslate"><span class="pre">Tensor</span></code>. The value takes<code class="docutils literal notranslate"><span class="pre">tensor_x</span> <span class="pre">[index]</span></code>as an example, and the assignment takes<code class="docutils literal notranslate"> <span class="pre">tensor_x</span> <span class="pre">[index]</span> <span class="pre">=</span> <span class="pre">u</span></code> as an example for detailed description. Among them, tensor_x is a <code class="docutils literal notranslate"><span class="pre">Tensor</span></code>, which is sliced; index means the index, u means the assigned value, which can be<code class="docutils literal notranslate"> <span class="pre">scalar</span></code> or <code class="docutils literal notranslate"><span class="pre">Tensor</span> <span class="pre">(size</span> <span class="pre">=</span> <span class="pre">1)</span></code>. The index types are as follows:</p>
<ul class="simple">
<li><p>Slice index: index is <code class="docutils literal notranslate"><span class="pre">slice</span></code></p>
<ul>
<li><p>Value: <code class="docutils literal notranslate"><span class="pre">tensor_x[start:</span> <span class="pre">stop:</span> <span class="pre">step]</span></code>, where Slice (start: stop: step) has the same syntax as Python, and will not be repeated here.</p></li>
<li><p>Assignment: <code class="docutils literal notranslate"><span class="pre">tensor_x[start:</span> <span class="pre">stop:</span> <span class="pre">step]</span> <span class="pre">=</span> <span class="pre">u</span></code>.</p></li>
</ul>
</li>
<li><p>Ellipsis index: index is <code class="docutils literal notranslate"><span class="pre">ellipsis</span></code></p>
<ul>
<li><p>Value: <code class="docutils literal notranslate"><span class="pre">tensor_x</span> <span class="pre">[...]</span></code>.</p></li>
<li><p>Assignment: <code class="docutils literal notranslate"><span class="pre">tensor_x</span> <span class="pre">[...]</span> <span class="pre">=</span> <span class="pre">u</span></code>.</p></li>
</ul>
</li>
<li><p>Boolean constant index: index is <code class="docutils literal notranslate"><span class="pre">True</span></code>, index is <code class="docutils literal notranslate"><span class="pre">False</span></code> is not supported temporarily.</p>
<ul>
<li><p>Value: <code class="docutils literal notranslate"><span class="pre">tensor_x[True]</span></code>.</p></li>
<li><p>Assignment: Not supported yet.</p></li>
</ul>
</li>
<li><p>Tensor index: index is <code class="docutils literal notranslate"><span class="pre">Tensor</span></code></p>
<ul>
<li><p>Value: <code class="docutils literal notranslate"><span class="pre">tensor_x</span> <span class="pre">[index]</span></code>, <code class="docutils literal notranslate"><span class="pre">index</span></code> must be <code class="docutils literal notranslate"><span class="pre">Tensor</span></code> of data type <code class="docutils literal notranslate"><span class="pre">int32</span></code> or <code class="docutils literal notranslate"><span class="pre">int64</span></code>,
the element value range is <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">tensor_x.shape[0])</span></code>.</p></li>
<li><p>Assignment: <code class="docutils literal notranslate"><span class="pre">tensor_x</span> <span class="pre">[index]</span> <span class="pre">=</span> <span class="pre">U</span></code>.</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">tensor_x</span></code> data type must be one of the following: <code class="docutils literal notranslate"><span class="pre">float16</span></code>, <code class="docutils literal notranslate"><span class="pre">float32</span></code>, <code class="docutils literal notranslate"><span class="pre">int8</span></code>, <code class="docutils literal notranslate"><span class="pre">uint8</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">index</span></code> must be <code class="docutils literal notranslate"><span class="pre">Tensor</span></code> of data type <code class="docutils literal notranslate"><span class="pre">int32</span></code>, the element value range is <code class="docutils literal notranslate"><span class="pre">[0,</span> <span class="pre">tensor_x.shape</span> <span class="pre">[0])</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">U</span></code> can be <code class="docutils literal notranslate"><span class="pre">Number</span></code>, <code class="docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="docutils literal notranslate"><span class="pre">Tuple</span></code> only containing <code class="docutils literal notranslate"><span class="pre">Number</span></code>, <code class="docutils literal notranslate"><span class="pre">Tuple</span></code> only containing <code class="docutils literal notranslate"><span class="pre">Tensor</span></code>.</p>
<ul>
<li><p>Single <code class="docutils literal notranslate"><span class="pre">Number</span></code> or every <code class="docutils literal notranslate"><span class="pre">Number</span></code> in  <code class="docutils literal notranslate"><span class="pre">Tuple</span></code> must be the same type as <code class="docutils literal notranslate"><span class="pre">tensor_x</span></code>, ie
When the data type of <code class="docutils literal notranslate"><span class="pre">tensor_x</span></code> is <code class="docutils literal notranslate"><span class="pre">uint8</span></code> or <code class="docutils literal notranslate"><span class="pre">int8</span></code>, the <code class="docutils literal notranslate"><span class="pre">Number</span></code> type should be <code class="docutils literal notranslate"><span class="pre">int</span></code>;
When the data type of <code class="docutils literal notranslate"><span class="pre">tensor_x</span></code> is <code class="docutils literal notranslate"><span class="pre">float16</span></code> or <code class="docutils literal notranslate"><span class="pre">float32</span></code>, the <code class="docutils literal notranslate"><span class="pre">Number</span></code> type should be <code class="docutils literal notranslate"><span class="pre">float</span></code>.</p></li>
<li><p>Single <code class="docutils literal notranslate"><span class="pre">Tensor</span></code> or every <code class="docutils literal notranslate"><span class="pre">Tensor</span> <span class="pre">in</span> <span class="pre">Tuple</span></code> must be consistent with the data type of <code class="docutils literal notranslate"><span class="pre">tensor_x</span></code>,
when single <code class="docutils literal notranslate"><span class="pre">Tensor</span></code>, the <code class="docutils literal notranslate"><span class="pre">shape</span></code> should be equal to or broadcast as <code class="docutils literal notranslate"><span class="pre">index.shape</span> <span class="pre">+</span> <span class="pre">tensor_x.shape</span> <span class="pre">[1:]</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Tuple</span></code> containing <code class="docutils literal notranslate"><span class="pre">Number</span></code> must meet requirement:
<code class="docutils literal notranslate"><span class="pre">len</span> <span class="pre">(Tuple)</span> <span class="pre">=</span> <span class="pre">(index.shape</span> <span class="pre">+</span> <span class="pre">tensor_x.shape</span> <span class="pre">[1:])</span> <span class="pre">[-1]</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Tuple</span></code> containing <code class="docutils literal notranslate"><span class="pre">Tensor</span></code> must meet requirements:
the <code class="docutils literal notranslate"><span class="pre">shape</span></code> of each <code class="docutils literal notranslate"><span class="pre">Tensor</span></code> should be the same,
<code class="docutils literal notranslate"><span class="pre">(len</span> <span class="pre">(Tuple),)</span> <span class="pre">+</span> <span class="pre">Tensor.shape</span></code> should be equal to or broadcast as <code class="docutils literal notranslate"><span class="pre">index.shape</span> <span class="pre">+</span> <span class="pre">tensor_x.shape</span> <span class="pre">[1:]</span></code>.</p></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>None constant index: index is <code class="docutils literal notranslate"><span class="pre">None</span></code></p>
<ul>
<li><p>Value: <code class="docutils literal notranslate"><span class="pre">tensor_x[None]</span></code>, results are consistent with numpy.</p></li>
<li><p>Assignment: Not supported yet.</p></li>
</ul>
</li>
<li><p>tuple index: index is <code class="docutils literal notranslate"><span class="pre">tuple</span></code></p>
<ul>
<li><p>The tuple element is a slice:</p>
<ul>
<li><p>Value: for example <code class="docutils literal notranslate"><span class="pre">tensor_x[::,:</span> <span class="pre">4,</span> <span class="pre">3:</span> <span class="pre">0:</span> <span class="pre">-1]</span></code>.</p></li>
<li><p>Assignment: for example <code class="docutils literal notranslate"><span class="pre">tensor_x[::,:</span> <span class="pre">4,</span> <span class="pre">3:</span> <span class="pre">0:</span> <span class="pre">-1]</span> <span class="pre">=</span> <span class="pre">u</span></code>.</p></li>
</ul>
</li>
<li><p>The tuple element is Number:</p>
<ul>
<li><p>Value: for example <code class="docutils literal notranslate"><span class="pre">tensor_x[2,1]</span></code>.</p></li>
<li><p>Assignment: for example <code class="docutils literal notranslate"><span class="pre">tensor_x[1,4]</span> <span class="pre">=</span> <span class="pre">u</span></code>.</p></li>
</ul>
</li>
<li><p>The tuple element is a mixture of slice and ellipsis:</p>
<ul>
<li><p>Value: for example <code class="docutils literal notranslate"><span class="pre">tensor_x[...,</span> <span class="pre">::,</span> <span class="pre">1:]</span></code>.</p></li>
<li><p>Assignment: for example <code class="docutils literal notranslate"><span class="pre">tensor_x[...,</span> <span class="pre">::,</span> <span class="pre">1:]</span> <span class="pre">=</span> <span class="pre">u</span></code>.</p></li>
</ul>
</li>
<li><p>Not supported in other situations</p></li>
</ul>
</li>
</ul>
<p>In addition, tuple also supports slice value operation, <code class="docutils literal notranslate"><span class="pre">tuple_x</span> <span class="pre">[start:</span> <span class="pre">stop:</span> <span class="pre">step]</span></code>, which has the same effect as Python, and will not be repeated here.</p>
</div>
<div class="section" id="unsupported-syntax">
<h3>Unsupported Syntax<a class="headerlink" href="#unsupported-syntax" title="Permalink to this headline">¶</a></h3>
<p>Currently, the following syntax is not supported in network constructors:
<code class="docutils literal notranslate"><span class="pre">raise</span></code>, <code class="docutils literal notranslate"><span class="pre">yield</span></code>, <code class="docutils literal notranslate"><span class="pre">async</span> <span class="pre">for</span></code>, <code class="docutils literal notranslate"><span class="pre">with</span></code>, <code class="docutils literal notranslate"><span class="pre">async</span> <span class="pre">with</span></code>, <code class="docutils literal notranslate"><span class="pre">assert</span></code>, <code class="docutils literal notranslate"><span class="pre">import</span></code>, and <code class="docutils literal notranslate"><span class="pre">await</span></code>.</p>
</div>
</div>
<div class="section" id="network-definition-constraints">
<h2>Network Definition Constraints<a class="headerlink" href="#network-definition-constraints" title="Permalink to this headline">¶</a></h2>
<div class="section" id="instance-types-on-the-entire-network">
<h3>Instance Types on the Entire Network<a class="headerlink" href="#instance-types-on-the-entire-network" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>Common Python function with the <a class="reference external" href="https://www.mindspore.cn/api/en/0.3.0-alpha/api/python/mindspore/mindspore.html#mindspore.ms_function">&#64;ms_function</a> decorator.</p></li>
<li><p>Cell subclass inherited from <a class="reference external" href="https://www.mindspore.cn/api/en/0.3.0-alpha/api/python/mindspore/mindspore.nn.html#mindspore.nn.Cell">nn.Cell</a>.</p></li>
</ul>
</div>
<div class="section" id="network-input-type">
<h3>Network Input Type<a class="headerlink" href="#network-input-type" title="Permalink to this headline">¶</a></h3>
<ul class="simple">
<li><p>The training data input parameters of the entire network must be of the Tensor type.</p></li>
<li><p>The generated ANF diagram cannot contain the following constant nodes: string constants, constants with nested tuples, and constants with nested lists.</p></li>
</ul>
</div>
<div class="section" id="network-graph-optimization">
<h3>Network Graph Optimization<a class="headerlink" href="#network-graph-optimization" title="Permalink to this headline">¶</a></h3>
<p>During graph optimization at the ME frontend, the dataclass, dictionary, list, and key-value pair types are converted to tuple types, and the corresponding operations are converted to tuple operations.</p>
</div>
<div class="section" id="network-construction-components">
<h3>Network Construction Components<a class="headerlink" href="#network-construction-components" title="Permalink to this headline">¶</a></h3>
<table border="1" class="docutils">
<thead>
<tr>
<th align="left">Category</th>
<th align="left">Content</th>
</tr>
</thead>
<tbody>
<tr>
<td align="left"><code>Cell</code> instance</td>
<td align="left"><a href="https://www.mindspore.cn/api/en/0.3.0-alpha/api/python/mindspore/mindspore.nn.html">mindspore/nn/*</a>, and custom <a href="https://www.mindspore.cn/api/en/0.3.0-alpha/api/python/mindspore/mindspore.nn.html#mindspore.nn.Cell">Cell</a>.</td>
</tr>
<tr>
<td align="left">Member function of a <code>Cell</code> instance</td>
<td align="left">Member functions of other classes in the construct function of Cell can be called.</td>
</tr>
<tr>
<td align="left">Function</td>
<td align="left">Custom Python functions and system functions listed in the preceding content.</td>
</tr>
<tr>
<td align="left">Dataclass instance</td>
<td align="left">Class decorated with @dataclass.</td>
</tr>
<tr>
<td align="left">Primitive operator</td>
<td align="left"><a href="https://www.mindspore.cn/api/en/0.3.0-alpha/api/python/mindspore/mindspore.ops.operations.html">mindspore/ops/operations/*</a>.</td>
</tr>
<tr>
<td align="left">Composite operator</td>
<td align="left"><a href="https://www.mindspore.cn/api/en/0.3.0-alpha/api/python/mindspore/mindspore.ops.composite.html">mindspore/ops/composite/*</a>.</td>
</tr>
<tr>
<td align="left">Operator generated by constexpr</td>
<td align="left">Uses the value generated by <a href="https://www.mindspore.cn/api/en/0.3.0-alpha/api/python/mindspore/mindspore.ops.html#mindspore.ops.constexpr">@constexpr</a> to calculate operators.</td>
</tr>
</tbody>
</table></div>
<div class="section" id="other-constraints">
<h3>Other Constraints<a class="headerlink" href="#other-constraints" title="Permalink to this headline">¶</a></h3>
<p>Input parameters of the construct function on the entire network and parameters of functions modified by the ms_function decorator are generalized during the graph compilation. Therefore, they cannot be transferred to operators as constant input, as shown in the following example:</p>
<ul>
<li><p>The following is an example of incorrect input:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ExpandDimsTest</span><span class="p">(</span><span class="n">Cell</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ExpandDimsTest</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">expandDims</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">ExpandDims</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">construct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_x</span><span class="p">,</span> <span class="n">input_axis</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">expandDims</span><span class="p">(</span><span class="n">input_x</span><span class="p">,</span> <span class="n">input_axis</span><span class="p">)</span>
<span class="n">expand_dim</span> <span class="o">=</span> <span class="n">ExpandDimsTest</span><span class="p">()</span>
<span class="n">input_x</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>
<span class="n">expand_dim</span><span class="p">(</span><span class="n">input_x</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
</pre></div>
</div>
<p>In the example, ExpandDimsTest is a single-operator network with two inputs: input_x and input_axis. The second input of the ExpandDims operator must be a constant. This is because input_axis is required when the output dimension of the ExpandDims operator is deduced during graph compilation. As the network parameter input, the value of input_axis is generalized into a variable and cannot be determined. As a result, the output dimension of the operator cannot be deduced, causing the graph compilation failure. Therefore, the input required by deduction in the graph compilation phase must be a constant. In APIs, the “constant input is needed” is marked for parameters that require constant input of these operators.</p>
</li>
<li><p>Directly enter the needed value or a member variable in a class for the constant input of the operator in the construct function. The following is an example of correct input:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">ExpandDimsTest</span><span class="p">(</span><span class="n">Cell</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">axis</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ExpandDimsTest</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">expandDims</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">ExpandDims</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">axis</span> <span class="o">=</span> <span class="n">axis</span>

    <span class="k">def</span> <span class="nf">construct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_x</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">expandDims</span><span class="p">(</span><span class="n">input_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">axis</span><span class="p">)</span>
<span class="n">axis</span> <span class="o">=</span> <span class="mi">0</span>
<span class="n">expand_dim</span> <span class="o">=</span> <span class="n">ExpandDimsTest</span><span class="p">(</span><span class="n">axis</span><span class="p">)</span>
<span class="n">input_x</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">,</span><span class="mi">2</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>
<span class="n">expand_dim</span><span class="p">(</span><span class="n">input_x</span><span class="p">)</span>
</pre></div>
</div>
</li>
</ul>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="glossary.html" class="btn btn-neutral float-right" title="Glossary" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="operator_list.html" class="btn btn-neutral float-left" title="Operator List" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, MindSpore

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>