<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>mindspore.context &mdash; MindSpore master documentation</title>
      <link rel="stylesheet" href="../_static/css/bootstrap.min.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/training.css" type="text/css" /><link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/js/training.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="mindspore.dataset" href="mindspore.dataset.html" />
    <link rel="prev" title="mindspore.communication" href="mindspore.communication.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> MindSpore
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Design</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../design/technical_white_paper.html">Technical White Paper</a></li>
<li class="toctree-l1"><a class="reference internal" href="../design/gradient.html">MindSpore Automatic Differentiation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../design/distributed_training_design.html">Distributed Training Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="../design/mindir.html">MindSpore IR (MindIR)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../design/data_engine.html">High Performance Data Processing Engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="../design/graph_kernel_fusion.html">Graph Kernel Fusion</a></li>
<li class="toctree-l1"><a class="reference internal" href="../design/second_order_optimizer.html">Second Order Optimizer</a></li>
<li class="toctree-l1"><a class="reference external" href="https://www.mindspore.cn/mindinsight/docs/en/r1.7/training_visual_design.html">Design of Visualization↗</a></li>
<li class="toctree-l1"><a class="reference internal" href="../design/glossary.html">Glossary</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Note</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../note/benchmark.html">Benchmarks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../note/network_list.html">Network List</a></li>
<li class="toctree-l1"><a class="reference internal" href="../note/operator_list.html">Operator List</a></li>
<li class="toctree-l1"><a class="reference internal" href="../note/syntax_list.html">Syntax Support</a></li>
<li class="toctree-l1"><a class="reference internal" href="../note/env_var_list.html">Environment Variables</a></li>
<li class="toctree-l1"><a class="reference internal" href="../note/api_mapping.html">API Mapping</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="mindspore.html">mindspore</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindspore.common.initializer.html">mindspore.common.initializer</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindspore.communication.html">mindspore.communication</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">mindspore.context</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindspore.dataset.html">mindspore.dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindspore.dataset.audio.html">mindspore.dataset.audio</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindspore.dataset.config.html">mindspore.dataset.config</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindspore.dataset.text.html">mindspore.dataset.text</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindspore.dataset.transforms.html">mindspore.dataset.transforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindspore.dataset.vision.html">mindspore.dataset.vision</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindspore.mindrecord.html">mindspore.mindrecord</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindspore.nn.html">mindspore.nn</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindspore.nn.probability.html">mindspore.nn.probability</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindspore.nn.transformer.html">mindspore.nn.transformer</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindspore.numpy.html">mindspore.numpy</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindspore.ops.html">mindspore.ops</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindspore.ops.functional.html">mindspore.ops.functional</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindspore.parallel.html">mindspore.parallel</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindspore.parallel.nn.html">mindspore.parallel.nn</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindspore.profiler.html">mindspore.profiler</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindspore.scipy.html">mindspore.scipy</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindspore.train.html">mindspore.train</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindspore.boost.html">mindspore.boost (experimental)</a></li>
<li class="toctree-l1"><a class="reference external" href="https://www.mindspore.cn/lite/api/en/r1.7/api_cpp/mindspore.html">C++ API↗</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Migration Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../migration_guide/overview.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../migration_guide/preparation.html">Preparation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../migration_guide/script_analysis.html">Network Script Analysis</a></li>
<li class="toctree-l1"><a class="reference internal" href="../migration_guide/script_development.html">Network Script Development</a></li>
<li class="toctree-l1"><a class="reference internal" href="../migration_guide/neural_network_debug.html">Network Debugging</a></li>
<li class="toctree-l1"><a class="reference internal" href="../migration_guide/performance_optimization.html">Performance Profiling</a></li>
<li class="toctree-l1"><a class="reference internal" href="../migration_guide/inference.html">Inference Execution</a></li>
<li class="toctree-l1"><a class="reference internal" href="../migration_guide/sample_code.html">Network Migration Debugging Example</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">FAQ</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../faq/installation.html">Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/data_processing.html">Data Processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/implement_problem.html">Implement Problem</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/network_compilation.html">Network Compilation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/operators_compile.html">Operators Compile</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/usage_migrate_3rd.html">Migration from a Third-party Framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/performance_tuning.html">Performance Tuning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/precision_tuning.html">Precision Tuning</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/distributed_configure.html">Distributed Configuration</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/inference.html">Inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../faq/feature_advice.html">Feature Advice</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">RELEASE NOTES</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../RELEASE.html">Release Notes</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MindSpore</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>mindspore.context</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/api_python/mindspore.context.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="module-mindspore.context">
<span id="mindspore-context"></span><h1>mindspore.context<a class="headerlink" href="#module-mindspore.context" title="Permalink to this headline"></a></h1>
<p>The context of mindspore, used to configure the current execution environment,
includes the execution mode, execution backend and other feature switches.</p>
<dl class="py class">
<dt class="sig sig-object py" id="mindspore.context.ParallelMode">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore.context.</span></span><span class="sig-name descname"><span class="pre">ParallelMode</span></span><a class="reference internal" href="../_modules/mindspore/context.html#ParallelMode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore.context.ParallelMode" title="Permalink to this definition"></a></dt>
<dd><p>Parallel mode options.</p>
<p>There are five kinds of parallel modes, “STAND_ALONE”, “DATA_PARALLEL”,
“HYBRID_PARALLEL”, “SEMI_AUTO_PARALLEL” and “AUTO_PARALLEL”. Default: “STAND_ALONE”.</p>
<ul class="simple">
<li><p>STAND_ALONE: Only one processor is working.</p></li>
<li><p>DATA_PARALLEL: Distributes the data across different processors.</p></li>
<li><p>HYBRID_PARALLEL: Achieves data parallelism and model parallelism manually.</p></li>
<li><p>SEMI_AUTO_PARALLEL: Achieves data parallelism and model parallelism by setting parallel strategies.</p></li>
<li><p>AUTO_PARALLEL: Achieves parallelism automatically.</p></li>
</ul>
<p>MODE_LIST: The list of all supported parallel modes.</p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mindspore.context.get_auto_parallel_context">
<span class="sig-prename descclassname"><span class="pre">mindspore.context.</span></span><span class="sig-name descname"><span class="pre">get_auto_parallel_context</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">attr_key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mindspore/context.html#get_auto_parallel_context"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore.context.get_auto_parallel_context" title="Permalink to this definition"></a></dt>
<dd><p>Get auto parallel context attribute value according to the key.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>attr_key</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – The key of the attribute.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Returns attribute value according to the key.</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/library/exceptions.html#ValueError" title="(in Python v3.8)"><strong>ValueError</strong></a> – If input key is not attribute in auto parallel context.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore</span> <span class="kn">import</span> <span class="n">context</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parallel_mode</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">get_auto_parallel_context</span><span class="p">(</span><span class="s2">&quot;parallel_mode&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dataset_strategy</span> <span class="o">=</span> <span class="n">context</span><span class="o">.</span><span class="n">get_auto_parallel_context</span><span class="p">(</span><span class="s2">&quot;dataset_strategy&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mindspore.context.get_context">
<span class="sig-prename descclassname"><span class="pre">mindspore.context.</span></span><span class="sig-name descname"><span class="pre">get_context</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">attr_key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mindspore/context.html#get_context"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore.context.get_context" title="Permalink to this definition"></a></dt>
<dd><p>Get context attribute value according to the input key.
If some attributes are not set, they will be automatically obtained.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>attr_key</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – The key of the attribute.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Object, The value of given attribute key.</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/library/exceptions.html#ValueError" title="(in Python v3.8)"><strong>ValueError</strong></a> – If input key is not an attribute in context.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore</span> <span class="kn">import</span> <span class="n">context</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">get_context</span><span class="p">(</span><span class="s2">&quot;device_target&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">get_context</span><span class="p">(</span><span class="s2">&quot;device_id&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mindspore.context.get_ps_context">
<span class="sig-prename descclassname"><span class="pre">mindspore.context.</span></span><span class="sig-name descname"><span class="pre">get_ps_context</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">attr_key</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mindspore/context.html#get_ps_context"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore.context.get_ps_context" title="Permalink to this definition"></a></dt>
<dd><p>Get parameter server training mode context attribute value according to the key.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>attr_key</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – <p>The key of the attribute:</p>
<ul class="simple">
<li><p>enable_ps (bool): Whether to enable parameter server training mode.</p></li>
</ul>
</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Returns attribute value according to the key.</p>
</dd>
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><p><a class="reference external" href="https://docs.python.org/library/exceptions.html#ValueError" title="(in Python v3.8)"><strong>ValueError</strong></a> – If input key is not attribute in auto parallel context.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore</span> <span class="kn">import</span> <span class="n">context</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">get_ps_context</span><span class="p">(</span><span class="s2">&quot;enable_ps&quot;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mindspore.context.reset_auto_parallel_context">
<span class="sig-prename descclassname"><span class="pre">mindspore.context.</span></span><span class="sig-name descname"><span class="pre">reset_auto_parallel_context</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mindspore/context.html#reset_auto_parallel_context"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore.context.reset_auto_parallel_context" title="Permalink to this definition"></a></dt>
<dd><p>Reset auto parallel context attributes to the default values:</p>
<ul class="simple">
<li><p>device_num: 1.</p></li>
<li><p>global_rank: 0.</p></li>
<li><p>gradients_mean: False.</p></li>
<li><p>gradient_fp32_sync: True.</p></li>
<li><p>parallel_mode: ‘stand_alone’.</p></li>
<li><p>search_mode: ‘dynamic_programming’.</p></li>
<li><p>auto_parallel_search_mode: ‘dynamic_programming’.</p></li>
<li><p>parameter_broadcast: False.</p></li>
<li><p>strategy_ckpt_load_file: ‘’.</p></li>
<li><p>strategy_ckpt_save_file: ‘’.</p></li>
<li><p>full_batch: False.</p></li>
<li><p>enable_parallel_optimizer: False.</p></li>
<li><p>enable_alltoall: False.</p></li>
<li><p>pipeline_stages: 1.</p></li>
<li><p>fusion_threshold: 64.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mindspore.context.reset_ps_context">
<span class="sig-prename descclassname"><span class="pre">mindspore.context.</span></span><span class="sig-name descname"><span class="pre">reset_ps_context</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mindspore/context.html#reset_ps_context"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore.context.reset_ps_context" title="Permalink to this definition"></a></dt>
<dd><p>Reset parameter server training mode context attributes to the default values:</p>
<ul class="simple">
<li><p>enable_ps: False.</p></li>
</ul>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mindspore.context.set_auto_parallel_context">
<span class="sig-prename descclassname"><span class="pre">mindspore.context.</span></span><span class="sig-name descname"><span class="pre">set_auto_parallel_context</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mindspore/context.html#set_auto_parallel_context"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore.context.set_auto_parallel_context" title="Permalink to this definition"></a></dt>
<dd><p>Set auto parallel context, which is valid only for Ascend and GPU target.</p>
<p>Auto parallel context should be configured before the initialization of your network.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Attribute name is required for setting attributes.
If a program has tasks on different parallel modes, before setting a new parallel mode for the
next task, interface mindspore.context.reset_auto_parallel_context() should be called to reset
the configuration.
Setting or changing parallel modes must be called before creating any Initializer, otherwise,
it may have RuntimeError when compiling the network.</p>
</div>
<p>Some configurations are parallel mode specific, see the below table for details:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 50%" />
<col style="width: 50%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Common</p></th>
<th class="head"><p>AUTO_PARALLEL</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>device_num</p></td>
<td><p>gradient_fp32_sync</p></td>
</tr>
<tr class="row-odd"><td><p>global_rank</p></td>
<td><p>loss_repeated_mean</p></td>
</tr>
<tr class="row-even"><td><p>gradients_mean</p></td>
<td><p>search_mode</p></td>
</tr>
<tr class="row-odd"><td><p>parallel_mode</p></td>
<td><p>strategy_ckpt_load_file</p></td>
</tr>
<tr class="row-even"><td><p>all_reduce_fusion_config</p></td>
<td><p>strategy_ckpt_save_file</p></td>
</tr>
<tr class="row-odd"><td><p>enable_parallel_optimizer</p></td>
<td><p>dataset_strategy</p></td>
</tr>
<tr class="row-even"><td><p>parallel_optimizer_config</p></td>
<td><p>pipeline_stages</p></td>
</tr>
<tr class="row-odd"><td><p>enable_alltoall</p></td>
<td><p>grad_accumulation_step</p></td>
</tr>
<tr class="row-even"><td><p></p></td>
<td><p>auto_parallel_search_mode</p></td>
</tr>
<tr class="row-odd"><td><p></p></td>
<td><p>comm_fusion</p></td>
</tr>
</tbody>
</table>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>device_num</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Available device number, the value must be in [1, 4096]. Default: 1.</p></li>
<li><p><strong>global_rank</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Global rank id, the value must be in [0, 4095]. Default: 0.</p></li>
<li><p><strong>gradients_mean</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Whether to perform mean operator after allreduce of gradients.
“stand_alone” do not support gradients_mean. Default: False.</p></li>
<li><p><strong>gradient_fp32_sync</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Run allreduce of gradients in fp32. “stand_alone”, “data_parallel”
and “hybrid_parallel” do not support gradient_fp32_sync. Default: True.</p></li>
<li><p><strong>parallel_mode</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – <p>There are five kinds of parallel modes, “stand_alone”, “data_parallel”,
“hybrid_parallel”, “semi_auto_parallel” and “auto_parallel”. Note the pynative mode only supports
the “stand_alone” and “data_parallel” mode. Default: “stand_alone”.</p>
<ul>
<li><p>stand_alone: Only one processor is working.</p></li>
<li><p>data_parallel: Distributes the data across different processors.</p></li>
<li><p>hybrid_parallel: Achieves data parallelism and model parallelism manually.</p></li>
<li><p>semi_auto_parallel: Achieves data and model parallelism by setting parallel strategies.</p></li>
<li><p>auto_parallel: Achieving parallelism automatically.</p></li>
</ul>
</p></li>
<li><p><strong>search_mode</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – <p>There are three kinds of shard strategy search modes: “recursive_programming”,
“dynamic_programming” and “sharding_propagation”. Default: “dynamic_programming”.</p>
<ul>
<li><p>recursive_programming: Recursive programming search mode.</p></li>
<li><p>dynamic_programming: Dynamic programming search mode.</p></li>
<li><p>sharding_propagation: Propagate shardings from configured ops to non-configured ops.</p></li>
</ul>
</p></li>
<li><p><strong>auto_parallel_search_mode</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – This is the old version of ‘search_mode’. Here, remaining this attribute is
for forward compatibility, and this attribute will be deleted in a future MindSpore version.</p></li>
<li><p><strong>parameter_broadcast</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Whether to broadcast parameters before training. Before training, in order to have
the same network initialization parameter values for all devices, broadcast the parameters
on device 0 to other devices. Parameter broadcasting in different parallel modes is different,
data_parallel mode, all parameters are broadcast except for the parameter whose attribute
layerwise_parallel is True. Hybrid_parallel, semi_auto_parallel and auto_parallel mode, the
segmented parameters do not participate in broadcasting. Default: False.</p></li>
<li><p><strong>strategy_ckpt_load_file</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – The path to load parallel strategy checkpoint. Default: ‘’</p></li>
<li><p><strong>strategy_ckpt_save_file</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – The path to save parallel strategy checkpoint. Default: ‘’</p></li>
<li><p><strong>full_batch</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – If you load whole batch datasets in auto_parallel mode, this parameter
should be set as True. Default: False. The interface is not to be recommended currently,
it is better using ‘dataset_strategy’ to replace it.</p></li>
<li><p><strong>dataset_strategy</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a><em>, </em><a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em>]</em>) – Dataset sharding strategy. Default: “data_parallel”.
dataset_strategy=”data_parallel” is equal to full_batch=False, dataset_strategy=”full_batch” is
equal to full_batch=True. For dataset load into net by model parallel strategy likes
ds_stra ((1, 8), (1, 8)), it requires using set_auto_parallel_context(dataset_strategy=ds_stra).</p></li>
<li><p><strong>enable_parallel_optimizer</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – This is a developing feature, which shards the weight update computation for
data parallel training in the benefit of time and memory saving. Currently, auto and semi auto
parallel mode support all optimizers in both Ascend and GPU. Data parallel mode only supports
<cite>Lamb</cite> and <cite>AdamWeightDecay</cite> in Ascend . Default: False.</p></li>
<li><p><strong>enable_alltoall</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – A switch that allows AllToAll operators to be generated during communication. If its
value is False, there will be a combination of operators such as AllGather, Split and Concat
instead of AllToAll. Default: False.</p></li>
<li><p><strong>all_reduce_fusion_config</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a>) – Set allreduce fusion strategy by parameters indices. Only support ReduceOp.SUM
and HCCL_WORLD_GROUP/NCCL_WORLD_GROUP. No Default, if it is not set, the fusion is closed.</p></li>
<li><p><strong>pipeline_stages</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Set the stage information for pipeline parallel. This indicates how the devices are
distributed alone in the pipeline. The total devices will be divided into ‘pipeline_stags’
stages. Currently, this could only be used when parallel mode semi_auto_parallel is enabled.
Default: 1.</p></li>
<li><p><strong>grad_accumulation_step</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Set the accumulation steps of gradients in auto and semi auto parallel mode.
This should be a positive int. Default: 1.</p></li>
<li><p><strong>parallel_optimizer_config</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – <p>A dict contains the keys and values for setting the parallel optimizer
configure. The configure provides more detailed behavior control about parallel training
when parallel optimizer is enabled. Currently it supports the key <cite>gradient_accumulation_shard</cite>.
The configure will be effective when we use
context.set_auto_parallel_context(enable_parallel_optimizer=True).
It supports the following keys.</p>
<ul>
<li><p>gradient_accumulation_shard(bool): If true, the accumulation gradient parameters will be
sharded across the data parallel devices. This will
introduce additional communication(ReduceScatter) at
each step when accumulate the gradients, but saves a
lot of device memories, thus can make model be trained
with larger batch size. This configure is effective only
when the model runs on pipeline training or gradient
accumulation with data parallel. Default True.</p></li>
<li><p>parallel_optimizer_threshold(int): Set the threshold of parallel optimizer. When parallel
optimizer is enabled, parameters with size smaller than this threshold will not be sharded
across the devices. Parameter size = shape[0] * … * shape[n] * size(dtype). Non-negative.
Unit: KB. Default: 64.</p></li>
</ul>
</p></li>
<li><p><strong>comm_fusion</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – <p>A dict contains the types and configurations for setting the communication fusion. each
communication fusion config has two keys: “mode” and “config”.
It supports following communication fusion types and configurations:</p>
<ul>
<li><p>allreduce: If communication fusion type is <cite>allreduce</cite>. The <cite>mode</cite> contains: <cite>auto</cite>, <cite>size</cite>
and <cite>index</cite>. In <cite>auto</cite> mode, AllReduce fusion is configured by gradients size and the default
fusion threshold is <cite>64</cite> MB. In ‘size’ mode, AllReduce fusion is configured by gradients size
manually, and the fusion threshold must be larger than <cite>0</cite> MB. In <cite>index</cite> mode, it is same as
<cite>all_reduce_fusion_config</cite>.</p></li>
<li><p>allgather: If communication fusion type is <cite>allgather</cite>. The <cite>mode</cite> contains: <cite>auto</cite>, <cite>size</cite>.
In <cite>auto</cite> mode, AllGather fusion is configured by gradients size, and the default fusion
threshold is <cite>64</cite> MB. In ‘size’ mode, AllGather fusion is configured by gradients size
manually, and the fusion threshold must be larger than <cite>0</cite> MB.</p></li>
<li><p>reducescatter: If communication fusion type is <cite>reducescatter</cite>. The <cite>mode</cite> contains: <cite>auto</cite>
and <cite>size</cite>. Config is same as <cite>allgather</cite>.</p></li>
</ul>
</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/library/exceptions.html#ValueError" title="(in Python v3.8)"><strong>ValueError</strong></a> – If input key is not attribute in auto parallel context.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore</span> <span class="kn">import</span> <span class="n">context</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">set_auto_parallel_context</span><span class="p">(</span><span class="n">device_num</span><span class="o">=</span><span class="mi">8</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">set_auto_parallel_context</span><span class="p">(</span><span class="n">global_rank</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">set_auto_parallel_context</span><span class="p">(</span><span class="n">gradients_mean</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">set_auto_parallel_context</span><span class="p">(</span><span class="n">gradient_fp32_sync</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">set_auto_parallel_context</span><span class="p">(</span><span class="n">parallel_mode</span><span class="o">=</span><span class="s2">&quot;auto_parallel&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">set_auto_parallel_context</span><span class="p">(</span><span class="n">search_mode</span><span class="o">=</span><span class="s2">&quot;dynamic_programming&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">set_auto_parallel_context</span><span class="p">(</span><span class="n">auto_parallel_search_mode</span><span class="o">=</span><span class="s2">&quot;dynamic_programming&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">set_auto_parallel_context</span><span class="p">(</span><span class="n">parameter_broadcast</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">set_auto_parallel_context</span><span class="p">(</span><span class="n">strategy_ckpt_load_file</span><span class="o">=</span><span class="s2">&quot;./strategy_stage1.ckpt&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">set_auto_parallel_context</span><span class="p">(</span><span class="n">strategy_ckpt_save_file</span><span class="o">=</span><span class="s2">&quot;./strategy_stage1.ckpt&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">set_auto_parallel_context</span><span class="p">(</span><span class="n">dataset_strategy</span><span class="o">=</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">)))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">set_auto_parallel_context</span><span class="p">(</span><span class="n">enable_parallel_optimizer</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">set_auto_parallel_context</span><span class="p">(</span><span class="n">enable_alltoall</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">set_auto_parallel_context</span><span class="p">(</span><span class="n">all_reduce_fusion_config</span><span class="o">=</span><span class="p">[</span><span class="mi">8</span><span class="p">,</span> <span class="mi">160</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">set_auto_parallel_context</span><span class="p">(</span><span class="n">pipeline_stages</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">parallel_config</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;gradient_accumulation_shard&quot;</span><span class="p">:</span> <span class="kc">True</span><span class="p">,</span> <span class="s2">&quot;parallel_optimizer_threshold&quot;</span><span class="p">:</span> <span class="mi">24</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">set_auto_parallel_context</span><span class="p">(</span><span class="n">parallel_optimizer_config</span><span class="o">=</span><span class="n">parallel_config</span><span class="p">,</span> <span class="n">enable_parallel_optimizer</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">config</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;allreduce&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;mode&quot;</span><span class="p">:</span> <span class="s2">&quot;size&quot;</span><span class="p">,</span> <span class="s2">&quot;config&quot;</span><span class="p">:</span> <span class="mi">32</span><span class="p">},</span> <span class="s2">&quot;allgather&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;mode&quot;</span><span class="p">:</span> <span class="s2">&quot;size&quot;</span><span class="p">,</span> <span class="s2">&quot;config&quot;</span><span class="p">:</span> <span class="mi">32</span><span class="p">}}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">set_auto_parallel_context</span><span class="p">(</span><span class="n">comm_fusion</span><span class="o">=</span><span class="n">config</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mindspore.context.set_context">
<span class="sig-prename descclassname"><span class="pre">mindspore.context.</span></span><span class="sig-name descname"><span class="pre">set_context</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mindspore/context.html#set_context"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore.context.set_context" title="Permalink to this definition"></a></dt>
<dd><p>Set context for running environment.</p>
<p>Context should be configured before running your program. If there is no configuration,
it will be automatically set according to the device target by default.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Attribute name is required for setting attributes.
The mode is not recommended to be changed after net was initialized because the implementations of some
operations are different in graph mode and pynative mode. Default: GRAPH_MODE.</p>
</div>
<p>Some configurations are device specific, see the below table for details:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 30%" />
<col style="width: 36%" />
<col style="width: 34%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Function Classification</p></th>
<th class="head"><p>Configuration Parameters</p></th>
<th class="head"><p>Hardware Platform Support</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td rowspan="5"><p>System Configuration</p></td>
<td><p>device_id</p></td>
<td><p>CPU/GPU/Ascend</p></td>
</tr>
<tr class="row-odd"><td><p>device_target</p></td>
<td><p>CPU/GPU/Ascend</p></td>
</tr>
<tr class="row-even"><td><p>max_device_memory</p></td>
<td><p>GPU/Ascend</p></td>
</tr>
<tr class="row-odd"><td><p>variable_memory_max_size</p></td>
<td><p>Ascend</p></td>
</tr>
<tr class="row-even"><td><p>mempool_block_size</p></td>
<td><p>GPU/Ascend</p></td>
</tr>
<tr class="row-odd"><td rowspan="11"><p>Debug Configuration</p></td>
<td><p>save_graphs</p></td>
<td><p>CPU/GPU/Ascend</p></td>
</tr>
<tr class="row-even"><td><p>save_graphs_path</p></td>
<td><p>CPU/GPU/Ascend</p></td>
</tr>
<tr class="row-odd"><td><p>enable_dump</p></td>
<td><p>Ascend</p></td>
</tr>
<tr class="row-even"><td><p>save_dump_path</p></td>
<td><p>Ascend</p></td>
</tr>
<tr class="row-odd"><td><p>enable_profiling</p></td>
<td><p>Ascend</p></td>
</tr>
<tr class="row-even"><td><p>profiling_options</p></td>
<td><p>Ascend</p></td>
</tr>
<tr class="row-odd"><td><p>print_file_path</p></td>
<td><p>Ascend</p></td>
</tr>
<tr class="row-even"><td><p>env_config_path</p></td>
<td><p>CPU/GPU/Ascend</p></td>
</tr>
<tr class="row-odd"><td><p>precompile_only</p></td>
<td><p>CPU/GPU/Ascend</p></td>
</tr>
<tr class="row-even"><td><p>reserve_class_name_in_scope</p></td>
<td><p>CPU/GPU/Ascend</p></td>
</tr>
<tr class="row-odd"><td><p>pynative_synchronize</p></td>
<td><p>GPU/Ascend</p></td>
</tr>
<tr class="row-even"><td rowspan="12"><p>Executive Control</p></td>
<td><p>mode</p></td>
<td><p>CPU/GPU/Ascend</p></td>
</tr>
<tr class="row-odd"><td><p>enable_graph_kernel</p></td>
<td><p>Ascend/GPU</p></td>
</tr>
<tr class="row-even"><td><p>graph_kernel_flags</p></td>
<td><p>Ascend/GPU</p></td>
</tr>
<tr class="row-odd"><td><p>enable_reduce_precision</p></td>
<td><p>Ascend</p></td>
</tr>
<tr class="row-even"><td><p>auto_tune_mode</p></td>
<td><p>Ascend</p></td>
</tr>
<tr class="row-odd"><td><p>check_bprop</p></td>
<td><p>CPU/GPU/Ascend</p></td>
</tr>
<tr class="row-even"><td><p>max_call_depth</p></td>
<td><p>CPU/GPU/Ascend</p></td>
</tr>
<tr class="row-odd"><td><p>enable_sparse</p></td>
<td><p>CPU/GPU/Ascend</p></td>
</tr>
<tr class="row-even"><td><p>grad_for_scalar</p></td>
<td><p>CPU/GPU/Ascend</p></td>
</tr>
<tr class="row-odd"><td><p>enable_compile_cache</p></td>
<td><p>CPU/GPU/Ascend</p></td>
</tr>
<tr class="row-even"><td><p>runtime_num_threads</p></td>
<td><p>CPU/GPU/Ascend</p></td>
</tr>
<tr class="row-odd"><td><p>compile_cache_path</p></td>
<td><p>CPU/GPU/Ascend</p></td>
</tr>
</tbody>
</table>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>device_id</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – ID of the target device, the value must be in [0, device_num_per_host-1],
while device_num_per_host should be no more than 4096. Default: 0.</p></li>
<li><p><strong>device_target</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – The target device to run, support “Ascend”, “GPU”, and “CPU”.
If device target is not set, the version of MindSpore package is used.</p></li>
<li><p><strong>max_device_memory</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – Set the maximum memory available for devices. The format is “xxGB”. Default: “1024GB”.
The actual used memory size is the minimum of the available memory of the device and max_device_memory.</p></li>
<li><p><strong>variable_memory_max_size</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – This parameter is deprecated, and will be removed in a future version.
Please use parameter ‘max_device_memory’ instead.</p></li>
<li><p><strong>mempool_block_size</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – Set the size of the memory pool block in PyNative mode for devices.
The format is “xxGB”. Default: “1GB”. Minimum size is “1G”. The actual used memory block size is the minimum
of the available memory of the device and mempool_block_size.</p></li>
<li><p><strong>save_graphs</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Whether to save graphs. Default: False.
When the <cite>save_graphs</cite> attribute is set as True, attribute of <cite>save_graphs_path</cite> is used to set the
intermediate compilation graph storage path. By default, the graphs are saved in the current directory.</p></li>
<li><p><strong>save_graphs_path</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – Path to save graphs. Default: “.”.
If the specified directory does not exist, the system will automatically create the directory.
During distributed training, graphs will be saved to the directory of
<cite>save_graphs_path/rank_${rank_id}/</cite>. <cite>rank_id</cite> is the ID of the current device in the cluster.</p></li>
<li><p><strong>enable_dump</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – This parameters is deprecated, and will be deleted in the next version.</p></li>
<li><p><strong>save_dump_path</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – This parameters is deprecated, and will be deleted in the next version.</p></li>
<li><p><strong>enable_profiling</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – This parameters is deprecated, and will be deleted in the next version.
Please use mindspore.profiler.Profiler api instead.</p></li>
<li><p><strong>profiling_options</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – This parameters is deprecated, and will be deleted in the next version.
Please use mindspore.profiler.Profiler api instead.</p></li>
<li><p><strong>print_file_path</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – The path of saving print data. If this parameter is set, print data is saved to
a file by default, and print_file_path is not set, the screen will be displayed.
If the saved file already exists, the timestamp suffix will be added to the file. Saving data to a file
solves the problem of data loss in screen printing when a large amount of data is generated.
If it is not set, an error will be reported: prompt to set the upper absolute path.</p></li>
<li><p><strong>env_config_path</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – <p>Config path for DFX.
Through context.set_context(env_config_path=”./mindspore_config.json”)</p>
<p>configure RDR:</p>
<ul>
<li><p>enable: controls whether the RDR is enabled to collect the key data during training and
save key data in the fault scenario. When set to true, the RDR will be turned on.
When set to false, the RDR will be turned off.</p></li>
<li><p>mode: sets the mode of RDR on exporting data. When set to 1, the RDR only exports data
in the fault scenario. When set to 2, the RDR exports data in the fault scenario and the
normal end scenario. Default is 1.</p></li>
<li><p>path: sets the path where RDR saves data. The current path must be absolute.</p></li>
</ul>
<p>Memory reuse:</p>
<ul>
<li><p>mem_Reuse: controls whether the memory reuse function is turned on. When set to True,</p></li>
<li><p>the memory reuse function is turned on. When set to False, the memory reuse function is turned off.</p></li>
</ul>
</p></li>
<li><p><strong>precompile_only</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Whether to only precompile the network. Default: False.
If set to True, the network will only be compiled, not executed.</p></li>
<li><p><strong>reserve_class_name_in_scope</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – <p>Whether to save the network class name in the scope. Default: True.
Each node has a scope. A scope of a subnode is the name of its parent node. If reserve_class_name_in_scope
is set to True, the class name will be saved after keyword ‘net-’ in the scope.
For example:</p>
<p>Default/net-Net1/net-Net2 (reserve_class_name_in_scope=True)</p>
<p>Default/net/net (reserve_class_name_in_scope=False)</p>
</p></li>
<li><p><strong>pynative_synchronize</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Whether to enable synchronous execution of the device in PyNative mode.
Default: False. When the value is set to False, the operator is executed asynchronously on the device.
When an error occurs in the execution of the operator, the specific error script code location cannot
be located, when the value is set to True, the operator is executed synchronously on the device. It will
reduce the execution performance of the program. At this time, when an error occurs in the execution of
the operator, the location of the error script code can be located according to the call stack of the error.</p></li>
<li><p><strong>mode</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Running in GRAPH_MODE(0) or PYNATIVE_MODE(1). Default: GRAPH_MODE(0).
GRAPH_MODE or PYNATIVE_MODE can be set by <cite>mode</cite> attribute and both modes support all backends, default
mode is GRAPH_MODE.</p></li>
<li><p><strong>enable_graph_kernel</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Whether to enable graph kernel fusion to optimize network execution performance.
Default: False.
Indicates whether to enable image-computing convergence to optimize network execution performance.
If enable_graph_kernel is set to True, acceleration can be enabled.
For details of graph kernel fusion, please check
<a class="reference external" href="https://www.mindspore.cn/docs/en/r1.7/design/enable_graph_kernel_fusion.html">Enabling Graph Kernel Fusion</a>.</p></li>
<li><p><strong>graph_kernel_flags</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – <p>Optimization options of graph kernel fusion, and the priority is higher when it conflicts
with enable_graph_kernel. Only for experienced users.
For example, context.set_context(graph_kernel_flags=”–opt_level=2 –dump_as_text”). Some general options:</p>
<ul>
<li><p>opt_level: Set the optimization level.
Default: 2. Graph kernel fusion can be enabled equivalently by setting opt_level greater than 0.
Available values are:</p>
<ul>
<li><p>0: disables graph kernel fusion;</p></li>
<li><p>1: enables the basic fusion of operators;</p></li>
<li><p>2: includes all optimizations of level 1,
and turns on more optimizations such as CSE, arithmetic simplification and so on;</p></li>
<li><p>3: includes all optimizations of level 2, and turns on more optimizations such as SitchingFusion,
ParallelFusion and so on. Optimizations of this level are radical and unstable in some scenarios.
Be caution when using this level.</p></li>
</ul>
</li>
<li><p>dump_as_text: dumps detail info as text files. Default: false.</p></li>
</ul>
<p>More options can refer to the implementation code.</p>
</p></li>
<li><p><strong>enable_reduce_precision</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Whether to enable precision reduction.
If the operator does not support the user-specified precision, the precision will
be changed automatically. Default: True.</p></li>
<li><p><strong>auto_tune_mode</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – <p>The mode of auto tune when op building, get the best tiling performance.
Default: NO_TUNE. The value must be in [‘RL’, ‘GA’, ‘RL,GA’].</p>
<ul>
<li><p>RL: Reinforcement Learning tune.</p></li>
<li><p>GA: Genetic Algorithm tune.</p></li>
<li><p>RL,GA: When both RL and GA optimization are enabled, the tool automatically selects RL or GA based on
different types of operators in the network model. The sequence of RL and GA is not differentiated.
(Automatic selection).</p></li>
</ul>
<p>For more information about the enable operator tuning tool settings, please check
<a class="reference external" href="https://www.mindspore.cn/tutorials/experts/en/r1.7/debug/auto_tune.html">Enable the operator optimization tool</a>.</p>
</p></li>
<li><p><strong>check_bprop</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Whether to check back propagation nodes. The checking ensures that the shape and dtype
of back propagation node outputs is the same as input parameters. Default: False.</p></li>
<li><p><strong>max_call_depth</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Specify the maximum depth of function call. Must be positive integer. Default: 1000.
The max_call_depth parameter needs to be set when the nested call is too deep or the number
of subgraphs is too large. If max_call_depth is set larger than before, the system max stack depth should be
set larger too, otherwise a <cite>core dumped</cite> exception may be raised because of system stack overflow.</p></li>
<li><p><strong>enable_sparse</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Whether to enable sparsity feature. Default: False.
For details of sparsity and sparse tensor, please check
<a class="reference external" href="https://www.mindspore.cn/tutorials/en/r1.7/beginner/tensor.html#sparse-tensor">sparse tensor</a>.</p></li>
<li><p><strong>grad_for_scalar</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Whether to get gradient for scalar. Default: False.
When grad_for_scalar is set to True, the function’s scalar input can be derived.
The default value is False. Because the back-end does not support scaling operations currently,
this interface only supports simple operations that can be deduced by the front-end.</p></li>
<li><p><strong>enable_compile_cache</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Whether to save or load the cache of the graph compiled by front-end.
After enable_compile_cache is set to True, during the first execution, a hardware-independent
compilation cache is generated and exported to a MINDIR file. When the network is executed again,
if enable_compile_cache is still set to True and the network scripts are not changed,
the compile cache is loaded. Note that only limited automatic detection for the changes of
python scripts is supported by now, which means that there is a correctness risk. Default: False.
This is an experimental prototype that is subject to change and/or deletion.</p></li>
<li><p><strong>compile_cache_path</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – Path to save the cache of the graph compiled by front-end. Default: “.”.
If the specified directory does not exist, the system will automatically create the directory.
The cache will be saved to the directory of <cite>compile_cache_path/rank_${rank_id}/</cite>. The <cite>rank_id</cite> is
the ID of the current device in the cluster.</p></li>
<li><p><strong>runtime_num_threads</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The thread pool number of cpu kernel and actor used in runtime,
which must bigger than 0. Default value is 30, if you run many processes at
the same time, you should set the value smaller to avoid thread contention.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/library/exceptions.html#ValueError" title="(in Python v3.8)"><strong>ValueError</strong></a> – If input key is not an attribute in context.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore</span> <span class="kn">import</span> <span class="n">context</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="n">context</span><span class="o">.</span><span class="n">PYNATIVE_MODE</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="n">precompile_only</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="n">device_target</span><span class="o">=</span><span class="s2">&quot;Ascend&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="n">device_id</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="n">save_graphs</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">save_graphs_path</span><span class="o">=</span><span class="s2">&quot;./model.ms&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="n">enable_reduce_precision</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="n">enable_dump</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">save_dump_path</span><span class="o">=</span><span class="s2">&quot;.&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="n">enable_graph_kernel</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="n">graph_kernel_flags</span><span class="o">=</span><span class="s2">&quot;--opt_level=2 --dump_as_text&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="n">reserve_class_name_in_scope</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="n">variable_memory_max_size</span><span class="o">=</span><span class="s2">&quot;6GB&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="n">enable_profiling</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
<span class="gp">... </span>                    <span class="n">profiling_options</span><span class="o">=</span><span class="s1">&#39;{&quot;output&quot;:&quot;/home/data/output&quot;,&quot;training_trace&quot;:&quot;on&quot;}&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="n">check_bprop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="n">max_device_memory</span><span class="o">=</span><span class="s2">&quot;3.5GB&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="n">mempool_block_size</span><span class="o">=</span><span class="s2">&quot;1GB&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="n">print_file_path</span><span class="o">=</span><span class="s2">&quot;print.pb&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="n">enable_sparse</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="n">max_call_depth</span><span class="o">=</span><span class="mi">80</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="n">env_config_path</span><span class="o">=</span><span class="s2">&quot;./env_config.json&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="n">auto_tune_mode</span><span class="o">=</span><span class="s2">&quot;GA,RL&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="n">grad_for_scalar</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="n">enable_compile_cache</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">compile_cache_path</span><span class="o">=</span><span class="s2">&quot;./cache.ms&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="n">pynative_synchronize</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="n">runtime_num_threads</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mindspore.context.set_ps_context">
<span class="sig-prename descclassname"><span class="pre">mindspore.context.</span></span><span class="sig-name descname"><span class="pre">set_ps_context</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/mindspore/context.html#set_ps_context"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore.context.set_ps_context" title="Permalink to this definition"></a></dt>
<dd><p>Set parameter server training mode context.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Some other environment variables should also be set for parameter server training mode.
These environment variables are listed below:</p>
<p>MS_SERVER_NUM: Server number</p>
<p>MS_WORKER_NUM: Worker number</p>
<p>MS_SCHED_HOST: Scheduler IP address</p>
<p>MS_SCHED_PORT: Scheduler port</p>
<p>MS_ROLE: The role of this process:</p>
<p>MS_SCHED: represents the scheduler,</p>
<p>MS_WORKER: represents the worker,</p>
<p>MS_PSERVER/MS_SERVER: represents the Server</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>enable_ps</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Whether to enable parameter server training mode.
Only after enable_ps is set True, the environment variables will be effective.
Default: False.</p></li>
<li><p><strong>config_file_path</strong> (<em>string</em>) – Configuration file path used by recovery, parameter server training mode only
supports Server disaster recovery currently. Default: ‘’.</p></li>
<li><p><strong>scheduler_manage_port</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Scheduler manage port used to scale out/in. Default: 11202.</p></li>
<li><p><strong>enable_ssl</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Set PS SSL mode enabled or disabled. Default: False.</p></li>
<li><p><strong>client_password</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – Password to decrypt the secret key stored in the client certificate. Default: ‘’.</p></li>
<li><p><strong>server_password</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – Password to decrypt the secret key stored in the server certificate. Default: ‘’.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/library/exceptions.html#ValueError" title="(in Python v3.8)"><strong>ValueError</strong></a> – If input key is not the attribute in parameter server training mode context.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore</span> <span class="kn">import</span> <span class="n">context</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">context</span><span class="o">.</span><span class="n">set_ps_context</span><span class="p">(</span><span class="n">enable_ps</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">enable_ssl</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">client_password</span><span class="o">=</span><span class="s1">&#39;123456&#39;</span><span class="p">,</span> <span class="n">server_password</span><span class="o">=</span><span class="s1">&#39;123456&#39;</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="mindspore.communication.html" class="btn btn-neutral float-left" title="mindspore.communication" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="mindspore.dataset.html" class="btn btn-neutral float-right" title="mindspore.dataset" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, MindSpore.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 
</body>
</html>