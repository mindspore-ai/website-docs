<!DOCTYPE html>
<html class="writer-html5" lang="zh-CN" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>静态图语法-Python语句 &mdash; MindSpore master 文档</title><script>;(()=>{const e=localStorage.getItem("ms-theme"),t=window.matchMedia("(prefers-color-scheme: dark)").matches;(e?"dark"===e:t)&&document.documentElement.setAttribute("data-o-theme","dark")})();</script>
      <link rel="stylesheet" href="../../_static/css/bootstrap.min.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/training.css" type="text/css" /><link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/js/training.js"></script>
        <script src="../../_static/translations.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="索引" href="../../genindex.html" />
    <link rel="search" title="搜索" href="../../search.html" />
    <link rel="next" title="静态图语法-Python内置函数" href="python_builtin_functions.html" />
    <link rel="prev" title="静态图语法-运算符" href="operators.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> MindSpore
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="在文档中搜索" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">设计</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../design/overview.html">MindSpore设计概览</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../design/programming_paradigm.html">函数式和对象式融合编程范式</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../design/all_scenarios.html">全场景统一架构</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../design/dynamic_graph_and_static_graph.html">动静态图结合</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../design/pluggable_device.html">三方硬件对接</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../design/distributed_training_design.html">原生分布式并行架构</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../design/graph_fusion_engine.html">图算融合加速引擎</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../design/data_engine.html">高性能数据处理引擎</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../design/glossary.html">术语</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">模型库</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../official_models.html">官方模型库</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../api_python/mindspore.html">mindspore</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api_python/mindspore.nn.html">mindspore.nn</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api_python/mindspore.ops.html">mindspore.ops</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api_python/mindspore.ops.primitive.html">mindspore.ops.primitive</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api_python/mindspore.amp.html">mindspore.amp</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api_python/mindspore.train.html">mindspore.train</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api_python/mindspore.communication.html">mindspore.communication</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api_python/mindspore.common.initializer.html">mindspore.common.initializer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api_python/mindspore.dataset.html">mindspore.dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api_python/mindspore.dataset.transforms.html">mindspore.dataset.transforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api_python/mindspore.mindrecord.html">mindspore.mindrecord</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api_python/mindspore.nn.probability.html">mindspore.nn.probability</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api_python/mindspore.rewrite.html">mindspore.rewrite</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api_python/mindspore.boost.html">mindspore.boost</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api_python/mindspore.numpy.html">mindspore.numpy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api_python/mindspore.scipy.html">mindspore.scipy</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../api_python/mindspore.experimental.html">mindspore.experimental</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API映射</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../api_mapping/pytorch_api_mapping.html">PyTorch与MindSpore API映射表</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">迁移指南</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../migration_guide/overview.html">迁移指南概述</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../migration_guide/enveriment_preparation.html">环境准备与资料获取</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../migration_guide/analysis_and_preparation.html">模型分析与准备</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../migration_guide/typical_api_comparision.html">PyTorch对比</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../migration_guide/model_development/model_development.html">MindSpore网络搭建</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../migration_guide/debug_and_tune.html">调试调优</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../migration_guide/sample_code.html">网络迁移调试实例</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../migration_guide/migrator_with_tools.html">网络迁移工具应用实践指南</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../migration_guide/faq.html">常见问题</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">语法支持</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../static_graph_syntax_support.html">静态图语法支持</a></li>
<li class="toctree-l1"><a class="reference internal" href="operators.html">静态图语法-运算符</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">静态图语法-Python语句</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#简单语句">简单语句</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#raise语句">raise语句</a></li>
<li class="toctree-l3"><a class="reference internal" href="#assert语句">assert语句</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pass语句">pass语句</a></li>
<li class="toctree-l3"><a class="reference internal" href="#return语句">return语句</a></li>
<li class="toctree-l3"><a class="reference internal" href="#break语句">break语句</a></li>
<li class="toctree-l3"><a class="reference internal" href="#continue语句">continue语句</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#复合语句">复合语句</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#条件控制语句">条件控制语句</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#if语句">if语句</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#循环语句">循环语句</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#for语句">for语句</a></li>
<li class="toctree-l4"><a class="reference internal" href="#while语句">while语句</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#函数定义语句">函数定义语句</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#def关键字">def关键字</a></li>
<li class="toctree-l4"><a class="reference internal" href="#lambda表达式">lambda表达式</a></li>
<li class="toctree-l4"><a class="reference internal" href="#偏函数partial">偏函数partial</a></li>
<li class="toctree-l4"><a class="reference internal" href="#函数参数">函数参数</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#列表生成式和生成器表达式">列表生成式和生成器表达式</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#列表生成式">列表生成式</a></li>
<li class="toctree-l4"><a class="reference internal" href="#生成器表达式">生成器表达式</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#with语句">with语句</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="python_builtin_functions.html">静态图语法-Python内置函数</a></li>
<li class="toctree-l1"><a class="reference internal" href="../index_support.html">Tensor索引支持</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">环境变量</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../env_var_list.html">环境变量</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">FAQ</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../faq/installation.html">安装</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq/data_processing.html">数据处理</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq/implement_problem.html">执行问题</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq/network_compilation.html">网络编译</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq/operators_compile.html">算子编译</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq/usage_migrate_3rd.html">第三方框架迁移使用</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq/performance_tuning.html">性能调优</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq/precision_tuning.html">精度调优</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq/distributed_parallel.html">分布式并行</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq/inference.html">推理</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../faq/feature_advice.html">特性咨询</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">RELEASE NOTES</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../RELEASE.html">Release Notes</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">MindSpore</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>静态图语法-Python语句</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/note/static_graph_syntax/statements.md.txt" rel="nofollow"> 查看页面源码</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="静态图语法-python语句">
<h1>静态图语法-Python语句<a class="headerlink" href="#静态图语法-python语句" title="永久链接至标题"></a></h1>
<p><a class="reference external" href="https://gitee.com/mindspore/docs/blob/master/docs/mindspore/source_zh_cn/note/static_graph_syntax/statements.md"><img alt="查看源文件" src="https://mindspore-website.obs.cn-north-4.myhuaweicloud.com/website-images/master/resource/_static/logo_source.png" /></a></p>
<section id="简单语句">
<h2>简单语句<a class="headerlink" href="#简单语句" title="永久链接至标题"></a></h2>
<section id="raise语句">
<h3>raise语句<a class="headerlink" href="#raise语句" title="永久链接至标题"></a></h3>
<p>支持使用<code class="docutils literal notranslate"><span class="pre">raise</span></code>触发异常，<code class="docutils literal notranslate"><span class="pre">raise</span></code>语法格式：<code class="docutils literal notranslate"><span class="pre">raise[Exception</span> <span class="pre">[,</span> <span class="pre">args]]</span></code>。语句中的<code class="docutils literal notranslate"><span class="pre">Exception</span></code>是异常的类型，<code class="docutils literal notranslate"><span class="pre">args</span></code>是用户提供的异常参数，通常可以是字符串或者其他对象。目前支持的异常类型有：NoExceptionType、UnknownError、ArgumentError、NotSupportError、NotExistsError、DeviceProcessError、AbortedError、IndexError、ValueError、TypeError、KeyError、AttributeError、NameError、AssertionError、BaseException、KeyboardInterrupt、Exception、StopIteration、OverflowError、ZeroDivisionError、EnvironmentError、IOError、OSError、ImportError、MemoryError、UnboundLocalError、RuntimeError、NotImplementedError、IndentationError、RuntimeWarning。</p>
<p>例如：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mindspore.nn</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="kn">import</span> <span class="nn">mindspore</span> <span class="k">as</span> <span class="nn">ms</span>

<span class="k">class</span> <span class="nc">Net</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Cell</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Net</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">construct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">x</span> <span class="o">&lt;=</span> <span class="n">y</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="s2">&quot;x should be greater than y.&quot;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">x</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">x</span>

<span class="n">ms</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">GRAPH_MODE</span><span class="p">)</span>
<span class="n">net</span> <span class="o">=</span> <span class="n">Net</span><span class="p">()</span>
<span class="n">net</span><span class="p">(</span><span class="n">ms</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span><span class="p">),</span> <span class="n">ms</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
<p>输出结果:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>ValueError: x should be greater than y.
</pre></div>
</div>
</section>
<section id="assert语句">
<h3>assert语句<a class="headerlink" href="#assert语句" title="永久链接至标题"></a></h3>
<p>支持使用assert来做异常检查，<code class="docutils literal notranslate"><span class="pre">assert</span></code>语法格式：<code class="docutils literal notranslate"><span class="pre">assert[Expression</span> <span class="pre">[,</span> <span class="pre">args]]</span></code>。其中<code class="docutils literal notranslate"><span class="pre">Expression</span></code>是判断条件，如果条件为真，就不做任何事情；条件为假时，则将抛出<code class="docutils literal notranslate"><span class="pre">AssertError</span></code>类型的异常信息。<code class="docutils literal notranslate"><span class="pre">args</span></code>是用户提供的异常参数，通常可以是字符串或者其他对象。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mindspore.nn</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="kn">import</span> <span class="nn">mindspore</span> <span class="k">as</span> <span class="nn">ms</span>

<span class="k">class</span> <span class="nc">Net</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Cell</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Net</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">construct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">assert</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">x</span>

<span class="n">ms</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">GRAPH_MODE</span><span class="p">)</span>
<span class="n">net</span> <span class="o">=</span> <span class="n">Net</span><span class="p">()</span>
<span class="n">net</span><span class="p">(</span><span class="n">ms</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">))</span>
</pre></div>
</div>
<p>输出结果中正常出现:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>AssertionError.
</pre></div>
</div>
</section>
<section id="pass语句">
<h3>pass语句<a class="headerlink" href="#pass语句" title="永久链接至标题"></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">pass</span></code>语句不做任何事情，通常用于占位，保持结构的完整性。例如：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mindspore</span> <span class="k">as</span> <span class="nn">ms</span>
<span class="kn">from</span> <span class="nn">mindspore</span> <span class="kn">import</span> <span class="n">nn</span><span class="p">,</span> <span class="n">set_context</span>

<span class="n">set_context</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">GRAPH_MODE</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Net</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Cell</span><span class="p">):</span>
  <span class="k">def</span> <span class="nf">construct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">while</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="mi">5</span><span class="p">:</span>
      <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">3</span><span class="p">:</span>
        <span class="k">pass</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">*</span> <span class="mf">1.5</span>
      <span class="n">i</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="k">return</span> <span class="n">x</span>

<span class="n">net</span> <span class="o">=</span> <span class="n">Net</span><span class="p">()</span>
<span class="n">ret</span> <span class="o">=</span> <span class="n">net</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ret:&quot;</span><span class="p">,</span> <span class="n">ret</span><span class="p">)</span>
</pre></div>
</div>
<p>结果如下：</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>ret: 50.625
</pre></div>
</div>
</section>
<section id="return语句">
<h3>return语句<a class="headerlink" href="#return语句" title="永久链接至标题"></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">return</span></code>语句通常是将结果返回调用的地方，<code class="docutils literal notranslate"><span class="pre">return</span></code>语句之后的语句不被执行。如果返回语句没有任何表达式或者函数没有<code class="docutils literal notranslate"><span class="pre">return</span></code>语句，则默认返回一个<code class="docutils literal notranslate"><span class="pre">None</span></code>对象。一个函数体内可以根据不同的情况有多个<code class="docutils literal notranslate"><span class="pre">return</span></code>语句。例如：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mindspore</span> <span class="k">as</span> <span class="nn">ms</span>
<span class="kn">from</span> <span class="nn">mindspore</span> <span class="kn">import</span> <span class="n">nn</span><span class="p">,</span> <span class="n">set_context</span>

<span class="n">set_context</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">GRAPH_MODE</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Net</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Cell</span><span class="p">):</span>
  <span class="k">def</span> <span class="nf">construct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
      <span class="k">if</span> <span class="n">x</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">x</span>
      <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">0</span>

<span class="n">net</span> <span class="o">=</span> <span class="n">Net</span><span class="p">()</span>
<span class="n">ret</span> <span class="o">=</span> <span class="n">net</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ret:&quot;</span><span class="p">,</span> <span class="n">ret</span><span class="p">)</span>
</pre></div>
</div>
<p>输出结果:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>ret: 10
</pre></div>
</div>
<p>如上，在控制流场景语句中，可以有多个<code class="docutils literal notranslate"><span class="pre">return</span></code>语句。如果一个函数中没有<code class="docutils literal notranslate"><span class="pre">return</span></code>语句，则默认返回None对象，如下用例：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mindspore</span> <span class="kn">import</span> <span class="n">jit</span><span class="p">,</span> <span class="n">context</span>

<span class="n">context</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="n">context</span><span class="o">.</span><span class="n">GRAPH_MODE</span><span class="p">)</span>

<span class="nd">@jit</span>
<span class="k">def</span> <span class="nf">foo</span><span class="p">():</span>
  <span class="n">x</span> <span class="o">=</span> <span class="mi">3</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;x:&quot;</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>

<span class="n">res</span> <span class="o">=</span> <span class="n">foo</span><span class="p">()</span>
<span class="k">assert</span> <span class="n">res</span> <span class="ow">is</span> <span class="kc">None</span>
</pre></div>
</div>
</section>
<section id="break语句">
<h3>break语句<a class="headerlink" href="#break语句" title="永久链接至标题"></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">break</span></code>语句用来终止循环语句，即循环条件没有<code class="docutils literal notranslate"><span class="pre">False</span></code>条件或者序列还没完全递归完时，也会停止执行循环语句，通常用在<code class="docutils literal notranslate"><span class="pre">while</span></code>和<code class="docutils literal notranslate"><span class="pre">for</span></code>循环中。在嵌套循环中，<code class="docutils literal notranslate"><span class="pre">break</span></code>语句将停止执行最内层的循环。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mindspore</span> <span class="k">as</span> <span class="nn">ms</span>
<span class="kn">from</span> <span class="nn">mindspore</span> <span class="kn">import</span> <span class="n">nn</span><span class="p">,</span> <span class="n">set_context</span>

<span class="n">set_context</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">GRAPH_MODE</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Net</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Cell</span><span class="p">):</span>
  <span class="k">def</span> <span class="nf">construct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">8</span><span class="p">):</span>
      <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">5</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">*=</span> <span class="mi">3</span>
        <span class="k">break</span>
      <span class="n">x</span> <span class="o">=</span> <span class="n">x</span> <span class="o">*</span> <span class="mi">2</span>
    <span class="k">return</span> <span class="n">x</span>

<span class="n">net</span> <span class="o">=</span> <span class="n">Net</span><span class="p">()</span>
<span class="n">ret</span> <span class="o">=</span> <span class="n">net</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ret:&quot;</span><span class="p">,</span> <span class="n">ret</span><span class="p">)</span>
</pre></div>
</div>
<p>得到结果：</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>ret: 1920
</pre></div>
</div>
</section>
<section id="continue语句">
<h3>continue语句<a class="headerlink" href="#continue语句" title="永久链接至标题"></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">continue</span></code>语句用来跳出当前的循环语句，进入下一轮的循环。与<code class="docutils literal notranslate"><span class="pre">break</span></code>语句有所不同，<code class="docutils literal notranslate"><span class="pre">break</span></code>语句用来终止整个循环语句。<code class="docutils literal notranslate"><span class="pre">continue</span></code>也用在<code class="docutils literal notranslate"><span class="pre">while</span></code>和<code class="docutils literal notranslate"><span class="pre">for</span></code>循环中。例如：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mindspore</span> <span class="k">as</span> <span class="nn">ms</span>
<span class="kn">from</span> <span class="nn">mindspore</span> <span class="kn">import</span> <span class="n">nn</span><span class="p">,</span> <span class="n">set_context</span>

<span class="n">set_context</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">GRAPH_MODE</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Net</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Cell</span><span class="p">):</span>
  <span class="k">def</span> <span class="nf">construct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">4</span><span class="p">):</span>
      <span class="k">if</span> <span class="n">i</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">*=</span> <span class="mi">3</span>
        <span class="k">continue</span>
    <span class="k">return</span> <span class="n">x</span>


<span class="n">net</span> <span class="o">=</span> <span class="n">Net</span><span class="p">()</span>
<span class="n">ret</span> <span class="o">=</span> <span class="n">net</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ret:&quot;</span><span class="p">,</span> <span class="n">ret</span><span class="p">)</span>
</pre></div>
</div>
<p>得到结果：</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>ret: 9
</pre></div>
</div>
</section>
</section>
<section id="复合语句">
<h2>复合语句<a class="headerlink" href="#复合语句" title="永久链接至标题"></a></h2>
<section id="条件控制语句">
<h3>条件控制语句<a class="headerlink" href="#条件控制语句" title="永久链接至标题"></a></h3>
<section id="if语句">
<h4>if语句<a class="headerlink" href="#if语句" title="永久链接至标题"></a></h4>
<p>使用方式：</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">if</span> <span class="pre">(cond):</span> <span class="pre">statements...</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">x</span> <span class="pre">=</span> <span class="pre">y</span> <span class="pre">if</span> <span class="pre">(cond)</span> <span class="pre">else</span> <span class="pre">z</span></code></p></li>
</ul>
<p>参数：<code class="docutils literal notranslate"><span class="pre">cond</span></code> – 支持<code class="docutils literal notranslate"><span class="pre">Bool</span></code>类型的变量，也支持类型为<code class="docutils literal notranslate"><span class="pre">Number</span></code>、<code class="docutils literal notranslate"><span class="pre">List</span></code>、<code class="docutils literal notranslate"><span class="pre">Tuple</span></code>、<code class="docutils literal notranslate"><span class="pre">Dict</span></code>、<code class="docutils literal notranslate"><span class="pre">String</span></code>类型的常量以及<code class="docutils literal notranslate"><span class="pre">None</span></code>对象。</p>
<p>限制：</p>
<ul class="simple">
<li><p>如果<code class="docutils literal notranslate"><span class="pre">cond</span></code>不为常量，在不同分支中同一符号被赋予的变量或者常量的数据类型应一致，如果是被赋予变量或者常量数据类型是<code class="docutils literal notranslate"><span class="pre">Tensor</span></code>，则要求<code class="docutils literal notranslate"><span class="pre">Tensor</span></code>的type和shape也应一致。</p></li>
</ul>
<p>示例1：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mindspore</span> <span class="k">as</span> <span class="nn">ms</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">ms</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">ms</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="n">m</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">2</span>

<span class="nd">@ms</span><span class="o">.</span><span class="n">jit</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">test_if_cond</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">&gt;</span> <span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
        <span class="k">return</span> <span class="n">m</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">n</span>

<span class="n">ret</span> <span class="o">=</span> <span class="n">test_if_cond</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ret:</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ret</span><span class="p">))</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">if</span></code>分支返回的<code class="docutils literal notranslate"><span class="pre">m</span></code>和<code class="docutils literal notranslate"><span class="pre">else</span></code>分支返回的<code class="docutils literal notranslate"><span class="pre">n</span></code>，二者数据类型必须一致。</p>
<p>结果如下:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>ret:1
</pre></div>
</div>
<p>示例2：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mindspore</span> <span class="k">as</span> <span class="nn">ms</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">ms</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">ms</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="n">m</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">2</span>

<span class="nd">@ms</span><span class="o">.</span><span class="n">jit</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">test_if_cond</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="n">out</span> <span class="o">=</span> <span class="mi">3</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">&gt;</span> <span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">m</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">n</span>
    <span class="k">return</span> <span class="n">out</span>

<span class="n">ret</span> <span class="o">=</span> <span class="n">test_if_cond</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ret:</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ret</span><span class="p">))</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">if</span></code>分支中<code class="docutils literal notranslate"><span class="pre">out</span></code>被赋值的变量或者常量<code class="docutils literal notranslate"><span class="pre">m</span></code>与<code class="docutils literal notranslate"><span class="pre">else</span></code>分支中<code class="docutils literal notranslate"><span class="pre">out</span></code>被赋值的变量或者常量<code class="docutils literal notranslate"><span class="pre">n</span></code>的数据类型必须一致。</p>
<p>结果如下:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>ret:1
</pre></div>
</div>
<p>示例3：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mindspore</span> <span class="k">as</span> <span class="nn">ms</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">ms</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">ms</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="n">m</span> <span class="o">=</span> <span class="mi">1</span>

<span class="nd">@ms</span><span class="o">.</span><span class="n">jit</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">test_if_cond</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="n">out</span> <span class="o">=</span> <span class="mi">2</span>
    <span class="k">if</span> <span class="p">(</span><span class="n">x</span> <span class="o">&gt;</span> <span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">any</span><span class="p">():</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">m</span>
    <span class="k">return</span> <span class="n">out</span>

<span class="n">ret</span> <span class="o">=</span> <span class="n">test_if_cond</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ret:</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ret</span><span class="p">))</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">if</span></code>分支中<code class="docutils literal notranslate"><span class="pre">out</span></code>被赋值的变量或者常量<code class="docutils literal notranslate"><span class="pre">m</span></code>与<code class="docutils literal notranslate"><span class="pre">out</span></code>初始赋值的数据类型必须一致。</p>
<p>结果如下:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>ret:1
</pre></div>
</div>
</section>
</section>
<section id="循环语句">
<h3>循环语句<a class="headerlink" href="#循环语句" title="永久链接至标题"></a></h3>
<section id="for语句">
<h4>for语句<a class="headerlink" href="#for语句" title="永久链接至标题"></a></h4>
<p>使用方式：</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">for</span> <span class="pre">i</span> <span class="pre">in</span> <span class="pre">sequence</span>&#160; <span class="pre">statements...</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">for</span> <span class="pre">i</span> <span class="pre">in</span> <span class="pre">sequence</span>&#160; <span class="pre">statements...</span> <span class="pre">if</span> <span class="pre">(cond)</span> <span class="pre">break</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">for</span> <span class="pre">i</span> <span class="pre">in</span> <span class="pre">sequence</span>&#160; <span class="pre">statements...</span> <span class="pre">if</span> <span class="pre">(cond)</span> <span class="pre">continue</span></code></p></li>
</ul>
<p>参数：<code class="docutils literal notranslate"><span class="pre">sequence</span></code> – 遍历序列(<code class="docutils literal notranslate"><span class="pre">Tuple</span></code>、<code class="docutils literal notranslate"><span class="pre">List</span></code>、<code class="docutils literal notranslate"><span class="pre">range</span></code>等)</p>
<p>限制：</p>
<ul class="simple">
<li><p>图的算子数量和<code class="docutils literal notranslate"><span class="pre">for</span></code>循环的迭代次数成倍数关系，<code class="docutils literal notranslate"><span class="pre">for</span></code>循环迭代次数过大可能会导致图占用内存超过使用限制。</p></li>
<li><p>不支持<code class="docutils literal notranslate"><span class="pre">for...else...</span></code>语句。</p></li>
</ul>
<p>示例：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">mindspore</span> <span class="k">as</span> <span class="nn">ms</span>

<span class="n">z</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)))</span>

<span class="nd">@ms</span><span class="o">.</span><span class="n">jit</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">test_cond</span><span class="p">():</span>
    <span class="n">x</span> <span class="o">=</span> <span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">x</span><span class="p">:</span>
        <span class="n">z</span> <span class="o">+=</span> <span class="n">i</span>
    <span class="k">return</span> <span class="n">z</span>

<span class="n">ret</span> <span class="o">=</span> <span class="n">test_cond</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ret:</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ret</span><span class="p">))</span>
</pre></div>
</div>
<p>结果如下：</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>ret:[[7. 7. 7.]
 [7. 7. 7.]]
</pre></div>
</div>
</section>
<section id="while语句">
<h4>while语句<a class="headerlink" href="#while语句" title="永久链接至标题"></a></h4>
<p>使用方式：</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">while</span> <span class="pre">(cond)</span>&#160; <span class="pre">statements...</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">while</span> <span class="pre">(cond)</span>&#160; <span class="pre">statements...</span> <span class="pre">if</span> <span class="pre">(cond1)</span> <span class="pre">break</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">while</span> <span class="pre">(cond)</span>&#160; <span class="pre">statements...</span> <span class="pre">if</span> <span class="pre">(cond1)</span> <span class="pre">continue</span></code></p></li>
</ul>
<p>参数：<code class="docutils literal notranslate"><span class="pre">cond</span></code> – 支持<code class="docutils literal notranslate"><span class="pre">Bool</span></code>类型的变量，也支持类型为<code class="docutils literal notranslate"><span class="pre">Number</span></code>、<code class="docutils literal notranslate"><span class="pre">List</span></code>、<code class="docutils literal notranslate"><span class="pre">Tuple</span></code>、<code class="docutils literal notranslate"><span class="pre">Dict</span></code>、<code class="docutils literal notranslate"><span class="pre">String</span></code>类型的常量以及<code class="docutils literal notranslate"><span class="pre">None</span></code>对象。</p>
<p>限制：</p>
<ul class="simple">
<li><p>如果<code class="docutils literal notranslate"><span class="pre">cond</span></code>不为常量，在循环体内外同一符号被赋值的变量或者常量的数据类型应一致，如果是被赋予数据类型<code class="docutils literal notranslate"><span class="pre">Tensor</span></code>，则要求<code class="docutils literal notranslate"><span class="pre">Tensor</span></code>的type和shape也应一致。</p></li>
<li><p>不支持<code class="docutils literal notranslate"><span class="pre">while...else...</span></code>语句。</p></li>
</ul>
<p>示例1：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mindspore</span> <span class="k">as</span> <span class="nn">ms</span>

<span class="n">m</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">2</span>

<span class="nd">@ms</span><span class="o">.</span><span class="n">jit</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">test_cond</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">while</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">y</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">return</span> <span class="n">m</span>
    <span class="k">return</span> <span class="n">n</span>

<span class="n">ret</span> <span class="o">=</span> <span class="n">test_cond</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ret:</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ret</span><span class="p">))</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">while</span></code>循环内返回的<code class="docutils literal notranslate"><span class="pre">m</span></code>和<code class="docutils literal notranslate"><span class="pre">while</span></code>外返回的<code class="docutils literal notranslate"><span class="pre">n</span></code>数据类型必须一致。</p>
<p>结果如下：</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>ret:1
</pre></div>
</div>
<p>示例2：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mindspore</span> <span class="k">as</span> <span class="nn">ms</span>

<span class="n">m</span> <span class="o">=</span> <span class="mi">1</span>
<span class="n">n</span> <span class="o">=</span> <span class="mi">2</span>

<span class="k">def</span> <span class="nf">ops1</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">+</span> <span class="n">b</span>

<span class="nd">@ms</span><span class="o">.</span><span class="n">jit</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">test_cond</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="n">out</span> <span class="o">=</span> <span class="n">m</span>
    <span class="k">while</span> <span class="n">x</span> <span class="o">&lt;</span> <span class="n">y</span><span class="p">:</span>
        <span class="n">x</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">ops1</span><span class="p">(</span><span class="n">out</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">out</span>

<span class="n">ret</span> <span class="o">=</span> <span class="n">test_cond</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ret:</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ret</span><span class="p">))</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">while</span></code>内，<code class="docutils literal notranslate"><span class="pre">out</span></code>在循环体内被赋值的变量<code class="docutils literal notranslate"><span class="pre">op1</span></code>的输出类型和初始类型<code class="docutils literal notranslate"><span class="pre">m</span></code>必须一致。</p>
<p>结果如下：</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>ret:15
</pre></div>
</div>
</section>
</section>
<section id="函数定义语句">
<h3>函数定义语句<a class="headerlink" href="#函数定义语句" title="永久链接至标题"></a></h3>
<section id="def关键字">
<h4>def关键字<a class="headerlink" href="#def关键字" title="永久链接至标题"></a></h4>
<p><code class="docutils literal notranslate"><span class="pre">def</span></code>用于定义函数，后接函数标识符名称和原括号<code class="docutils literal notranslate"><span class="pre">()</span></code>，括号中可以包含函数的参数。
使用方式：<code class="docutils literal notranslate"><span class="pre">def</span> <span class="pre">function_name(args):</span> <span class="pre">statements...</span></code>。</p>
<p>示例如下：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mindspore</span> <span class="k">as</span> <span class="nn">ms</span>

<span class="k">def</span> <span class="nf">number_add</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>

<span class="nd">@ms</span><span class="o">.</span><span class="n">jit</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">test</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">number_add</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="n">ret</span> <span class="o">=</span> <span class="n">test</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ret:</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ret</span><span class="p">))</span>
</pre></div>
</div>
<p>结果如下：</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>ret:6
</pre></div>
</div>
<p>说明：</p>
<ul class="simple">
<li><p>函数可以支持不写返回值，不写返回值默认函数的返回值为None。</p></li>
<li><p>支持最外层网络模型的<code class="docutils literal notranslate"><span class="pre">construct</span></code>函数和内层网络函数输入kwargs，即支持 <code class="docutils literal notranslate"><span class="pre">def</span> <span class="pre">construct(**kwargs):</span></code>。</p></li>
<li><p>支持变参和非变参的混合使用，即支持 <code class="docutils literal notranslate"><span class="pre">def</span> <span class="pre">function(x,</span> <span class="pre">y,</span> <span class="pre">*args):</span></code>和 <code class="docutils literal notranslate"><span class="pre">def</span> <span class="pre">function(x</span> <span class="pre">=</span> <span class="pre">1,</span> <span class="pre">y</span> <span class="pre">=</span> <span class="pre">1,</span> <span class="pre">**kwargs):</span></code>。</p></li>
</ul>
</section>
<section id="lambda表达式">
<h4>lambda表达式<a class="headerlink" href="#lambda表达式" title="永久链接至标题"></a></h4>
<p><code class="docutils literal notranslate"><span class="pre">lambda</span></code>表达式用于生成匿名函数。与普通函数不同，它只计算并返回一个表达式。使用方式：<code class="docutils literal notranslate"><span class="pre">lambda</span> <span class="pre">x,</span> <span class="pre">y:</span> <span class="pre">x</span> <span class="pre">+</span> <span class="pre">y</span></code>。</p>
<p>示例如下：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mindspore</span> <span class="k">as</span> <span class="nn">ms</span>

<span class="nd">@ms</span><span class="o">.</span><span class="n">jit</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">test</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="n">number_add</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">:</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
    <span class="k">return</span> <span class="n">number_add</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

<span class="n">ret</span> <span class="o">=</span> <span class="n">test</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ret:</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ret</span><span class="p">))</span>
</pre></div>
</div>
<p>结果如下：</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>ret:6
</pre></div>
</div>
</section>
<section id="偏函数partial">
<h4>偏函数partial<a class="headerlink" href="#偏函数partial" title="永久链接至标题"></a></h4>
<p>功能：偏函数，固定函数入参。使用方式：<code class="docutils literal notranslate"><span class="pre">partial(func,</span> <span class="pre">arg,</span> <span class="pre">...)</span></code>。</p>
<p>入参：</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">func</span></code> – 函数。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">arg</span></code> – 一个或多个要固定的参数，支持位置参数和键值对传参。</p></li>
</ul>
<p>返回值：返回某些入参固定了值的函数。</p>
<p>示例如下：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mindspore</span> <span class="k">as</span> <span class="nn">ms</span>
<span class="kn">from</span> <span class="nn">mindspore</span> <span class="kn">import</span> <span class="n">ops</span>

<span class="k">def</span> <span class="nf">add</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>

<span class="nd">@ms</span><span class="o">.</span><span class="n">jit</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">test</span><span class="p">():</span>
    <span class="n">add_</span> <span class="o">=</span> <span class="n">ops</span><span class="o">.</span><span class="n">partial</span><span class="p">(</span><span class="n">add</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
    <span class="n">m</span> <span class="o">=</span> <span class="n">add_</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
    <span class="n">n</span> <span class="o">=</span> <span class="n">add_</span><span class="p">(</span><span class="n">y</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">m</span><span class="p">,</span> <span class="n">n</span>

<span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">test</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;m:</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">m</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;n:</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n</span><span class="p">))</span>
</pre></div>
</div>
<p>结果如下：</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>m:5
n:7
</pre></div>
</div>
</section>
<section id="函数参数">
<h4>函数参数<a class="headerlink" href="#函数参数" title="永久链接至标题"></a></h4>
<ul class="simple">
<li><p>参数默认值：目前不支持默认值设为<code class="docutils literal notranslate"><span class="pre">Tensor</span></code>类型数据，支持<code class="docutils literal notranslate"><span class="pre">int</span></code>、<code class="docutils literal notranslate"><span class="pre">float</span></code>、<code class="docutils literal notranslate"><span class="pre">bool</span></code>、<code class="docutils literal notranslate"><span class="pre">None</span></code>、<code class="docutils literal notranslate"><span class="pre">str</span></code>、<code class="docutils literal notranslate"><span class="pre">tuple</span></code>、<code class="docutils literal notranslate"><span class="pre">list</span></code>、<code class="docutils literal notranslate"><span class="pre">dict</span></code>类型数据。</p></li>
<li><p>可变参数：支持带可变参数网络的推理和训练。</p></li>
<li><p>键值对参数：目前不支持带键值对参数的函数求反向。</p></li>
<li><p>可变键值对参数：目前不支持带可变键值对的函数求反向。</p></li>
</ul>
</section>
</section>
<section id="列表生成式和生成器表达式">
<h3>列表生成式和生成器表达式<a class="headerlink" href="#列表生成式和生成器表达式" title="永久链接至标题"></a></h3>
<p>支持列表生成式（List Comprehension）和生成器表达式（Generator Expression）。支持构建一个新的序列。</p>
<section id="列表生成式">
<h4>列表生成式<a class="headerlink" href="#列表生成式" title="永久链接至标题"></a></h4>
<p>列表生成式用于生成列表。使用方式：<code class="docutils literal notranslate"><span class="pre">[arg</span> <span class="pre">for</span> <span class="pre">loop</span> <span class="pre">if</span> <span class="pre">statements]</span></code>。</p>
<p>示例如下：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mindspore</span> <span class="k">as</span> <span class="nn">ms</span>

<span class="nd">@ms</span><span class="o">.</span><span class="n">jit</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">test</span><span class="p">():</span>
    <span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="n">x</span> <span class="o">*</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">l</span>

<span class="n">ret</span> <span class="o">=</span> <span class="n">test</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ret:</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ret</span><span class="p">))</span>
</pre></div>
</div>
<p>结果如下：</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>ret:[4, 16, 36, 64, 100]
</pre></div>
</div>
<p>限制：</p>
<p>图模式下不支持多层嵌套迭代器的使用方式。</p>
<p>限制用法示例如下（使用了两层迭代器）：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">l</span> <span class="o">=</span> <span class="p">[</span><span class="n">y</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">))</span> <span class="k">for</span> <span class="n">y</span> <span class="ow">in</span> <span class="n">x</span><span class="p">]</span>
</pre></div>
</div>
<p>会提示错误：</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>TypeError:  The `generators` supports one `comprehension` in ListComp/GeneratorExp, but got 2 comprehensions.
</pre></div>
</div>
</section>
<section id="生成器表达式">
<h4>生成器表达式<a class="headerlink" href="#生成器表达式" title="永久链接至标题"></a></h4>
<p>生成器表达式用于生成列表。使用方式：<code class="docutils literal notranslate"><span class="pre">(arg</span> <span class="pre">for</span> <span class="pre">loop</span> <span class="pre">if</span> <span class="pre">statements)</span></code>。</p>
<p>示例如下：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mindspore</span> <span class="k">as</span> <span class="nn">ms</span>

<span class="nd">@ms</span><span class="o">.</span><span class="n">jit</span><span class="p">()</span>
<span class="k">def</span> <span class="nf">test</span><span class="p">():</span>
    <span class="n">l</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="n">x</span> <span class="k">for</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">11</span><span class="p">)</span> <span class="k">if</span> <span class="n">x</span> <span class="o">%</span> <span class="mi">2</span> <span class="o">==</span> <span class="mi">0</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">l</span>

<span class="n">ret</span> <span class="o">=</span> <span class="n">test</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;ret:</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">ret</span><span class="p">))</span>
</pre></div>
</div>
<p>结果如下：</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>ret:[4, 16, 36, 64, 100]
</pre></div>
</div>
<p>使用限制同列表生成式。即：图模式下不支持多层嵌套迭代器的使用方式。</p>
</section>
</section>
<section id="with语句">
<h3>with语句<a class="headerlink" href="#with语句" title="永久链接至标题"></a></h3>
<p>在图模式下，有限制地支持<code class="docutils literal notranslate"><span class="pre">with</span></code>语句。<code class="docutils literal notranslate"><span class="pre">with</span></code>语句要求对象必须有两个魔术方法：<code class="docutils literal notranslate"><span class="pre">__enter__()</span></code>和<code class="docutils literal notranslate"><span class="pre">__exit__()</span></code>。</p>
<p>示例如下：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mindspore</span> <span class="k">as</span> <span class="nn">ms</span>
<span class="kn">import</span> <span class="nn">mindspore.nn</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="kn">from</span> <span class="nn">mindspore</span> <span class="kn">import</span> <span class="n">set_context</span>

<span class="n">set_context</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">GRAPH_MODE</span><span class="p">)</span>

<span class="nd">@ms</span><span class="o">.</span><span class="n">jit_class</span>
<span class="k">class</span> <span class="nc">Sample</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Sample</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">num</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([</span><span class="mi">2</span><span class="p">])</span>

    <span class="k">def</span> <span class="fm">__enter__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">num</span> <span class="o">*</span> <span class="mi">2</span>

    <span class="k">def</span> <span class="fm">__exit__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">exc_type</span><span class="p">,</span> <span class="n">exc_value</span><span class="p">,</span> <span class="n">traceback</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">num</span> <span class="o">*</span> <span class="mi">4</span>

<span class="k">class</span> <span class="nc">TestNet</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Cell</span><span class="p">):</span>
    <span class="k">def</span> <span class="nf">construct</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="n">res</span> <span class="o">=</span> <span class="mi">1</span>
        <span class="n">obj</span> <span class="o">=</span> <span class="n">Sample</span><span class="p">()</span>
        <span class="k">with</span> <span class="n">obj</span> <span class="k">as</span> <span class="n">sample</span><span class="p">:</span>
            <span class="n">res</span> <span class="o">+=</span> <span class="n">sample</span>
        <span class="k">return</span> <span class="n">res</span><span class="p">,</span> <span class="n">obj</span><span class="o">.</span><span class="n">num</span>

<span class="n">test_net</span> <span class="o">=</span> <span class="n">TestNet</span><span class="p">()</span>
<span class="n">out1</span><span class="p">,</span> <span class="n">out2</span> <span class="o">=</span> <span class="n">test_net</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;out1:&quot;</span><span class="p">,</span> <span class="n">out1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;out2:&quot;</span><span class="p">,</span> <span class="n">out2</span><span class="p">)</span>
</pre></div>
</div>
<p>结果如下：</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>out1: [5]
out2: [2]
</pre></div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="operators.html" class="btn btn-neutral float-left" title="静态图语法-运算符" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> 上一页</a>
        <a href="python_builtin_functions.html" class="btn btn-neutral float-right" title="静态图语法-Python内置函数" accesskey="n" rel="next">下一页 <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; 版权所有 2022, MindSpore.</p>
  </div>

  利用 <a href="https://www.sphinx-doc.org/">Sphinx</a> 构建，使用了 
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">主题</a>
    由 <a href="https://readthedocs.org">Read the Docs</a>开发.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 
</body>
</html>