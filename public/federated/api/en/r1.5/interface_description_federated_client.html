<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Examples &mdash; MindSpore Federated master documentation</title><link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="SyncFLJob" href="java_api_syncfljob.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> MindSpore Federated
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="federated_server.html">Federated-Server</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="federated_client.html">Federated-Client</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="java_api_flparameter.html">FLParameter</a></li>
<li class="toctree-l2"><a class="reference internal" href="java_api_syncfljob.html">SyncFLJob</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Examples</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#fljobrun-for-starting-federated-learning">flJobRun() for Starting Federated Learning</a></li>
<li class="toctree-l3"><a class="reference internal" href="#modelinference-for-inferring-multiple-input-data-records">modelInference() for Inferring Multiple Input Data Records</a></li>
<li class="toctree-l3"><a class="reference internal" href="#getmodel-for-obtaining-the-latest-model-on-the-cloud">getModel() for Obtaining the Latest Model on the Cloud</a></li>
</ul>
</li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">MindSpore Federated</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="federated_client.html">Federated-Client</a> &raquo;</li>
      <li>Examples</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/interface_description_federated_client.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="examples">
<h1>Examples<a class="headerlink" href="#examples" title="Permalink to this headline"></a></h1>
<p><a href="https://gitee.com/mindspore/docs/blob/r1.5/docs/federated/api/source_en/interface_description_federated_client.md" target="_blank"><img src="https://gitee.com/mindspore/docs/raw/r1.5/resource/_static/logo_source_en.png"></a></p>
<p>Note that before using the following interfaces, you can first refer to the document <a class="reference external" href="https://www.mindspore.cn/federated/docs/en/r1.5/deploy_federated_client.html">on-device deployment</a> to deploy related environments.</p>
<section id="fljobrun-for-starting-federated-learning">
<h2>flJobRun() for Starting Federated Learning<a class="headerlink" href="#fljobrun-for-starting-federated-learning" title="Permalink to this headline"></a></h2>
<p>Before calling the flJobRun() API, instantiate the parameter class FLParameter and set related parameters as follows:</p>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Mandatory</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Remarks</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>trainDataset</p></td>
<td><p>String</p></td>
<td><p>Y</p></td>
<td><p>Path of the training dataset.</p></td>
<td><p>The training data of a sentiment classification task is in .txt format. The training files data.bin and label.bin in the image classification task are combined by commas (,).</p></td>
</tr>
<tr class="row-odd"><td><p>vocabFile</p></td>
<td><p>String</p></td>
<td><p>Y</p></td>
<td><p>Path of the dictionary file for data preprocessing.</p></td>
<td><p>This parameter is mandatory for sentiment classification tasks. This parameter does not need to be set for image classification tasks, and the default value is null.</p></td>
</tr>
<tr class="row-even"><td><p>idsFile</p></td>
<td><p>String</p></td>
<td><p>Y</p></td>
<td><p>Path of the mapping ID file of a dictionary.</p></td>
<td><p>This parameter is mandatory for sentiment classification tasks. This parameter does not need to be set for image classification tasks, and the default value is null.</p></td>
</tr>
<tr class="row-odd"><td><p>testDataset</p></td>
<td><p>String</p></td>
<td><p>N</p></td>
<td><p>Path of the test dataset.</p></td>
<td><p>1. For image classification tasks, this parameter does not need to be set and the default value is null. For sentiment classification tasks, if this parameter is not set, verification is not performed during training.<br />2. The test data of a sentiment classification task is in .txt format. The test files data.bin and label.bin in the image classification task are combined by commas (,).</p></td>
</tr>
<tr class="row-even"><td><p>flName</p></td>
<td><p>String</p></td>
<td><p>Y</p></td>
<td><p>Name of the model used for federated learning.</p></td>
<td><p>Set this parameter to <code class="docutils literal notranslate"><span class="pre">albert</span></code> for sentiment classification tasks or <code class="docutils literal notranslate"><span class="pre">lenet</span></code> for the LeNet scenario.</p></td>
</tr>
<tr class="row-odd"><td><p>trainModelPath</p></td>
<td><p>String</p></td>
<td><p>Y</p></td>
<td><p>Path of a training model used for federated learning, which is an absolute path of the .ms file.</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>inferModelPath</p></td>
<td><p>String</p></td>
<td><p>Y</p></td>
<td><p>Path of an inference model used for federated learning, which is an absolute path of the .ms file.</p></td>
<td><p>The value of this parameter need to be the same as that of trainModelPath for supervised sentiment classification tasks and image classification tasks.</p></td>
</tr>
<tr class="row-odd"><td><p>useSSL</p></td>
<td><p>Boolean</p></td>
<td><p>N</p></td>
<td><p>Whether to perform SSL certificate authentication (which applies only to the HTTPS communication scenario) for device-cloud communication.</p></td>
<td><p>The value false indicates that SSL certificate authentication is not performed. The value true indicates that SSL certificate authentication is performed. The default value is false.</p></td>
</tr>
<tr class="row-even"><td><p>certPath</p></td>
<td><p>String</p></td>
<td><p>N</p></td>
<td><p>the SSL root certificate path used for device-cloud https communication.</p></td>
<td><p>This parameter must be set when the device-cloud is performing https communication and <code class="docutils literal notranslate"><span class="pre">useSSL</span></code> is set to true.</p></td>
</tr>
<tr class="row-odd"><td><p>domainName</p></td>
<td><p>String</p></td>
<td><p>Y</p></td>
<td><p>the url for device-cloud communication.</p></td>
<td><p>Currently, https and http communication are supported, the corresponding formats are like: https://……, http://……, and when <code class="docutils literal notranslate"><span class="pre">useElb</span></code> is set to true, the format must be: https://127.0.0.0 : 6666 or http://127.0.0.0 : 6666 , where <code class="docutils literal notranslate"><span class="pre">127.0.0.0</span></code> corresponds to the ip of the machine providing cloud-side services (corresponding to the cloud-side parameter <code class="docutils literal notranslate"><span class="pre">--scheduler_ip</span></code>), and <code class="docutils literal notranslate"><span class="pre">6666</span></code> corresponds to the cloud-side parameter <code class="docutils literal notranslate"><span class="pre">--fl_server_port</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p>ifUseElb</p></td>
<td><p>Boolean</p></td>
<td><p>Y</p></td>
<td><p>Whether to simulate the elastic load balancing. The value true indicates that the client sends requests to a random server address within a specified range. The value false indicates that the client sends a request to a fixed server address.</p></td>
<td><p>The default value is false.</p></td>
</tr>
<tr class="row-odd"><td><p>serverNum</p></td>
<td><p>Integer</p></td>
<td><p>Y</p></td>
<td><p>Number of servers that can send requests during elastic load balancing simulation.</p></td>
<td><p>It can be the same as the number of servers started on the cloud when set <code class="docutils literal notranslate"><span class="pre">ifUseElb</span></code> to true, the default value is 1.</p></td>
</tr>
</tbody>
</table>
<p>When <code class="docutils literal notranslate"><span class="pre">useSSL</span></code> is set to <code class="docutils literal notranslate"><span class="pre">true</span></code>, only HTTPS communication is supported. In addition, the following parameters need to be set:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">FLParameter</span><span class="w"> </span><span class="n">flParameter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FLParameter</span><span class="p">.</span><span class="na">getInstance</span><span class="p">();</span>
<span class="n">String</span><span class="w"> </span><span class="n">certPath</span><span class="w">  </span><span class="o">=</span><span class="w">  </span><span class="s">&quot;client.crt&quot;</span><span class="p">;</span><span class="w">             </span><span class="c1">// Provide the absolute path of the SSL root certificate.</span>
<span class="n">flParameter</span><span class="p">.</span><span class="na">setCertPath</span><span class="p">(</span><span class="n">certPath</span><span class="p">);</span>
</pre></div>
</div>
<p>Create a SyncFLJob object and use the flJobRun() method of the SyncFLJob class to start a federated learning task.</p>
<p>The sample code is as follows:</p>
<ol class="arabic">
<li><p>Sample code of a sentiment classification task</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">// set parameters</span>
<span class="n">String</span><span class="w"> </span><span class="n">trainDataset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;SyncFLClient/data/albert/client/0.txt&quot;</span><span class="p">;</span><span class="w">                        </span><span class="c1">// Absolute path</span>
<span class="n">String</span><span class="w"> </span><span class="n">vocal_file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;SyncFLClient/data/albert/vocab.txt&quot;</span><span class="p">;</span><span class="w">                           </span><span class="c1">// Absolute path</span>
<span class="n">String</span><span class="w"> </span><span class="n">idsFile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;SyncFLClient/data/albert/vocab_map_ids.txt&quot;</span><span class="p">;</span><span class="w">                      </span><span class="c1">// Absolute path</span>
<span class="n">String</span><span class="w"> </span><span class="n">testDataset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;SyncFLClient/data/albert/eval/eval.txt&quot;</span><span class="p">;</span><span class="w">    </span><span class="c1">// Absolute path. If no independent test set is included, use the training data as the test set or do not perform the test (do not set this parameter).</span>
<span class="n">String</span><span class="w"> </span><span class="n">flName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;albert&quot;</span><span class="p">;</span><span class="w">  </span>
<span class="n">String</span><span class="w"> </span><span class="n">trainModelPath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;SyncFLClient/ms/albert/albert_train.mindir.ms&quot;</span><span class="p">;</span><span class="w">                      </span><span class="c1">// Absolute path</span>
<span class="n">String</span><span class="w"> </span><span class="n">inferModelPath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;SyncFLClient/ms/albert/albert_train.mindir.ms&quot;</span><span class="p">;</span><span class="w">                      </span><span class="c1">// Absolute path</span>
<span class="kt">boolean</span><span class="w"> </span><span class="n">useSSL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="n">String</span><span class="w"> </span><span class="n">domainName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;http://10.113.216.106:6668&quot;</span><span class="p">;</span>

<span class="n">FLParameter</span><span class="w"> </span><span class="n">flParameter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FLParameter</span><span class="p">.</span><span class="na">getInstance</span><span class="p">();</span>
<span class="n">flParameter</span><span class="p">.</span><span class="na">setTrainDataset</span><span class="p">(</span><span class="n">trainDataset</span><span class="p">);</span>
<span class="n">flParameter</span><span class="p">.</span><span class="na">setVocabFile</span><span class="p">(</span><span class="n">vocabFile</span><span class="p">);</span>
<span class="n">flParameter</span><span class="p">.</span><span class="na">setIdsFile</span><span class="p">(</span><span class="n">idsFile</span><span class="p">);</span>
<span class="n">flParameter</span><span class="p">.</span><span class="na">setTestDataset</span><span class="p">(</span><span class="n">testDataset</span><span class="p">);</span>
<span class="n">flParameter</span><span class="p">.</span><span class="na">setFlName</span><span class="p">(</span><span class="n">flName</span><span class="p">);</span>
<span class="n">flParameter</span><span class="p">.</span><span class="na">setTrainModelPath</span><span class="p">(</span><span class="n">trainModelPath</span><span class="p">);</span>
<span class="n">flParameter</span><span class="p">.</span><span class="na">setInferModelPath</span><span class="p">(</span><span class="n">inferModelPath</span><span class="p">);</span>
<span class="n">flParameter</span><span class="p">.</span><span class="na">setUseSSL</span><span class="p">(</span><span class="n">useSSL</span><span class="p">);</span>
<span class="n">flParameter</span><span class="p">.</span><span class="na">setDomainName</span><span class="p">(</span><span class="n">domainName</span><span class="p">);</span>

<span class="c1">// start FLJob</span>
<span class="n">SyncFLJob</span><span class="w"> </span><span class="n">syncFLJob</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SyncFLJob</span><span class="p">();</span>
<span class="n">syncFLJob</span><span class="p">.</span><span class="na">flJobRun</span><span class="p">();</span>
</pre></div>
</div>
</li>
<li><p>Sample code of a LeNet image classification task</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">// set parameters</span>
<span class="n">String</span><span class="w"> </span><span class="n">trainDataset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;SyncFLClient/data/3500_clients_bin/f0178_39/f0178_39_bn_9_train_data.bin,SyncFLClient/data/3500_clients_bin/f0178_39/f0178_39_bn_9_train_label.bin&quot;</span><span class="p">;</span><span class="w">                        </span><span class="c1">// Absolute path</span>
<span class="n">String</span><span class="w"> </span><span class="n">testDataset</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;SyncFLClient/data/3500_clients_bin/f0178_39/f0178_39_bn_1_test_data.bin,SyncFLClient/data/3500_clients_bin/f0178_39/f0178_39_bn_1_test_label.bin&quot;</span><span class="p">;</span><span class="w">    </span><span class="c1">// Absolute path. If no independent test set is included, use the training data as the test set or do not perform the test (do not set this parameter).</span>
<span class="n">String</span><span class="w"> </span><span class="n">flName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;lenet&quot;</span><span class="p">;</span>
<span class="n">String</span><span class="w"> </span><span class="n">trainModelPath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;SyncFLClient/lenet_train.mindir0.ms&quot;</span><span class="p">;</span><span class="w">                      </span><span class="c1">// Absolute path</span>
<span class="n">String</span><span class="w"> </span><span class="n">inferModelPath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;SyncFLClient/lenet_train.mindir0.ms&quot;</span><span class="p">;</span><span class="w">                      </span><span class="c1">// Absolute path</span>
<span class="kt">boolean</span><span class="w"> </span><span class="n">useSSL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="n">String</span><span class="w"> </span><span class="n">domainName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;http://10.113.216.106:6668&quot;</span><span class="p">;</span>

<span class="n">FLParameter</span><span class="w"> </span><span class="n">flParameter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FLParameter</span><span class="p">.</span><span class="na">getInstance</span><span class="p">();</span>
<span class="n">flParameter</span><span class="p">.</span><span class="na">setTrainDataset</span><span class="p">(</span><span class="n">trainDataset</span><span class="p">);</span>
<span class="n">flParameter</span><span class="p">.</span><span class="na">setTestDataset</span><span class="p">(</span><span class="n">testDataset</span><span class="p">);</span>
<span class="n">flParameter</span><span class="p">.</span><span class="na">setFlName</span><span class="p">(</span><span class="n">flName</span><span class="p">);</span>
<span class="n">flParameter</span><span class="p">.</span><span class="na">setTrainModelPath</span><span class="p">(</span><span class="n">trainModelPath</span><span class="p">);</span>
<span class="n">flParameter</span><span class="p">.</span><span class="na">setInferModelPath</span><span class="p">(</span><span class="n">inferModelPath</span><span class="p">);</span>
<span class="n">flParameter</span><span class="p">.</span><span class="na">setUseSSL</span><span class="p">(</span><span class="n">useSSL</span><span class="p">);</span>
<span class="n">flParameter</span><span class="p">.</span><span class="na">setDomainName</span><span class="p">(</span><span class="n">domainName</span><span class="p">);</span>

<span class="c1">// start FLJob</span>
<span class="n">SyncFLJob</span><span class="w"> </span><span class="n">syncFLJob</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SyncFLJob</span><span class="p">();</span>
<span class="n">syncFLJob</span><span class="p">.</span><span class="na">flJobRun</span><span class="p">();</span>
</pre></div>
</div>
</li>
</ol>
</section>
<section id="modelinference-for-inferring-multiple-input-data-records">
<h2>modelInference() for Inferring Multiple Input Data Records<a class="headerlink" href="#modelinference-for-inferring-multiple-input-data-records" title="Permalink to this headline"></a></h2>
<p>Before calling the modelInference() API, instantiate the parameter class FLParameter and set related parameters as follows:</p>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Mandatory</p></th>
<th class="head"><p>DescriptionRemarks</p></th>
<th class="head"><p>Remarks</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>flName</p></td>
<td><p>String</p></td>
<td><p>Y</p></td>
<td><p>Name of the model used for federated learning.</p></td>
<td><p>Set this parameter to <code class="docutils literal notranslate"><span class="pre">albert</span></code> for sentiment classification tasks or <code class="docutils literal notranslate"><span class="pre">lenet</span></code> for image classification tasks.</p></td>
</tr>
<tr class="row-odd"><td><p>dataPath</p></td>
<td><p>String</p></td>
<td><p>Y</p></td>
<td><p>Dataset path.</p></td>
<td><p>The sentiment classification task is in .txt format without labels. The image classification task is in .bin format.</p></td>
</tr>
<tr class="row-even"><td><p>vocabFile</p></td>
<td><p>String</p></td>
<td><p>Y</p></td>
<td><p>Path of the dictionary file for data preprocessing.</p></td>
<td><p>This parameter is mandatory for sentiment classification tasks.  This parameter is not needed for image classification task.</p></td>
</tr>
<tr class="row-odd"><td><p>idsFile</p></td>
<td><p>String</p></td>
<td><p>Y</p></td>
<td><p>Path of the mapping ID file of a dictionary.</p></td>
<td><p>This parameter is mandatory for sentiment classification tasks. This parameter is not needed for image classification task.</p></td>
</tr>
<tr class="row-even"><td><p>modelPath</p></td>
<td><p>String</p></td>
<td><p>Y</p></td>
<td><p>Path of an inference model used for federated learning, which is an absolute path of the .ms file.</p></td>
<td><p>Both the supervised sentiment classification task and the image classification task need to be set as the same as trainModelPath that used in the federated learning training task.</p></td>
</tr>
</tbody>
</table>
<p>Create a SyncFLJob object and use the modelInference() method of the SyncFLJob class to start an inference task on the device. The inferred label array is returned.</p>
<p>The sample code is as follows:</p>
<ol class="arabic">
<li><p>Sample code of a sentiment classification task</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">// set parameters</span>
<span class="n">String</span><span class="w"> </span><span class="n">flName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;albert&quot;</span><span class="p">;</span>
<span class="n">String</span><span class="w"> </span><span class="n">dataPath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;SyncFLClient/data/albert/eval/eval.txt&quot;</span><span class="p">;</span><span class="w">                             </span><span class="c1">// Absolute path</span>
<span class="n">String</span><span class="w"> </span><span class="n">vocal_file</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;SyncFLClient/data/albert/vocab.txt&quot;</span><span class="p">;</span><span class="w">                                  </span><span class="c1">// Absolute path</span>
<span class="n">String</span><span class="w"> </span><span class="n">idsFile</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;SyncFLClient/data/albert/vocab_map_ids.txt&quot;</span><span class="p">;</span><span class="w">                    </span><span class="c1">// Absolute path</span>
<span class="n">String</span><span class="w"> </span><span class="n">modelPath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;SyncFLClient/ms/albert/albert_train.mindir.ms&quot;</span><span class="p">;</span><span class="w">                                </span><span class="c1">// Absolute path</span>
<span class="n">FLParameter</span><span class="w"> </span><span class="n">flParameter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FLParameter</span><span class="p">.</span><span class="na">getInstance</span><span class="p">();</span>
<span class="n">flParameter</span><span class="p">.</span><span class="na">setFlName</span><span class="p">(</span><span class="n">flName</span><span class="p">);</span>
<span class="n">flParameter</span><span class="p">.</span><span class="na">setTestDataset</span><span class="p">(</span><span class="n">dataPath</span><span class="p">);</span>
<span class="n">flParameter</span><span class="p">.</span><span class="na">setVocabFile</span><span class="p">(</span><span class="n">vocabFile</span><span class="p">);</span>
<span class="n">flParameter</span><span class="p">.</span><span class="na">setIdsFile</span><span class="p">(</span><span class="n">idsFile</span><span class="p">);</span>
<span class="n">flParameter</span><span class="p">.</span><span class="na">setInferModelPath</span><span class="p">(</span><span class="n">modelPath</span><span class="p">);</span>

<span class="c1">// inference</span>
<span class="n">SyncFLJob</span><span class="w"> </span><span class="n">syncFLJob</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SyncFLJob</span><span class="p">();</span>
<span class="kt">int</span><span class="o">[]</span><span class="w"> </span><span class="n">labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">syncFLJob</span><span class="p">.</span><span class="na">modelInference</span><span class="p">();</span>
</pre></div>
</div>
</li>
<li><p>Sample code of a LeNet image classification</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">// set parameters</span>
<span class="n">String</span><span class="w"> </span><span class="n">flName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;lenet&quot;</span><span class="p">;</span>
<span class="n">String</span><span class="w"> </span><span class="n">dataPath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;/SyncFLClient/data/3500_clients_bin/f0178_39/f0178_39_bn_1_test_data.bin,/SyncFLClient/data/3500_clients_bin/f0178_39/f0178_39_bn_1_test_label.bin&quot;</span><span class="p">;</span><span class="w">     </span><span class="c1">//绝对路径</span>
<span class="n">String</span><span class="w"> </span><span class="n">modelPath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;SyncFLClient/lenet_train.mindir0.ms&quot;</span><span class="p">;</span><span class="w">            </span><span class="c1">// Absolute path</span>
<span class="n">FLParameter</span><span class="w"> </span><span class="n">flParameter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FLParameter</span><span class="p">.</span><span class="na">getInstance</span><span class="p">();</span>
<span class="n">flParameter</span><span class="p">.</span><span class="na">setFlName</span><span class="p">(</span><span class="n">flName</span><span class="p">);</span>
<span class="n">flParameter</span><span class="p">.</span><span class="na">setTestDataset</span><span class="p">(</span><span class="n">dataPath</span><span class="p">);</span>
<span class="n">flParameter</span><span class="p">.</span><span class="na">setInferModelPath</span><span class="p">(</span><span class="n">modelPath</span><span class="p">);</span>

<span class="c1">// inference</span>
<span class="n">SyncFLJob</span><span class="w"> </span><span class="n">syncFLJob</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SyncFLJob</span><span class="p">();</span>
<span class="kt">int</span><span class="o">[]</span><span class="w"> </span><span class="n">labels</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">syncFLJob</span><span class="p">.</span><span class="na">modelInference</span><span class="p">();</span>
</pre></div>
</div>
</li>
</ol>
</section>
<section id="getmodel-for-obtaining-the-latest-model-on-the-cloud">
<h2>getModel() for Obtaining the Latest Model on the Cloud<a class="headerlink" href="#getmodel-for-obtaining-the-latest-model-on-the-cloud" title="Permalink to this headline"></a></h2>
<p>Before calling the getModel() API, instantiate the parameter class FLParameter and set related parameters as follows:</p>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>Parameter</p></th>
<th class="head"><p>Type</p></th>
<th class="head"><p>Mandatory</p></th>
<th class="head"><p>Description</p></th>
<th class="head"><p>Remarks</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>flName</p></td>
<td><p>String</p></td>
<td><p>Y</p></td>
<td><p>Name of the model used for federated learning.</p></td>
<td><p>Set this parameter to <code class="docutils literal notranslate"><span class="pre">albert</span></code> for sentiment classification tasks or <code class="docutils literal notranslate"><span class="pre">lenet</span></code> for the LeNet scenario.</p></td>
</tr>
<tr class="row-odd"><td><p>trainModelPath</p></td>
<td><p>String</p></td>
<td><p>Y</p></td>
<td><p>Path of a training model used for federated learning, which is an absolute path of the .ms file.</p></td>
<td><p></p></td>
</tr>
<tr class="row-even"><td><p>inferModelPath</p></td>
<td><p>String</p></td>
<td><p>Y</p></td>
<td><p>Path of an inference model used for federated learning, which is an absolute path of the .ms file.</p></td>
<td><p>The value of this parameter need to be the same as that of trainModelPath for supervised sentiment classification tasks and image classification tasks.</p></td>
</tr>
<tr class="row-odd"><td><p>useSSL</p></td>
<td><p>Boolean</p></td>
<td><p>N</p></td>
<td><p>Whether to perform SSL certificate authentication (which applies only to the HTTPS communication scenario) for device-cloud communication.</p></td>
<td><p>The value false indicates that SSL certificate authentication is not performed. The value true indicates that SSL certificate authentication is performed. The default value is false.</p></td>
</tr>
<tr class="row-even"><td><p>certPath</p></td>
<td><p>String</p></td>
<td><p>N</p></td>
<td><p>the SSL root certificate path used for device-cloud https communication.</p></td>
<td><p>This parameter must be set when the device-cloud is performing https communication and <code class="docutils literal notranslate"><span class="pre">useSSL</span></code> is set to true.</p></td>
</tr>
<tr class="row-odd"><td><p>domainName</p></td>
<td><p>String</p></td>
<td><p>Y</p></td>
<td><p>the url for device-cloud communication.</p></td>
<td><p>Currently, https and http communication are supported, the corresponding formats are like: https://……, http://……, and when <code class="docutils literal notranslate"><span class="pre">useElb</span></code> is set to true, the format must be: https://127.0.0.0 : 6666 or http://127.0.0.0 : 6666 , where <code class="docutils literal notranslate"><span class="pre">127.0.0.0</span></code> corresponds to the ip of the machine providing cloud-side services (corresponding to the cloud-side parameter <code class="docutils literal notranslate"><span class="pre">--scheduler_ip</span></code>), and <code class="docutils literal notranslate"><span class="pre">6666</span></code> corresponds to the cloud-side parameter <code class="docutils literal notranslate"><span class="pre">--fl_server_port</span></code>.</p></td>
</tr>
<tr class="row-even"><td><p>ifUseElb</p></td>
<td><p>Boolean</p></td>
<td><p>Y</p></td>
<td><p>Whether to simulate the elastic load balancing. The value true indicates that the client sends requests to a random server address within a specified range. The value false indicates that the client sends a request to a fixed server address.</p></td>
<td><p>The default value is false.</p></td>
</tr>
<tr class="row-odd"><td><p>serverNum</p></td>
<td><p>Integer</p></td>
<td><p>Y</p></td>
<td><p>Number of servers that can send requests during elastic load balancing simulation.</p></td>
<td><p>It can be the same as the number of servers started on the cloud when set <code class="docutils literal notranslate"><span class="pre">ifUseElb</span></code> to true, the default value is 1.</p></td>
</tr>
</tbody>
</table>
<p>When <code class="docutils literal notranslate"><span class="pre">useSSL</span></code> is set to <code class="docutils literal notranslate"><span class="pre">true</span></code>, only HTTPS communication is supported. In addition, the following parameters need to be set:</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="n">FLParameter</span><span class="w"> </span><span class="n">flParameter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FLParameter</span><span class="p">.</span><span class="na">getInstance</span><span class="p">();</span>
<span class="n">String</span><span class="w"> </span><span class="n">certPath</span><span class="w">  </span><span class="o">=</span><span class="w">  </span><span class="s">&quot;client.crt&quot;</span><span class="p">;</span><span class="w">             </span><span class="c1">// Provide the absolute path of the SSL root certificate.</span>
<span class="n">flParameter</span><span class="p">.</span><span class="na">setCertPath</span><span class="p">(</span><span class="n">certPath</span><span class="p">);</span>
</pre></div>
</div>
<p>Create a SyncFLJob object and use the getModel() method of the SyncFLJob class to start an asynchronous inference task. The status code of the getModel request is returned.</p>
<p>The sample code is as follows:</p>
<ol class="arabic">
<li><p>Sentiment classification task</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">// set parameters</span>
<span class="n">String</span><span class="w"> </span><span class="n">flName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;albert&quot;</span><span class="p">;</span><span class="w">     </span><span class="c1">// Set this parameter to `albert` for sentiment classification tasks or `lenet` for image classification tasks.</span>
<span class="n">String</span><span class="w"> </span><span class="n">trainModelPath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;SyncFLClient/ms/albert/albert_train.mindir.ms&quot;</span><span class="p">;</span><span class="w">                      </span><span class="c1">// Absolute path</span>
<span class="n">String</span><span class="w"> </span><span class="n">inferModelPath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;SyncFLClient/ms/albert/albert_train.mindir.ms&quot;</span><span class="p">;</span><span class="w">                      </span><span class="c1">// Absolute path</span>
<span class="kt">boolean</span><span class="w"> </span><span class="n">useSSL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="n">String</span><span class="w"> </span><span class="n">domainName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;http://10.113.216.106:6668&quot;</span><span class="p">;</span>
<span class="kt">boolean</span><span class="w"> </span><span class="n">useElb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="kt">int</span><span class="w"> </span><span class="n">serverNum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>

<span class="n">FLParameter</span><span class="w"> </span><span class="n">flParameter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FLParameter</span><span class="p">.</span><span class="na">getInstance</span><span class="p">();</span>
<span class="n">flParameter</span><span class="p">.</span><span class="na">setFlName</span><span class="p">(</span><span class="n">flName</span><span class="p">);</span>
<span class="n">flParameter</span><span class="p">.</span><span class="na">setTrainModelPath</span><span class="p">(</span><span class="n">trainModelPath</span><span class="p">);</span>
<span class="n">flParameter</span><span class="p">.</span><span class="na">setInferModelPath</span><span class="p">(</span><span class="n">inferModelPath</span><span class="p">);</span>
<span class="n">flParameter</span><span class="p">.</span><span class="na">setUseSSL</span><span class="p">(</span><span class="n">useSSL</span><span class="p">);</span>
<span class="n">flParameter</span><span class="p">.</span><span class="na">setDomainName</span><span class="p">(</span><span class="n">domainName</span><span class="p">);</span>
<span class="n">flParameter</span><span class="p">.</span><span class="na">setUseElb</span><span class="p">(</span><span class="n">useElb</span><span class="p">);</span>
<span class="n">flParameter</span><span class="p">.</span><span class="na">setServerNum</span><span class="p">(</span><span class="n">serverNum</span><span class="p">);</span>

<span class="c1">// getModel</span>
<span class="n">SyncFLJob</span><span class="w"> </span><span class="n">syncFLJob</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SyncFLJob</span><span class="p">();</span>
<span class="n">syncFLJob</span><span class="p">.</span><span class="na">getModel</span><span class="p">();</span>
</pre></div>
</div>
</li>
<li><p>LeNet image classification task</p>
<div class="highlight-java notranslate"><div class="highlight"><pre><span></span><span class="c1">// set parameters</span>
<span class="n">String</span><span class="w"> </span><span class="n">flName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;lenet&quot;</span><span class="p">;</span><span class="w">     </span><span class="c1">// Set this parameter to `albert` for sentiment classification tasks or `lenet` for the LeNet scenario.</span>
<span class="n">String</span><span class="w"> </span><span class="n">trainModelPath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;SyncFLClient/lenet_train.mindir0.ms&quot;</span><span class="p">;</span><span class="w">                      </span><span class="c1">// Absolute path</span>
<span class="n">String</span><span class="w"> </span><span class="n">inferModelPath</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;SyncFLClient/lenet_train.mindir0.ms&quot;</span><span class="p">;</span><span class="w">                      </span><span class="c1">// Absolute path</span>
<span class="kt">boolean</span><span class="w"> </span><span class="n">useSSL</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="n">String</span><span class="w"> </span><span class="n">domainName</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="s">&quot;http://10.113.216.106:6668&quot;</span><span class="p">;</span>
<span class="kt">boolean</span><span class="w"> </span><span class="n">useElb</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="kc">false</span><span class="p">;</span>
<span class="kt">int</span><span class="w"> </span><span class="n">serverNum</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mi">1</span><span class="p">;</span>

<span class="n">FLParameter</span><span class="w"> </span><span class="n">flParameter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">FLParameter</span><span class="p">.</span><span class="na">getInstance</span><span class="p">();</span>
<span class="n">flParameter</span><span class="p">.</span><span class="na">setFlName</span><span class="p">(</span><span class="n">flName</span><span class="p">);</span>
<span class="n">flParameter</span><span class="p">.</span><span class="na">setTrainModelPath</span><span class="p">(</span><span class="n">trainModelPath</span><span class="p">);</span>
<span class="n">flParameter</span><span class="p">.</span><span class="na">setInferModelPath</span><span class="p">(</span><span class="n">inferModelPath</span><span class="p">);</span>
<span class="n">flParameter</span><span class="p">.</span><span class="na">setUseSSL</span><span class="p">(</span><span class="n">useSSL</span><span class="p">);</span>
<span class="n">flParameter</span><span class="p">.</span><span class="na">setDomainName</span><span class="p">(</span><span class="n">domainName</span><span class="p">);</span>
<span class="n">flParameter</span><span class="p">.</span><span class="na">setUseElb</span><span class="p">(</span><span class="n">useElb</span><span class="p">);</span>
<span class="n">flParameter</span><span class="p">.</span><span class="na">setServerNum</span><span class="p">(</span><span class="n">serverNum</span><span class="p">);</span>

<span class="c1">// getModel</span>
<span class="n">SyncFLJob</span><span class="w"> </span><span class="n">syncFLJob</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="k">new</span><span class="w"> </span><span class="n">SyncFLJob</span><span class="p">();</span>
<span class="n">syncFLJob</span><span class="p">.</span><span class="na">getModel</span><span class="p">();</span>
</pre></div>
</div>
</li>
</ol>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="java_api_syncfljob.html" class="btn btn-neutral float-left" title="SyncFLJob" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2021, MindSpore Federated.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>