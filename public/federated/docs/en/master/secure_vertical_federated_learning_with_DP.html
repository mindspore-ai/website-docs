<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Vertical Federated - Label Protection Based on Differential Privacy &mdash; MindSpore master documentation</title><script>;(()=>{const e=localStorage.getItem("ms-theme"),t=window.matchMedia("(prefers-color-scheme: dark)").matches;(e?"dark"===e:t)&&document.documentElement.setAttribute("data-o-theme","dark")})();</script><link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script><script src="_static/jquery.js"></script>
        <script src="_static/js/theme.js"></script><script src="_static/underscore.js"></script><script src="_static/doctools.js"></script><script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script><script async="async" src="https://mindspore-website.obs.cn-north-4.myhuaweicloud.com/mathjax/MathJax-3.2.2/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Device-Cloud Federated Learning Communication Compression" href="communication_compression.html" />
    <link rel="prev" title="Vertical Federated - Feature Protection Based on Trusted Execution Environment" href="secure_vertical_federated_learning_with_TEE.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> MindSpore
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Deployment</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="federated_install.html">Obtaining MindSpore Federated</a></li>
<li class="toctree-l1"><a class="reference internal" href="deploy_federated_server.html">Horizontal Federated Cloud-based Deployment</a></li>
<li class="toctree-l1"><a class="reference internal" href="deploy_federated_client.html">Horizontal Federated Device-side Deployment</a></li>
<li class="toctree-l1"><a class="reference internal" href="deploy_vfl.html">Vertical Federated Deployment</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Horizontal Application</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="image_classfication_dataset_process.html">Federated Learning Image Classification Dataset Process</a></li>
<li class="toctree-l1"><a class="reference internal" href="image_classification_application.html">Implementing an Image Classification Application of Cross-device Federated Learning (x86)</a></li>
<li class="toctree-l1"><a class="reference internal" href="sentiment_classification_application.html">Implementing a Sentiment Classification Application (Android)</a></li>
<li class="toctree-l1"><a class="reference internal" href="image_classification_application_in_cross_silo.html">Implementing a Cloud-Slio Federated Image Classification Application (x86)</a></li>
<li class="toctree-l1"><a class="reference internal" href="object_detection_application_in_cross_silo.html">Implementing a Cross-Silo Federated Target Detection Application (x86)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Vertical Application</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="data_join.html">Vertical Federated Learning Data Access</a></li>
<li class="toctree-l1"><a class="reference internal" href="split_wnd_application.html">Vertical Federated Learning Model Training - Wide&amp;Deep Recommendation Application</a></li>
<li class="toctree-l1"><a class="reference internal" href="split_pangu_alpha_application.html">Vertical Federated Learning Model Training - Pangu Alpha Large Model Cross-Domain Training</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Security and Privacy</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="local_differential_privacy_training_noise.html">Horizontal FL-Local Differential Privacy Perturbation Training</a></li>
<li class="toctree-l1"><a class="reference internal" href="local_differential_privacy_training_signds.html">Horizontal FL-Local Differential Privacy SignDS training</a></li>
<li class="toctree-l1"><a class="reference internal" href="local_differential_privacy_eval_laplace.html">Horizontal Federated-Local Differential Privacy Inference Result Protection</a></li>
<li class="toctree-l1"><a class="reference internal" href="pairwise_encryption_training.html">Horizontal FL-Pairwise encryption training</a></li>
<li class="toctree-l1"><a class="reference internal" href="private_set_intersection.html">Vertical Federated-Privacy Set Intersection</a></li>
<li class="toctree-l1"><a class="reference internal" href="secure_vertical_federated_learning_with_EmbeddingDP.html">Vertical Federated-Feature Protection Based on Information Obfuscation</a></li>
<li class="toctree-l1"><a class="reference internal" href="secure_vertical_federated_learning_with_TEE.html">Vertical Federated - Feature Protection Based on Trusted Execution Environment</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Vertical Federated - Label Protection Based on Differential Privacy</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#background">Background</a></li>
<li class="toctree-l2"><a class="reference internal" href="#algorithm-implementation">Algorithm Implementation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#binary-labels-protection">Binary Labels Protection</a></li>
<li class="toctree-l3"><a class="reference internal" href="#onehot-labels-protection">Onehot Labels Protection</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#quick-experience">Quick Experience</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#front-end-needs">Front-End Needs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#starting-the-script">Starting the Script</a></li>
<li class="toctree-l3"><a class="reference internal" href="#viewing-results">Viewing Results</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#deep-experience">Deep Experience</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#front-end-needs-1">Front-End Needs</a></li>
<li class="toctree-l3"><a class="reference internal" href="#option-1-call-the-integrated-label-dp-function-in-the-flmodel-class">Option 1: Call the integrated label dp function in the FLModel class</a></li>
<li class="toctree-l3"><a class="reference internal" href="#option-2-directly-call-the-labeldp-class">Option 2: Directly call the LabelDP class</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Communication Compression</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="communication_compression.html">Device-Cloud Federated Learning Communication Compression</a></li>
<li class="toctree-l1"><a class="reference internal" href="vfl_communication_compress.html">Vertical Federated Learning Communication Compression</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Horizontal Federated API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="horizontal_server.html">Federated Server</a></li>
<li class="toctree-l1"><a class="reference internal" href="cross_device.html">Device-side Client</a></li>
<li class="toctree-l1"><a class="reference internal" href="horizontal/cross_silo.html">Cross-Silo</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Vertical Federated API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Data_Join.html">Data Join</a></li>
<li class="toctree-l1"><a class="reference internal" href="vertical/vertical_communicator.html">Vertical Federated Learning Communicator</a></li>
<li class="toctree-l1"><a class="reference internal" href="vertical_federated_trainer.html">Vertical Federated Trainer</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="faq.html">FAQ</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">RELEASE NOTES</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="RELEASE.html">Release Notes</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">MindSpore</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Vertical Federated - Label Protection Based on Differential Privacy</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/secure_vertical_federated_learning_with_DP.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section class="tex2jax_ignore mathjax_ignore" id="vertical-federated--label-protection-based-on-differential-privacy">
<h1>Vertical Federated - Label Protection Based on Differential Privacy<a class="headerlink" href="#vertical-federated--label-protection-based-on-differential-privacy" title="Permalink to this headline"></a></h1>
<p><a class="reference external" href="https://gitee.com/mindspore/docs/blob/master/docs/federated/docs/source_en/secure_vertical_federated_learning_with_DP.md"><img alt="View Source On Gitee" src="https://mindspore-website.obs.cn-north-4.myhuaweicloud.com/website-images/master/resource/_static/logo_source_en.svg" /></a></p>
<section id="background">
<h2>Background<a class="headerlink" href="#background" title="Permalink to this headline"></a></h2>
<p>Vertical federated learning (vFL) is a major branch of federated learning (FL). When different participants have data from the same batch of users but with different attributes, they can use vFL for collaborative training. In vFL, the participants with user features (follower for short, participant A as shown in the figure below) hold a bottom network (Bottom Model). They input the features into the bottom network, compute the intermediate results (embedding), and send them to the participants with labels (leader for short, participant B as shown in the figure below). The leader uses these embeddings and its own labels to train the upper network (upper network), and then passes the computed gradients back to each participant to train the bottom network. It can be seen that vFL does not require any participant to upload their own raw data to collaboratively train the model.</p>
<p><img alt="image.png" src="_images/vfl_1_en.png" /></p>
<p>The vFL framework avoids the direct upload of raw data, protecting data privacy at a certain level. However, there exists possibility for a semi-honest or a malicious party to infer the label information from the gradients passing back from the leader party, causing privacy disclosure. Given the large number of vFL scenarios where labels are the most valuable and most important piece of information to protect, in this context, we need to provide stronger privacy guarantees for vFL training to avoid the privacy disclosure.</p>
<p>Differential privacy (DP) is a definition of privacy based strictly on statistics/information theory, which currently the golden standard of privacy-preserving data analysis. The core idea behind DP is to induce randomness to overwhelm each individual data’s influence on the algorithm’s result, making sure that it is hard for the algorithm’s results to be inverted to the individual data. The protection of DP can hold under an extreme threat model, which holds even when:</p>
<ul class="simple">
<li><p>the adversary knows all the details of the DP algorithm</p></li>
<li><p>the adversary has infinite computing power</p></li>
<li><p>the adversary has arbitrary auxiliary information about the raw data</p></li>
</ul>
<p>Regarding the backgrounds, theories and implementation of DP, please refer to [1] for an excellent survey.</p>
<p>Our scheme is based on label differential privacy (label dp) [2], which provides differential privacy guarantees for the labels of the leader participants during vertical federated learning training, so that an attacker cannot invert the label information of the data from the returned gradients. Under the protection of this scheme, even if the follower party is semi-honest or malicious, the label information of the leader party is guaranteed to be protected, mitigating vFL participants’ concerns on the data privacy risk.</p>
</section>
<section id="algorithm-implementation">
<h2>Algorithm Implementation<a class="headerlink" href="#algorithm-implementation" title="Permalink to this headline"></a></h2>
<p>MindSpore Federated adopt a lightweight implementation of label dp. During training, a certain percentage of the labels are randomly flipped before using the label data from the leader participants. Due to the introduction of randomness, an attacker who wants to invert the labels can at most invert the labels after the random flip or perturbation, increasing the difficulty of inverting the original labels and satisfying the differential privacy guarantee. In practical applications, we can adjust the privacy parameter <code class="docutils literal notranslate"><span class="pre">eps</span></code> (which can be interpreted as the ratio of randomly flipped labels) to meet the needs of different scenarios:</p>
<ul class="simple">
<li><p>smaller <code class="docutils literal notranslate"><span class="pre">eps</span></code> (&lt;1.0) corresponds to high privacy, low performance</p></li>
<li><p>larger <code class="docutils literal notranslate"><span class="pre">eps</span></code>  (&gt;5.0) corresponds to high performance, low privacy</p></li>
</ul>
<p><img alt="image.png" src="_images/label_dp_en.png" /></p>
<p>The implementation of this scheme is divided into the binary case and the onehot case. Whether the input labels are binary or onehot is automatically recognized, and the same type of labels will then be output. The detailed algorithm is shown as follows:</p>
<section id="binary-labels-protection">
<h3>Binary Labels Protection<a class="headerlink" href="#binary-labels-protection" title="Permalink to this headline"></a></h3>
<ol class="arabic simple">
<li><p>Calculate the flip probability <span class="math notranslate nohighlight">\(p = \frac{1}{1 + e^{eps}}\)</span> according to the preset privacy parameter eps.</p></li>
<li><p>Flip each label with probability <span class="math notranslate nohighlight">\(p\)</span>.</p></li>
</ol>
</section>
<section id="onehot-labels-protection">
<h3>Onehot Labels Protection<a class="headerlink" href="#onehot-labels-protection" title="Permalink to this headline"></a></h3>
<ol class="arabic simple">
<li><p>For n classes of labels, calculate <span class="math notranslate nohighlight">\(p_1 = \frac{e^{eps}}{n - 1 + e^{eps}}\)</span>，<span class="math notranslate nohighlight">\(p_2 = \frac{1}{n - 1 + e^{eps}}\)</span>.</p></li>
<li><p>Randomly scramble the labels according to the following probabilities: the probability of keeping the current label unchanged is <span class="math notranslate nohighlight">\(p_1\)</span> and the probability of changing to any of the other n - 1 classes is <span class="math notranslate nohighlight">\(p_2\)</span>.</p></li>
</ol>
</section>
</section>
<section id="quick-experience">
<h2>Quick Experience<a class="headerlink" href="#quick-experience" title="Permalink to this headline"></a></h2>
<p>We use the local case in <a class="reference external" href="https://gitee.com/mindspore/federated/tree/master/example/splitnn_criteo">Wide&amp;Deep Vertical Federated Learning Case</a> as an example of how to add label dp to a vertical federated model protection.</p>
<section id="front-end-needs">
<h3>Front-End Needs<a class="headerlink" href="#front-end-needs" title="Permalink to this headline"></a></h3>
<ol class="arabic">
<li><p>Install MindSpore 1.8.1 or its higher version, please refer to <a class="reference external" href="https://www.mindspore.cn/install">MindSpore official website installation guide</a>.</p></li>
<li><p>Install MindSpore Federated and the Python libraries which the MindSpore Federated depends on.</p>
<div class="highlight-shell notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>federated
python<span class="w"> </span>-m<span class="w"> </span>pip<span class="w"> </span>install<span class="w"> </span>-r<span class="w"> </span>requirements_test.txt
</pre></div>
</div>
</li>
<li><p>Prepare the criteo dataset, please refer to <a class="reference external" href="https://gitee.com/mindspore/federated/tree/master/example/splitnn_criteo">Wide&amp;Deep Vertical Federated Learning Case</a>.</p></li>
</ol>
</section>
<section id="starting-the-script">
<h3>Starting the Script<a class="headerlink" href="#starting-the-script" title="Permalink to this headline"></a></h3>
<ol class="arabic">
<li><p>Download federated</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>git<span class="w"> </span>clone<span class="w"> </span>https://gitee.com/mindspore/federated.git
</pre></div>
</div>
</li>
<li><p>Go to the folder where the script is located</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>federated/example/splitnn_criteo
</pre></div>
</div>
</li>
<li><p>Run the script</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>sh<span class="w"> </span>run_vfl_train_local_label_dp.sh
</pre></div>
</div>
</li>
</ol>
</section>
<section id="viewing-results">
<h3>Viewing Results<a class="headerlink" href="#viewing-results" title="Permalink to this headline"></a></h3>
<p>Check loss changes of the model training in the training log <code class="docutils literal notranslate"><span class="pre">log_local_gpu.txt</span></code>.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>INFO:root:epoch<span class="w"> </span><span class="m">0</span><span class="w"> </span>step<span class="w"> </span><span class="m">100</span>/2582<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.588637
INFO:root:epoch<span class="w"> </span><span class="m">0</span><span class="w"> </span>step<span class="w"> </span><span class="m">200</span>/2582<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.561055
INFO:root:epoch<span class="w"> </span><span class="m">0</span><span class="w"> </span>step<span class="w"> </span><span class="m">300</span>/2582<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.556246
INFO:root:epoch<span class="w"> </span><span class="m">0</span><span class="w"> </span>step<span class="w"> </span><span class="m">400</span>/2582<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.557931
INFO:root:epoch<span class="w"> </span><span class="m">0</span><span class="w"> </span>step<span class="w"> </span><span class="m">500</span>/2582<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.553283
INFO:root:epoch<span class="w"> </span><span class="m">0</span><span class="w"> </span>step<span class="w"> </span><span class="m">600</span>/2582<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.549618
INFO:root:epoch<span class="w"> </span><span class="m">0</span><span class="w"> </span>step<span class="w"> </span><span class="m">700</span>/2582<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.550243
INFO:root:epoch<span class="w"> </span><span class="m">0</span><span class="w"> </span>step<span class="w"> </span><span class="m">800</span>/2582<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.549496
INFO:root:epoch<span class="w"> </span><span class="m">0</span><span class="w"> </span>step<span class="w"> </span><span class="m">900</span>/2582<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.549224
INFO:root:epoch<span class="w"> </span><span class="m">0</span><span class="w"> </span>step<span class="w"> </span><span class="m">1000</span>/2582<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.547547
INFO:root:epoch<span class="w"> </span><span class="m">0</span><span class="w"> </span>step<span class="w"> </span><span class="m">1100</span>/2582<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.546989
INFO:root:epoch<span class="w"> </span><span class="m">0</span><span class="w"> </span>step<span class="w"> </span><span class="m">1200</span>/2582<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.552165
INFO:root:epoch<span class="w"> </span><span class="m">0</span><span class="w"> </span>step<span class="w"> </span><span class="m">1300</span>/2582<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.546926
INFO:root:epoch<span class="w"> </span><span class="m">0</span><span class="w"> </span>step<span class="w"> </span><span class="m">1400</span>/2582<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.558071
INFO:root:epoch<span class="w"> </span><span class="m">0</span><span class="w"> </span>step<span class="w"> </span><span class="m">1500</span>/2582<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.548258
INFO:root:epoch<span class="w"> </span><span class="m">0</span><span class="w"> </span>step<span class="w"> </span><span class="m">1600</span>/2582<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.546442
INFO:root:epoch<span class="w"> </span><span class="m">0</span><span class="w"> </span>step<span class="w"> </span><span class="m">1700</span>/2582<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.549062
INFO:root:epoch<span class="w"> </span><span class="m">0</span><span class="w"> </span>step<span class="w"> </span><span class="m">1800</span>/2582<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.546558
INFO:root:epoch<span class="w"> </span><span class="m">0</span><span class="w"> </span>step<span class="w"> </span><span class="m">1900</span>/2582<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.542755
INFO:root:epoch<span class="w"> </span><span class="m">0</span><span class="w"> </span>step<span class="w"> </span><span class="m">2000</span>/2582<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.543118
INFO:root:epoch<span class="w"> </span><span class="m">0</span><span class="w"> </span>step<span class="w"> </span><span class="m">2100</span>/2582<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.542587
INFO:root:epoch<span class="w"> </span><span class="m">0</span><span class="w"> </span>step<span class="w"> </span><span class="m">2200</span>/2582<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.545770
INFO:root:epoch<span class="w"> </span><span class="m">0</span><span class="w"> </span>step<span class="w"> </span><span class="m">2300</span>/2582<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.554520
INFO:root:epoch<span class="w"> </span><span class="m">0</span><span class="w"> </span>step<span class="w"> </span><span class="m">2400</span>/2582<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.551129
INFO:root:epoch<span class="w"> </span><span class="m">0</span><span class="w"> </span>step<span class="w"> </span><span class="m">2500</span>/2582<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.545622
...
</pre></div>
</div>
</section>
</section>
<section id="deep-experience">
<h2>Deep Experience<a class="headerlink" href="#deep-experience" title="Permalink to this headline"></a></h2>
<p>We take the local case in <a class="reference external" href="https://gitee.com/mindspore/federated/tree/master/example/splitnn_criteo">Wide&amp;Deep Vertical Federated Learning Case</a> as an example to introduce the specific operation method of adding label dp protection in the vertical federated model.</p>
<section id="front-end-needs-1">
<h3>Front-End Needs<a class="headerlink" href="#front-end-needs-1" title="Permalink to this headline"></a></h3>
<p>Same as <a class="reference internal" href="#quick-experience"><span class="std std-doc">Quick Experience</span></a>: Install MindSpore, Install MindSpore Federated, and Prepare dataset.</p>
</section>
<section id="option-1-call-the-integrated-label-dp-function-in-the-flmodel-class">
<h3>Option 1: Call the integrated label dp function in the FLModel class<a class="headerlink" href="#option-1-call-the-integrated-label-dp-function-in-the-flmodel-class" title="Permalink to this headline"></a></h3>
<p>MindSpore Federated uses <code class="docutils literal notranslate"><span class="pre">FLModel</span></code> (see <a class="reference external" href="https://www.mindspore.cn/federated/docs/en/master/vertical/vertical_federated_FLModel.html">Vertical Federated Learning Model Training Interface</a> and yaml files (see <a class="reference external" href="https://www.mindspore.cn/federated/docs/en/master/vertical/vertical_federated_yaml.html">detailed configuration items of Vertical Federated Learning yaml</a>) to model the training process of vertical federated learning.</p>
<p>We have integrated the label dp function in the <code class="docutils literal notranslate"><span class="pre">FLModel</span></code> class. After the normal completion of modeling the entire vertical federated learning training process (for detailed vFl training, see <a class="reference external" href="https://www.mindspore.cn/federated/docs/en/master/split_pangu_alpha_application.html">Vertical Federated Learning Model Training - Pangu Alpha Large Model Cross-Domain Training</a>), users can simply add the <code class="docutils literal notranslate"><span class="pre">label_dp</span></code> submodule under the <code class="docutils literal notranslate"><span class="pre">privacy</span></code> module in the yaml file of the label side (or add it by user if there is no <code class="docutils literal notranslate"><span class="pre">privacy</span></code> module), and set the <code class="docutils literal notranslate"><span class="pre">eps</span></code> parameter in the <code class="docutils literal notranslate"><span class="pre">label_dp</span></code> module (differential privacy parameter <span class="math notranslate nohighlight">\(\epsilon\)</span>, the user can set the value of this parameter according to the actual needs). Let the model enjoy label dp protection:</p>
<div class="highlight-yaml notranslate"><div class="highlight"><pre><span></span><span class="nt">privacy</span><span class="p">:</span>
<span class="w">  </span><span class="nt">label_dp</span><span class="p">:</span>
<span class="w">    </span><span class="nt">eps</span><span class="p">:</span><span class="w"> </span><span class="l l-Scalar l-Scalar-Plain">1.0</span>
</pre></div>
</div>
</section>
<section id="option-2-directly-call-the-labeldp-class">
<h3>Option 2: Directly call the LabelDP class<a class="headerlink" href="#option-2-directly-call-the-labeldp-class" title="Permalink to this headline"></a></h3>
<p>Users can also call the <code class="docutils literal notranslate"><span class="pre">LabelDP</span></code> class directly to use the label dp function more flexibly. The <code class="docutils literal notranslate"><span class="pre">LabelDP</span></code> class is integrated in the <code class="docutils literal notranslate"><span class="pre">mindspore_federated.privacy</span></code> module. The user can define a <code class="docutils literal notranslate"><span class="pre">LabelDP</span></code> object by specifying the value of <code class="docutils literal notranslate"><span class="pre">eps</span></code>, and then pass the label group as an argument to this object. The <code class="docutils literal notranslate"><span class="pre">_call_</span></code> functio of objext will automatically recognize whether the current input is one-hot or binary label and outputs a label group processed by label dp. Refer to the following example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># make private a batch of binary labels</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">mindspore</span>
<span class="kn">from</span> <span class="nn">mindspore</span> <span class="kn">import</span> <span class="n">Tensor</span>
<span class="kn">from</span> <span class="nn">mindspore_federated.privacy</span> <span class="kn">import</span> <span class="n">LabelDP</span>
<span class="n">label_dp</span> <span class="o">=</span> <span class="n">LabelDP</span><span class="p">(</span><span class="n">eps</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
<span class="n">label</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">zero</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">mindspore</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">dp_label</span> <span class="o">=</span> <span class="n">label_dp</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>

<span class="c1"># make private a batch of one-hot labels</span>
<span class="n">label</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">hstack</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">1</span><span class="p">)),</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">5</span><span class="p">,</span> <span class="mi">2</span><span class="p">)))),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">mindspore</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">dp_label</span> <span class="o">=</span> <span class="n">label_dp</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">dp_label</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline"></a></h2>
<p>[1] Dwork C, Roth A. The algorithmic foundations of differential privacy[J]. Foundations and Trends® in Theoretical Computer Science, 2014, 9(3–4): 211-407.</p>
<p>[2] Ghazi B, Golowich N, Kumar R, et al. Deep learning with label differential privacy[J]. Advances in Neural Information Processing Systems, 2021, 34: 27131-27145.</p>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="secure_vertical_federated_learning_with_TEE.html" class="btn btn-neutral float-left" title="Vertical Federated - Feature Protection Based on Trusted Execution Environment" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="communication_compression.html" class="btn btn-neutral float-right" title="Device-Cloud Federated Learning Communication Compression" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright MindSpore.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 
</body>
</html>