<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Implementing a Cloud-Slio Federated Image Classification Application (x86) &mdash; MindSpore master documentation</title><link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Implementing a Cross-Silo Federated Target Detection Application (x86)" href="object_detection_application_in_cross_silo.html" />
    <link rel="prev" title="Implementing a Sentiment Classification Application (Android)" href="sentiment_classification_application.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> MindSpore
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Deployment</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="federated_install.html">Obtaining MindSpore Federated</a></li>
<li class="toctree-l1"><a class="reference internal" href="deploy_federated_server.html">Horizontal Federated Cloud-based Deployment</a></li>
<li class="toctree-l1"><a class="reference internal" href="deploy_federated_client.html">Horizontal Federated Device-side Deployment</a></li>
<li class="toctree-l1"><a class="reference internal" href="deploy_vfl.html">Vertical Federated Deployment</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Horizontal Application</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="image_classfication_dataset_process.html">Federated Learning Image Classification Dataset Process</a></li>
<li class="toctree-l1"><a class="reference internal" href="image_classification_application.html">Implementing an Image Classification Application of Cross-device Federated Learning (x86)</a></li>
<li class="toctree-l1"><a class="reference internal" href="sentiment_classification_application.html">Implementing a Sentiment Classification Application (Android)</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Implementing a Cloud-Slio Federated Image Classification Application (x86)</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#downloading-the-dataset">Downloading the Dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="#defining-the-network">Defining the Network</a></li>
<li class="toctree-l2"><a class="reference internal" href="#launching-the-cross-silo-federated-task">Launching the Cross-Silo Federated Task</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#installing-mindspore-and-mindspore-federated">Installing MindSpore and Mindspore Federated</a></li>
<li class="toctree-l3"><a class="reference internal" href="#launching-the-task">Launching the Task</a></li>
<li class="toctree-l3"><a class="reference internal" href="#viewing-log">Viewing Log</a></li>
<li class="toctree-l3"><a class="reference internal" href="#closing-the-task">Closing the Task</a></li>
<li class="toctree-l3"><a class="reference internal" href="#results">Results</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="object_detection_application_in_cross_silo.html">Implementing a Cross-Silo Federated Target Detection Application (x86)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Vertical Application</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="data_join.html">Vertical Federated Learning Data Access</a></li>
<li class="toctree-l1"><a class="reference internal" href="split_wnd_application.html">Vertical Federated Learning Model Training - Wide&amp;Deep Recommendation Application</a></li>
<li class="toctree-l1"><a class="reference internal" href="split_pangu_alpha_application.html">Vertical Federated Learning Model Training - Pangu Alpha Large Model Cross-Domain Training</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Security and Privacy</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="local_differential_privacy_training_noise.html">Horizontal FL-Local Differential Privacy Perturbation Training</a></li>
<li class="toctree-l1"><a class="reference internal" href="local_differential_privacy_training_signds.html">Horizontal FL-Local Differential Privacy SignDS training</a></li>
<li class="toctree-l1"><a class="reference internal" href="pairwise_encryption_training.html">Horizontal FL-Pairwise encryption training</a></li>
<li class="toctree-l1"><a class="reference internal" href="private_set_intersection.html">Vertical Federated-Privacy Set Intersection</a></li>
<li class="toctree-l1"><a class="reference internal" href="secure_vertical_federated_learning_with_EmbeddingDP.html">Vertical Federated-Feature Protection Based on Information Obfuscation</a></li>
<li class="toctree-l1"><a class="reference internal" href="secure_vertical_federated_learning_with_TEE.html">Vertical Federated - Feature Protection Based on Trusted Execution Environment</a></li>
<li class="toctree-l1"><a class="reference internal" href="secure_vertical_federated_learning_with_DP.html">Vertical Federated - Label Protection Based on Differential Privacy</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Communication Compression</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="communication_compression.html">Device-Cloud Federated Learning Communication Compression</a></li>
<li class="toctree-l1"><a class="reference internal" href="vfl_communication_compress.html">Vertical Federated Learning Communication Compression</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Horizontal Federated API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="horizontal_server.html">Federated Server</a></li>
<li class="toctree-l1"><a class="reference internal" href="cross_device.html">Device-side Client</a></li>
<li class="toctree-l1"><a class="reference internal" href="horizontal/cross_silo.html">Cross-Silo</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Vertical Federated API Reference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="Data_Join.html">Data Join</a></li>
<li class="toctree-l1"><a class="reference internal" href="vertical/vertical_communicator.html">Vertical Federated Learning Communicator</a></li>
<li class="toctree-l1"><a class="reference internal" href="vertical_federated_trainer.html">Vertical Federated Trainer</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="faq.html">FAQ</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">RELEASE NOTES</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="RELEASE.html">Release Notes</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">MindSpore</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Implementing a Cloud-Slio Federated Image Classification Application (x86)</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/image_classification_application_in_cross_silo.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="implementing-a-cloud-slio-federated-image-classification-application-x86">
<h1>Implementing a Cloud-Slio Federated Image Classification Application (x86)<a class="headerlink" href="#implementing-a-cloud-slio-federated-image-classification-application-x86" title="Permalink to this headline"></a></h1>
<p><a class="reference external" href="https://gitee.com/mindspore/docs/blob/r2.0/docs/federated/docs/source_en/image_classification_application_in_cross_silo.md"><img alt="View Source On Gitee" src="https://mindspore-website.obs.cn-north-4.myhuaweicloud.com/website-images/r2.0/resource/_static/logo_source_en.png" /></a></p>
<p>Based on the type of participating clients, federated learning can be classified into cross-silo federated learning and cross-device federated learning. In a cross-silo federated learning scenario, the clients involved in federated learning are different organizations (e.g., healthcare or finance) or geographically distributed data centers, i.e., training models on multiple data silos. In the cross-device federated learning scenario, the participating clients are a large number of mobile or IoT devices. This framework will describe how to implement an image classification application by using the network LeNet on the MindSpore Federated cross-silo federated framework.</p>
<p>The full script to launch cross-silo federated image classification application can be found <a class="reference external" href="https://gitee.com/mindspore/federated/tree/r0.1/example/cross_silo_femnist">here</a>.</p>
<section id="downloading-the-dataset">
<h2>Downloading the Dataset<a class="headerlink" href="#downloading-the-dataset" title="Permalink to this headline"></a></h2>
<p>This example uses the federated learning dataset <code class="docutils literal notranslate"><span class="pre">FEMNIST</span></code> from <a class="reference external" href="https://github.com/TalwalkarLab/leaf">leaf dataset</a>, which contains 62 different categories of handwritten numbers and letters (numbers 0 to 9, 26 lowercase letters, 26 uppercase letters) with an image size of <code class="docutils literal notranslate"><span class="pre">28</span> <span class="pre">x</span> <span class="pre">28</span></code> pixels . The dataset contains handwritten digits and letters from 3500 users (up to 3500 clients can be simulated to participate in federated learning). The total data volume is 805263, the average amount of data contained per user is 226.83, and the variance of the data volume for all users is 88.94.</p>
<p>You can refer to <a class="reference external" href="https://www.mindspore.cn/federated/docs/en/r0.1/image_classfication_dataset_process.html">Image classfication dataset process</a> in steps 1 to 7 to obtain the 3500 user datasets <code class="docutils literal notranslate"><span class="pre">3500_client_img</span></code> in the form of images.</p>
<p>Due to the relatively small amount of data per user in the original 3500 user dataset, it will converge too fast in the cross-silo federated task to obviously reflect the convergence effect of the cross-silo federated framework. The following provides a reference script to merge the specified number of user data into one user to increase the amount of individual user data participating in the cross-silo federated task and better simulate the cross-silo federated framework experiment.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">shutil</span>


<span class="k">def</span> <span class="nf">mkdir</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">mkdir</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">combine_users</span><span class="p">(</span><span class="n">root_data_path</span><span class="p">,</span> <span class="n">new_data_path</span><span class="p">,</span> <span class="n">raw_user_num</span><span class="p">,</span> <span class="n">new_user_num</span><span class="p">):</span>
    <span class="n">mkdir</span><span class="p">(</span><span class="n">new_data_path</span><span class="p">)</span>
    <span class="n">user_list</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">root_data_path</span><span class="p">)</span>
    <span class="n">num_per_user</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">raw_user_num</span> <span class="o">/</span> <span class="n">new_user_num</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">new_user_num</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span>
            <span class="s2">&quot;========================== combine the raw </span><span class="si">{}</span><span class="s2">~</span><span class="si">{}</span><span class="s2"> users to the new user: dataset_</span><span class="si">{}</span><span class="s2"> ==========================&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span>
                <span class="n">i</span> <span class="o">*</span> <span class="n">num_per_user</span><span class="p">,</span> <span class="n">i</span> <span class="o">*</span> <span class="n">num_per_user</span> <span class="o">+</span> <span class="n">num_per_user</span> <span class="o">-</span> <span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="p">))</span>
        <span class="n">new_user</span> <span class="o">=</span> <span class="s2">&quot;dataset_&quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">new_user_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">new_data_path</span><span class="p">,</span> <span class="n">new_user</span><span class="p">)</span>
        <span class="n">mkdir</span><span class="p">(</span><span class="n">new_user_path</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">num_per_user</span><span class="p">):</span>
            <span class="n">index</span> <span class="o">=</span> <span class="n">i</span> <span class="o">*</span> <span class="n">new_user_num</span> <span class="o">+</span> <span class="n">j</span>
            <span class="n">user</span> <span class="o">=</span> <span class="n">user_list</span><span class="p">[</span><span class="n">index</span><span class="p">]</span>
            <span class="n">user_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">root_data_path</span><span class="p">,</span> <span class="n">user</span><span class="p">)</span>
            <span class="n">tags</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">user_path</span><span class="p">)</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;------------- process the raw user: </span><span class="si">{}</span><span class="s2"> -------------&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">user</span><span class="p">))</span>
            <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">tags</span><span class="p">:</span>
                <span class="n">tag_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">user_path</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
                <span class="n">label_list</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">tag_path</span><span class="p">)</span>
                <span class="n">new_tag_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">new_user_path</span><span class="p">,</span> <span class="n">t</span><span class="p">)</span>
                <span class="n">mkdir</span><span class="p">(</span><span class="n">new_tag_path</span><span class="p">)</span>
                <span class="k">for</span> <span class="n">label</span> <span class="ow">in</span> <span class="n">label_list</span><span class="p">:</span>
                    <span class="n">label_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">tag_path</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span>
                    <span class="n">img_list</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">listdir</span><span class="p">(</span><span class="n">label_path</span><span class="p">)</span>
                    <span class="n">new_label_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">new_tag_path</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span>
                    <span class="n">mkdir</span><span class="p">(</span><span class="n">new_label_path</span><span class="p">)</span>

                    <span class="k">for</span> <span class="n">img</span> <span class="ow">in</span> <span class="n">img_list</span><span class="p">:</span>
                        <span class="n">img_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">label_path</span><span class="p">,</span> <span class="n">img</span><span class="p">)</span>
                        <span class="n">new_img_name</span> <span class="o">=</span> <span class="n">user</span> <span class="o">+</span> <span class="s2">&quot;_&quot;</span> <span class="o">+</span> <span class="n">img</span>
                        <span class="n">new_img_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">new_label_path</span><span class="p">,</span> <span class="n">new_img_name</span><span class="p">)</span>
                        <span class="n">shutil</span><span class="o">.</span><span class="n">copy</span><span class="p">(</span><span class="n">img_path</span><span class="p">,</span> <span class="n">new_img_path</span><span class="p">)</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">root_data_path</span> <span class="o">=</span> <span class="s2">&quot;cross_silo_femnist/femnist/3500_clients_img&quot;</span>
    <span class="n">new_data_path</span> <span class="o">=</span> <span class="s2">&quot;cross_silo_femnist/femnist/35_7_client_img&quot;</span>
    <span class="n">raw_user_num</span> <span class="o">=</span> <span class="mi">35</span>
    <span class="n">new_user_num</span> <span class="o">=</span> <span class="mi">7</span>
    <span class="n">combine_users</span><span class="p">(</span><span class="n">root_data_path</span><span class="p">,</span> <span class="n">new_data_path</span><span class="p">,</span> <span class="n">raw_user_num</span><span class="p">,</span> <span class="n">new_user_num</span><span class="p">)</span>
</pre></div>
</div>
<p>where <code class="docutils literal notranslate"><span class="pre">root_data_path</span></code> is the path to the original 3500 user datasets, <code class="docutils literal notranslate"><span class="pre">new_data_path</span></code> is the path to the merged dataset, <code class="docutils literal notranslate"><span class="pre">raw_user_num</span></code> specifies the total number of user datasets to be merged (needs to be &lt;= 3500), and <code class="docutils literal notranslate"><span class="pre">new_user_num</span></code> is used to set the number of users merged by the original datasets. For example, the sample code will select the first 35 users from <code class="docutils literal notranslate"><span class="pre">cross_silo_femnist/femnist/3500_clients_img</span></code>, merge them into 7 user datasets and store them in the path <code class="docutils literal notranslate"><span class="pre">cross_silo_femnist/femnist/35_7_client_img</span></code> (the merged 7 users each contains the original 5 user dataset).</p>
<p>The following print represents a successful merge of the data sets.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="o">==========================</span><span class="w"> </span>combine<span class="w"> </span>the<span class="w"> </span>raw<span class="w"> </span><span class="m">0</span>~4<span class="w"> </span>users<span class="w"> </span>to<span class="w"> </span>the<span class="w"> </span>new<span class="w"> </span>user:<span class="w"> </span><span class="nv">dataset_0</span><span class="w"> </span><span class="o">==========================</span>
-------------<span class="w"> </span>process<span class="w"> </span>the<span class="w"> </span>raw<span class="w"> </span>user:<span class="w"> </span>f1798_42<span class="w"> </span>-------------
-------------<span class="w"> </span>process<span class="w"> </span>the<span class="w"> </span>raw<span class="w"> </span>user:<span class="w"> </span>f2149_81<span class="w"> </span>-------------
-------------<span class="w"> </span>process<span class="w"> </span>the<span class="w"> </span>raw<span class="w"> </span>user:<span class="w"> </span>f4046_46<span class="w"> </span>-------------
-------------<span class="w"> </span>process<span class="w"> </span>the<span class="w"> </span>raw<span class="w"> </span>user:<span class="w"> </span>f1093_13<span class="w"> </span>-------------
-------------<span class="w"> </span>process<span class="w"> </span>the<span class="w"> </span>raw<span class="w"> </span>user:<span class="w"> </span>f1124_24<span class="w"> </span>-------------
<span class="o">==========================</span><span class="w"> </span>combine<span class="w"> </span>the<span class="w"> </span>raw<span class="w"> </span><span class="m">5</span>~9<span class="w"> </span>users<span class="w"> </span>to<span class="w"> </span>the<span class="w"> </span>new<span class="w"> </span>user:<span class="w"> </span><span class="nv">dataset_1</span><span class="w"> </span><span class="o">==========================</span>
-------------<span class="w"> </span>process<span class="w"> </span>the<span class="w"> </span>raw<span class="w"> </span>user:<span class="w"> </span>f0586_11<span class="w"> </span>-------------
-------------<span class="w"> </span>process<span class="w"> </span>the<span class="w"> </span>raw<span class="w"> </span>user:<span class="w"> </span>f0721_31<span class="w"> </span>-------------
-------------<span class="w"> </span>process<span class="w"> </span>the<span class="w"> </span>raw<span class="w"> </span>user:<span class="w"> </span>f3527_33<span class="w"> </span>-------------
-------------<span class="w"> </span>process<span class="w"> </span>the<span class="w"> </span>raw<span class="w"> </span>user:<span class="w"> </span>f0146_33<span class="w"> </span>-------------
-------------<span class="w"> </span>process<span class="w"> </span>the<span class="w"> </span>raw<span class="w"> </span>user:<span class="w"> </span>f1272_09<span class="w"> </span>-------------
<span class="o">==========================</span><span class="w"> </span>combine<span class="w"> </span>the<span class="w"> </span>raw<span class="w"> </span><span class="m">10</span>~14<span class="w"> </span>users<span class="w"> </span>to<span class="w"> </span>the<span class="w"> </span>new<span class="w"> </span>user:<span class="w"> </span><span class="nv">dataset_2</span><span class="w"> </span><span class="o">==========================</span>
-------------<span class="w"> </span>process<span class="w"> </span>the<span class="w"> </span>raw<span class="w"> </span>user:<span class="w"> </span>f0245_40<span class="w"> </span>-------------
-------------<span class="w"> </span>process<span class="w"> </span>the<span class="w"> </span>raw<span class="w"> </span>user:<span class="w"> </span>f2363_77<span class="w"> </span>-------------
-------------<span class="w"> </span>process<span class="w"> </span>the<span class="w"> </span>raw<span class="w"> </span>user:<span class="w"> </span>f3596_19<span class="w"> </span>-------------
-------------<span class="w"> </span>process<span class="w"> </span>the<span class="w"> </span>raw<span class="w"> </span>user:<span class="w"> </span>f2418_82<span class="w"> </span>-------------
-------------<span class="w"> </span>process<span class="w"> </span>the<span class="w"> </span>raw<span class="w"> </span>user:<span class="w"> </span>f2288_58<span class="w"> </span>-------------
<span class="o">==========================</span><span class="w"> </span>combine<span class="w"> </span>the<span class="w"> </span>raw<span class="w"> </span><span class="m">15</span>~19<span class="w"> </span>users<span class="w"> </span>to<span class="w"> </span>the<span class="w"> </span>new<span class="w"> </span>user:<span class="w"> </span><span class="nv">dataset_3</span><span class="w"> </span><span class="o">==========================</span>
-------------<span class="w"> </span>process<span class="w"> </span>the<span class="w"> </span>raw<span class="w"> </span>user:<span class="w"> </span>f2249_75<span class="w"> </span>-------------
-------------<span class="w"> </span>process<span class="w"> </span>the<span class="w"> </span>raw<span class="w"> </span>user:<span class="w"> </span>f3681_31<span class="w"> </span>-------------
-------------<span class="w"> </span>process<span class="w"> </span>the<span class="w"> </span>raw<span class="w"> </span>user:<span class="w"> </span>f3766_48<span class="w"> </span>-------------
-------------<span class="w"> </span>process<span class="w"> </span>the<span class="w"> </span>raw<span class="w"> </span>user:<span class="w"> </span>f0537_35<span class="w"> </span>-------------
-------------<span class="w"> </span>process<span class="w"> </span>the<span class="w"> </span>raw<span class="w"> </span>user:<span class="w"> </span>f0614_14<span class="w"> </span>-------------
<span class="o">==========================</span><span class="w"> </span>combine<span class="w"> </span>the<span class="w"> </span>raw<span class="w"> </span><span class="m">20</span>~24<span class="w"> </span>users<span class="w"> </span>to<span class="w"> </span>the<span class="w"> </span>new<span class="w"> </span>user:<span class="w"> </span><span class="nv">dataset_4</span><span class="w"> </span><span class="o">==========================</span>
-------------<span class="w"> </span>process<span class="w"> </span>the<span class="w"> </span>raw<span class="w"> </span>user:<span class="w"> </span>f2302_58<span class="w"> </span>-------------
-------------<span class="w"> </span>process<span class="w"> </span>the<span class="w"> </span>raw<span class="w"> </span>user:<span class="w"> </span>f3472_19<span class="w"> </span>-------------
-------------<span class="w"> </span>process<span class="w"> </span>the<span class="w"> </span>raw<span class="w"> </span>user:<span class="w"> </span>f3327_11<span class="w"> </span>-------------
-------------<span class="w"> </span>process<span class="w"> </span>the<span class="w"> </span>raw<span class="w"> </span>user:<span class="w"> </span>f1892_07<span class="w"> </span>-------------
-------------<span class="w"> </span>process<span class="w"> </span>the<span class="w"> </span>raw<span class="w"> </span>user:<span class="w"> </span>f3184_11<span class="w"> </span>-------------
<span class="o">==========================</span><span class="w"> </span>combine<span class="w"> </span>the<span class="w"> </span>raw<span class="w"> </span><span class="m">25</span>~29<span class="w"> </span>users<span class="w"> </span>to<span class="w"> </span>the<span class="w"> </span>new<span class="w"> </span>user:<span class="w"> </span><span class="nv">dataset_5</span><span class="w"> </span><span class="o">==========================</span>
-------------<span class="w"> </span>process<span class="w"> </span>the<span class="w"> </span>raw<span class="w"> </span>user:<span class="w"> </span>f1692_18<span class="w"> </span>-------------
-------------<span class="w"> </span>process<span class="w"> </span>the<span class="w"> </span>raw<span class="w"> </span>user:<span class="w"> </span>f1473_30<span class="w"> </span>-------------
-------------<span class="w"> </span>process<span class="w"> </span>the<span class="w"> </span>raw<span class="w"> </span>user:<span class="w"> </span>f0909_04<span class="w"> </span>-------------
-------------<span class="w"> </span>process<span class="w"> </span>the<span class="w"> </span>raw<span class="w"> </span>user:<span class="w"> </span>f1956_19<span class="w"> </span>-------------
-------------<span class="w"> </span>process<span class="w"> </span>the<span class="w"> </span>raw<span class="w"> </span>user:<span class="w"> </span>f1234_26<span class="w"> </span>-------------
<span class="o">==========================</span><span class="w"> </span>combine<span class="w"> </span>the<span class="w"> </span>raw<span class="w"> </span><span class="m">30</span>~34<span class="w"> </span>users<span class="w"> </span>to<span class="w"> </span>the<span class="w"> </span>new<span class="w"> </span>user:<span class="w"> </span><span class="nv">dataset_6</span><span class="w"> </span><span class="o">==========================</span>
-------------<span class="w"> </span>process<span class="w"> </span>the<span class="w"> </span>raw<span class="w"> </span>user:<span class="w"> </span>f0031_02<span class="w"> </span>-------------
-------------<span class="w"> </span>process<span class="w"> </span>the<span class="w"> </span>raw<span class="w"> </span>user:<span class="w"> </span>f0300_24<span class="w"> </span>-------------
-------------<span class="w"> </span>process<span class="w"> </span>the<span class="w"> </span>raw<span class="w"> </span>user:<span class="w"> </span>f4064_46<span class="w"> </span>-------------
-------------<span class="w"> </span>process<span class="w"> </span>the<span class="w"> </span>raw<span class="w"> </span>user:<span class="w"> </span>f2439_77<span class="w"> </span>-------------
-------------<span class="w"> </span>process<span class="w"> </span>the<span class="w"> </span>raw<span class="w"> </span>user:<span class="w"> </span>f1717_16<span class="w"> </span>-------------
</pre></div>
</div>
<p>The following directory structure of the folder <code class="docutils literal notranslate"><span class="pre">cross_silo_femnist/femnist/35_7_client_img</span></code> is as follows:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>35_7_client_img  # Merge the 35 users in the FeMnist dataset into 7 client data (each containing 5 user data)
├── dataset_0  # The dataset of Client 0
│   ├── train   # Training dataset
│   │   ├── 0  # Store image data corresponding to category 0
│   │   ├── 1  # Store image data corresponding to category 1
│   │   │        ......
│   │   └── 61  # Store image data corresponding to category 61
│   └── test  # Test dataset，with the same directory structure as train
│              ......
│
└── dataset_6  # The dataset of Client 6
    ├── train   # Training dataset
    │   ├── 0  # Store image data corresponding to category 0
    │   ├── 1  # Store image data corresponding to category 1
    │   │        ......
    │   └── 61  # Store image data corresponding to category 61
    └── test  # Test dataset，with the same directory structure as train
</pre></div>
</div>
</section>
<section id="defining-the-network">
<h2>Defining the Network<a class="headerlink" href="#defining-the-network" title="Permalink to this headline"></a></h2>
<p>We choose the relatively simple LeNet network, which has seven layers without the input layer: two convolutional layers, two downsampling layers (pooling layers), and three fully connected layers. Each layer contains a different number of training parameters, as shown in the following figure:</p>
<p><img alt="LeNet5" src="https://gitee.com/mindspore/docs/raw/r2.0/docs/federated/docs/source_zh_cn/images/LeNet_5.jpg" /></p>
<blockquote>
<div><p>More information about LeNet network is not described herein. For more details, please refer to <a class="reference external" href="http://yann.lecun.com/exdb/lenet/">http://yann.lecun.com/exdb/lenet/</a>.</p>
</div></blockquote>
<p>The network used for this task can be found in the script <a class="reference external" href="https://gitee.com/mindspore/federated/blob/r0.1/example/cross_silo_femnist/test_cross_silo_femnist.py">test_cross_silo_femnist.py</a>.</p>
<p>For a specific understanding of the network definition process in MindSpore, please refer to <a class="reference external" href="https://www.mindspore.cn/tutorials/en/r2.0/beginner/quick_start.html#building-network">quick start</a>.</p>
</section>
<section id="launching-the-cross-silo-federated-task">
<h2>Launching the Cross-Silo Federated Task<a class="headerlink" href="#launching-the-cross-silo-federated-task" title="Permalink to this headline"></a></h2>
<section id="installing-mindspore-and-mindspore-federated">
<h3>Installing MindSpore and Mindspore Federated<a class="headerlink" href="#installing-mindspore-and-mindspore-federated" title="Permalink to this headline"></a></h3>
<p>Both source code and downloadable distribution are included. Support CPU, GPU, Ascend hardware platforms, just choose to install according to the hardware platforms. The installation steps can be found in <a class="reference external" href="https://www.mindspore.cn/install">MindSpore Installation Guide</a>, <a class="reference external" href="https://www.mindspore.cn/federated/docs/en/r0.1/federated_install.html">Mindspore Federated Installation Guide</a>.</p>
<p>Currently the federated learning framework is only supported for deployment in Linux environments. Cross-silo federated learning framework requires MindSpore version number &gt;= 1.5.0.</p>
</section>
<section id="launching-the-task">
<h3>Launching the Task<a class="headerlink" href="#launching-the-task" title="Permalink to this headline"></a></h3>
<p>Refer to <a class="reference external" href="https://gitee.com/mindspore/federated/tree/r0.1/example/cross_silo_femnist">Example</a> to launch cluster. The reference example directory structure is as follows.</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>cross_silo_femnist/
├── config.json # Configuration file
├── finish_cross_silo_femnist.py # Close the cross-silo federated task script
├── run_cross_silo_femnist_sched.py # Start cross-silo federated scheduler script
├── run_cross_silo_femnist_server.py # Start cross-silo federated server script
├── run_cross_silo_femnist_worker.py # Start cross-silo federated worker script
├── run_cross_silo_femnist_worker_distributed.py # Start the cloud Federation distributed training worker script
└── test_cross_silo_femnist.py # Training scripts used by the client
</pre></div>
</div>
<ol class="arabic">
<li><p>Start Scheduler</p>
<p><code class="docutils literal notranslate"><span class="pre">run_cross_silo_femnist_sched.py</span></code> is a Python script provided for the user to start the <code class="docutils literal notranslate"><span class="pre">Scheduler</span></code> and supports modifying the configuration via argument passing <code class="docutils literal notranslate"><span class="pre">argparse</span></code>. The following command is executed, representing the <code class="docutils literal notranslate"><span class="pre">Scheduler</span></code> that starts this federated learning task with TCP port <code class="docutils literal notranslate"><span class="pre">5554</span></code>.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>run_cross_silo_femnist_sched.py<span class="w"> </span>--scheduler_manage_address<span class="o">=</span><span class="m">127</span>.0.0.1:5554
</pre></div>
</div>
<p>The following print represents a successful start-up:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>FEDERATED<span class="o">(</span><span class="m">35566</span>,7f4275895740,python<span class="o">)</span>:2022-10-09-15:23:22.450.205<span class="w"> </span><span class="o">[</span>mindspore_federated/fl_arch/ccsrc/scheduler/scheduler.cc:35<span class="o">]</span><span class="w"> </span>Run<span class="o">]</span><span class="w"> </span>Scheduler<span class="w"> </span>started<span class="w"> </span>successfully.
<span class="o">[</span>INFO<span class="o">]</span><span class="w"> </span>FEDERATED<span class="o">(</span><span class="m">35566</span>,7f41f259d700,python<span class="o">)</span>:2022-10-09-15:23:22.450.357<span class="w"> </span><span class="o">[</span>mindspore_federated/fl_arch/ccsrc/common/communicator/http_request_handler.cc:90<span class="o">]</span><span class="w"> </span>Run<span class="o">]</span><span class="w"> </span>Start<span class="w"> </span>http<span class="w"> </span>server!
</pre></div>
</div>
</li>
<li><p>Start Server</p>
<p><code class="docutils literal notranslate"><span class="pre">run_cross_silo_femnist_server.py</span></code> is a Python script for the user to start a number of <code class="docutils literal notranslate"><span class="pre">Server</span></code>, and supports modify the configuration via argument passing <code class="docutils literal notranslate"><span class="pre">argparse</span></code>. The following command is executed, representing the <code class="docutils literal notranslate"><span class="pre">Server</span></code> that starts this federated learning task, with an http start port of <code class="docutils literal notranslate"><span class="pre">5555</span></code> and a number of <code class="docutils literal notranslate"><span class="pre">servers</span></code> of <code class="docutils literal notranslate"><span class="pre">4</span></code>.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="w"> </span>python<span class="w"> </span>run_cross_silo_femnist_server.py<span class="w"> </span>--local_server_num<span class="o">=</span><span class="m">4</span><span class="w"> </span>--http_server_address<span class="o">=</span><span class="m">10</span>.*.*.*:5555
</pre></div>
</div>
<p>The above command is equivalent to starting four <code class="docutils literal notranslate"><span class="pre">Server</span></code> processes, each with a federal learning service port of <code class="docutils literal notranslate"><span class="pre">5555</span></code>, <code class="docutils literal notranslate"><span class="pre">5556</span></code>, <code class="docutils literal notranslate"><span class="pre">5557</span></code> and <code class="docutils literal notranslate"><span class="pre">5558</span></code>.</p>
</li>
<li><p>Start Worker</p>
<p><code class="docutils literal notranslate"><span class="pre">run_cross_silo_femnist_worker.py</span></code> is a Python script for the user to start a number of <code class="docutils literal notranslate"><span class="pre">worker</span></code>, and supports modify the configuration via argument passing <code class="docutils literal notranslate"><span class="pre">argparse</span></code>. The following command is executed, representing the <code class="docutils literal notranslate"><span class="pre">worker</span></code> that starts this federated learning task, with an http start port of <code class="docutils literal notranslate"><span class="pre">5555</span></code> and a number of <code class="docutils literal notranslate"><span class="pre">worker</span></code> of <code class="docutils literal notranslate"><span class="pre">4</span></code>.</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>run_cross_silo_femnist_worker.py<span class="w"> </span>--dataset_path<span class="o">=</span>/data_nfs/code/fed_user_doc/federated/tests/st/cross_silo_femnist/35_7_client_img/<span class="w"> </span>--http_server_address<span class="o">=</span><span class="m">10</span>.*.*.*:5555
</pre></div>
</div>
<p>At present, the <code class="docutils literal notranslate"><span class="pre">worker</span></code> node of the cloud federation supports the distributed training mode of single machine multi-card and multi-machine multi-card. <code class="docutils literal notranslate"><span class="pre">run_cross_silo_femnist_worker_distributed.py</span></code> is a Python script provided for users to start the distributed training of <code class="docutils literal notranslate"><span class="pre">worker</span></code> node. It also supports the configuration modification through parameter argparse. Execute the following instructions, representing the distributed <code class="docutils literal notranslate"><span class="pre">worker</span></code> that starts this federated learning task, where <code class="docutils literal notranslate"><span class="pre">device_num</span></code> represents the number of processes started by the <code class="docutils literal notranslate"><span class="pre">worker</span></code> cluster, <code class="docutils literal notranslate"><span class="pre">run_distribute</span></code> represents the distributed training started by the cluster, and its http start port is <code class="docutils literal notranslate"><span class="pre">5555</span></code>. The number of <code class="docutils literal notranslate"><span class="pre">orker</span></code> processes is <code class="docutils literal notranslate"><span class="pre">4</span></code>:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>run_cross_silo_femnist_worker_distributed.py<span class="w"> </span>--device_num<span class="o">=</span><span class="m">4</span><span class="w"> </span>--run_distribute<span class="o">=</span>True<span class="w"> </span>--dataset_path<span class="o">=</span>/data_nfs/code/fed_user_doc/federated/tests/st/cross_silo_femnist/35_7_client_img/<span class="w"> </span>--http_server_address<span class="o">=</span><span class="m">10</span>.*.*.*:5555
</pre></div>
</div>
</li>
</ol>
<p>After executing the above three commands, go to the <code class="docutils literal notranslate"><span class="pre">worker_0</span></code> folder in the current directory and check the <code class="docutils literal notranslate"><span class="pre">worker_0</span></code> log with the command <code class="docutils literal notranslate"><span class="pre">grep</span> <span class="pre">-rn</span> <span class="pre">&quot;test</span> <span class="pre">acc&quot;</span> <span class="pre">*</span></code> and you will see a print similar to the following:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span><span class="nb">local</span><span class="w"> </span>epoch:<span class="w"> </span><span class="m">0</span>,<span class="w"> </span>loss:<span class="w"> </span><span class="m">3</span>.787421340711655,<span class="w"> </span>trian<span class="w"> </span>acc:<span class="w"> </span><span class="m">0</span>.05342741935483871,<span class="w"> </span><span class="nb">test</span><span class="w"> </span>acc:<span class="w"> </span><span class="m">0</span>.075
</pre></div>
</div>
<p>Then it means that cross-silo federated learning is started successfully and <code class="docutils literal notranslate"><span class="pre">worker_0</span></code> is training, other workers can be viewed in a similar way.</p>
<p>Please refer to <a class="reference external" href="https://www.mindspore.cn/federated/docs/zh-CN/r0.1/horizontal/federated_server_yaml.html">yaml configuration notes</a> for the description of parameter configuration in the above script.</p>
<p>If worker has been started in distributed multi-card training mode, enter the folder <code class="docutils literal notranslate"><span class="pre">worker_distributed/log_output/</span></code> in the current directory, and run the command <code class="docutils literal notranslate"><span class="pre">grep</span> <span class="pre">-rn</span> <span class="pre">&quot;test</span> <span class="pre">acc&quot;</span> <span class="pre">*</span></code> to view the log of <code class="docutils literal notranslate"><span class="pre">worker</span></code> distributed cluster. You can see the following print:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>local epoch: 0, loss: 2.3467453340711655, trian acc: 0.06532451988877687, test acc: 0.076
</pre></div>
</div>
</section>
<section id="viewing-log">
<h3>Viewing Log<a class="headerlink" href="#viewing-log" title="Permalink to this headline"></a></h3>
<p>After successfully starting the task, the corresponding log file will be generated under the current directory <code class="docutils literal notranslate"><span class="pre">cross_silo_femnist</span></code> with the following log file directory structure:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>cross_silo_femnist
├── scheduler
│   └── scheduler.log     # Print the log during running scheduler
├── server_0
│   └── server.log        # Print the log during running server_0
├── server_1
│   └── server.log        # Print the log during running server_1
├── server_2
│   └── server.log        # Print the log during running server_2
├── server_3
│   └── server.log        # Print the log during running server_3
├── worker_0
│   ├── ckpt              # Store the aggregated model ckpt obtained by worker_0 at the end of each federation learning iteration
│   │   ├── 0-fl-ms-bs32-0epoch.ckpt
│   │   ├── 0-fl-ms-bs32-1epoch.ckpt
│   │   │
│   │   │              ......
│   │   │
│   │   └── 0-fl-ms-bs32-19epoch.ckpt
│   └── worker.log        # Record the output logs when worker_0 participates in the federated learning task
└── worker_1
    ├── ckpt              # Store the aggregated model ckpt obtained by worker_1 at the end of each federation learning iteration
    │  ├── 1-fl-ms-bs32-0epoch.ckpt
    │  ├── 1-fl-ms-bs32-1epoch.ckpt
    │  │
    │  │                     ......
    │  │
    │  └── 1-fl-ms-bs32-19epoch.ckpt
    └── worker.log        # Record the output logs when worker_1 participates in the federated learning task
</pre></div>
</div>
</section>
<section id="closing-the-task">
<h3>Closing the Task<a class="headerlink" href="#closing-the-task" title="Permalink to this headline"></a></h3>
<p>If you want to exit in the middle, the following command is available:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>finish_cross_silo_femnist.py<span class="w"> </span>--redis_port<span class="o">=</span><span class="m">2345</span>
</pre></div>
</div>
<p>Or wait until the training task is finished and then the cluster will exit automatically, no need to close it manually.</p>
</section>
<section id="results">
<h3>Results<a class="headerlink" href="#results" title="Permalink to this headline"></a></h3>
<ul>
<li><p>Used data:</p>
<p>The <code class="docutils literal notranslate"><span class="pre">35_7_client_img/</span></code> dataset generated in the <code class="docutils literal notranslate"><span class="pre">download</span> <span class="pre">dataset</span></code> section above</p>
</li>
<li><p>The number of client-side local training epochs: 20</p></li>
<li><p>The total number of cross-silo federated learning iterations: 20</p></li>
<li><p>Results (accuracy of the model on the client’s test set after each iteration aggregation)</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">worker_0</span></code> result:</p>
<div class="highlight-sh notranslate"><div class="highlight"><pre><span></span>worker_0/worker.log:7409:local<span class="w"> </span>epoch:<span class="w"> </span><span class="m">0</span>,<span class="w"> </span>loss:<span class="w"> </span><span class="m">3</span>.787421340711655,<span class="w"> </span>trian<span class="w"> </span>acc:<span class="w"> </span><span class="m">0</span>.05342741935483871,<span class="w"> </span><span class="nb">test</span><span class="w"> </span>acc:<span class="w"> </span><span class="m">0</span>.075
worker_0/worker.log:14419:local<span class="w"> </span>epoch:<span class="w"> </span><span class="m">1</span>,<span class="w"> </span>loss:<span class="w"> </span><span class="m">3</span>.725699281115686,<span class="w"> </span>trian<span class="w"> </span>acc:<span class="w"> </span><span class="m">0</span>.05342741935483871,<span class="w"> </span><span class="nb">test</span><span class="w"> </span>acc:<span class="w"> </span><span class="m">0</span>.075
worker_0/worker.log:21429:local<span class="w"> </span>epoch:<span class="w"> </span><span class="m">2</span>,<span class="w"> </span>loss:<span class="w"> </span><span class="m">3</span>.5285709657335795,<span class="w"> </span>trian<span class="w"> </span>acc:<span class="w"> </span><span class="m">0</span>.19556451612903225,<span class="w"> </span><span class="nb">test</span><span class="w"> </span>acc:<span class="w"> </span><span class="m">0</span>.16875
worker_0/worker.log:28439:local<span class="w"> </span>epoch:<span class="w"> </span><span class="m">3</span>,<span class="w"> </span>loss:<span class="w"> </span><span class="m">3</span>.0393165519160608,<span class="w"> </span>trian<span class="w"> </span>acc:<span class="w"> </span><span class="m">0</span>.4889112903225806,<span class="w"> </span><span class="nb">test</span><span class="w"> </span>acc:<span class="w"> </span><span class="m">0</span>.4875
worker_0/worker.log:35449:local<span class="w"> </span>epoch:<span class="w"> </span><span class="m">4</span>,<span class="w"> </span>loss:<span class="w"> </span><span class="m">2</span>.575952764115026,<span class="w"> </span>trian<span class="w"> </span>acc:<span class="w"> </span><span class="m">0</span>.6854838709677419,<span class="w"> </span><span class="nb">test</span><span class="w"> </span>acc:<span class="w"> </span><span class="m">0</span>.60625
worker_0/worker.log:42459:local<span class="w"> </span>epoch:<span class="w"> </span><span class="m">5</span>,<span class="w"> </span>loss:<span class="w"> </span><span class="m">2</span>.2081101375296512,<span class="w"> </span>trian<span class="w"> </span>acc:<span class="w"> </span><span class="m">0</span>.7782258064516129,<span class="w"> </span><span class="nb">test</span><span class="w"> </span>acc:<span class="w"> </span><span class="m">0</span>.6875
worker_0/worker.log:49470:local<span class="w"> </span>epoch:<span class="w"> </span><span class="m">6</span>,<span class="w"> </span>loss:<span class="w"> </span><span class="m">1</span>.9229739431736557,<span class="w"> </span>trian<span class="w"> </span>acc:<span class="w"> </span><span class="m">0</span>.8054435483870968,<span class="w"> </span><span class="nb">test</span><span class="w"> </span>acc:<span class="w"> </span><span class="m">0</span>.69375
worker_0/worker.log:56480:local<span class="w"> </span>epoch:<span class="w"> </span><span class="m">7</span>,<span class="w"> </span>loss:<span class="w"> </span><span class="m">1</span>.7005576549999293,<span class="w"> </span>trian<span class="w"> </span>acc:<span class="w"> </span><span class="m">0</span>.8296370967741935,<span class="w"> </span><span class="nb">test</span><span class="w"> </span>acc:<span class="w"> </span><span class="m">0</span>.65625
worker_0/worker.log:63490:local<span class="w"> </span>epoch:<span class="w"> </span><span class="m">8</span>,<span class="w"> </span>loss:<span class="w"> </span><span class="m">1</span>.5248727620766704,<span class="w"> </span>trian<span class="w"> </span>acc:<span class="w"> </span><span class="m">0</span>.8407258064516129,<span class="w"> </span><span class="nb">test</span><span class="w"> </span>acc:<span class="w"> </span><span class="m">0</span>.6375
worker_0/worker.log:70500:local<span class="w"> </span>epoch:<span class="w"> </span><span class="m">9</span>,<span class="w"> </span>loss:<span class="w"> </span><span class="m">1</span>.3838803705352127,<span class="w"> </span>trian<span class="w"> </span>acc:<span class="w"> </span><span class="m">0</span>.8568548387096774,<span class="w"> </span><span class="nb">test</span><span class="w"> </span>acc:<span class="w"> </span><span class="m">0</span>.7
worker_0/worker.log:77510:local<span class="w"> </span>epoch:<span class="w"> </span><span class="m">10</span>,<span class="w"> </span>loss:<span class="w"> </span><span class="m">1</span>.265225578921041,<span class="w"> </span>trian<span class="w"> </span>acc:<span class="w"> </span><span class="m">0</span>.8679435483870968,<span class="w"> </span><span class="nb">test</span><span class="w"> </span>acc:<span class="w"> </span><span class="m">0</span>.7125
worker_0/worker.log:84520:local<span class="w"> </span>epoch:<span class="w"> </span><span class="m">11</span>,<span class="w"> </span>loss:<span class="w"> </span><span class="m">1</span>.167484122101638,<span class="w"> </span>trian<span class="w"> </span>acc:<span class="w"> </span><span class="m">0</span>.8659274193548387,<span class="w"> </span><span class="nb">test</span><span class="w"> </span>acc:<span class="w"> </span><span class="m">0</span>.70625
worker_0/worker.log:91530:local<span class="w"> </span>epoch:<span class="w"> </span><span class="m">12</span>,<span class="w"> </span>loss:<span class="w"> </span><span class="m">1</span>.082880981700859,<span class="w"> </span>trian<span class="w"> </span>acc:<span class="w"> </span><span class="m">0</span>.8770161290322581,<span class="w"> </span><span class="nb">test</span><span class="w"> </span>acc:<span class="w"> </span><span class="m">0</span>.65625
worker_0/worker.log:98540:local<span class="w"> </span>epoch:<span class="w"> </span><span class="m">13</span>,<span class="w"> </span>loss:<span class="w"> </span><span class="m">1</span>.0097520119572772,<span class="w"> </span>trian<span class="w"> </span>acc:<span class="w"> </span><span class="m">0</span>.8840725806451613,<span class="w"> </span><span class="nb">test</span><span class="w"> </span>acc:<span class="w"> </span><span class="m">0</span>.64375
worker_0/worker.log:105550:local<span class="w"> </span>epoch:<span class="w"> </span><span class="m">14</span>,<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.9469810053708015,<span class="w"> </span>trian<span class="w"> </span>acc:<span class="w"> </span><span class="m">0</span>.9022177419354839,<span class="w"> </span><span class="nb">test</span><span class="w"> </span>acc:<span class="w"> </span><span class="m">0</span>.7
worker_0/worker.log:112560:local<span class="w"> </span>epoch:<span class="w"> </span><span class="m">15</span>,<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.8907848935604703,<span class="w"> </span>trian<span class="w"> </span>acc:<span class="w"> </span><span class="m">0</span>.9022177419354839,<span class="w"> </span><span class="nb">test</span><span class="w"> </span>acc:<span class="w"> </span><span class="m">0</span>.6625
worker_0/worker.log:119570:local<span class="w"> </span>epoch:<span class="w"> </span><span class="m">16</span>,<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.8416629644123349,<span class="w"> </span>trian<span class="w"> </span>acc:<span class="w"> </span><span class="m">0</span>.9082661290322581,<span class="w"> </span><span class="nb">test</span><span class="w"> </span>acc:<span class="w"> </span><span class="m">0</span>.70625
worker_0/worker.log:126580:local<span class="w"> </span>epoch:<span class="w"> </span><span class="m">17</span>,<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.798475691030866,<span class="w"> </span>trian<span class="w"> </span>acc:<span class="w"> </span><span class="m">0</span>.9122983870967742,<span class="w"> </span><span class="nb">test</span><span class="w"> </span>acc:<span class="w"> </span><span class="m">0</span>.70625
worker_0/worker.log:133591:local<span class="w"> </span>epoch:<span class="w"> </span><span class="m">18</span>,<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.7599438544427897,<span class="w"> </span>trian<span class="w"> </span>acc:<span class="w"> </span><span class="m">0</span>.9243951612903226,<span class="w"> </span><span class="nb">test</span><span class="w"> </span>acc:<span class="w"> </span><span class="m">0</span>.6875
worker_0/worker.log:140599:local<span class="w"> </span>epoch:<span class="w"> </span><span class="m">19</span>,<span class="w"> </span>loss:<span class="w"> </span><span class="m">0</span>.7250227383907605,<span class="w"> </span>trian<span class="w"> </span>acc:<span class="w"> </span><span class="m">0</span>.9294354838709677,<span class="w"> </span><span class="nb">test</span><span class="w"> </span>acc:<span class="w"> </span><span class="m">0</span>.7125
</pre></div>
</div>
<p>The test results of other clients are basically the same, so the details are not listed herein.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="sentiment_classification_application.html" class="btn btn-neutral float-left" title="Implementing a Sentiment Classification Application (Android)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="object_detection_application_in_cross_silo.html" class="btn btn-neutral float-right" title="Implementing a Cross-Silo Federated Target Detection Application (x86)" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, MindSpore.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 
</body>
</html>