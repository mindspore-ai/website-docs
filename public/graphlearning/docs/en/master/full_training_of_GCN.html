<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Entire Graph Training Network &mdash; MindSpore master documentation</title><script>;(()=>{const e=localStorage.getItem("ms-theme"),t=window.matchMedia("(prefers-color-scheme: dark)").matches;(e?"dark"===e:t)&&document.documentElement.setAttribute("data-o-theme","dark")})();</script>
      <link rel="stylesheet" href="_static/css/bootstrap.min.css" type="text/css" /><link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script><script src="_static/jquery.js"></script>
        <script src="_static/js/theme.js"></script><script src="_static/underscore.js"></script><script src="_static/doctools.js"></script><script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Batched Graph Training Network" href="batched_graph_training_GIN.html" />
    <link rel="prev" title="Install Graph Learning" href="mindspore_graphlearning_install.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> MindSpore
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Deployment</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="mindspore_graphlearning_install.html">Install Graph Learning</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Guide</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Entire Graph Training Network</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#gcn-principles">GCN Principles</a></li>
<li class="toctree-l2"><a class="reference internal" href="#defining-a-network-model">Defining a Network Model</a></li>
<li class="toctree-l2"><a class="reference internal" href="#defining-a-loss-function">Defining a Loss Function</a></li>
<li class="toctree-l2"><a class="reference internal" href="#constructing-a-dataset">Constructing a Dataset</a></li>
<li class="toctree-l2"><a class="reference internal" href="#network-training-and-validation">Network Training and Validation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#setting-environment-variables">Setting Environment Variables</a></li>
<li class="toctree-l3"><a class="reference internal" href="#defining-a-training-network">Defining a Training Network</a></li>
<li class="toctree-l3"><a class="reference internal" href="#network-training-and-validation-1">Network Training and Validation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#executing-jobs-and-viewing-results">Executing Jobs and Viewing Results</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#running-process">Running Process</a></li>
<li class="toctree-l3"><a class="reference internal" href="#enabling-or-disabling-translation-display">Enabling or Disabling Translation Display</a></li>
<li class="toctree-l3"><a class="reference internal" href="#execution-results">Execution Results</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="batched_graph_training_GIN.html">Batched Graph Training Network</a></li>
<li class="toctree-l1"><a class="reference internal" href="spatio_temporal_graph_training_STGCN.html">Spatio-Temporal Graph Training Network</a></li>
<li class="toctree-l1"><a class="reference internal" href="single_host_distributed_Graphsage.html">Single-host Distributed Training</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="mindspore_gl.html">mindspore_gl</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindspore_gl.dataloader.html">mindspore_gl.dataloader</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindspore_gl.dataset.html">mindspore_gl.dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindspore_gl.graph.html">mindspore_gl.graph</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindspore_gl.nn.html">mindspore_gl.nn</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindspore_gl.sampling.html">mindspore_gl.sampling</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindspore_gl.utils.html">mindspore_gl.utils</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="faq.html">FAQ</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">RELEASE NOTES</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="RELEASE.html">Release Notes</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">MindSpore</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Entire Graph Training Network</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/full_training_of_GCN.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="entire-graph-training-network">
<h1>Entire Graph Training Network<a class="headerlink" href="#entire-graph-training-network" title="Permalink to this headline"></a></h1>
<p><a class="reference external" href="https://gitee.com/mindspore/docs/blob/master/docs/graphlearning/docs/source_en/full_training_of_GCN.md"><img alt="View Source On Gitee" src="https://mindspore-website.obs.cn-north-4.myhuaweicloud.com/website-images/master/resource/_static/logo_source_en.png" /></a>
  </p>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline"></a></h2>
<p>In this example, it will show how to do the semi-supervised classification with Graph Convolutional Networks in Cora Dataset.</p>
<p>Graph Convolutional Networks (GCN) was proposed in 2016 and designed to do semi-supervised learning on graph-structured data. A scalable approach based on an efficient variant of convolutional neural networks which operate directly on graphs was presented. The model scales linearly in the number of graph edges and learns hidden layer representations that encode both local graph structure and features of nodes.</p>
<p>The Cora dataset consists of 2708 scientific publications classified into one of seven classes. The citation network consists of 10556 links. Each publication in the dataset is described by a 0/1-valued word vector indicating the absence/presence of the corresponding word from the dictionary. The dictionary consists of 1433 unique words.</p>
<p>The classification of Cora’s literature is taken as the label,the word vector of the literature is taken as the node feature of GCN,and the reference of the literature is taken as the edge. The GCN is used to train the cora graph to predict which category the literature belongs to.</p>
<blockquote>
<div><p>Download the complete sample code here: <a class="reference external" href="https://gitee.com/mindspore/graphlearning/tree/master/examples/">GCN</a>.</p>
</div></blockquote>
</section>
<section id="gcn-principles">
<h2>GCN Principles<a class="headerlink" href="#gcn-principles" title="Permalink to this headline"></a></h2>
<p>Paper: <a class="reference external" href="https://arxiv.org/abs/1609.02907">Semi-Supervised Classification with Graph Convolutional Networks</a></p>
</section>
<section id="defining-a-network-model">
<h2>Defining a Network Model<a class="headerlink" href="#defining-a-network-model" title="Permalink to this headline"></a></h2>
<p>mindspore_gl.nn implements GCNConv, which can be directly imported for use. You can also define your own convolutional layer. The code for implementing a two-layer GCN network using GCNConv is as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mindspore</span>
<span class="kn">from</span> <span class="nn">mindspore_gl.nn</span> <span class="kn">import</span> <span class="n">GNNCell</span>
<span class="kn">from</span> <span class="nn">mindspore_gl</span> <span class="kn">import</span> <span class="n">Graph</span>
<span class="kn">from</span> <span class="nn">mindspore_gl.nn</span> <span class="kn">import</span> <span class="n">GCNConv</span>


<span class="k">class</span> <span class="nc">GCNNet</span><span class="p">(</span><span class="n">GNNCell</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span>
                 <span class="n">data_feat_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                 <span class="n">hidden_dim_size</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                 <span class="n">n_classes</span><span class="p">:</span> <span class="nb">int</span><span class="p">,</span>
                 <span class="n">dropout</span><span class="p">:</span> <span class="nb">float</span><span class="p">,</span>
                 <span class="n">activation</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layer0</span> <span class="o">=</span> <span class="n">GCNConv</span><span class="p">(</span><span class="n">data_feat_size</span><span class="p">,</span> <span class="n">hidden_dim_size</span><span class="p">,</span> <span class="n">activation</span><span class="p">(),</span> <span class="n">dropout</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">layer1</span> <span class="o">=</span> <span class="n">GCNConv</span><span class="p">(</span><span class="n">hidden_dim_size</span><span class="p">,</span> <span class="n">n_classes</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">dropout</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">construct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">in_deg</span><span class="p">,</span> <span class="n">out_deg</span><span class="p">,</span> <span class="n">g</span><span class="p">:</span> <span class="n">Graph</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">layer0</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">in_deg</span><span class="p">,</span> <span class="n">out_deg</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">layer1</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">in_deg</span><span class="p">,</span> <span class="n">out_deg</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">x</span>
</pre></div>
</div>
<p>GCNNet is inherited from GNNCell. The last input of the construct function in GNNCell must be a graph or BatchedGraph, that is, the graph structure class supported by MindSpore Graph Learning. In addition, you must import mindspore at the header of the file to identify the execution backend when the code is translated.</p>
<p>In GCNConv, data_feat_size indicates the feature dimension of the input node, hidden_dim_size indicates the feature dimension of the hidden layer, n_classes indicates the dimension of the output classification, and in_deg and out_deg indicate the indegree and outdegree of the node in the graph data, respectively.
For details about GCN implementation, see the <a class="reference external" href="https://gitee.com/mindspore/graphlearning/blob/master/mindspore_gl/nn/conv/gcnconv.py">API</a> code of mindspore_gl.nn.GCNConv.</p>
</section>
<section id="defining-a-loss-function">
<h2>Defining a Loss Function<a class="headerlink" href="#defining-a-loss-function" title="Permalink to this headline"></a></h2>
<p>Define LossNet, including a network backbone net and a loss function. In this example, mindspore.nn.SoftmaxCrossEntropyWithLogits is used to implement a cross entropy loss.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mindspore</span> <span class="k">as</span> <span class="nn">ms</span>
<span class="kn">import</span> <span class="nn">mindspore.nn</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="kn">import</span> <span class="nn">mindspore.ops</span> <span class="k">as</span> <span class="nn">ops</span>
<span class="kn">from</span> <span class="nn">mindspore_gl.nn</span> <span class="kn">import</span> <span class="n">GNNCell</span>


<span class="k">class</span> <span class="nc">LossNet</span><span class="p">(</span><span class="n">GNNCell</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot; LossNet definition &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">net</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">net</span> <span class="o">=</span> <span class="n">net</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">loss_fn</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">SoftmaxCrossEntropyWithLogits</span><span class="p">(</span><span class="n">sparse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">reduction</span><span class="o">=</span><span class="s1">&#39;none&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">construct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">in_deg</span><span class="p">,</span> <span class="n">out_deg</span><span class="p">,</span> <span class="n">train_mask</span><span class="p">,</span> <span class="n">target</span><span class="p">,</span> <span class="n">g</span><span class="p">:</span> <span class="n">Graph</span><span class="p">):</span>
        <span class="n">predict</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">net</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">in_deg</span><span class="p">,</span> <span class="n">out_deg</span><span class="p">,</span> <span class="n">g</span><span class="p">)</span>
        <span class="n">target</span> <span class="o">=</span> <span class="n">ops</span><span class="o">.</span><span class="n">Squeeze</span><span class="p">()(</span><span class="n">target</span><span class="p">)</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">loss_fn</span><span class="p">(</span><span class="n">predict</span><span class="p">,</span> <span class="n">target</span><span class="p">)</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="n">loss</span> <span class="o">*</span> <span class="n">train_mask</span>
        <span class="k">return</span> <span class="n">ms</span><span class="o">.</span><span class="n">ops</span><span class="o">.</span><span class="n">ReduceSum</span><span class="p">()(</span><span class="n">loss</span><span class="p">)</span> <span class="o">/</span> <span class="n">ms</span><span class="o">.</span><span class="n">ops</span><span class="o">.</span><span class="n">ReduceSum</span><span class="p">()(</span><span class="n">train_mask</span><span class="p">)</span>
</pre></div>
</div>
<p>In the preceding code, net can be transferred to GCNNet by constructing a LossNet instance. predict indicates the predicted value output by the net, and target indicates the actual value. Because the training is based on the entire graph, train_mask is used to obtain a part of the entire graph as the training data. Only this part of nodes are involved in the loss calculation.
LossNet and GCNNet are inherited from GNNCell.</p>
</section>
<section id="constructing-a-dataset">
<h2>Constructing a Dataset<a class="headerlink" href="#constructing-a-dataset" title="Permalink to this headline"></a></h2>
<p>The mindspore_gl.dataset directory contains some dataset class definitions for reference. You can directly read some common datasets. The following uses the CORA dataset as an example. Enter the data path to construct a data class.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mindspore_gl.dataset</span> <span class="kn">import</span> <span class="n">CoraV2</span>

<span class="n">ds</span> <span class="o">=</span> <span class="n">CoraV2</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">data_path</span><span class="p">)</span>
</pre></div>
</div>
<p>The <a class="reference external" href="https://data.dgl.ai/dataset/cora_v2.zip">Cora</a> data can be downloaded and decompressed to args.data_path.</p>
</section>
<section id="network-training-and-validation">
<h2>Network Training and Validation<a class="headerlink" href="#network-training-and-validation" title="Permalink to this headline"></a></h2>
<section id="setting-environment-variables">
<h3>Setting Environment Variables<a class="headerlink" href="#setting-environment-variables" title="Permalink to this headline"></a></h3>
<p>The settings of environment variables are the same as those for other MindSpore network training. Especially, if enable_graph_kernel is set to True, the graph kernel build optimization is enabled to accelerate the graph model training.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mindspore</span> <span class="k">as</span> <span class="nn">ms</span>

<span class="k">if</span> <span class="n">train_args</span><span class="o">.</span><span class="n">fuse</span><span class="p">:</span>
    <span class="n">ms</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="n">device_target</span><span class="o">=</span><span class="s2">&quot;GPU&quot;</span><span class="p">,</span> <span class="n">save_graphs</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">save_graphs_path</span><span class="o">=</span><span class="s2">&quot;./computational_graph/&quot;</span><span class="p">,</span>
                        <span class="n">mode</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">GRAPH_MODE</span><span class="p">,</span> <span class="n">enable_graph_kernel</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                        <span class="n">graph_kernel_flags</span><span class="o">=</span><span class="s2">&quot;--enable_expand_ops=Gather --enable_cluster_ops=TensorScatterAdd,&quot;</span>
                                           <span class="s2">&quot;UnsortedSegmentSum, GatherNd --enable_recompute_fusion=false &quot;</span>
                                           <span class="s2">&quot;--enable_parallel_fusion=true &quot;</span><span class="p">)</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">ms</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="n">device_target</span><span class="o">=</span><span class="s2">&quot;GPU&quot;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">PYNATIVE_MODE</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="defining-a-training-network">
<h3>Defining a Training Network<a class="headerlink" href="#defining-a-training-network" title="Permalink to this headline"></a></h3>
<p>Similar to other supervised learning models, in addition to the instantiation of the model body GCNNet and LossNet, the graph neural network training requires the definition of an optimizer. Here, mindspore.nn.Adam is used.
Input the LossNet instance and optimizer to mindspore.nn.TrainOneStepCell to construct a single-step training network train_net.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mindspore.nn</span> <span class="k">as</span> <span class="nn">nn</span>

<span class="n">net</span> <span class="o">=</span> <span class="n">GCNNet</span><span class="p">(</span><span class="n">data_feat_size</span><span class="o">=</span><span class="n">feature_size</span><span class="p">,</span>
             <span class="n">hidden_dim_size</span><span class="o">=</span><span class="n">train_args</span><span class="o">.</span><span class="n">num_hidden</span><span class="p">,</span>
             <span class="n">n_classes</span><span class="o">=</span><span class="n">ds</span><span class="o">.</span><span class="n">n_classes</span><span class="p">,</span>
             <span class="n">dropout</span><span class="o">=</span><span class="n">train_args</span><span class="o">.</span><span class="n">dropout</span><span class="p">,</span>
             <span class="n">activation</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">ELU</span><span class="p">)</span>
    <span class="n">optimizer</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">optim</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">net</span><span class="o">.</span><span class="n">trainable_params</span><span class="p">(),</span> <span class="n">learning_rate</span><span class="o">=</span><span class="n">train_args</span><span class="o">.</span><span class="n">lr</span><span class="p">,</span> <span class="n">weight_decay</span><span class="o">=</span><span class="n">train_args</span><span class="o">.</span><span class="n">weight_decay</span><span class="p">)</span>
    <span class="n">loss</span> <span class="o">=</span> <span class="n">LossNet</span><span class="p">(</span><span class="n">net</span><span class="p">)</span>
    <span class="n">train_net</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">TrainOneStepCell</span><span class="p">(</span><span class="n">loss</span><span class="p">,</span> <span class="n">optimizer</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="network-training-and-validation-1">
<h3>Network Training and Validation<a class="headerlink" href="#network-training-and-validation-1" title="Permalink to this headline"></a></h3>
<p>Because the entire graph is trained, one training step covers the entire dataset. Each epoch is one training step. Similarly, the verification node is obtained through test_mask. To calculate the verification accuracy, you only need to compare the verification node in the entire graph with the actual value label.
If the predicted value is consistent with the actual value, the verification is correct. The ratio of the number of correct nodes (count) to the total number of verification nodes is the verification accuracy.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">e</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">train_args</span><span class="o">.</span><span class="n">epochs</span><span class="p">):</span>
    <span class="n">beg</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">train_net</span><span class="o">.</span><span class="n">set_train</span><span class="p">()</span>
    <span class="n">train_loss</span> <span class="o">=</span> <span class="n">train_net</span><span class="p">()</span>
    <span class="n">end</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">dur</span> <span class="o">=</span> <span class="n">end</span> <span class="o">-</span> <span class="n">beg</span>
    <span class="k">if</span> <span class="n">e</span> <span class="o">&gt;=</span> <span class="n">warm_up</span><span class="p">:</span>
        <span class="n">total</span> <span class="o">=</span> <span class="n">total</span> <span class="o">+</span> <span class="n">dur</span>

    <span class="n">test_mask</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">test_mask</span>
    <span class="k">if</span> <span class="n">test_mask</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">net</span><span class="o">.</span><span class="n">set_train</span><span class="p">(</span><span class="kc">False</span><span class="p">)</span>
        <span class="n">out</span> <span class="o">=</span> <span class="n">net</span><span class="p">(</span><span class="n">ds</span><span class="o">.</span><span class="n">x</span><span class="p">,</span> <span class="n">ds</span><span class="o">.</span><span class="n">in_deg</span><span class="p">,</span> <span class="n">ds</span><span class="o">.</span><span class="n">out_deg</span><span class="p">,</span> <span class="n">ds</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="n">src_idx</span><span class="p">,</span> <span class="n">ds</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="n">dst_idx</span><span class="p">,</span> <span class="n">ds</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="n">n_nodes</span><span class="p">,</span> <span class="n">ds</span><span class="o">.</span><span class="n">g</span><span class="o">.</span><span class="n">n_edges</span><span class="p">)</span><span class="o">.</span><span class="n">asnumpy</span><span class="p">()</span>
        <span class="n">labels</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">y</span><span class="o">.</span><span class="n">asnumpy</span><span class="p">()</span>
        <span class="n">predict</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">argmax</span><span class="p">(</span><span class="n">out</span><span class="p">[</span><span class="n">test_mask</span><span class="p">],</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="n">label</span> <span class="o">=</span> <span class="n">labels</span><span class="p">[</span><span class="n">test_mask</span><span class="p">]</span>
        <span class="n">count</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">equal</span><span class="p">(</span><span class="n">predict</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span>
        <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Epoch time:</span><span class="si">{}</span><span class="s1"> ms Train loss </span><span class="si">{}</span><span class="s1"> Test acc:</span><span class="si">{}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">dur</span> <span class="o">*</span> <span class="mi">1000</span><span class="p">,</span> <span class="n">train_loss</span><span class="p">,</span>
                                                                  <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">count</span><span class="p">)</span> <span class="o">/</span> <span class="n">label</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
</section>
</section>
<section id="executing-jobs-and-viewing-results">
<h2>Executing Jobs and Viewing Results<a class="headerlink" href="#executing-jobs-and-viewing-results" title="Permalink to this headline"></a></h2>
<section id="running-process">
<h3>Running Process<a class="headerlink" href="#running-process" title="Permalink to this headline"></a></h3>
<p>After running the program, you can view the comparison diagram of all translated functions. By default, the construct function in GNNCell is translated. The following figure shows the GCNConv translation comparison. The left part is the GCNConv source code, and the right part is the translated code.
You can see the code implementation after the graph API is replaced by mindspore_gl. For example, the code implementation after the called graph aggregate function g.sum is replaced by Gather-Scatter.
It can be seen that the node-centric programming paradigm greatly reduces the amount of code implemented by the graph model.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
<span class="p">|</span><span class="w">    </span>def<span class="w"> </span>construct<span class="o">(</span>self,<span class="w"> </span>x,<span class="w"> </span>in_deg,<span class="w"> </span>out_deg,<span class="w"> </span>g:<span class="w"> </span>Graph<span class="o">)</span>:<span class="w">                                        </span><span class="m">1</span><span class="w">   </span><span class="o">||</span><span class="w">  </span><span class="m">1</span><span class="w">      </span>def<span class="w"> </span>construct<span class="o">(</span><span class="w">                                                                           </span><span class="p">|</span>
<span class="p">|</span><span class="w">                                                                                                  </span><span class="o">||</span><span class="w">             </span>self,<span class="w">                                                                                </span><span class="p">|</span>
<span class="p">|</span><span class="w">                                                                                                  </span><span class="o">||</span><span class="w">             </span>x,<span class="w">                                                                                   </span><span class="p">|</span>
<span class="p">|</span><span class="w">                                                                                                  </span><span class="o">||</span><span class="w">             </span>in_deg,<span class="w">                                                                              </span><span class="p">|</span>
<span class="p">|</span><span class="w">                                                                                                  </span><span class="o">||</span><span class="w">             </span>out_deg,<span class="w">                                                                             </span><span class="p">|</span>
<span class="p">|</span><span class="w">                                                                                                  </span><span class="o">||</span><span class="w">             </span>src_idx,<span class="w">                                                                             </span><span class="p">|</span>
<span class="p">|</span><span class="w">                                                                                                  </span><span class="o">||</span><span class="w">             </span>dst_idx,<span class="w">                                                                             </span><span class="p">|</span>
<span class="p">|</span><span class="w">                                                                                                  </span><span class="o">||</span><span class="w">             </span>n_nodes,<span class="w">                                                                             </span><span class="p">|</span>
<span class="p">|</span><span class="w">                                                                                                  </span><span class="o">||</span><span class="w">             </span>n_edges,<span class="w">                                                                             </span><span class="p">|</span>
<span class="p">|</span><span class="w">                                                                                                  </span><span class="o">||</span><span class="w">             </span><span class="nv">ver_subgraph_idx</span><span class="o">=</span>None,<span class="w">                                                               </span><span class="p">|</span>
<span class="p">|</span><span class="w">                                                                                                  </span><span class="o">||</span><span class="w">             </span><span class="nv">edge_subgraph_idx</span><span class="o">=</span>None,<span class="w">                                                              </span><span class="p">|</span>
<span class="p">|</span><span class="w">                                                                                                  </span><span class="o">||</span><span class="w">             </span><span class="nv">graph_mask</span><span class="o">=</span>None<span class="w">                                                                      </span><span class="p">|</span>
<span class="p">|</span><span class="w">                                                                                                  </span><span class="o">||</span><span class="w">         </span><span class="o">)</span>:<span class="w">                                                                                       </span><span class="p">|</span>
<span class="p">|</span><span class="w">                                                                                                  </span><span class="o">||</span><span class="w">  </span><span class="m">2</span><span class="w">          </span><span class="nv">SCATTER_ADD</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>ms.ops.TensorScatterAdd<span class="o">()</span><span class="w">                                              </span><span class="p">|</span>
<span class="p">|</span><span class="w">                                                                                                  </span><span class="o">||</span><span class="w">  </span><span class="m">3</span><span class="w">          </span><span class="nv">SCATTER_MAX</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>ms.ops.TensorScatterMax<span class="o">()</span><span class="w">                                              </span><span class="p">|</span>
<span class="p">|</span><span class="w">                                                                                                  </span><span class="o">||</span><span class="w">  </span><span class="m">4</span><span class="w">          </span><span class="nv">SCATTER_MIN</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>ms.ops.TensorScatterMin<span class="o">()</span><span class="w">                                              </span><span class="p">|</span>
<span class="p">|</span><span class="w">                                                                                                  </span><span class="o">||</span><span class="w">  </span><span class="m">5</span><span class="w">          </span><span class="nv">GATHER</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>ms.ops.Gather<span class="o">()</span><span class="w">                                                             </span><span class="p">|</span>
<span class="p">|</span><span class="w">                                                                                                  </span><span class="o">||</span><span class="w">  </span><span class="m">6</span><span class="w">          </span><span class="nv">ZEROS</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>ms.ops.Zeros<span class="o">()</span><span class="w">                                                               </span><span class="p">|</span>
<span class="p">|</span><span class="w">                                                                                                  </span><span class="o">||</span><span class="w">  </span><span class="m">7</span><span class="w">          </span><span class="nv">SHAPE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>ms.ops.Shape<span class="o">()</span><span class="w">                                                               </span><span class="p">|</span>
<span class="p">|</span><span class="w">                                                                                                  </span><span class="o">||</span><span class="w">  </span><span class="m">8</span><span class="w">          </span><span class="nv">RESHAPE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>ms.ops.Reshape<span class="o">()</span><span class="w">                                                           </span><span class="p">|</span>
<span class="p">|</span><span class="w">                                                                                                  </span><span class="o">||</span><span class="w">  </span><span class="m">9</span><span class="w">          </span><span class="nv">scatter_src_idx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>RESHAPE<span class="o">(</span>src_idx,<span class="w"> </span><span class="o">(</span>SHAPE<span class="o">(</span>src_idx<span class="o">)[</span><span class="m">0</span><span class="o">]</span>,<span class="w"> </span><span class="m">1</span><span class="o">))</span><span class="w">                           </span><span class="p">|</span>
<span class="p">|</span><span class="w">                                                                                                  </span><span class="o">||</span><span class="w">  </span><span class="m">10</span><span class="w">         </span><span class="nv">scatter_dst_idx</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>RESHAPE<span class="o">(</span>dst_idx,<span class="w"> </span><span class="o">(</span>SHAPE<span class="o">(</span>dst_idx<span class="o">)[</span><span class="m">0</span><span class="o">]</span>,<span class="w"> </span><span class="m">1</span><span class="o">))</span><span class="w">                           </span><span class="p">|</span>
<span class="p">|</span><span class="w">        </span><span class="nv">out_deg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>ms.ops.clip_by_value<span class="o">(</span>out_deg,<span class="w"> </span>self.min_clip,<span class="w"> </span>self.max_clip<span class="o">)</span><span class="w">                 </span><span class="m">2</span><span class="w">   </span><span class="o">||</span><span class="w">  </span><span class="m">11</span><span class="w">         </span><span class="nv">out_deg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>ms.ops.clip_by_value<span class="o">(</span>out_deg,<span class="w"> </span>self.min_clip,<span class="w"> </span>self.max_clip<span class="o">)</span><span class="w">                </span><span class="p">|</span>
<span class="p">|</span><span class="w">        </span><span class="nv">out_deg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>ms.ops.Reshape<span class="o">()(</span><span class="w">                                                           </span><span class="m">3</span><span class="w">   </span><span class="o">||</span><span class="w">  </span><span class="m">12</span><span class="w">         </span><span class="nv">out_deg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>ms.ops.Reshape<span class="o">()(</span><span class="w">                                                          </span><span class="p">|</span>
<span class="p">|</span><span class="w">            </span>ms.ops.Pow<span class="o">()(</span>out_deg,<span class="w"> </span>-0.5<span class="o">)</span>,<span class="w">                                                          </span><span class="o">||</span><span class="w">                 </span>ms.ops.Pow<span class="o">()(</span>out_deg,<span class="w"> </span>-0.5<span class="o">)</span>,<span class="w">                                                     </span><span class="p">|</span>
<span class="p">|</span><span class="w">            </span>ms.ops.Shape<span class="o">()(</span>out_deg<span class="o">)</span><span class="w"> </span>+<span class="w"> </span><span class="o">(</span><span class="m">1</span>,<span class="o">)</span><span class="w">                                                        </span><span class="o">||</span><span class="w">                 </span>ms.ops.Shape<span class="o">()(</span>out_deg<span class="o">)</span><span class="w"> </span>+<span class="w"> </span><span class="o">(</span><span class="m">1</span>,<span class="o">)</span><span class="w">                                                   </span><span class="p">|</span>
<span class="p">|</span><span class="w">        </span><span class="o">)</span><span class="w">                                                                                         </span><span class="o">||</span><span class="w">             </span><span class="o">)</span><span class="w">                                                                                    </span><span class="p">|</span>
<span class="p">|</span><span class="w">        </span><span class="nv">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>self.drop_out<span class="o">(</span>x<span class="o">)</span><span class="w">                                                                  </span><span class="m">4</span><span class="w">   </span><span class="o">||</span><span class="w">  </span><span class="m">13</span><span class="w">         </span><span class="nv">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>self.drop_out<span class="o">(</span>x<span class="o">)</span><span class="w">                                                                 </span><span class="p">|</span>
<span class="p">|</span><span class="w">        </span><span class="nv">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>ms.ops.Squeeze<span class="o">()(</span>x<span class="o">)</span><span class="w">                                                               </span><span class="m">5</span><span class="w">   </span><span class="o">||</span><span class="w">  </span><span class="m">14</span><span class="w">         </span><span class="nv">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>ms.ops.Squeeze<span class="o">()(</span>x<span class="o">)</span><span class="w">                                                              </span><span class="p">|</span>
<span class="p">|</span><span class="w">        </span><span class="nv">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>x<span class="w"> </span>*<span class="w"> </span>out_deg<span class="w">                                                                       </span><span class="m">6</span><span class="w">   </span><span class="o">||</span><span class="w">  </span><span class="m">15</span><span class="w">         </span><span class="nv">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>x<span class="w"> </span>*<span class="w"> </span>out_deg<span class="w">                                                                      </span><span class="p">|</span>
<span class="p">|</span><span class="w">        </span><span class="nv">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>self.fc<span class="o">(</span>x<span class="o">)</span><span class="w">                                                                        </span><span class="m">7</span><span class="w">   </span><span class="o">||</span><span class="w">  </span><span class="m">16</span><span class="w">         </span><span class="nv">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>self.fc<span class="o">(</span>x<span class="o">)</span><span class="w">                                                                       </span><span class="p">|</span>
<span class="p">|</span><span class="w">        </span>g.set_vertex_attr<span class="o">({</span><span class="s1">&#39;x&#39;</span>:<span class="w"> </span>x<span class="o">})</span><span class="w">                                                           </span><span class="m">8</span><span class="w">   </span><span class="o">||</span><span class="w">  </span><span class="m">17</span><span class="w">         </span><span class="nv">VERTEX_SHAPE</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>SHAPE<span class="o">(</span>x<span class="o">)[</span><span class="m">0</span><span class="o">]</span><span class="w">                                                           </span><span class="p">|</span>
<span class="p">|</span><span class="w">                                                                                                  </span><span class="o">||</span><span class="w">  </span><span class="m">18</span><span class="w">         </span>x,<span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span>x<span class="o">]</span><span class="w">                                                                             </span><span class="p">|</span>
<span class="p">|</span><span class="w">        </span><span class="k">for</span><span class="w"> </span>v<span class="w"> </span><span class="k">in</span><span class="w"> </span>g.dst_vertex:<span class="w">                                                                </span><span class="m">9</span><span class="w">   </span><span class="o">||</span><span class="w">                                                                                                  </span><span class="p">|</span>
<span class="p">|</span><span class="w">            </span>v.x<span class="w"> </span><span class="o">=</span><span class="w"> </span>g.sum<span class="o">([</span>u.x<span class="w"> </span><span class="k">for</span><span class="w"> </span>u<span class="w"> </span><span class="k">in</span><span class="w"> </span>v.innbs<span class="o">])</span><span class="w">                                               </span><span class="m">10</span><span class="w">  </span><span class="o">||</span><span class="w">  </span><span class="m">19</span><span class="w">         </span><span class="nv">SCATTER_INPUT_SNAPSHOT2</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>GATHER<span class="o">(</span>x,<span class="w"> </span>src_idx,<span class="w"> </span><span class="m">0</span><span class="o">)</span><span class="w">                                      </span><span class="p">|</span>
<span class="p">|</span><span class="w">                                                                                                  </span><span class="o">||</span><span class="w">  </span><span class="m">20</span><span class="w">         </span><span class="nv">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>SCATTER_ADD<span class="o">(</span><span class="w">                                                                     </span><span class="p">|</span>
<span class="p">|</span><span class="w">                                                                                                  </span><span class="o">||</span><span class="w">                 </span>ZEROS<span class="o">((</span>VERTEX_SHAPE,<span class="o">)</span><span class="w"> </span>+<span class="w"> </span>SHAPE<span class="o">(</span>SCATTER_INPUT_SNAPSHOT2<span class="o">)[</span><span class="m">1</span>:<span class="o">]</span>,<span class="w"> </span>ms.float32<span class="o">)</span>,<span class="w">         </span><span class="p">|</span>
<span class="p">|</span><span class="w">                                                                                                  </span><span class="o">||</span><span class="w">                 </span>scatter_dst_idx,<span class="w">                                                                 </span><span class="p">|</span>
<span class="p">|</span><span class="w">                                                                                                  </span><span class="o">||</span><span class="w">                 </span>SCATTER_INPUT_SNAPSHOT2<span class="w">                                                          </span><span class="p">|</span>
<span class="p">|</span><span class="w">                                                                                                  </span><span class="o">||</span><span class="w">             </span><span class="o">)</span><span class="w">                                                                                    </span><span class="p">|</span>
<span class="p">|</span><span class="w">        </span><span class="nv">in_deg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>ms.ops.clip_by_value<span class="o">(</span>in_deg,<span class="w"> </span>self.min_clip,<span class="w"> </span>self.max_clip<span class="o">)</span><span class="w">                   </span><span class="m">11</span><span class="w">  </span><span class="o">||</span><span class="w">  </span><span class="m">21</span><span class="w">         </span><span class="nv">in_deg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>ms.ops.clip_by_value<span class="o">(</span>in_deg,<span class="w"> </span>self.min_clip,<span class="w"> </span>self.max_clip<span class="o">)</span><span class="w">                  </span><span class="p">|</span>
<span class="p">|</span><span class="w">        </span><span class="nv">in_deg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>ms.ops.Reshape<span class="o">()(</span>ms.ops.Pow<span class="o">()(</span>in_deg,<span class="w"> </span>-0.5<span class="o">)</span>,<span class="w"> </span>ms.ops.Shape<span class="o">()(</span>in_deg<span class="o">)</span><span class="w"> </span>+<span class="w"> </span><span class="o">(</span><span class="m">1</span>,<span class="o">))</span><span class="w">  </span><span class="m">12</span><span class="w">  </span><span class="o">||</span><span class="w">  </span><span class="m">22</span><span class="w">         </span><span class="nv">in_deg</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>ms.ops.Reshape<span class="o">()(</span>ms.ops.Pow<span class="o">()(</span>in_deg,<span class="w"> </span>-0.5<span class="o">)</span>,<span class="w"> </span>ms.ops.Shape<span class="o">()(</span>in_deg<span class="o">)</span><span class="w"> </span>+<span class="w"> </span><span class="o">(</span><span class="m">1</span>,<span class="o">))</span><span class="w"> </span><span class="p">|</span>
<span class="p">|</span><span class="w">        </span><span class="nv">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="o">[</span>v.x<span class="w"> </span><span class="k">for</span><span class="w"> </span>v<span class="w"> </span><span class="k">in</span><span class="w"> </span>g.dst_vertex<span class="o">]</span><span class="w"> </span>*<span class="w"> </span>in_deg<span class="w">                                              </span><span class="m">13</span><span class="w">  </span><span class="o">||</span><span class="w">  </span><span class="m">23</span><span class="w">         </span><span class="nv">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>x<span class="w"> </span>*<span class="w"> </span>in_deg<span class="w">                                                                       </span><span class="p">|</span>
<span class="p">|</span><span class="w">        </span><span class="nv">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>x<span class="w"> </span>+<span class="w"> </span>self.bias<span class="w">                                                                     </span><span class="m">14</span><span class="w">  </span><span class="o">||</span><span class="w">  </span><span class="m">24</span><span class="w">         </span><span class="nv">x</span><span class="w"> </span><span class="o">=</span><span class="w"> </span>x<span class="w"> </span>+<span class="w"> </span>self.bias<span class="w">                                                                    </span><span class="p">|</span>
<span class="p">|</span><span class="w">        </span><span class="k">return</span><span class="w"> </span>x<span class="w">                                                                              </span><span class="m">15</span><span class="w">  </span><span class="o">||</span><span class="w">  </span><span class="m">25</span><span class="w">         </span><span class="k">return</span><span class="w"> </span>x<span class="w">                                                                             </span><span class="p">|</span>
--------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------
</pre></div>
</div>
</section>
<section id="enabling-or-disabling-translation-display">
<h3>Enabling or Disabling Translation Display<a class="headerlink" href="#enabling-or-disabling-translation-display" title="Permalink to this headline"></a></h3>
<p>The translation comparison show is displayed by default setting during code execution. To disable the comparison show is as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mindspore_gl.nn</span> <span class="kn">import</span> <span class="n">GNNCell</span>
<span class="n">GNNCell</span><span class="o">.</span><span class="n">disable_display</span><span class="p">()</span>
</pre></div>
</div>
<p>To change the display width (default: 200), code is as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mindspore_gl.nn</span> <span class="kn">import</span> <span class="n">GNNCell</span>
<span class="n">GNNCell</span><span class="o">.</span><span class="n">enable_display</span><span class="p">(</span><span class="n">screen_width</span><span class="o">=</span><span class="mi">350</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="execution-results">
<h3>Execution Results<a class="headerlink" href="#execution-results" title="Permalink to this headline"></a></h3>
<p>Run the <a class="reference external" href="https://gitee.com/mindspore/graphlearning/blob/master/examples/vc_gcn_datanet.py">vc_gcn_datanet.py</a> script to start training.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">cd</span><span class="w"> </span>examples
python<span class="w"> </span>vc_gcn_datanet.py<span class="w"> </span>--data-path<span class="o">={</span>path<span class="o">}</span><span class="w"> </span>--fuse<span class="o">=</span>True
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">{path}</span></code> indicates the dataset storage path.</p>
<p>The training result (of the last five epochs) is as follows:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>...
Epoch<span class="w"> </span><span class="m">196</span>,<span class="w"> </span>Train<span class="w"> </span>loss<span class="w"> </span><span class="m">0</span>.30630863,<span class="w"> </span>Test<span class="w"> </span>acc<span class="w"> </span><span class="m">0</span>.822
Epoch<span class="w"> </span><span class="m">197</span>,<span class="w"> </span>Train<span class="w"> </span>loss<span class="w"> </span><span class="m">0</span>.30918056,<span class="w"> </span>Test<span class="w"> </span>acc<span class="w"> </span><span class="m">0</span>.819
Epoch<span class="w"> </span><span class="m">198</span>,<span class="w"> </span>Train<span class="w"> </span>loss<span class="w"> </span><span class="m">0</span>.3299482,<span class="w"> </span>Test<span class="w"> </span>acc<span class="w"> </span><span class="m">0</span>.819
Epoch<span class="w"> </span><span class="m">199</span>,<span class="w"> </span>Train<span class="w"> </span>loss<span class="w"> </span><span class="m">0</span>.2945389,<span class="w"> </span>Test<span class="w"> </span>acc<span class="w"> </span><span class="m">0</span>.821
Epoch<span class="w"> </span><span class="m">200</span>,<span class="w"> </span>Train<span class="w"> </span>loss<span class="w"> </span><span class="m">0</span>.27628058,<span class="w"> </span>Test<span class="w"> </span>acc<span class="w"> </span><span class="m">0</span>.819
</pre></div>
</div>
<p>Accuracy verified on CORA: 0.82 (thesis: 0.815)</p>
<p>The preceding is the usage guide of the entire graph training. For more examples, see <a class="reference external" href="https://gitee.com/mindspore/graphlearning/tree/master/examples/">examples directory</a>.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="mindspore_graphlearning_install.html" class="btn btn-neutral float-left" title="Install Graph Learning" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="batched_graph_training_GIN.html" class="btn btn-neutral float-right" title="Batched Graph Training Network" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, MindSpore.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 
</body>
</html>