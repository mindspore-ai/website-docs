<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>benchmark &mdash; MindSpore Lite master documentation</title><script>;(()=>{const e=localStorage.getItem("ms-theme"),t=window.matchMedia("(prefers-color-scheme: dark)").matches;(e?"dark"===e:t)&&document.documentElement.setAttribute("data-o-theme","dark")})();</script>
      <link rel="stylesheet" href="../_static/css/bootstrap.min.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/lite.css" type="text/css" /><link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script><script src="../_static/jquery.js"></script>
        <script src="../_static/js/theme.js"></script><script src="../_static/underscore.js"></script><script src="../_static/doctools.js"></script><script src="../_static/js/lite.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="benchmark_train" href="benchmark_train_tool.html" />
    <link rel="prev" title="基准测试工具" href="benchmark.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> MindSpore Lite
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">获取MindSpore Lite</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="downloads.html">下载MindSpore Lite</a></li>
<li class="toctree-l1"><a class="reference internal" href="build.html">编译MindSpore Lite</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">快速入门</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../quick_start/one_hour_introduction.html">一小时入门</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quick_start/quick_start_cpp.html">体验C++极简推理Demo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quick_start/quick_start_server_inference_cpp.html">体验C++极简并发推理Demo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quick_start/quick_start_java.html">体验Java极简推理Demo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quick_start/quick_start_server_inference_java.html">体验Java极简并发推理Demo</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quick_start/quick_start.html">基于JNI接口的Android应用开发</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quick_start/image_segmentation.html">基于Java接口的Android应用开发</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quick_start/train_lenet.html">基于C++接口实现端侧训练</a></li>
<li class="toctree-l1"><a class="reference internal" href="../quick_start/train_lenet_java.html">基于Java接口实现端侧训练</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">端侧推理</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="converter_tool.html">推理模型转换</a></li>
<li class="toctree-l1"><a class="reference internal" href="post_training_quantization.html">训练后量化</a></li>
<li class="toctree-l1"><a class="reference internal" href="data_preprocessing.html">预处理数据</a></li>
<li class="toctree-l1"><a class="reference internal" href="runtime.html">执行推理</a></li>
<li class="toctree-l1"><a class="reference internal" href="micro.html">在MCU或小型系统上执行推理</a></li>
<li class="toctree-l1"><a class="reference internal" href="asic.html">专用芯片集成说明</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">端侧训练</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="converter_train.html">训练模型转换</a></li>
<li class="toctree-l1"><a class="reference internal" href="runtime_train.html">执行训练</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">服务端推理</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="runtime_server_inference.html">执行并发推理</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">第三方接入</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="register.html">自定义算子</a></li>
<li class="toctree-l1"><a class="reference internal" href="delegate.html">使用Delegate支持第三方AI框架接入</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">其他工具</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="benchmark.html">基准测试工具</a><ul class="current">
<li class="toctree-l2 current"><a class="current reference internal" href="#">benchmark</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#概述">概述</a></li>
<li class="toctree-l3"><a class="reference internal" href="#linux环境使用说明">Linux环境使用说明</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#环境准备">环境准备</a></li>
<li class="toctree-l4"><a class="reference internal" href="#参数说明">参数说明</a></li>
<li class="toctree-l4"><a class="reference internal" href="#使用示例">使用示例</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dump功能">Dump功能</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#windows环境使用说明">Windows环境使用说明</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#环境准备-1">环境准备</a></li>
<li class="toctree-l4"><a class="reference internal" href="#参数说明-1">参数说明</a></li>
<li class="toctree-l4"><a class="reference internal" href="#使用示例-1">使用示例</a></li>
<li class="toctree-l4"><a class="reference internal" href="#dump功能-1">Dump功能</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="benchmark_train_tool.html">benchmark_train</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="cropper_tool.html">静态库裁剪工具</a></li>
<li class="toctree-l1"><a class="reference internal" href="visual_tool.html">可视化工具</a></li>
<li class="toctree-l1"><a class="reference internal" href="obfuscator_tool.html">模型混淆工具</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">参考文档</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../architecture_lite.html">总体架构</a></li>
<li class="toctree-l1"><a class="reference internal" href="../operator_list_lite.html">Lite算子支持</a></li>
<li class="toctree-l1"><a class="reference internal" href="../operator_list_codegen.html">Codegen算子支持</a></li>
<li class="toctree-l1"><a class="reference internal" href="../model_lite.html">模型支持</a></li>
<li class="toctree-l1"><a class="reference internal" href="../troubleshooting_guide.html">问题定位指南</a></li>
<li class="toctree-l1"><a class="reference internal" href="../log.html">日志</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">RELEASE NOTES</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../RELEASE.html">Release Notes</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MindSpore Lite</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="benchmark.html">基准测试工具</a> &raquo;</li>
      <li>benchmark</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/use/benchmark_tool.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="benchmark">
<h1>benchmark<a class="headerlink" href="#benchmark" title="Permalink to this headline"></a></h1>
<p><a class="reference external" href="https://gitee.com/mindspore/docs/blob/r1.8/docs/lite/docs/source_zh_cn/use/benchmark_tool.md"><img alt="查看源文件" src="https://mindspore-website.obs.cn-north-4.myhuaweicloud.com/website-images/r1.8/resource/_static/logo_source.png" /></a></p>
<section id="概述">
<h2>概述<a class="headerlink" href="#概述" title="Permalink to this headline"></a></h2>
<p>转换模型后执行推理前，你可以使用Benchmark工具对MindSpore Lite模型进行基准测试。它不仅可以对MindSpore Lite模型前向推理执行耗时进行定量分析（性能），还可以通过指定模型输出进行可对比的误差分析（精度）。</p>
</section>
<section id="linux环境使用说明">
<h2>Linux环境使用说明<a class="headerlink" href="#linux环境使用说明" title="Permalink to this headline"></a></h2>
<section id="环境准备">
<h3>环境准备<a class="headerlink" href="#环境准备" title="Permalink to this headline"></a></h3>
<p>使用Benchmark工具，需要进行如下环境准备工作。</p>
<ul>
<li><p>编译：Benchmark工具代码在MindSpore源码的<code class="docutils literal notranslate"><span class="pre">mindspore/lite/tools/benchmark</span></code>目录中，参考构建文档中的<a class="reference external" href="https://www.mindspore.cn/lite/docs/zh-CN/r1.8/use/build.html#%E7%8E%AF%E5%A2%83%E8%A6%81%E6%B1%82">环境要求</a>和<a class="reference external" href="https://www.mindspore.cn/lite/docs/zh-CN/r1.8/use/build.html#%E7%BC%96%E8%AF%91%E7%A4%BA%E4%BE%8B">编译示例</a>执行编译。</p></li>
<li><p>运行：参考构建文档中的<a class="reference external" href="https://www.mindspore.cn/lite/docs/zh-CN/r1.8/use/build.html#%E7%BC%96%E8%AF%91%E9%80%89%E9%A1%B9">编译输出</a>，获得<code class="docutils literal notranslate"><span class="pre">benchmark</span></code>工具。</p></li>
<li><p>将推理需要的动态链接库加入环境变量LD_LIBRARY_PATH。</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span><span class="w"> </span><span class="nv">LD_LIBRARY_PATH</span><span class="o">=</span><span class="si">${</span><span class="nv">PACKAGE_ROOT_PATH</span><span class="si">}</span>/runtime/lib:<span class="si">${</span><span class="nv">LD_LIBRARY_PATH</span><span class="si">}</span>
</pre></div>
</div>
<p>其中${PACKAGE_ROOT_PATH}是编译得到的包解压后的根目录。</p>
</li>
</ul>
</section>
<section id="参数说明">
<h3>参数说明<a class="headerlink" href="#参数说明" title="Permalink to this headline"></a></h3>
<p>使用编译好的Benchmark工具进行模型的基准测试时，其命令格式如下所示。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>./benchmark [--modelFile=&lt;MODELFILE&gt;] [--accuracyThreshold=&lt;ACCURACYTHRESHOLD&gt;]
   [--cosineDistanceThreshold=&lt;COSINEDISTANCETHRESHOLD&gt;]
   [--benchmarkDataFile=&lt;BENCHMARKDATAFILE&gt;] [--benchmarkDataType=&lt;BENCHMARKDATATYPE&gt;]
   [--cpuBindMode=&lt;CPUBINDMODE&gt;] [--device=&lt;DEVICE&gt;] [--help]
   [--inDataFile=&lt;INDATAFILE&gt;] [--loopCount=&lt;LOOPCOUNT&gt;]
   [--numThreads=&lt;NUMTHREADS&gt;] [--warmUpLoopCount=&lt;WARMUPLOOPCOUNT&gt;]
   [--enableFp16=&lt;ENABLEFP16&gt;] [--timeProfiling=&lt;TIMEPROFILING&gt;]
   [--inputShapes=&lt;INPUTSHAPES&gt;] [--perfProfiling=&lt;PERFPROFILING&gt;]
            [--perfEvent=&lt;PERFEVENT&gt;]
</pre></div>
</div>
<p>下面提供详细的参数说明。</p>
<table class="colwidths-auto docutils align-default">
<thead>
<tr class="row-odd"><th class="head"><p>参数名</p></th>
<th class="head"><p>属性</p></th>
<th class="head"><p>功能描述</p></th>
<th class="head"><p>参数类型</p></th>
<th class="head"><p>默认值</p></th>
<th class="head"><p>取值范围</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">--modelFile=&lt;MODELPATH&gt;</span></code></p></td>
<td><p>必选</p></td>
<td><p>指定需要进行基准测试的MindSpore Lite模型文件路径。</p></td>
<td><p>String</p></td>
<td><p>null</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">--accuracyThreshold=&lt;ACCURACYTHRESHOLD&gt;</span></code></p></td>
<td><p>可选</p></td>
<td><p>指定准确度阈值。</p></td>
<td><p>Float</p></td>
<td><p>0.5</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">--cosineDistanceThreshold=&lt;COSINEDISTANCETHRESHOLD&gt;</span></code></p></td>
<td><p>可选</p></td>
<td><p>指定余弦距离阈值，只有指定该参数并且其值大于-1时，才会计算余弦距离。</p></td>
<td><p>Float</p></td>
<td><p>-1.1</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">--benchmarkDataFile=&lt;CALIBDATAPATH&gt;</span></code></p></td>
<td><p>可选</p></td>
<td><p>指定标杆数据的文件路径。标杆数据作为该测试模型的对比输出，是该测试模型使用相同输入并由其它深度学习框架前向推理而来。</p></td>
<td><p>String</p></td>
<td><p>null</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">--benchmarkDataType=&lt;CALIBDATATYPE&gt;</span></code></p></td>
<td><p>可选</p></td>
<td><p>指定标杆数据类型。</p></td>
<td><p>String</p></td>
<td><p>FLOAT</p></td>
<td><p>FLOAT、INT32、INT8、UINT8</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">--cpuBindMode=&lt;CPUBINDMODE&gt;</span></code></p></td>
<td><p>可选</p></td>
<td><p>指定模型推理程序运行时绑定的CPU核类型。</p></td>
<td><p>Integer</p></td>
<td><p>1</p></td>
<td><p>2：表示中核<br/>1：表示大核<br/>0：表示不绑定</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">--device=&lt;DEVICE&gt;</span></code></p></td>
<td><p>可选</p></td>
<td><p>指定模型推理程序运行的设备类型。</p></td>
<td><p>String</p></td>
<td><p>CPU</p></td>
<td><p>CPU、GPU、NPU、Ascend310</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">--help</span></code></p></td>
<td><p>可选</p></td>
<td><p>显示<code class="docutils literal notranslate"><span class="pre">benchmark</span></code>命令的帮助信息。</p></td>
<td><p>-</p></td>
<td><p>-</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">--inDataFile=&lt;INDATAPATH&gt;</span></code></p></td>
<td><p>可选</p></td>
<td><p>指定测试模型输入数据的文件路径。如果未设置，则使用随机输入。</p></td>
<td><p>String</p></td>
<td><p>null</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">--loopCount=&lt;LOOPCOUNT&gt;</span></code></p></td>
<td><p>可选</p></td>
<td><p>指定Benchmark工具进行基准测试时，测试模型的前向推理运行次数，其值为正整数。</p></td>
<td><p>Integer</p></td>
<td><p>10</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">--numThreads=&lt;NUMTHREADS&gt;</span></code></p></td>
<td><p>可选</p></td>
<td><p>指定模型推理程序运行的线程数。</p></td>
<td><p>Integer</p></td>
<td><p>2</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">--warmUpLoopCount=&lt;WARMUPLOOPCOUNT&gt;</span></code></p></td>
<td><p>可选</p></td>
<td><p>指定测试模型在执行基准测试运行轮数前进行的模型预热推理次数。</p></td>
<td><p>Integer</p></td>
<td><p>3</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">--enableFp16=&lt;FP16PIORITY&gt;</span></code></p></td>
<td><p>可选</p></td>
<td><p>指定是否优先使用float16算子。</p></td>
<td><p>Boolean</p></td>
<td><p>false</p></td>
<td><p>true, false</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">--timeProfiling=&lt;TIMEPROFILING&gt;</span></code></p></td>
<td><p>可选</p></td>
<td><p>性能验证时生效，指定是否使用TimeProfiler打印每个算子的耗时。</p></td>
<td><p>Boolean</p></td>
<td><p>false</p></td>
<td><p>true, false</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">--inputShapes=&lt;INPUTSHAPES&gt;</span></code></p></td>
<td><p>可选</p></td>
<td><p>指定输入维度，维度应该按照NHWC格式输入. 维度值之间用‘,’隔开，多个输入的维度之间用‘:’隔开</p></td>
<td><p>String</p></td>
<td><p>Null</p></td>
<td><p>-</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">--perfProfiling=&lt;PERFPROFILING&gt;</span></code></p></td>
<td><p>可选</p></td>
<td><p>CPU性能验证时生效，指定是否使用PerfProfiler打印每个算子的CPU性能，当timeProfiling为true时无效。目前仅支持aarch64 CPU。</p></td>
<td><p>Boolean</p></td>
<td><p>false</p></td>
<td><p>true, false</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">--perfEvent=&lt;PERFEVENT&gt;</span></code></p></td>
<td><p>可选</p></td>
<td><p>CPU性能验证时生效，指定PerfProfiler打印的CPU性能参数的具体内容，指定为CYCLE时，会打印算子的CPU周期数和指令条数；指定为CACHE时，会打印算子的缓存读取次数和缓存未命中次数；指定为STALL时，会打印CPU前端等待周期数和后端等待周期数。</p></td>
<td><p>String</p></td>
<td><p>CYCLE</p></td>
<td><p>CYCLE/CACHE/STALL</p></td>
</tr>
<tr class="row-odd"><td><p><code class="docutils literal notranslate"><span class="pre">--decryptKey=&lt;DECRYPTKEY&gt;</span></code></p></td>
<td><p>可选</p></td>
<td><p>用于解密文件的密钥，以十六进制字符表示。仅支持 AES-GCM，密钥长度仅支持16Byte。</p></td>
<td><p>String</p></td>
<td><p>null</p></td>
<td><p>注意密钥为十六进制表示的字符串，如密钥定义为<code class="docutils literal notranslate"><span class="pre">b'0123456789ABCDEF'</span></code>对应的十六进制表示为<code class="docutils literal notranslate"><span class="pre">30313233343536373839414243444546</span></code>，Linux平台用户可以使用<code class="docutils literal notranslate"><span class="pre">xxd</span></code>工具对字节表示的密钥进行十六进制表达转换。</p></td>
</tr>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">--cryptoLibPath=&lt;CRYPTOLIBPATH&gt;</span></code></p></td>
<td><p>可选</p></td>
<td><p>OpenSSL加密库crypto的路径</p></td>
<td><p>String</p></td>
<td><p>null</p></td>
<td><p>-</p></td>
</tr>
</tbody>
</table>
</section>
<section id="使用示例">
<h3>使用示例<a class="headerlink" href="#使用示例" title="Permalink to this headline"></a></h3>
<p>对于不同的MindSpore Lite模型，在使用Benchmark工具对其进行基准测试时，可通过设置不同的参数，实现对其不同的测试功能。主要分为性能测试和精度测试。</p>
<section id="性能测试">
<h4>性能测试<a class="headerlink" href="#性能测试" title="Permalink to this headline"></a></h4>
<p>Benchmark工具进行的性能测试主要的测试指标为模型单次前向推理的耗时。在性能测试任务中，不需要设置<code class="docutils literal notranslate"><span class="pre">benchmarkDataFile</span></code>等标杆数据参数。但是，可以设置<code class="docutils literal notranslate"><span class="pre">timeProfiling</span></code>选项参数，控制是否输出在某设备上模型网络层的耗时，<code class="docutils literal notranslate"><span class="pre">timeProfiling</span></code>默认为false，例如：</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./benchmark<span class="w"> </span>--modelFile<span class="o">=</span>/path/to/model.ms
</pre></div>
</div>
<p>这条命令使用随机输入，其他参数使用默认值。该命令执行后会输出如下统计信息，该信息显示了测试模型在运行指定推理轮数后所统计出的单次推理最短耗时、单次推理最长耗时和平均推理耗时。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Model = model.ms, numThreads = 2, MinRunTime = 72.228996 ms, MaxRuntime = 73.094002 ms, AvgRunTime = 72.556000 ms
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./benchmark<span class="w"> </span>--modelFile<span class="o">=</span>/path/to/model.ms<span class="w"> </span>--timeProfiling<span class="o">=</span><span class="nb">true</span>
</pre></div>
</div>
<p>这条命令使用随机输入，并且输出模型网络层的耗时信息，其他参数使用默认值。该命令执行后，模型网络层的耗时会输出如下统计信息，在该例中，该统计信息按照<code class="docutils literal notranslate"><span class="pre">opName</span></code>和<code class="docutils literal notranslate"><span class="pre">optype</span></code>两种划分方式分别显示，<code class="docutils literal notranslate"><span class="pre">opName</span></code>表示算子名，<code class="docutils literal notranslate"><span class="pre">optype</span></code>表示算子类别，<code class="docutils literal notranslate"><span class="pre">avg</span></code>表示该算子的平均单次运行时间，<code class="docutils literal notranslate"><span class="pre">percent</span></code>表示该算子运行耗时占所有算子运行总耗时的比例，<code class="docutils literal notranslate"><span class="pre">calledTimess</span></code>表示该算子的运行次数，<code class="docutils literal notranslate"><span class="pre">opTotalTime</span></code>表示该算子运行指定次数的总耗时。最后，<code class="docutils literal notranslate"><span class="pre">total</span> <span class="pre">time</span></code>和<code class="docutils literal notranslate"><span class="pre">kernel</span> <span class="pre">cost</span></code>分别显示了该模型单次推理的平均耗时和模型推理中所有算子的平均耗时之和。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>-----------------------------------------------------------------------------------------
opName                                                          avg(ms)         percent         calledTimess    opTotalTime
conv2d_1/convolution                                            2.264800        0.824012        10              22.648003
conv2d_2/convolution                                            0.223700        0.081390        10              2.237000
dense_1/BiasAdd                                                 0.007500        0.002729        10              0.075000
dense_1/MatMul                                                  0.126000        0.045843        10              1.260000
dense_1/Relu                                                    0.006900        0.002510        10              0.069000
max_pooling2d_1/MaxPool                                         0.035100        0.012771        10              0.351000
max_pooling2d_2/MaxPool                                         0.014300        0.005203        10              0.143000
max_pooling2d_2/MaxPool_nchw2nhwc_reshape_1/Reshape_0           0.006500        0.002365        10              0.065000
max_pooling2d_2/MaxPool_nchw2nhwc_reshape_1/Shape_0             0.010900        0.003966        10              0.109000
output/BiasAdd                                                  0.005300        0.001928        10              0.053000
output/MatMul                                                   0.011400        0.004148        10              0.114000
output/Softmax                                                  0.013300        0.004839        10              0.133000
reshape_1/Reshape                                               0.000900        0.000327        10              0.009000
reshape_1/Reshape/shape                                         0.009900        0.003602        10              0.099000
reshape_1/Shape                                                 0.002300        0.000837        10              0.023000
reshape_1/strided_slice                                         0.009700        0.003529        10              0.097000
-----------------------------------------------------------------------------------------
opType          avg(ms)         percent         calledTimess    opTotalTime
Activation      0.006900        0.002510        10              0.069000
BiasAdd         0.012800        0.004657        20              0.128000
Conv2D          2.488500        0.905401        20              24.885004
MatMul          0.137400        0.049991        20              1.374000
Nchw2Nhwc       0.017400        0.006331        20              0.174000
Pooling         0.049400        0.017973        20              0.494000
Reshape         0.000900        0.000327        10              0.009000
Shape           0.002300        0.000837        10              0.023000
SoftMax         0.013300        0.004839        10              0.133000
Stack           0.009900        0.003602        10              0.099000
StridedSlice    0.009700        0.003529        10              0.097000

total time :     2.90800 ms,    kernel cost : 2.74851 ms

-----------------------------------------------------------------------------------------
</pre></div>
</div>
</section>
<section id="精度测试">
<h4>精度测试<a class="headerlink" href="#精度测试" title="Permalink to this headline"></a></h4>
<p>Benchmark工具进行的精度测试主要是通过设置标杆数据来对比验证MindSpore Lite模型输出的精确性。在精确度测试任务中，除了需要设置<code class="docutils literal notranslate"><span class="pre">modelFile</span></code>参数以外，还必须设置<code class="docutils literal notranslate"><span class="pre">benchmarkDataFile</span></code>参数。例如：</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./benchmark<span class="w"> </span>--modelFile<span class="o">=</span>/path/to/model.ms<span class="w"> </span>--inDataFile<span class="o">=</span>/path/to/input.bin<span class="w"> </span>--device<span class="o">=</span>CPU<span class="w"> </span>--accuracyThreshold<span class="o">=</span><span class="m">3</span><span class="w"> </span>--benchmarkDataFile<span class="o">=</span>/path/to/output.out
</pre></div>
</div>
<p>这条命令指定了测试模型的输入数据、标杆数据（默认的输入及标杆数据类型均为float32），同时指定了模型推理程序在CPU上运行，并指定了准确度阈值为3%。该命令执行后会输出如下统计信息，该信息显示了测试模型的单条输入数据、输出节点的输出结果和平均偏差率以及所有节点的平均偏差率。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>InData0: 139.947 182.373 153.705 138.945 108.032 164.703 111.585 227.402 245.734 97.7776 201.89 134.868 144.851 236.027 18.1142 22.218 5.15569 212.318 198.43 221.853
================ Comparing Output data ================
Data of node age_out : 5.94584e-08 6.3317e-08 1.94726e-07 1.91809e-07 8.39805e-08 7.66035e-08 1.69285e-07 1.46246e-07 6.03796e-07 1.77631e-07 1.54343e-07 2.04623e-07 8.89609e-07 3.63487e-06 4.86876e-06 1.23939e-05 3.09981e-05 3.37098e-05 0.000107102 0.000213932 0.000533579 0.00062465 0.00296401 0.00993984 0.038227 0.0695085 0.162854 0.123199 0.24272 0.135048 0.169159 0.0221256 0.013892 0.00502971 0.00134921 0.00135701 0.000383242 0.000163475 0.000136294 9.77864e-05 8.00793e-05 5.73874e-05 3.53858e-05 2.18535e-05 2.04467e-05 1.85286e-05 1.05075e-05 9.34751e-06 6.12732e-06 4.55476e-06
Mean bias of node age_out : 0%
Mean bias of all nodes: 0%
=======================================================
</pre></div>
</div>
<p>如果需要指定输入数据的维度（例如输入维度为1，32，32，1），使用如下命令：</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./benchmark<span class="w"> </span>--modelFile<span class="o">=</span>/path/to/model.ms<span class="w"> </span>--inDataFile<span class="o">=</span>/path/to/input.bin<span class="w"> </span>--inputShapes<span class="o">=</span><span class="m">1</span>,32,32,1<span class="w"> </span>--device<span class="o">=</span>CPU<span class="w"> </span>--accuracyThreshold<span class="o">=</span><span class="m">3</span><span class="w"> </span>--benchmarkDataFile<span class="o">=</span>/path/to/output.out
</pre></div>
</div>
</section>
<section id="cpu性能测试">
<h4>CPU性能测试<a class="headerlink" href="#cpu性能测试" title="Permalink to this headline"></a></h4>
<p>Benchmark工具进行的CPU性能测试主要的测试指标为模型单次前向推理CPU性能参数(目前只支持aarch64 CPU)，包括周期数和指令数、缓存读取次数和缓存未命中次数、CPU前端和后端等待时间。在CPU性能测试任务中，不需要设置<code class="docutils literal notranslate"><span class="pre">benchmarkDataFile</span></code>等标杆数据参数。但是，可以设置<code class="docutils literal notranslate"><span class="pre">perfProfiling</span></code>与<code class="docutils literal notranslate"><span class="pre">perfEvent</span></code>选项参数，控制输出在某设备上模型网络层的哪些CPU性能参数，<code class="docutils literal notranslate"><span class="pre">perfProfiling</span></code>默认为false，<code class="docutils literal notranslate"><span class="pre">perfEvent</span></code>默认为<code class="docutils literal notranslate"><span class="pre">CYCLE</span></code>(CPU周期数和指令数)。由于多线程的读数波动较大，建议设置线程数为1。使用方法如下：</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./benchmark<span class="w"> </span>--modelFile<span class="o">=</span>/path/to/model.ms<span class="w"> </span>--perfProfiling<span class="o">=</span><span class="nb">true</span><span class="w"> </span>--numThreads<span class="o">=</span><span class="m">1</span>
</pre></div>
</div>
<p>这条命令使用随机输入，并且输出模型网络层的周期数/指令数信息，其他参数使用默认值。该命令执行后，会输出如下CPU性能参数统计信息，在该例中，该统计信息按照<code class="docutils literal notranslate"><span class="pre">opName</span></code>和<code class="docutils literal notranslate"><span class="pre">optype</span></code>两种划分方式分别显示，<code class="docutils literal notranslate"><span class="pre">opName</span></code>表示算子名，<code class="docutils literal notranslate"><span class="pre">optype</span></code>表示算子类别，<code class="docutils literal notranslate"><span class="pre">cycles(k)</span></code>表示该算子的平均CPU周期数（以k为单位，受CPU频率影响），<code class="docutils literal notranslate"><span class="pre">cycles(%)</span></code>表示该算子CPU周期数占所有算子CPU周期数的比例，<code class="docutils literal notranslate"><span class="pre">ins(k)</span></code>表示该算子的指令数（以k为单位），<code class="docutils literal notranslate"><span class="pre">ins(%)</span></code>表示该算子的指令数占所有算子指令数的比例。最后会显示当前模型、线程数、最小运行时间、最大运行时间、平均运行时间用做参考。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>-----------------------------------------------------------------------------------------
opName                                                   cycles(k)       cycles(%)       ins(k)          ins(%)
Add_Plus214_Output_0                                     1.53            0.006572        1.27            0.002148
Conv_Convolution110_Output_0                             91.12           0.390141        217.58          0.369177
Conv_COnvolution28_Output_0                              114.61          0.490704        306.28          0.519680
Matmul_Times212_Output_0                                 8.75            0.037460        15.55           0.026385
MaxPool_Pooling160_Output_0                              3.24            0.013873        8.70            0.014767
MaxPool_Pooling66_Output_0                               11.63           0.049780        35.17           0.059671
Reshape_Pooling160_Output_0_reshape0                     0.91            0.003899        1.58            0.002677
nhwc2nchw_MaxPool_Pooling160_Output_0_post8_0            1.77            0.007571        3.25            0.005508
-----------------------------------------------------------------------------------------
opType          cycles(k)       cycles(%)       ins(k)          ins(%)
Add             1.53            0.006572        1.27            0.002148
Conv2D          205.73          0.880845        523.85          0.888856
MatMul          8.75            0.037460        15.55           0.026385
Nhwc2nchw       1.77            0.007571        3.25            0.005508
Pooling         14.87           0.063654        43.87           0.074437
Reshape         0.91            0.003839        1.58            0.002677

Model = model.ms, NumThreads = 1, MinRunTime = 0.104000 ms, MaxRunTime = 0.179000 ms, AvgRunTime = 0.116000 ms

-----------------------------------------------------------------------------------------
</pre></div>
</div>
<p>当<code class="docutils literal notranslate"><span class="pre">perfEvent</span></code>参数被指定为<code class="docutils literal notranslate"><span class="pre">CACHE</span></code>时，列标题会变为<code class="docutils literal notranslate"><span class="pre">cache</span> <span class="pre">ref(k)</span></code>/<code class="docutils literal notranslate"><span class="pre">cache</span> <span class="pre">ref(%)</span></code>/<code class="docutils literal notranslate"><span class="pre">miss(k)</span></code>/<code class="docutils literal notranslate"><span class="pre">miss(%)</span></code>，分别代表算子缓存读取次数/缓存读取占比/缓存未命中次数/缓存未命中次数占比；当<code class="docutils literal notranslate"><span class="pre">perfEvent</span></code>参数被指定为<code class="docutils literal notranslate"><span class="pre">STALL</span></code>时，列标题会变为<code class="docutils literal notranslate"><span class="pre">frontend(k)</span></code>/<code class="docutils literal notranslate"><span class="pre">frontend(%)</span></code>/<code class="docutils literal notranslate"><span class="pre">backend(k)</span></code>/<code class="docutils literal notranslate"><span class="pre">backend(%)</span></code>，分别代表CPU前端等待时间/CPU前端等待时间占比/CPU后端等待时间/CPU后端等待时间数占比。使用方法如下：</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./benchmark<span class="w"> </span>--modelFile<span class="o">=</span>/path/to/model.ms<span class="w"> </span>--perfProfiling<span class="o">=</span><span class="nb">true</span><span class="w"> </span>--perfEvent<span class="o">=</span><span class="s2">&quot;CACHE&quot;</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./benchmark<span class="w"> </span>--modelFile<span class="o">=</span>/path/to/model.ms<span class="w"> </span>--perfProfiling<span class="o">=</span><span class="nb">true</span><span class="w"> </span>--perfEvent<span class="o">=</span><span class="s2">&quot;STALL&quot;</span>
</pre></div>
</div>
</section>
</section>
<section id="dump功能">
<h3>Dump功能<a class="headerlink" href="#dump功能" title="Permalink to this headline"></a></h3>
<p>Benchmark工具提供Dump功能（目前仅支持<code class="docutils literal notranslate"><span class="pre">CPU</span></code>算子），将模型中的算子的输入输出数据保存到磁盘文件中，可用于定位模型推理过程中精度异常的问题。</p>
<section id="dump操作步骤">
<h4>Dump操作步骤<a class="headerlink" href="#dump操作步骤" title="Permalink to this headline"></a></h4>
<ol class="arabic">
<li><p>创建json格式的配置文件，JSON文件的名称和位置可以自定义设置。</p>
<div class="highlight-json notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
<span class="w">    </span><span class="nt">&quot;common_dump_settings&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
<span class="w">        </span><span class="nt">&quot;dump_mode&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;path&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;/absolute_path&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;net_name&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;ResNet50&quot;</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;input_output&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span>
<span class="w">        </span><span class="nt">&quot;kernels&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;Default/Conv-op12&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;Default/Conv-op13&quot;</span><span class="p">]</span>
<span class="w">    </span><span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">dump_mode</span></code>：设置成0，表示Dump出该网络中的所有算子数据；设置成1，表示Dump<code class="docutils literal notranslate"><span class="pre">&quot;kernels&quot;</span></code>里面指定的算子数据。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">path</span></code>：Dump保存数据的绝对路径。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">net_name</span></code>：自定义的网络名称，例如：”ResNet50”，未指定该字段的话，默认值为”default”。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">input_output</span></code>：设置成0，表示Dump出算子的输入和算子的输出；设置成1，表示Dump出算子的输入；设置成2，表示Dump出算子的输出。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">kernels</span></code>：算子的名称列表。如果未指定此字段或者此字段的值设置为[]，<code class="docutils literal notranslate"><span class="pre">&quot;dump_mode&quot;</span></code>须设置为0；否则<code class="docutils literal notranslate"><span class="pre">&quot;dump_mode&quot;</span></code>的值须设置为1。</p></li>
</ul>
</li>
<li><p>设置Dump环境变量，指定Dump的json配置文件。</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span><span class="w"> </span><span class="nv">MINDSPORE_DUMP_CONFIG</span><span class="o">=</span><span class="si">${</span><span class="nv">xxx</span><span class="si">}</span>
</pre></div>
</div>
<p>其中”xxx”为配置文件的绝对路径，如：</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span><span class="w"> </span><span class="nv">MINDSPORE_DUMP_CONFIG</span><span class="o">=</span>/path/to/data_dump.json
</pre></div>
</div>
<p>注意：</p>
<ul class="simple">
<li><p>需要在执行benchmark之前，设置好环境变量，benchmark执行过程中设置将会不生效。</p></li>
</ul>
</li>
</ol>
</section>
<section id="dump数据目录结构">
<h4>Dump数据目录结构<a class="headerlink" href="#dump数据目录结构" title="Permalink to this headline"></a></h4>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>{path}/
    - {net_name}/
        - {folder_id}/
            {op_name}_{input_output_index}_{shape}_{data_type}_{format}.bin
        ...
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">path</span></code>：<code class="docutils literal notranslate"><span class="pre">data_dump.json</span></code>配置文件中设置的绝对路径。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">net_name</span></code>：<code class="docutils literal notranslate"><span class="pre">data_dump.json</span></code>配置文件中设置的网络名称。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">folder_id</span></code>：默认创建编号为0的文件夹，每执行一次benchmark程序，该文件夹编号加1，以此类推，最多支持的文件夹数量为1000。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">op_name</span></code>：算子名称。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">input_output_index</span></code>：输入或输出标号，例如<code class="docutils literal notranslate"><span class="pre">output_0</span></code>表示该文件是该算子的第1个输出Tensor的数据。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">data_type</span></code>：数据类型。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">shape</span></code>：形状信息。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">format</span></code>: 数据格式。</p></li>
</ul>
<p>Dump生成的数据文件是后缀名为<code class="docutils literal notranslate"><span class="pre">.bin</span></code>的二进制文件，可以用Numpy的<code class="docutils literal notranslate"><span class="pre">np.fromfile()</span></code>接口读取数据，以数据类型为float32的bin文件为例：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">np</span><span class="o">.</span><span class="n">fromfile</span><span class="p">(</span><span class="s2">&quot;/path/to/dump.bin&quot;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
</section>
<section id="windows环境使用说明">
<h2>Windows环境使用说明<a class="headerlink" href="#windows环境使用说明" title="Permalink to this headline"></a></h2>
<section id="环境准备-1">
<h3>环境准备<a class="headerlink" href="#环境准备-1" title="Permalink to this headline"></a></h3>
<p>使用Benchmark工具，需要进行如下环境准备工作。</p>
<ul>
<li><p>编译：Benchmark工具代码在MindSpore源码的<code class="docutils literal notranslate"><span class="pre">mindspore/lite/tools/benchmark</span></code>目录中，参考构建文档中的<a class="reference external" href="https://www.mindspore.cn/lite/docs/zh-CN/r1.8/use/build.html#%E7%8E%AF%E5%A2%83%E8%A6%81%E6%B1%82-1">环境要求</a>和<a class="reference external" href="https://www.mindspore.cn/lite/docs/zh-CN/r1.8/use/build.html#%E7%BC%96%E8%AF%91%E7%A4%BA%E4%BE%8B-1">编译示例</a>执行编译。</p></li>
<li><p>将推理需要的动态链接库加入环境变量PATH。</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">set</span><span class="w"> </span><span class="nv">PATH</span><span class="o">=</span>%PACKAGE_ROOT_PATH%<span class="se">\r</span>untime<span class="se">\l</span>ib<span class="p">;</span>%PATH%
</pre></div>
</div>
<p>其中%PACKAGE_ROOT_PATH%是编译得到的包解压后的根目录。</p>
</li>
</ul>
</section>
<section id="参数说明-1">
<h3>参数说明<a class="headerlink" href="#参数说明-1" title="Permalink to this headline"></a></h3>
<p>使用编译好的Benchmark工具进行模型的基准测试时，其命令格式如下所示。参数与Linux环境下使用一致，此处不再赘述。</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>call benchmark.exe [--modelFile=&lt;MODELFILE&gt;] [--accuracyThreshold=&lt;ACCURACYTHRESHOLD&gt;]
   [--cosineDistanceThreshold=&lt;COSINEDISTANCETHRESHOLD&gt;]
   [--benchmarkDataFile=&lt;BENCHMARKDATAFILE&gt;] [--benchmarkDataType=&lt;BENCHMARKDATATYPE&gt;]
   [--cpuBindMode=&lt;CPUBINDMODE&gt;] [--device=&lt;DEVICE&gt;] [--help]
   [--inDataFile=&lt;INDATAFILE&gt;] [--loopCount=&lt;LOOPCOUNT&gt;]
   [--numThreads=&lt;NUMTHREADS&gt;] [--warmUpLoopCount=&lt;WARMUPLOOPCOUNT&gt;]
   [--enableFp16=&lt;ENABLEFP16&gt;] [--timeProfiling=&lt;TIMEPROFILING&gt;]
            [--inputShapes=&lt;INPUTSHAPES&gt;]
</pre></div>
</div>
</section>
<section id="使用示例-1">
<h3>使用示例<a class="headerlink" href="#使用示例-1" title="Permalink to this headline"></a></h3>
<p>对于不同的MindSpore Lite模型，在使用Benchmark工具对其进行基准测试时，可通过设置不同的参数，实现对其不同的测试功能。主要分为性能测试和精度测试，输出信息与Linux环境下一致，此处不再赘述。</p>
<section id="性能测试-1">
<h4>性能测试<a class="headerlink" href="#性能测试-1" title="Permalink to this headline"></a></h4>
<ul>
<li><p>使用随机输入，其他参数使用默认值。</p>
<div class="highlight-bat notranslate"><div class="highlight"><pre><span></span><span class="k">call</span> benchmark.exe  --modelFile=/path/to/model.ms
</pre></div>
</div>
</li>
<li><p>使用随机输入，<code class="docutils literal notranslate"><span class="pre">timeProfiling</span></code>设为true，其他参数使用默认值。</p>
<div class="highlight-bat notranslate"><div class="highlight"><pre><span></span><span class="k">call</span> benchmark.exe --modelFile=/path/to/model.ms --timeProfiling=true
</pre></div>
</div>
</li>
</ul>
</section>
<section id="精度测试-1">
<h4>精度测试<a class="headerlink" href="#精度测试-1" title="Permalink to this headline"></a></h4>
<p>输入数据通过<code class="docutils literal notranslate"><span class="pre">inDataFile</span></code>参数设定，标杆数据通过<code class="docutils literal notranslate"><span class="pre">benchmarkDataFile</span></code>参数设定。</p>
<ul class="simple">
<li><p>指定了准确度阈值为3%。</p></li>
</ul>
<div class="highlight-bat notranslate"><div class="highlight"><pre><span></span><span class="k">call</span> benchmark.exe --modelFile=/path/to/model.ms --inDataFile=/path/to/input.bin --benchmarkDataFile=/path/to/output.out --accuracyThreshold=3
</pre></div>
</div>
<ul class="simple">
<li><p>指定模型推理程序在CPU上运行。</p></li>
</ul>
<div class="highlight-bat notranslate"><div class="highlight"><pre><span></span><span class="k">call</span> benchmark.exe --modelFile=/path/to/model.ms --inDataFile=/path/to/input.bin --benchmarkDataFile=/path/to/output.out --device=CPU
</pre></div>
</div>
<ul class="simple">
<li><p>指定输入数据的维度。</p></li>
</ul>
<div class="highlight-bat notranslate"><div class="highlight"><pre><span></span><span class="k">call</span> benchmark.exe --modelFile=/path/to/model.ms --inDataFile=/path/to/input.bin --benchmarkDataFile=/path/to/output.out --inputShapes=1,32,32,1
</pre></div>
</div>
</section>
</section>
<section id="dump功能-1">
<h3>Dump功能<a class="headerlink" href="#dump功能-1" title="Permalink to this headline"></a></h3>
<p>Windows环境下Dump功能使用方法与<a class="reference external" href="https://www.mindspore.cn/lite/docs/zh-CN/r1.8/use/benchmark_tool.html#dump%E5%8A%9F%E8%83%BD">Linux环境</a>基本一致，此处不再赘述。</p>
<p>需注意的一点是，在Windows环境下，<code class="docutils literal notranslate"><span class="pre">data_dump.json</span></code>配置文件中设置绝对路径<code class="docutils literal notranslate"><span class="pre">Path</span></code>时，需指定为<code class="docutils literal notranslate"><span class="pre">\\</span></code>的形式。</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="benchmark.html" class="btn btn-neutral float-left" title="基准测试工具" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="benchmark_train_tool.html" class="btn btn-neutral float-right" title="benchmark_train" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, MindSpore Lite.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 
</body>
</html>