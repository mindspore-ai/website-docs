

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>mindarmour.reliability &mdash; MindSpore master documentation</title>
  

  
   
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  
  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        
        
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="mindarmour.utils" href="mindarmour.utils.html" />
    <link rel="prev" title="mindarmour.privacy.sup_privacy" href="mindarmour.privacy.sup_privacy.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> MindSpore
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Installation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="mindarmour_install.html">MindSpore Armour Installation</a></li>
</ul>
<p class="caption"><span class="caption-text">AI Security</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="improve_model_security_nad.html">Improving Model Security with NAD Algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="test_model_security_fuzzing.html">Testing Model Security Using Fuzz Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="evaluation_of_CNNCTC.html">Evaluating the Robustness of the OCR Model CNN-CTC</a></li>
<li class="toctree-l1"><a class="reference internal" href="dynamic_obfuscation_protection.html">Dynamic Model Obfuscation</a></li>
<li class="toctree-l1"><a class="reference internal" href="model_encrypt_protection.html">Model Encryption Protection</a></li>
</ul>
<p class="caption"><span class="caption-text">AI Privacy</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="protect_user_privacy_with_differential_privacy.html">Protecting User Privacy with Differential Privacy Mechanism</a></li>
<li class="toctree-l1"><a class="reference internal" href="protect_user_privacy_with_suppress_privacy.html">Protecting User Privacy with Suppress Privacy</a></li>
<li class="toctree-l1"><a class="reference internal" href="test_model_security_membership_inference.html">Using Membership Inference to Test Model Security</a></li>
</ul>
<p class="caption"><span class="caption-text">AI Reliability</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="concept_drift_time_series.html">Implementing the Concept Drift Detection Application of Time Series Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="concept_drift_images.html">Implementing the Concept Drift Detection Application of Image Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="fault_injection.html">Implementing the Model Fault Injection and Evaluation</a></li>
</ul>
<p class="caption"><span class="caption-text">API References</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="mindarmour.html">mindarmour</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindarmour.adv_robustness.attacks.html">mindarmour.adv_robustness.attacks</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindarmour.adv_robustness.defenses.html">mindarmour.adv_robustness.defenses</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindarmour.adv_robustness.detectors.html">mindarmour.adv_robustness.detectors</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindarmour.adv_robustness.evaluations.html">mindarmour.adv_robustness.evaluations</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindarmour.fuzz_testing.html">mindarmour.fuzz_testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindarmour.natural_robustness.transform.image.html">mindarmour.natural_robustness.transform.image</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindarmour.privacy.diff_privacy.html">mindarmour.privacy.diff_privacy</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindarmour.privacy.evaluation.html">mindarmour.privacy.evaluation</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindarmour.privacy.sup_privacy.html">mindarmour.privacy.sup_privacy</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">mindarmour.reliability</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindarmour.utils.html">mindarmour.utils</a></li>
</ul>
<p class="caption"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="design.html">Overall Security and Trustworthiness Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="differential_privacy_design.html">Differential Privacy Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="fuzzer_design.html">AI Model Security Testing Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="security_and_privacy.html">MindSpore Armour Module Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">FAQ</a></li>
</ul>
<p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="RELEASE.html">Release Notes</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">MindSpore</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>mindarmour.reliability</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/mindarmour.reliability.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-mindarmour.reliability">
<span id="module-mindarmour.reliability"></span><span id="mindarmour-reliability"></span><h1>mindarmour.reliability<a class="headerlink" href="#module-mindarmour.reliability" title="Permalink to this headline">¶</a></h1>
<p>Reliability methods of MindArmour.</p>
<dl class="class">
<dt id="mindarmour.reliability.FaultInjector">
<em class="property">class </em><code class="sig-prename descclassname">mindarmour.reliability.</code><code class="sig-name descname">FaultInjector</code><span class="sig-paren">(</span><em class="sig-param">model</em>, <em class="sig-param">fi_type=None</em>, <em class="sig-param">fi_mode=None</em>, <em class="sig-param">fi_size=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindarmour/reliability/model_fault_injection/fault_injection.html#FaultInjector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindarmour.reliability.FaultInjector" title="Permalink to this definition">¶</a></dt>
<dd><p>Fault injection module simulates various fault scenarios for deep neural networks and evaluates
performance and reliability of the model.</p>
<p>For details, please check <a class="reference external" href="https://mindspore.cn/mindarmour/docs/en/master/fault_injection.html">Implementing the Model Fault Injection and Evaluation</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>Model</em>) – The model need to be evaluated.</p></li>
<li><p><strong>fi_type</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a>) – The type of the fault injection which include <code class="docutils literal notranslate"><span class="pre">bitflips_random</span></code> (flip randomly),
<code class="docutils literal notranslate"><span class="pre">bitflips_designated</span></code> (flip the key bit), <code class="docutils literal notranslate"><span class="pre">random</span></code>, <code class="docutils literal notranslate"><span class="pre">zeros</span></code>, <code class="docutils literal notranslate"><span class="pre">nan</span></code>, <code class="docutils literal notranslate"><span class="pre">inf</span></code>,
<code class="docutils literal notranslate"><span class="pre">anti_activation</span></code>, <code class="docutils literal notranslate"><span class="pre">precision_loss</span></code> etc.</p></li>
<li><p><strong>fi_mode</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a>) – The mode of fault injection. Fault inject on just <code class="docutils literal notranslate"><span class="pre">single</span> <span class="pre">layer</span></code> or <code class="docutils literal notranslate"><span class="pre">all</span> <span class="pre">layers</span></code>.</p></li>
<li><p><strong>fi_size</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a>) – The number of fault injection. It mean that how many values need to be injected.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore</span> <span class="kn">import</span> <span class="n">Model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mindspore.ops.operations</span> <span class="k">as</span> <span class="nn">P</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindarmour.reliability.model_fault_injection.fault_injection</span> <span class="kn">import</span> <span class="n">FaultInjector</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Net</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Cell</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="nb">super</span><span class="p">(</span><span class="n">Net</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">_softmax</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">Softmax</span><span class="p">()</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">_Dense</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">_squeeze</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">Squeeze</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">construct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">):</span>
<span class="gp">... </span>        <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_softmax</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Dense</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_squeeze</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">def</span> <span class="nf">dataset_generator</span><span class="p">():</span>
<span class="gp">... </span>    <span class="n">batch_size</span> <span class="o">=</span> <span class="mi">16</span>
<span class="gp">... </span>    <span class="n">batches</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">... </span>    <span class="n">data</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">batches</span> <span class="o">*</span> <span class="n">batch_size</span><span class="p">,</span><span class="mi">1</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">... </span>    <span class="n">label</span> <span class="o">=</span>  <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">10</span><span class="p">,</span> <span class="n">batches</span> <span class="o">*</span> <span class="n">batch_size</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">batches</span><span class="p">):</span>
<span class="gp">... </span>        <span class="k">yield</span> <span class="n">data</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="n">batch_size</span><span class="p">:(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">batch_size</span><span class="p">],</span> <span class="n">label</span><span class="p">[</span><span class="n">i</span><span class="o">*</span><span class="n">batch_size</span><span class="p">:(</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">)</span><span class="o">*</span><span class="n">batch_size</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">net</span> <span class="o">=</span> <span class="n">Net</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">net</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ds_eval</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">GeneratorDataset</span><span class="p">(</span><span class="n">dataset_generator</span><span class="p">,</span> <span class="p">[</span><span class="s1">&#39;image&#39;</span><span class="p">,</span> <span class="s1">&#39;label&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fi_type</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;bitflips_random&#39;</span><span class="p">,</span> <span class="s1">&#39;bitflips_designated&#39;</span><span class="p">,</span> <span class="s1">&#39;random&#39;</span><span class="p">,</span> <span class="s1">&#39;zeros&#39;</span><span class="p">,</span>
<span class="gp">... </span>           <span class="s1">&#39;nan&#39;</span><span class="p">,</span> <span class="s1">&#39;inf&#39;</span><span class="p">,</span> <span class="s1">&#39;anti_activation&#39;</span><span class="p">,</span> <span class="s1">&#39;precision_loss&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fi_mode</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;single_layer&#39;</span><span class="p">,</span> <span class="s1">&#39;all_layer&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fi_size</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fi</span> <span class="o">=</span> <span class="n">FaultInjector</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">ds_eval</span><span class="p">,</span> <span class="n">fi_type</span><span class="p">,</span> <span class="n">fi_mode</span><span class="p">,</span> <span class="n">fi_size</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fi</span><span class="o">.</span><span class="n">kick_off</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">fi</span><span class="o">.</span><span class="n">metrics</span><span class="p">()</span>
</pre></div>
</div>
<dl class="method">
<dt id="mindarmour.reliability.FaultInjector.kick_off">
<code class="sig-name descname">kick_off</code><span class="sig-paren">(</span><em class="sig-param">ds_data</em>, <em class="sig-param">ds_label</em>, <em class="sig-param">iter_times=100</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindarmour/reliability/model_fault_injection/fault_injection.html#FaultInjector.kick_off"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindarmour.reliability.FaultInjector.kick_off" title="Permalink to this definition">¶</a></dt>
<dd><p>Startup and return final results after Fault Injection.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ds_data</strong> (<em>np.ndarray</em>) – Input data for testing. The evaluation is based on this data.</p></li>
<li><p><strong>ds_label</strong> (<em>np.ndarray</em>) – The label of data, corresponding to the data.</p></li>
<li><p><strong>iter_times</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The number of evaluations, which will determine the batch size.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>list, the result of fault injection.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindarmour.reliability.FaultInjector.metrics">
<code class="sig-name descname">metrics</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindarmour/reliability/model_fault_injection/fault_injection.html#FaultInjector.metrics"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindarmour.reliability.FaultInjector.metrics" title="Permalink to this definition">¶</a></dt>
<dd><p>Metrics of final result.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>list, the summary of result.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mindarmour.reliability.ConceptDriftCheckTimeSeries">
<em class="property">class </em><code class="sig-prename descclassname">mindarmour.reliability.</code><code class="sig-name descname">ConceptDriftCheckTimeSeries</code><span class="sig-paren">(</span><em class="sig-param">window_size=100</em>, <em class="sig-param">rolling_window=10</em>, <em class="sig-param">step=10</em>, <em class="sig-param">threshold_index=1.5</em>, <em class="sig-param">need_label=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindarmour/reliability/concept_drift/concept_drift_check_time_series.html#ConceptDriftCheckTimeSeries"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindarmour.reliability.ConceptDriftCheckTimeSeries" title="Permalink to this definition">¶</a></dt>
<dd><p>ConceptDriftCheckTimeSeries is used for example series distribution change detection.
For details, please check <a class="reference external" href="https://mindspore.cn/mindarmour/docs/en/master/concept_drift_time_series.html">Implementing the Concept Drift Detection Application of Time Series Data</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>window_size</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Size of a concept window, no less than 10. If given the input data,
window_size belongs to [10, 1/3*len(input data)]. If the data is periodic, usually
window_size equals 2-5 periods, such as, for monthly/weekly data, the data volume
of 30/7 days is a period. Default: <code class="docutils literal notranslate"><span class="pre">100</span></code>.</p></li>
<li><p><strong>rolling_window</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Smoothing window size, belongs to [1, window_size]. Default: <code class="docutils literal notranslate"><span class="pre">10</span></code>.</p></li>
<li><p><strong>step</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The jump length of the sliding window, belongs to [1, window_size]. Default: <code class="docutils literal notranslate"><span class="pre">10</span></code>.</p></li>
<li><p><strong>threshold_index</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – The threshold index, <span class="math notranslate nohighlight">\((-\infty, +\infty)\)</span>. Default: <code class="docutils literal notranslate"><span class="pre">1.5</span></code>.</p></li>
<li><p><strong>need_label</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – If <code class="docutils literal notranslate"><span class="pre">True</span></code>, concept drift labels are needed. Default: <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindarmour</span> <span class="kn">import</span> <span class="n">ConceptDriftCheckTimeSeries</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">concept</span> <span class="o">=</span> <span class="n">ConceptDriftCheckTimeSeries</span><span class="p">(</span><span class="n">window_size</span><span class="o">=</span><span class="mi">100</span><span class="p">,</span> <span class="n">rolling_window</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<span class="gp">... </span>                                      <span class="n">step</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">threshold_index</span><span class="o">=</span><span class="mf">1.5</span><span class="p">,</span> <span class="n">need_label</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_example</span> <span class="o">=</span> <span class="mi">5</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1000</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data_example</span><span class="p">[</span><span class="mi">200</span><span class="p">:</span> <span class="mi">800</span><span class="p">]</span> <span class="o">=</span> <span class="mi">20</span><span class="o">*</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">600</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">score</span><span class="p">,</span> <span class="n">threshold</span><span class="p">,</span> <span class="n">concept_drift_location</span> <span class="o">=</span> <span class="n">concept</span><span class="o">.</span><span class="n">concept_check</span><span class="p">(</span><span class="n">data_example</span><span class="p">)</span>
</pre></div>
</div>
<dl class="method">
<dt id="mindarmour.reliability.ConceptDriftCheckTimeSeries.concept_check">
<code class="sig-name descname">concept_check</code><span class="sig-paren">(</span><em class="sig-param">data</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindarmour/reliability/concept_drift/concept_drift_check_time_series.html#ConceptDriftCheckTimeSeries.concept_check"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindarmour.reliability.ConceptDriftCheckTimeSeries.concept_check" title="Permalink to this definition">¶</a></dt>
<dd><p>Find concept drift locations in a data series.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>data</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><em>numpy.ndarray</em></a>) – Input data. The shape of data could be <span class="math notranslate nohighlight">\((n,1)\)</span> or <span class="math notranslate nohighlight">\((n,m)\)</span>.
Note that each column (m columns) is one data series.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>numpy.ndarray, the concept drift score of the example series.</p></li>
<li><p>float, the threshold to judge concept drift.</p></li>
<li><p>list, the location of the concept drift.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mindarmour.reliability.OodDetector">
<em class="property">class </em><code class="sig-prename descclassname">mindarmour.reliability.</code><code class="sig-name descname">OodDetector</code><span class="sig-paren">(</span><em class="sig-param">model</em>, <em class="sig-param">ds_train</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindarmour/reliability/concept_drift/concept_drift_check_images.html#OodDetector"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindarmour.reliability.OodDetector" title="Permalink to this definition">¶</a></dt>
<dd><p>The abstract class of the out-of-distribution detector.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>Model</em>) – The training model.</p></li>
<li><p><strong>ds_train</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><em>numpy.ndarray</em></a>) – The training dataset.</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="mindarmour.reliability.OodDetector.get_optimal_threshold">
<code class="sig-name descname">get_optimal_threshold</code><span class="sig-paren">(</span><em class="sig-param">label</em>, <em class="sig-param">ds_eval</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindarmour/reliability/concept_drift/concept_drift_check_images.html#OodDetector.get_optimal_threshold"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindarmour.reliability.OodDetector.get_optimal_threshold" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the optimal threshold. Try to find an optimal threshold value to
detect OOD examples. The optimal threshold is calculated by a labeled
dateset <cite>ds_eval</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><em>numpy.ndarray</em></a>) – The label whether an image is in-distribution and out-of-distribution.</p></li>
<li><p><strong>ds_eval</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><em>numpy.ndarray</em></a>) – The testing dataset to help find the threshold.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>float, the optimal threshold.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindarmour.reliability.OodDetector.ood_predict">
<code class="sig-name descname">ood_predict</code><span class="sig-paren">(</span><em class="sig-param">threshold</em>, <em class="sig-param">ds_test</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindarmour/reliability/concept_drift/concept_drift_check_images.html#OodDetector.ood_predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindarmour.reliability.OodDetector.ood_predict" title="Permalink to this definition">¶</a></dt>
<dd><p>The out-of-distribution detection. This function aims to detect whether images,
regarded as <cite>ds_test</cite>, are OOD examples or not. If the prediction score of one
image is larger than <cite>threshold</cite>, this image is out-of-distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>threshold</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – the threshold to judge ood data. One can set value by experience
or use function get_optimal_threshold.</p></li>
<li><p><strong>ds_test</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><em>numpy.ndarray</em></a>) – The testing dataset.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>numpy.ndarray, the detection result. <code class="docutils literal notranslate"><span class="pre">0</span></code> means the data is not ood, <code class="docutils literal notranslate"><span class="pre">1</span></code> means the data is ood.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mindarmour.reliability.OodDetectorFeatureCluster">
<em class="property">class </em><code class="sig-prename descclassname">mindarmour.reliability.</code><code class="sig-name descname">OodDetectorFeatureCluster</code><span class="sig-paren">(</span><em class="sig-param">model</em>, <em class="sig-param">ds_train</em>, <em class="sig-param">n_cluster</em>, <em class="sig-param">layer</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindarmour/reliability/concept_drift/concept_drift_check_images.html#OodDetectorFeatureCluster"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindarmour.reliability.OodDetectorFeatureCluster" title="Permalink to this definition">¶</a></dt>
<dd><p>Train the OOD detector. Extract the training data features, and obtain the clustering centers. The distance between
the testing data features and the clustering centers determines whether an image is an out-of-distribution(OOD)
image or not.</p>
<p>For details, please check <a class="reference external" href="https://mindspore.cn/mindarmour/docs/en/master/concept_drift_images.html">Implementing the Concept Drift Detection Application of Image Data</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<em>Model</em>) – The training model.</p></li>
<li><p><strong>ds_train</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><em>numpy.ndarray</em></a>) – The training dataset.</p></li>
<li><p><strong>n_cluster</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The cluster number. Belonging to [2,100].
Usually, n_cluster equals to the class number of the training dataset.
If the OOD detector performs poor in the testing dataset, we can increase the value of n_cluster
appropriately.</p></li>
<li><p><strong>layer</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – The name of the feature layer. layer (str) is represented by
‘name[:Tensor]’, where ‘name’ is given by users when training the model.
Please see more details about how to name the model layer in ‘README.md’.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore</span> <span class="kn">import</span> <span class="n">Model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore.ops</span> <span class="kn">import</span> <span class="n">TensorSummary</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mindspore.ops.operations</span> <span class="k">as</span> <span class="nn">P</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindarmour.reliability.concept_drift.concept_drift_check_images</span> <span class="kn">import</span> <span class="n">OodDetectorFeatureCluster</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Net</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Cell</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="nb">super</span><span class="p">(</span><span class="n">Net</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">_softmax</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">Softmax</span><span class="p">()</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">_Dense</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">_squeeze</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">Squeeze</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">_summary</span> <span class="o">=</span> <span class="n">TensorSummary</span><span class="p">()</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">construct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">):</span>
<span class="gp">... </span>        <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_softmax</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Dense</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">_summary</span><span class="p">(</span><span class="s1">&#39;output&#39;</span><span class="p">,</span> <span class="n">out</span><span class="p">)</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_squeeze</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">net</span> <span class="o">=</span> <span class="n">Net</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">net</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">batch_size</span> <span class="o">=</span> <span class="mi">16</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">batches</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ds_train</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">batches</span> <span class="o">*</span> <span class="n">batch_size</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ds_eval</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randn</span><span class="p">(</span><span class="n">batches</span> <span class="o">*</span> <span class="n">batch_size</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">detector</span> <span class="o">=</span> <span class="n">OodDetectorFeatureCluster</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">ds_train</span><span class="p">,</span> <span class="n">n_cluster</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">layer</span><span class="o">=</span><span class="s1">&#39;output[:Tensor]&#39;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">num</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ds_eval</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ood_label</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">concatenate</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">num</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">num</span><span class="p">)),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">optimal_threshold</span> <span class="o">=</span> <span class="n">detector</span><span class="o">.</span><span class="n">get_optimal_threshold</span><span class="p">(</span><span class="n">ood_label</span><span class="p">,</span> <span class="n">ds_eval</span><span class="p">)</span>
</pre></div>
</div>
<dl class="method">
<dt id="mindarmour.reliability.OodDetectorFeatureCluster.get_optimal_threshold">
<code class="sig-name descname">get_optimal_threshold</code><span class="sig-paren">(</span><em class="sig-param">label</em>, <em class="sig-param">ds_eval</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindarmour/reliability/concept_drift/concept_drift_check_images.html#OodDetectorFeatureCluster.get_optimal_threshold"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindarmour.reliability.OodDetectorFeatureCluster.get_optimal_threshold" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the optimal threshold. Try to find an optimal threshold value to
detect OOD examples. The optimal threshold is calculated by a labeled
dateset <cite>ds_eval</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>label</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><em>numpy.ndarray</em></a>) – The label whether an image is in-distribution and out-of-distribution.</p></li>
<li><p><strong>ds_eval</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><em>numpy.ndarray</em></a>) – The testing dataset to help find the threshold.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>float, the optimal threshold.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindarmour.reliability.OodDetectorFeatureCluster.ood_predict">
<code class="sig-name descname">ood_predict</code><span class="sig-paren">(</span><em class="sig-param">threshold</em>, <em class="sig-param">ds_test</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindarmour/reliability/concept_drift/concept_drift_check_images.html#OodDetectorFeatureCluster.ood_predict"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindarmour.reliability.OodDetectorFeatureCluster.ood_predict" title="Permalink to this definition">¶</a></dt>
<dd><p>The out-of-distribution detection. This function aims to detect whether images,
regarded as <cite>ds_test</cite>, are OOD examples or not. If the prediction score of one
image is larger than <cite>threshold</cite>, this image is out-of-distribution.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>threshold</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – the threshold to judge ood data. One can set value by experience
or use function get_optimal_threshold.</p></li>
<li><p><strong>ds_test</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><em>numpy.ndarray</em></a>) – The testing dataset.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>numpy.ndarray, the detection result. <code class="docutils literal notranslate"><span class="pre">0</span></code> means the data is not ood, <code class="docutils literal notranslate"><span class="pre">1</span></code> means the data is ood.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="mindarmour.utils.html" class="btn btn-neutral float-right" title="mindarmour.utils" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="mindarmour.privacy.sup_privacy.html" class="btn btn-neutral float-left" title="mindarmour.privacy.sup_privacy" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2022, MindSpore.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   
	<script async="async" src="https://cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</body>
</html>