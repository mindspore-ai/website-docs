

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>mindarmour.privacy.sup_privacy &mdash; MindSpore master documentation</title>
  

  
   
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  
  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        
        
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="mindarmour.reliability" href="mindarmour.reliability.html" />
    <link rel="prev" title="mindarmour.privacy.evaluation" href="mindarmour.privacy.evaluation.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> MindSpore
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Installation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="mindarmour_install.html">MindArmour Installation</a></li>
</ul>
<p class="caption"><span class="caption-text">AI Security</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="improve_model_security_nad.html">Improving Model Security with NAD Algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="test_model_security_fuzzing.html">Testing Model Security Using Fuzz Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="test_model_security_membership_inference.html">Using Membership Inference to Test Model Security</a></li>
</ul>
<p class="caption"><span class="caption-text">AI Privacy</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="protect_user_privacy_with_differential_privacy.html">Protecting User Privacy with Differential Privacy Mechanism</a></li>
<li class="toctree-l1"><a class="reference internal" href="protect_user_privacy_with_suppress_privacy.html">Protecting User Privacy with Suppress Privacy</a></li>
<li class="toctree-l1"><a class="reference internal" href="model_encrypt_protection.html">Model Encryption Protection</a></li>
</ul>
<p class="caption"><span class="caption-text">AI Reliability</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="concept_drift_time_series.html">Implementing the Concept Drift Detection Application of Time Series Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="concept_drift_images.html">Implementing the Concept Drift Detection Application of Image Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="fault_injection.html">Implementing the Model Fault Injection and Evaluation</a></li>
</ul>
<p class="caption"><span class="caption-text">API References</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="mindarmour.html">mindarmour</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindarmour.adv_robustness.attacks.html">mindarmour.adv_robustness.attacks</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindarmour.adv_robustness.defenses.html">mindarmour.adv_robustness.defenses</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindarmour.adv_robustness.detectors.html">mindarmour.adv_robustness.detectors</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindarmour.adv_robustness.evaluations.html">mindarmour.adv_robustness.evaluations</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindarmour.fuzz_testing.html">mindarmour.fuzz_testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindarmour.natural_robustness.transform.image.html">mindarmour.natural_robustness.transform.image</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindarmour.privacy.diff_privacy.html">mindarmour.privacy.diff_privacy</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindarmour.privacy.evaluation.html">mindarmour.privacy.evaluation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">mindarmour.privacy.sup_privacy</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindarmour.reliability.html">mindarmour.reliability</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindarmour.utils.html">mindarmour.utils</a></li>
</ul>
<p class="caption"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="design.html">Overall Security and Trustworthiness Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="differential_privacy_design.html">Differential Privacy Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="fuzzer_design.html">AI Model Security Testing Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="security_and_privacy.html">MindArmour Module Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">FAQ</a></li>
</ul>
<p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="RELEASE.html">Release Notes</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">MindSpore</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>mindarmour.privacy.sup_privacy</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/mindarmour.privacy.sup_privacy.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="module-mindarmour.privacy.sup_privacy">
<span id="module-mindarmour.privacy.sup_privacy"></span><span id="mindarmour-privacy-sup-privacy"></span><h1>mindarmour.privacy.sup_privacy<a class="headerlink" href="#module-mindarmour.privacy.sup_privacy" title="Permalink to this headline">¶</a></h1>
<p>This module provides Suppress Privacy feature to protect user privacy.</p>
<dl class="class">
<dt id="mindarmour.privacy.sup_privacy.SuppressMasker">
<em class="property">class </em><code class="sig-prename descclassname">mindarmour.privacy.sup_privacy.</code><code class="sig-name descname">SuppressMasker</code><span class="sig-paren">(</span><em class="sig-param">model</em>, <em class="sig-param">suppress_ctrl</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindarmour/privacy/sup_privacy/mask_monitor/masker.html#SuppressMasker"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindarmour.privacy.sup_privacy.SuppressMasker" title="Permalink to this definition">¶</a></dt>
<dd><p>Periodicity check suppress privacy function status and toggle suppress operation.
For details, please check <a class="reference external" href="https://mindspore.cn/mindarmour/docs/en/r1.9/protect_user_privacy_with_suppress_privacy.html">Protecting User Privacy with Suppression Privacy</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>model</strong> (<a class="reference internal" href="#mindarmour.privacy.sup_privacy.SuppressModel" title="mindarmour.privacy.sup_privacy.SuppressModel"><em>SuppressModel</em></a>) – SuppressModel instance.</p></li>
<li><p><strong>suppress_ctrl</strong> (<a class="reference internal" href="#mindarmour.privacy.sup_privacy.SuppressCtrl" title="mindarmour.privacy.sup_privacy.SuppressCtrl"><em>SuppressCtrl</em></a>) – SuppressCtrl instance.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mindspore.nn</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mindspore</span> <span class="k">as</span> <span class="nn">ms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore</span> <span class="kn">import</span> <span class="n">set_context</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore.nn</span> <span class="kn">import</span> <span class="n">Accuracy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindarmour.privacy.sup_privacy</span> <span class="kn">import</span> <span class="n">SuppressModel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindarmour.privacy.sup_privacy</span> <span class="kn">import</span> <span class="n">SuppressMasker</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindarmour.privacy.sup_privacy</span> <span class="kn">import</span> <span class="n">SuppressPrivacyFactory</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindarmour.privacy.sup_privacy</span> <span class="kn">import</span> <span class="n">MaskLayerDes</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Net</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Cell</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="nb">super</span><span class="p">(</span><span class="n">Net</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">_softmax</span> <span class="o">=</span> <span class="n">ops</span><span class="o">.</span><span class="n">Softmax</span><span class="p">()</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">_Dense</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">_squeeze</span> <span class="o">=</span> <span class="n">ops</span><span class="o">.</span><span class="n">Squeeze</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">construct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">):</span>
<span class="gp">... </span>        <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_softmax</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Dense</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_squeeze</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">set_context</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">PYNATIVE_MODE</span><span class="p">,</span> <span class="n">device_target</span><span class="o">=</span><span class="s2">&quot;GPU&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">network</span> <span class="o">=</span> <span class="n">Net</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">masklayers</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">masklayers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">MaskLayerDes</span><span class="p">(</span><span class="s2">&quot;_Dense.weight&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">suppress_ctrl_instance</span> <span class="o">=</span> <span class="n">SuppressPrivacyFactory</span><span class="p">()</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">networks</span><span class="o">=</span><span class="n">network</span><span class="p">,</span>
<span class="gp">... </span>                                                         <span class="n">mask_layers</span><span class="o">=</span><span class="n">masklayers</span><span class="p">,</span>
<span class="gp">... </span>                                                         <span class="n">policy</span><span class="o">=</span><span class="s2">&quot;local_train&quot;</span><span class="p">,</span>
<span class="gp">... </span>                                                         <span class="n">end_epoch</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<span class="gp">... </span>                                                         <span class="n">batch_num</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="gp">... </span>                                                         <span class="n">start_epoch</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<span class="gp">... </span>                                                         <span class="n">mask_times</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<span class="gp">... </span>                                                         <span class="n">lr</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
<span class="gp">... </span>                                                         <span class="n">sparse_end</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span>
<span class="gp">... </span>                                                         <span class="n">sparse_start</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">net_loss</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">SoftmaxCrossEntropyWithLogits</span><span class="p">(</span><span class="n">sparse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">reduction</span><span class="o">=</span><span class="s2">&quot;mean&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">net_opt</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">network</span><span class="o">.</span><span class="n">trainable_params</span><span class="p">(),</span> <span class="mf">0.05</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model_instance</span> <span class="o">=</span> <span class="n">SuppressModel</span><span class="p">(</span><span class="n">network</span><span class="o">=</span><span class="n">network</span><span class="p">,</span>
<span class="gp">... </span>                               <span class="n">loss_fn</span><span class="o">=</span><span class="n">net_loss</span><span class="p">,</span>
<span class="gp">... </span>                               <span class="n">optimizer</span><span class="o">=</span><span class="n">net_opt</span><span class="p">,</span>
<span class="gp">... </span>                               <span class="n">metrics</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Accuracy&quot;</span><span class="p">:</span> <span class="n">Accuracy</span><span class="p">()})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model_instance</span><span class="o">.</span><span class="n">link_suppress_ctrl</span><span class="p">(</span><span class="n">suppress_ctrl_instance</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">masker_instance</span> <span class="o">=</span> <span class="n">SuppressMasker</span><span class="p">(</span><span class="n">model_instance</span><span class="p">,</span> <span class="n">suppress_ctrl_instance</span><span class="p">)</span>
</pre></div>
</div>
<dl class="method">
<dt id="mindarmour.privacy.sup_privacy.SuppressMasker.step_end">
<code class="sig-name descname">step_end</code><span class="sig-paren">(</span><em class="sig-param">run_context</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindarmour/privacy/sup_privacy/mask_monitor/masker.html#SuppressMasker.step_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindarmour.privacy.sup_privacy.SuppressMasker.step_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Update mask matrix tensor used for SuppressModel instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>run_context</strong> (<em>RunContext</em>) – Include some information of the model.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mindarmour.privacy.sup_privacy.SuppressModel">
<em class="property">class </em><code class="sig-prename descclassname">mindarmour.privacy.sup_privacy.</code><code class="sig-name descname">SuppressModel</code><span class="sig-paren">(</span><em class="sig-param">network</em>, <em class="sig-param">loss_fn</em>, <em class="sig-param">optimizer</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindarmour/privacy/sup_privacy/train/model.html#SuppressModel"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindarmour.privacy.sup_privacy.SuppressModel" title="Permalink to this definition">¶</a></dt>
<dd><p>Suppress privacy training model, which is overload from mindspore.train.model.Model.</p>
<p>For details, please check <a class="reference external" href="https://mindspore.cn/mindarmour/docs/en/r1.9/protect_user_privacy_with_suppress_privacy.html">Protecting User Privacy with Suppress Privacy</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>network</strong> (<em>Cell</em>) – The training network.</p></li>
<li><p><strong>loss_fn</strong> (<em>Cell</em>) – Loss function of optimizers.</p></li>
<li><p><strong>optimizer</strong> (<em>Optimizer</em>) – optimizer instance.</p></li>
<li><p><strong>kwargs</strong> – Keyword parameters used for creating a suppress model.</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="mindarmour.privacy.sup_privacy.SuppressModel.link_suppress_ctrl">
<code class="sig-name descname">link_suppress_ctrl</code><span class="sig-paren">(</span><em class="sig-param">suppress_pri_ctrl</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindarmour/privacy/sup_privacy/train/model.html#SuppressModel.link_suppress_ctrl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindarmour.privacy.sup_privacy.SuppressModel.link_suppress_ctrl" title="Permalink to this definition">¶</a></dt>
<dd><p>Link self and SuppressCtrl instance.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>suppress_pri_ctrl</strong> (<a class="reference internal" href="#mindarmour.privacy.sup_privacy.SuppressCtrl" title="mindarmour.privacy.sup_privacy.SuppressCtrl"><em>SuppressCtrl</em></a>) – SuppressCtrl instance.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mindarmour.privacy.sup_privacy.SuppressPrivacyFactory">
<em class="property">class </em><code class="sig-prename descclassname">mindarmour.privacy.sup_privacy.</code><code class="sig-name descname">SuppressPrivacyFactory</code><a class="reference internal" href="_modules/mindarmour/privacy/sup_privacy/sup_ctrl/conctrl.html#SuppressPrivacyFactory"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindarmour.privacy.sup_privacy.SuppressPrivacyFactory" title="Permalink to this definition">¶</a></dt>
<dd><p>Factory class of SuppressCtrl mechanisms.</p>
<p>For details, please check <a class="reference external" href="https://mindspore.cn/mindarmour/docs/en/r1.9/protect_user_privacy_with_suppress_privacy.html">Protecting User Privacy with Suppress Privacy</a>.</p>
<dl class="method">
<dt id="mindarmour.privacy.sup_privacy.SuppressPrivacyFactory.create">
<em class="property">static </em><code class="sig-name descname">create</code><span class="sig-paren">(</span><em class="sig-param">networks</em>, <em class="sig-param">mask_layers</em>, <em class="sig-param">policy=&quot;local_train&quot;</em>, <em class="sig-param">end_epoch=10</em>, <em class="sig-param">batch_num=20</em>, <em class="sig-param">start_epoch=3</em>, <em class="sig-param">mask_times=1000</em>, <em class="sig-param">lr=0.05</em>, <em class="sig-param">sparse_end=0.90</em>, <em class="sig-param">sparse_start=0.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindarmour/privacy/sup_privacy/sup_ctrl/conctrl.html#SuppressPrivacyFactory.create"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindarmour.privacy.sup_privacy.SuppressPrivacyFactory.create" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>networks</strong> (<em>Cell</em>) – The training network.
This networks parameter should be same as ‘network’ parameter of SuppressModel().</p></li>
<li><p><strong>mask_layers</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a>) – Description of the training network layers that need to be suppressed.</p></li>
<li><p><strong>policy</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – Training policy for suppress privacy training. Default: “local_train”, means local training.</p></li>
<li><p><strong>end_epoch</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The last epoch in suppress operations, 0&lt;start_epoch&lt;=end_epoch&lt;=100. Default: 10.
This end_epoch parameter should be same as ‘epoch’ parameter of mindspore.train.model.train().</p></li>
<li><p><strong>batch_num</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The num of batches in an epoch, should be equal to num_samples/batch_size. Default: 20.</p></li>
<li><p><strong>start_epoch</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The first epoch in suppress operations, 0&lt;start_epoch&lt;=end_epoch&lt;=100. Default: 3.</p></li>
<li><p><strong>mask_times</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The num of suppress operations. Default: 1000.</p></li>
<li><p><strong>lr</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a><em>, </em><a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>]</em>) – Learning rate, should be unchanged during training. 0&lt;lr&lt;=0.50. Default: 0.05.
This lr parameter should be same as ‘learning_rate’ parameter of mindspore.nn.SGD().</p></li>
<li><p><strong>sparse_end</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – The sparsity to reach, 0.0&lt;=sparse_start&lt;sparse_end&lt;1.0. Default: 0.90.</p></li>
<li><p><strong>sparse_start</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a><em>, </em><a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>]</em>) – The sparsity to start, 0.0&lt;=sparse_start&lt;sparse_end&lt;1.0. Default: 0.0.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>SuppressCtrl, class of Suppress Privavy Mechanism.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mindspore.nn</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mindspore</span> <span class="k">as</span> <span class="nn">ms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore</span> <span class="kn">import</span> <span class="n">set_context</span><span class="p">,</span> <span class="n">ops</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore.nn</span> <span class="kn">import</span> <span class="n">Accuracy</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindarmour.privacy.sup_privacy</span> <span class="kn">import</span> <span class="n">SuppressPrivacyFactory</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindarmour.privacy.sup_privacy</span> <span class="kn">import</span> <span class="n">MaskLayerDes</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindarmour.privacy.sup_privacy</span> <span class="kn">import</span> <span class="n">SuppressModel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Net</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Cell</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>        <span class="nb">super</span><span class="p">(</span><span class="n">Net</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">_softmax</span> <span class="o">=</span> <span class="n">ops</span><span class="o">.</span><span class="n">Softmax</span><span class="p">()</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">_Dense</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span><span class="mi">10</span><span class="p">)</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">_squeeze</span> <span class="o">=</span> <span class="n">ops</span><span class="o">.</span><span class="n">Squeeze</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">construct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">inputs</span><span class="p">):</span>
<span class="gp">... </span>        <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_softmax</span><span class="p">(</span><span class="n">inputs</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">out</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_Dense</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">_squeeze</span><span class="p">(</span><span class="n">out</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">set_context</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">PYNATIVE_MODE</span><span class="p">,</span> <span class="n">device_target</span><span class="o">=</span><span class="s2">&quot;CPU&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">network</span> <span class="o">=</span> <span class="n">Net</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">masklayers</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">masklayers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">MaskLayerDes</span><span class="p">(</span><span class="s2">&quot;_Dense.weight&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">suppress_ctrl_instance</span> <span class="o">=</span> <span class="n">SuppressPrivacyFactory</span><span class="p">()</span><span class="o">.</span><span class="n">create</span><span class="p">(</span><span class="n">networks</span><span class="o">=</span><span class="n">network</span><span class="p">,</span>
<span class="gp">... </span>                                                         <span class="n">mask_layers</span><span class="o">=</span><span class="n">masklayers</span><span class="p">,</span>
<span class="gp">... </span>                                                         <span class="n">policy</span><span class="o">=</span><span class="s2">&quot;local_train&quot;</span><span class="p">,</span>
<span class="gp">... </span>                                                         <span class="n">end_epoch</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<span class="gp">... </span>                                                         <span class="n">batch_num</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
<span class="gp">... </span>                                                         <span class="n">start_epoch</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span>
<span class="gp">... </span>                                                         <span class="n">mask_times</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span>
<span class="gp">... </span>                                                         <span class="n">lr</span><span class="o">=</span><span class="mf">0.05</span><span class="p">,</span>
<span class="gp">... </span>                                                         <span class="n">sparse_end</span><span class="o">=</span><span class="mf">0.95</span><span class="p">,</span>
<span class="gp">... </span>                                                         <span class="n">sparse_start</span><span class="o">=</span><span class="mf">0.0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">net_loss</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">SoftmaxCrossEntropyWithLogits</span><span class="p">(</span><span class="n">sparse</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">reduction</span><span class="o">=</span><span class="s2">&quot;mean&quot;</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">net_opt</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">SGD</span><span class="p">(</span><span class="n">network</span><span class="o">.</span><span class="n">trainable_params</span><span class="p">(),</span> <span class="mf">0.05</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model_instance</span> <span class="o">=</span> <span class="n">SuppressModel</span><span class="p">(</span><span class="n">network</span><span class="o">=</span><span class="n">network</span><span class="p">,</span>
<span class="gp">... </span>                               <span class="n">loss_fn</span><span class="o">=</span><span class="n">net_loss</span><span class="p">,</span>
<span class="gp">... </span>                               <span class="n">optimizer</span><span class="o">=</span><span class="n">net_opt</span><span class="p">,</span>
<span class="gp">... </span>                               <span class="n">metrics</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;Accuracy&quot;</span><span class="p">:</span> <span class="n">Accuracy</span><span class="p">()})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">model_instance</span><span class="o">.</span><span class="n">link_suppress_ctrl</span><span class="p">(</span><span class="n">suppress_ctrl_instance</span><span class="p">)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mindarmour.privacy.sup_privacy.SuppressCtrl">
<em class="property">class </em><code class="sig-prename descclassname">mindarmour.privacy.sup_privacy.</code><code class="sig-name descname">SuppressCtrl</code><span class="sig-paren">(</span><em class="sig-param">networks</em>, <em class="sig-param">mask_layers</em>, <em class="sig-param">end_epoch</em>, <em class="sig-param">batch_num</em>, <em class="sig-param">start_epoch</em>, <em class="sig-param">mask_times</em>, <em class="sig-param">lr</em>, <em class="sig-param">sparse_end</em>, <em class="sig-param">sparse_start</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindarmour/privacy/sup_privacy/sup_ctrl/conctrl.html#SuppressCtrl"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindarmour.privacy.sup_privacy.SuppressCtrl" title="Permalink to this definition">¶</a></dt>
<dd><p>Complete suppress privacy operation, including computing suppress ration,
finding the parameters that should be suppressed, and suppress these
parameters permanently.</p>
<p>For details, please check <a class="reference external" href="https://mindspore.cn/mindarmour/docs/en/r1.9/protect_user_privacy_with_suppress_privacy.html">Protecting User Privacy with Suppress Privacy</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>networks</strong> (<em>Cell</em>) – The training network.</p></li>
<li><p><strong>mask_layers</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a>) – Description of those layers that need to be suppressed.</p></li>
<li><p><strong>end_epoch</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The last epoch in suppress operations.</p></li>
<li><p><strong>batch_num</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The num of grad operation in an epoch.</p></li>
<li><p><strong>start_epoch</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The first epoch in suppress operations.</p></li>
<li><p><strong>mask_times</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The num of suppress operations.</p></li>
<li><p><strong>lr</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a><em>, </em><a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>]</em>) – Learning rate.</p></li>
<li><p><strong>sparse_end</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – The sparsity to reach.</p></li>
<li><p><strong>sparse_start</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a><em>, </em><a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>]</em>) – The sparsity to start.</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="mindarmour.privacy.sup_privacy.SuppressCtrl.calc_actual_sparse_for_conv">
<code class="sig-name descname">calc_actual_sparse_for_conv</code><span class="sig-paren">(</span><em class="sig-param">networks</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindarmour/privacy/sup_privacy/sup_ctrl/conctrl.html#SuppressCtrl.calc_actual_sparse_for_conv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindarmour.privacy.sup_privacy.SuppressCtrl.calc_actual_sparse_for_conv" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute actually sparsity of network for conv1 layer and conv2 layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>networks</strong> (<em>Cell</em>) – The training network.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindarmour.privacy.sup_privacy.SuppressCtrl.calc_actual_sparse_for_fc1">
<code class="sig-name descname">calc_actual_sparse_for_fc1</code><span class="sig-paren">(</span><em class="sig-param">networks</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindarmour/privacy/sup_privacy/sup_ctrl/conctrl.html#SuppressCtrl.calc_actual_sparse_for_fc1"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindarmour.privacy.sup_privacy.SuppressCtrl.calc_actual_sparse_for_fc1" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate actual sparse for full connection 1 layer</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>networks</strong> (<em>Cell</em>) – The training network.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindarmour.privacy.sup_privacy.SuppressCtrl.calc_actual_sparse_for_layer">
<code class="sig-name descname">calc_actual_sparse_for_layer</code><span class="sig-paren">(</span><em class="sig-param">networks</em>, <em class="sig-param">layer_name</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindarmour/privacy/sup_privacy/sup_ctrl/conctrl.html#SuppressCtrl.calc_actual_sparse_for_layer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindarmour.privacy.sup_privacy.SuppressCtrl.calc_actual_sparse_for_layer" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute actually sparsity of one network layer</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>networks</strong> (<em>Cell</em>) – The training network.</p></li>
<li><p><strong>layer_name</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – The name of target layer.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindarmour.privacy.sup_privacy.SuppressCtrl.calc_theoretical_sparse_for_conv">
<code class="sig-name descname">calc_theoretical_sparse_for_conv</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindarmour/privacy/sup_privacy/sup_ctrl/conctrl.html#SuppressCtrl.calc_theoretical_sparse_for_conv"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindarmour.privacy.sup_privacy.SuppressCtrl.calc_theoretical_sparse_for_conv" title="Permalink to this definition">¶</a></dt>
<dd><p>Compute actually sparsity of mask matrix for conv1 layer and conv2 layer.</p>
</dd></dl>

<dl class="method">
<dt id="mindarmour.privacy.sup_privacy.SuppressCtrl.print_paras">
<code class="sig-name descname">print_paras</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindarmour/privacy/sup_privacy/sup_ctrl/conctrl.html#SuppressCtrl.print_paras"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindarmour.privacy.sup_privacy.SuppressCtrl.print_paras" title="Permalink to this definition">¶</a></dt>
<dd><p>Show parameters info</p>
</dd></dl>

<dl class="method">
<dt id="mindarmour.privacy.sup_privacy.SuppressCtrl.reset_zeros">
<code class="sig-name descname">reset_zeros</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindarmour/privacy/sup_privacy/sup_ctrl/conctrl.html#SuppressCtrl.reset_zeros"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindarmour.privacy.sup_privacy.SuppressCtrl.reset_zeros" title="Permalink to this definition">¶</a></dt>
<dd><p>Set add mask arrays to be zero.</p>
</dd></dl>

<dl class="method">
<dt id="mindarmour.privacy.sup_privacy.SuppressCtrl.update_mask">
<code class="sig-name descname">update_mask</code><span class="sig-paren">(</span><em class="sig-param">networks</em>, <em class="sig-param">cur_step</em>, <em class="sig-param">target_sparse=0.0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindarmour/privacy/sup_privacy/sup_ctrl/conctrl.html#SuppressCtrl.update_mask"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindarmour.privacy.sup_privacy.SuppressCtrl.update_mask" title="Permalink to this definition">¶</a></dt>
<dd><p>Update add mask arrays and multiply mask arrays of network layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>networks</strong> (<em>Cell</em>) – The training network.</p></li>
<li><p><strong>cur_step</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Current epoch of the whole training process.</p></li>
<li><p><strong>target_sparse</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – The sparsity to reach. Default: 0.0.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindarmour.privacy.sup_privacy.SuppressCtrl.update_mask_layer">
<code class="sig-name descname">update_mask_layer</code><span class="sig-paren">(</span><em class="sig-param">weight_array_flat</em>, <em class="sig-param">sparse_weight_thd</em>, <em class="sig-param">sparse_stop_pos</em>, <em class="sig-param">weight_abs_max</em>, <em class="sig-param">layer_index</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindarmour/privacy/sup_privacy/sup_ctrl/conctrl.html#SuppressCtrl.update_mask_layer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindarmour.privacy.sup_privacy.SuppressCtrl.update_mask_layer" title="Permalink to this definition">¶</a></dt>
<dd><p>Update add mask arrays and multiply mask arrays of one single layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>weight_array_flat</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><em>numpy.ndarray</em></a>) – The weight array of layer’s parameters.</p></li>
<li><p><strong>sparse_weight_thd</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – The weight threshold of sparse operation.</p></li>
<li><p><strong>sparse_stop_pos</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The maximum number of elements to be suppressed.</p></li>
<li><p><strong>weight_abs_max</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – The maximum absolute value of weights.</p></li>
<li><p><strong>layer_index</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The index of target layer.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindarmour.privacy.sup_privacy.SuppressCtrl.update_mask_layer_approximity">
<code class="sig-name descname">update_mask_layer_approximity</code><span class="sig-paren">(</span><em class="sig-param">weight_array_flat</em>, <em class="sig-param">weight_array_flat_abs</em>, <em class="sig-param">actual_stop_pos</em>, <em class="sig-param">layer_index</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindarmour/privacy/sup_privacy/sup_ctrl/conctrl.html#SuppressCtrl.update_mask_layer_approximity"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindarmour.privacy.sup_privacy.SuppressCtrl.update_mask_layer_approximity" title="Permalink to this definition">¶</a></dt>
<dd><p>Update add mask arrays and multiply mask arrays of one single layer with many parameter.
Disable clipping lower, clipping, adding noise operation</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>weight_array_flat</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><em>numpy.ndarray</em></a>) – The weight array of layer’s parameters.</p></li>
<li><p><strong>weight_array_flat_abs</strong> (<a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><em>numpy.ndarray</em></a>) – The abs weight array of layer’s parameters.</p></li>
<li><p><strong>actual_stop_pos</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The actually para num should be suppressed.</p></li>
<li><p><strong>layer_index</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The index of target layer.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindarmour.privacy.sup_privacy.SuppressCtrl.update_status">
<code class="sig-name descname">update_status</code><span class="sig-paren">(</span><em class="sig-param">cur_epoch</em>, <em class="sig-param">cur_step</em>, <em class="sig-param">cur_step_in_epoch</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindarmour/privacy/sup_privacy/sup_ctrl/conctrl.html#SuppressCtrl.update_status"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindarmour.privacy.sup_privacy.SuppressCtrl.update_status" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the suppress operation status.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>cur_epoch</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Current epoch of the whole training process.</p></li>
<li><p><strong>cur_step</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Current step of the whole training process.</p></li>
<li><p><strong>cur_step_in_epoch</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Current step of the current epoch.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mindarmour.privacy.sup_privacy.MaskLayerDes">
<em class="property">class </em><code class="sig-prename descclassname">mindarmour.privacy.sup_privacy.</code><code class="sig-name descname">MaskLayerDes</code><span class="sig-paren">(</span><em class="sig-param">layer_name</em>, <em class="sig-param">grad_idx</em>, <em class="sig-param">is_add_noise</em>, <em class="sig-param">is_lower_clip</em>, <em class="sig-param">min_num</em>, <em class="sig-param">upper_bound=1.20</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindarmour/privacy/sup_privacy/sup_ctrl/conctrl.html#MaskLayerDes"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindarmour.privacy.sup_privacy.MaskLayerDes" title="Permalink to this definition">¶</a></dt>
<dd><p>Describe the layer that need to be suppressed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>layer_name</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – <p>Layer name, get the name of one layer as following:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">layer</span> <span class="ow">in</span> <span class="n">networks</span><span class="o">.</span><span class="n">get_parameters</span><span class="p">(</span><span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">layer</span><span class="o">.</span><span class="n">name</span> <span class="o">==</span> <span class="s2">&quot;conv&quot;</span><span class="p">:</span> <span class="o">...</span>
</pre></div>
</div>
</p></li>
<li><p><strong>grad_idx</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Mask layer’s index in grad tuple.You can refer to the construct function
of TrainOneStepCell in mindarmour/privacy/sup_privacy/train/model.py to print the index of some specified
grad layers in PYNATIVE_MODE.</p></li>
<li><p><strong>is_add_noise</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – If True, the weight of this layer can add noise.
If False, the weight of this layer can not add noise.
If parameter num is greater than 100000, is_add_noise has no effect.</p></li>
<li><p><strong>is_lower_clip</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – If True, the weights of this layer would be clipped to greater than an lower bound value.
If False, the weights of this layer won’t be clipped.
If parameter num is greater than 100000, is_lower_clip has no effect.</p></li>
<li><p><strong>min_num</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The number of weights left that not be suppressed.
If min_num is smaller than (parameter num*SupperssCtrl.sparse_end), min_num has not effect.</p></li>
<li><p><strong>upper_bound</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a><em>, </em><a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>]</em>) – max abs value of weight in this layer, default: 1.20.
If parameter num is greater than 100000, upper_bound has not effect.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindarmour.privacy.sup_privacy</span> <span class="kn">import</span> <span class="n">MaskLayerDes</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">masklayers</span> <span class="o">=</span> <span class="p">[]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">masklayers</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">MaskLayerDes</span><span class="p">(</span><span class="s2">&quot;conv1.weight&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="mindarmour.reliability.html" class="btn btn-neutral float-right" title="mindarmour.reliability" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="mindarmour.privacy.evaluation.html" class="btn btn-neutral float-left" title="mindarmour.privacy.evaluation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2022, MindSpore.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   
	<script async="async" src="https://cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</body>
</html>