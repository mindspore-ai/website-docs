<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Dynamic Model Obfuscation &mdash; MindSpore master documentation</title><script>;(()=>{const e=localStorage.getItem("ms-theme"),t=window.matchMedia("(prefers-color-scheme: dark)").matches;(e?"dark"===e:t)&&document.documentElement.setAttribute("data-o-theme","dark")})();</script><link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script><script src="_static/jquery.js"></script>
        <script src="_static/js/theme.js"></script><script src="_static/underscore.js"></script><script src="_static/doctools.js"></script><script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Model Encryption Protection" href="model_encrypt_protection.html" />
    <link rel="prev" title="Evaluating the Robustness of the OCR Model CNN-CTC" href="evaluation_of_CNNCTC.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> MindSpore
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Installation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="mindarmour_install.html">MindSpore Armour Installation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">AI Security</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="improve_model_security_nad.html">Improving Model Security with NAD Algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="test_model_security_fuzzing.html">Testing Model Security Using Fuzz Testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="evaluation_of_CNNCTC.html">Evaluating the Robustness of the OCR Model CNN-CTC</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Dynamic Model Obfuscation</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#using-export-to-export-obfuscated-models-and-deploying-inference">Using <code class="docutils literal notranslate"><span class="pre">export()</span></code> to Export Obfuscated Models and Deploying Inference</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#exporting-an-obfuscated-model-in-random-seed-mode">Exporting an Obfuscated Model in random_seed Mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="#loading-the-obfuscated-model-in-random-seed-mode">Loading the Obfuscated Model in random_seed Mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="#exporting-obfuscated-models-in-customized-function-mode-only-for-the-cpu-hardware-environment">Exporting Obfuscated Models in Customized Function Mode (Only for the CPU Hardware Environment)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#loading-the-obfuscated-model-in-customized-function-mode">Loading the Obfuscated Model in Customized Function Mode</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#using-obfuscate-model-to-export-obfuscated-models-and-deploying-inference">Using <code class="docutils literal notranslate"><span class="pre">obfuscate_model()</span></code> to Export Obfuscated Models and Deploying Inference</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#exporting-an-obfuscated-model-in-random-seed-mode-1">Exporting an Obfuscated Model in random_seed Mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="#loading-the-obfuscated-model-in-random-seed-mode-1">Loading the Obfuscated Model in random_seed Mode</a></li>
<li class="toctree-l3"><a class="reference internal" href="#exporting-obfuscated-models-in-customized-function-mode-only-for-the-cpu-hardware-environment-1">Exporting Obfuscated Models in Customized Function Mode (Only for the CPU Hardware Environment)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#loading-the-obfuscated-model-in-customized-function-mode-1">Loading the Obfuscated Model in Customized Function Mode</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="model_encrypt_protection.html">Model Encryption Protection</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">AI Privacy</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="protect_user_privacy_with_differential_privacy.html">Protecting User Privacy with Differential Privacy Mechanism</a></li>
<li class="toctree-l1"><a class="reference internal" href="protect_user_privacy_with_suppress_privacy.html">Protecting User Privacy with Suppress Privacy</a></li>
<li class="toctree-l1"><a class="reference internal" href="test_model_security_membership_inference.html">Using Membership Inference to Test Model Security</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">AI Reliability</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="concept_drift_time_series.html">Implementing the Concept Drift Detection Application of Time Series Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="concept_drift_images.html">Implementing the Concept Drift Detection Application of Image Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="fault_injection.html">Implementing the Model Fault Injection and Evaluation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="mindarmour.html">mindarmour</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindarmour.adv_robustness.attacks.html">mindarmour.adv_robustness.attacks</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindarmour.adv_robustness.defenses.html">mindarmour.adv_robustness.defenses</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindarmour.adv_robustness.detectors.html">mindarmour.adv_robustness.detectors</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindarmour.adv_robustness.evaluations.html">mindarmour.adv_robustness.evaluations</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindarmour.fuzz_testing.html">mindarmour.fuzz_testing</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindarmour.natural_robustness.transform.image.html">mindarmour.natural_robustness.transform.image</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindarmour.privacy.diff_privacy.html">mindarmour.privacy.diff_privacy</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindarmour.privacy.evaluation.html">mindarmour.privacy.evaluation</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindarmour.privacy.sup_privacy.html">mindarmour.privacy.sup_privacy</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindarmour.reliability.html">mindarmour.reliability</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindarmour.utils.html">mindarmour.utils</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="design.html">Overall Security and Trustworthiness Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="differential_privacy_design.html">Differential Privacy Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="fuzzer_design.html">AI Model Security Testing Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="security_and_privacy.html">MindSpore Armour Module Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="faq.html">FAQ</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">RELEASE NOTES</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="RELEASE.html">Release Notes</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">MindSpore</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Dynamic Model Obfuscation</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/dynamic_obfuscation_protection.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="dynamic-model-obfuscation">
<h1>Dynamic Model Obfuscation<a class="headerlink" href="#dynamic-model-obfuscation" title="Permalink to this headline"></a></h1>
<p><a class="reference external" href="https://gitee.com/mindspore/docs/blob/r2.0/docs/mindarmour/docs/source_en/dynamic_obfuscation_protection.md"><img alt="View Source On Gitee" src="https://mindspore-website.obs.cn-north-4.myhuaweicloud.com/website-images/r2.0/resource/_static/logo_source_en.png" /></a></p>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline"></a></h2>
<p>The MindSpore framework can protect a MindIR model through dynamic obfuscation. The structure of an obfuscated model is different from that of the original model. Therefore, even if someone steals the model, they do not know the network structure of the original model.
The model owner can use the native MindSpore API <code class="docutils literal notranslate"><span class="pre">load()</span></code> to load the obfuscated model for inference. The model is also in the obfuscation state during inference, ensuring the security of the model at runtime.</p>
<p>Currently, obfuscated models can be exported from the Linux platform using the native Python API <code class="docutils literal notranslate"><span class="pre">export()</span></code> of MindSpore or the Python API <code class="docutils literal notranslate"><span class="pre">obfuscate_model()</span></code>.</p>
<p>The following uses an example to describe how to export and load an obfuscated model.</p>
<blockquote>
<div><p>You can download the complete sample code at <a class="reference external" href="https://gitee.com/mindspore/docs/blob/r2.0/docs/sample_code/dynamic_obfuscation/test_dynamic_obfuscation.py">https://gitee.com/mindspore/docs/blob/r2.0/docs/sample_code/dynamic_obfuscation/test_dynamic_obfuscation.py</a>.</p>
</div></blockquote>
</section>
<section id="using-export-to-export-obfuscated-models-and-deploying-inference">
<h2>Using <code class="docutils literal notranslate"><span class="pre">export()</span></code> to Export Obfuscated Models and Deploying Inference<a class="headerlink" href="#using-export-to-export-obfuscated-models-and-deploying-inference" title="Permalink to this headline"></a></h2>
<p><code class="docutils literal notranslate"><span class="pre">export()</span></code> is a model export API provided by MindSpore. This API can export <code class="docutils literal notranslate"><span class="pre">nn.Cell</span></code> networks to model files in multiple formats.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">mindspore</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="o">*</span><span class="n">inputs</span><span class="p">,</span> <span class="n">file_name</span><span class="p">,</span> <span class="n">file_format</span><span class="o">=</span><span class="s2">&quot;MINDIR&quot;</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>
</div>
<p>To use this API to export an obfuscated model, you need to set the dictionary parameter <code class="docutils literal notranslate"><span class="pre">obf_config</span></code> for dynamic obfuscation and input it as <code class="docutils literal notranslate"><span class="pre">kwargs</span></code>. Dynamic obfuscation provides two modes to protect models: random_seed and customized function.
The following describes how to export and load obfuscated models in the two modes.</p>
<section id="exporting-an-obfuscated-model-in-random-seed-mode">
<h3>Exporting an Obfuscated Model in random_seed Mode<a class="headerlink" href="#exporting-an-obfuscated-model-in-random-seed-mode" title="Permalink to this headline"></a></h3>
<ol class="arabic">
<li><p>Prepare a test network ObfuscateNet:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">mindspore</span> <span class="k">as</span> <span class="nn">ms</span>
<span class="kn">import</span> <span class="nn">mindspore.ops</span> <span class="k">as</span> <span class="nn">ops</span>
<span class="kn">import</span> <span class="nn">mindspore.nn</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="kn">from</span> <span class="nn">mindspore.common.initializer</span> <span class="kn">import</span> <span class="n">TruncatedNormal</span>
<span class="n">ms</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">GRAPH_MODE</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">weight_variable</span><span class="p">():</span>
    <span class="k">return</span> <span class="n">TruncatedNormal</span><span class="p">(</span><span class="mf">0.02</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">conv</span><span class="p">(</span><span class="n">in_channels</span><span class="p">,</span> <span class="n">out_channels</span><span class="p">,</span> <span class="n">kernel_size</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
    <span class="n">weight</span> <span class="o">=</span> <span class="n">weight_variable</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="n">in_channels</span><span class="p">,</span> <span class="n">out_channels</span><span class="p">,</span>
                     <span class="n">kernel_size</span><span class="o">=</span><span class="n">kernel_size</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="n">stride</span><span class="p">,</span> <span class="n">padding</span><span class="o">=</span><span class="n">padding</span><span class="p">,</span>
                     <span class="n">weight_init</span><span class="o">=</span><span class="n">weight</span><span class="p">,</span> <span class="n">has_bias</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">pad_mode</span><span class="o">=</span><span class="s2">&quot;valid&quot;</span><span class="p">)</span>

<span class="k">def</span> <span class="nf">fc_with_initialize</span><span class="p">(</span><span class="n">input_channels</span><span class="p">,</span> <span class="n">out_channels</span><span class="p">):</span>
    <span class="n">weight</span> <span class="o">=</span> <span class="n">weight_variable</span><span class="p">()</span>
    <span class="n">bias</span> <span class="o">=</span> <span class="n">weight_variable</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">nn</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">input_channels</span><span class="p">,</span> <span class="n">out_channels</span><span class="p">,</span> <span class="n">weight</span><span class="p">,</span> <span class="n">bias</span><span class="p">,</span> <span class="n">has_bias</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">ObfuscateNet</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Cell</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">ObfuscateNet</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">batch_size</span> <span class="o">=</span> <span class="mi">32</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conv1</span> <span class="o">=</span> <span class="n">conv</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">conv2</span> <span class="o">=</span> <span class="n">conv</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">5</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">matmul</span> <span class="o">=</span> <span class="n">ops</span><span class="o">.</span><span class="n">MatMul</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">matmul_weight1</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">16</span> <span class="o">*</span> <span class="mi">5</span> <span class="o">*</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">120</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">matmul_weight2</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">120</span><span class="p">,</span> <span class="mi">84</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">matmul_weight3</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random</span><span class="p">((</span><span class="mi">84</span><span class="p">,</span> <span class="mi">10</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">relu</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">max_pool2d</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">MaxPool2d</span><span class="p">(</span><span class="n">kernel_size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">flatten</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Flatten</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">construct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">conv1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_pool2d</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">conv2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_pool2d</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">matmul_weight1</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">matmul_weight2</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">matmul</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">matmul_weight3</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">x</span>
</pre></div>
</div>
</li>
<li><p>Set the obfuscation dictionary parameter.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">obf_config</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;obf_ratio&quot;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">,</span> <span class="s2">&quot;obf_random_seed&quot;</span><span class="p">:</span> <span class="mi">3423</span><span class="p">}</span>
</pre></div>
</div>
<p>As shown in the preceding information, <code class="docutils literal notranslate"><span class="pre">obf_ratio</span></code> indicates the obfuscation ratio, that is, the ratio of obfuscated nodes in the obfuscated model to all model nodes. The value can be a floating point number or a character string. If the value is a floating point number, the value range is (0,1]. If the value is a character string, the valid value is <code class="docutils literal notranslate"><span class="pre">'small'</span></code>, <code class="docutils literal notranslate"><span class="pre">'medium'</span></code>, or <code class="docutils literal notranslate"><span class="pre">'large'</span></code>.
<code class="docutils literal notranslate"><span class="pre">obf_random_seed</span></code> indicates the obfuscation random seed. The valid value is an integer greater than 0 and less than or equal to int64_max (9223372036854775807).</p>
</li>
<li><p>Export the obfuscated model.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">net</span> <span class="o">=</span> <span class="n">ObfuscateNet</span><span class="p">()</span>
<span class="n">input_tensor</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>
<span class="n">obf_config</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;obf_ratio&quot;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">,</span> <span class="s2">&quot;obf_random_seed&quot;</span><span class="p">:</span> <span class="mi">3423</span><span class="p">}</span>
<span class="n">ms</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="n">input_tensor</span><span class="p">,</span> <span class="n">file_name</span><span class="o">=</span><span class="s2">&quot;obf_net&quot;</span><span class="p">,</span> <span class="n">file_format</span><span class="o">=</span><span class="s2">&quot;MINDIR&quot;</span><span class="p">,</span> <span class="n">obf_config</span><span class="o">=</span><span class="n">obf_config</span><span class="p">)</span>
</pre></div>
</div>
<p>After the preceding steps are complete, an obfuscated MindIR model is obtained. (Currently, only obfuscated models in MindIR format can be exported.)</p>
</li>
</ol>
</section>
<section id="loading-the-obfuscated-model-in-random-seed-mode">
<h3>Loading the Obfuscated Model in random_seed Mode<a class="headerlink" href="#loading-the-obfuscated-model-in-random-seed-mode" title="Permalink to this headline"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">load()</span></code> and <code class="docutils literal notranslate"><span class="pre">nn.GraphCell()</span></code> APIs of MindSpore can be used to load obfuscated models for inference. Ensure that the input <code class="docutils literal notranslate"><span class="pre">obf_random_seed</span></code> is correct when calling the <code class="docutils literal notranslate"><span class="pre">nn.GraphCell()</span></code> API. Otherwise, the obtained inference result is incorrect.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">obf_graph</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;obf_net.mindir&quot;</span><span class="p">)</span>
<span class="n">obf_net</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">GraphCell</span><span class="p">(</span><span class="n">obf_graph</span><span class="p">,</span> <span class="n">obf_random_seed</span><span class="o">=</span><span class="mi">3423</span><span class="p">)</span>
<span class="n">right_seed_result</span> <span class="o">=</span> <span class="n">obf_net</span><span class="p">(</span><span class="n">input_tensor</span><span class="p">)</span><span class="o">.</span><span class="n">asnumpy</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">right_seed_result</span><span class="p">)</span>
<span class="c1"># Note that the print results may be different under different software versions. The print here is only for comparison of results.</span>
<span class="c1"># [[743.6489  844.62427 716.82104 735.7657  802.5662  833.0927  861.00336 769.6415  857.3915  765.9037 ]]</span>
</pre></div>
</div>
<p>To check whether the inference result is correct, you can obtain the inference result of the original model and compare <code class="docutils literal notranslate"><span class="pre">right_seed_result</span></code> with the inference result as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">original_predict_result</span> <span class="o">=</span> <span class="n">net</span><span class="p">(</span><span class="n">input_tensor</span><span class="p">)</span><span class="o">.</span><span class="n">asnumpy</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">original_predict_result</span><span class="p">)</span>
<span class="c1"># Note that the print results may be different under different software versions. The print here is only for comparison of results.</span>
<span class="c1"># [[743.6489  844.62427 716.82104 735.7657  802.5662  833.0927  861.00336 769.6415  857.3915  765.9037 ]]</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">original_predict_result</span> <span class="o">==</span> <span class="n">right_seed_result</span><span class="p">))</span>
<span class="c1"># True</span>
</pre></div>
</div>
<p>The comparison result shows that the inference result obtained by entering the correct obf_random_seed is the same as that of the original model, and the accuracy is lossless.</p>
</section>
<section id="exporting-obfuscated-models-in-customized-function-mode-only-for-the-cpu-hardware-environment">
<h3>Exporting Obfuscated Models in Customized Function Mode (Only for the CPU Hardware Environment)<a class="headerlink" href="#exporting-obfuscated-models-in-customized-function-mode-only-for-the-cpu-hardware-environment" title="Permalink to this headline"></a></h3>
<p>In addition to the random_seed mode, dynamic obfuscation also provides the customized function mode. Compared with the random_seed mode, the customized function mode is more secure, but the configuration is more complex.
In customized function mode, you need to define a Python function that meets the following requirements: 1. There are 2 input parameters. 2. For any input (which comes from the output of any model layer during inference), the output value of this function is always True or False. Example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">my_func</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span> <span class="o">+</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x2</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="kc">False</span>
</pre></div>
</div>
<p>Note: You can search for <strong>Opaque predicate expression</strong> to construct functions that meet the preceding requirements. For example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">opaque_predicate</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
    <span class="k">if</span> <span class="mi">7</span><span class="o">*</span><span class="n">y</span><span class="o">^</span><span class="mi">2</span> <span class="o">-</span> <span class="mi">1</span> <span class="o">==</span> <span class="n">x</span><span class="o">^</span><span class="mi">2</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="kc">False</span>
</pre></div>
</div>
<p>If x and y are integers, opaque_predicate(x, y) is always False. You can refer to <a class="reference external" href="https://dl.acm.org/doi/epdf/10.1145/268946.268962">manufacturing cheap, resilient, and stealthy opaque constructs</a> or other literature to learn more about opaque predicates.</p>
<p>After the <code class="docutils literal notranslate"><span class="pre">customized_func</span></code> is ready, you can export the obfuscated model as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">obf_config</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;obf_ratio&quot;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">,</span> <span class="s2">&quot;customized_func&quot;</span><span class="p">:</span> <span class="n">my_func</span><span class="p">}</span>
<span class="n">net</span> <span class="o">=</span> <span class="n">ObfuscateNet</span><span class="p">()</span>
<span class="n">ms</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="n">input_tensor</span><span class="p">,</span> <span class="n">file_name</span><span class="o">=</span><span class="s2">&quot;obf_net&quot;</span><span class="p">,</span> <span class="n">file_format</span><span class="o">=</span><span class="s2">&quot;MINDIR&quot;</span><span class="p">,</span> <span class="n">obf_config</span><span class="o">=</span><span class="n">obf_config</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="loading-the-obfuscated-model-in-customized-function-mode">
<h3>Loading the Obfuscated Model in Customized Function Mode<a class="headerlink" href="#loading-the-obfuscated-model-in-customized-function-mode" title="Permalink to this headline"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">load()</span></code> and <code class="docutils literal notranslate"><span class="pre">nn.GraphCell()</span></code> APIs of MindSpore can be used to load obfuscated models for inference. Ensure that the input <code class="docutils literal notranslate"><span class="pre">customized_func</span></code> must be correct (the function name and body must be the same as those set during obfuscation) when calling the <code class="docutils literal notranslate"><span class="pre">load()</span></code> API. Otherwise, the obtained inference result is incorrect.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">obf_graph</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;obf_net.mindir&quot;</span><span class="p">,</span> <span class="n">obf_func</span><span class="o">=</span><span class="n">my_func</span><span class="p">)</span>
<span class="n">obf_net</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">GraphCell</span><span class="p">(</span><span class="n">obf_graph</span><span class="p">)</span>
<span class="n">right_func_result</span> <span class="o">=</span> <span class="n">obf_net</span><span class="p">(</span><span class="n">input_tensor</span><span class="p">)</span><span class="o">.</span><span class="n">asnumpy</span><span class="p">()</span>
</pre></div>
</div>
</section>
</section>
<section id="using-obfuscate-model-to-export-obfuscated-models-and-deploying-inference">
<h2>Using <code class="docutils literal notranslate"><span class="pre">obfuscate_model()</span></code> to Export Obfuscated Models and Deploying Inference<a class="headerlink" href="#using-obfuscate-model-to-export-obfuscated-models-and-deploying-inference" title="Permalink to this headline"></a></h2>
<p><code class="docutils literal notranslate"><span class="pre">obfuscate_model()</span></code> is an API dedicated to MindIR model obfuscation.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ms</span><span class="o">.</span><span class="n">obfuscate_model</span><span class="p">(</span><span class="n">obf_config</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">obfuscate_model()</span></code> also provides the random_seed and customized function modes.
The following describes how to export and load obfuscated models in the two modes.</p>
<section id="exporting-an-obfuscated-model-in-random-seed-mode-1">
<h3>Exporting an Obfuscated Model in random_seed Mode<a class="headerlink" href="#exporting-an-obfuscated-model-in-random-seed-mode-1" title="Permalink to this headline"></a></h3>
<ol class="arabic">
<li><p>Set the obfuscation dictionary parameter.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">input_tensor</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>
<span class="n">obf_config</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;original_model_path&quot;</span><span class="p">:</span> <span class="s2">&quot;net.mindir&quot;</span><span class="p">,</span> <span class="s2">&quot;save_model_path&quot;</span><span class="p">:</span> <span class="s2">&quot;./obf_net&quot;</span><span class="p">,</span>
              <span class="s2">&quot;model_inputs&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">input_tensor</span><span class="p">],</span> <span class="s2">&quot;obf_ratio&quot;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">,</span> <span class="s2">&quot;obf_random_seed&quot;</span><span class="p">:</span> <span class="mi">3423</span><span class="p">}</span>
</pre></div>
</div>
<p>As shown in the preceding information, <code class="docutils literal notranslate"><span class="pre">original_model_path</span></code> indicates the path of a model to be obfuscated, <code class="docutils literal notranslate"><span class="pre">save_model_path</span></code> indicates the path for storing the output of the obfuscated model, and <code class="docutils literal notranslate"><span class="pre">model_inputs</span></code> indicates the tensor input to the model. The tensor value can be a random number, which is similar to the <code class="docutils literal notranslate"><span class="pre">inputs</span></code> of <code class="docutils literal notranslate"><span class="pre">export()</span></code>.
The <code class="docutils literal notranslate"><span class="pre">obf_ratio</span></code> and <code class="docutils literal notranslate"><span class="pre">obf_random_seed</span></code> parameters are the same as those of the <code class="docutils literal notranslate"><span class="pre">export()</span></code> API.</p>
</li>
<li><p>Export the obfuscated model.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ms</span><span class="o">.</span><span class="n">obfuscate_model</span><span class="p">(</span><span class="n">obf_config</span><span class="p">)</span>
</pre></div>
</div>
<p>After the preceding steps are complete, an obfuscated MindIR model is obtained.</p>
</li>
</ol>
</section>
<section id="loading-the-obfuscated-model-in-random-seed-mode-1">
<h3>Loading the Obfuscated Model in random_seed Mode<a class="headerlink" href="#loading-the-obfuscated-model-in-random-seed-mode-1" title="Permalink to this headline"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">load()</span></code> and <code class="docutils literal notranslate"><span class="pre">nn.GraphCell()</span></code> APIs of MindSpore can be used to load obfuscated models for inference. Ensure that the input <code class="docutils literal notranslate"><span class="pre">obf_random_seed</span></code> is correct when calling the <code class="docutils literal notranslate"><span class="pre">nn.GraphCell()</span></code> API. Otherwise, the obtained inference result is incorrect.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">obf_graph</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;obf_net.mindir&quot;</span><span class="p">)</span>
<span class="n">obf_net</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">GraphCell</span><span class="p">(</span><span class="n">obf_graph</span><span class="p">,</span> <span class="n">obf_random_seed</span><span class="o">=</span><span class="mi">3423</span><span class="p">)</span>
<span class="n">right_seed_result</span> <span class="o">=</span> <span class="n">obf_net</span><span class="p">(</span><span class="n">input_tensor</span><span class="p">)</span><span class="o">.</span><span class="n">asnumpy</span><span class="p">()</span>
</pre></div>
</div>
<p>To check whether the inference result is correct, you can obtain the inference result of the original model and compare <code class="docutils literal notranslate"><span class="pre">right_seed_result</span></code> with the inference result as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ori_net</span> <span class="o">=</span> <span class="n">ObfuscateNet</span><span class="p">()</span>
<span class="n">ms</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="n">ori_net</span><span class="p">,</span> <span class="n">input_tensor</span><span class="p">,</span> <span class="n">file_name</span><span class="o">=</span><span class="s2">&quot;net&quot;</span><span class="p">,</span> <span class="n">file_format</span><span class="o">=</span><span class="s2">&quot;MINDIR&quot;</span><span class="p">)</span>
<span class="n">original_graph</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;net.mindir&quot;</span><span class="p">)</span>
<span class="n">original_net</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">GraphCell</span><span class="p">(</span><span class="n">original_graph</span><span class="p">)</span>
<span class="n">original_predict_result</span> <span class="o">=</span> <span class="n">original_net</span><span class="p">(</span><span class="n">input_tensor</span><span class="p">)</span><span class="o">.</span><span class="n">asnumpy</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">original_predict_result</span> <span class="o">==</span> <span class="n">right_seed_result</span><span class="p">))</span>
<span class="c1"># True</span>
</pre></div>
</div>
</section>
<section id="exporting-obfuscated-models-in-customized-function-mode-only-for-the-cpu-hardware-environment-1">
<h3>Exporting Obfuscated Models in Customized Function Mode (Only for the CPU Hardware Environment)<a class="headerlink" href="#exporting-obfuscated-models-in-customized-function-mode-only-for-the-cpu-hardware-environment-1" title="Permalink to this headline"></a></h3>
<p>Similar to the <code class="docutils literal notranslate"><span class="pre">export</span></code> API, you need to prepare a customized function.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">my_func</span><span class="p">(</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x1</span><span class="p">)</span> <span class="o">+</span> <span class="nb">abs</span><span class="p">(</span><span class="n">x2</span><span class="p">)</span> <span class="o">&lt;</span> <span class="mi">0</span><span class="p">:</span>
        <span class="k">return</span> <span class="kc">True</span>
    <span class="k">return</span> <span class="kc">False</span>
</pre></div>
</div>
<p>Export the obfuscated model as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">net</span> <span class="o">=</span> <span class="n">ObfuscateNet</span><span class="p">()</span>
<span class="n">input_tensor</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>
<span class="n">obf_config</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;original_model_path&quot;</span><span class="p">:</span> <span class="s2">&quot;net.mindir&quot;</span><span class="p">,</span> <span class="s2">&quot;save_model_path&quot;</span><span class="p">:</span> <span class="s2">&quot;./obf_net&quot;</span><span class="p">,</span>
              <span class="s2">&quot;model_inputs&quot;</span><span class="p">:</span> <span class="p">[</span><span class="n">input_tensor</span><span class="p">],</span> <span class="s2">&quot;obf_ratio&quot;</span><span class="p">:</span> <span class="mf">0.8</span><span class="p">,</span> <span class="s2">&quot;customized_func&quot;</span><span class="p">:</span> <span class="n">my_func</span><span class="p">}</span>
<span class="n">ms</span><span class="o">.</span><span class="n">obfuscate_model</span><span class="p">(</span><span class="n">obf_config</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="loading-the-obfuscated-model-in-customized-function-mode-1">
<h3>Loading the Obfuscated Model in Customized Function Mode<a class="headerlink" href="#loading-the-obfuscated-model-in-customized-function-mode-1" title="Permalink to this headline"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">load()</span></code> and <code class="docutils literal notranslate"><span class="pre">nn.GraphCell()</span></code> APIs of MindSpore can be used to load obfuscated models for inference. Ensure that the input <code class="docutils literal notranslate"><span class="pre">customized_func</span></code> must be correct (the function name and body must be the same as those set during obfuscation) when calling the <code class="docutils literal notranslate"><span class="pre">load()</span></code> API. Otherwise, the obtained inference result is incorrect.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">obf_graph</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="s2">&quot;obf_net.mindir&quot;</span><span class="p">,</span> <span class="n">obf_func</span><span class="o">=</span><span class="n">my_func</span><span class="p">)</span>
<span class="n">obf_net</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">GraphCell</span><span class="p">(</span><span class="n">obf_graph</span><span class="p">)</span>
<span class="n">right_func_result</span> <span class="o">=</span> <span class="n">obf_net</span><span class="p">(</span><span class="n">input_tensor</span><span class="p">)</span><span class="o">.</span><span class="n">asnumpy</span><span class="p">()</span>
</pre></div>
</div>
<p>Note: Dynamic obfuscation currently does not support dynamic shape input, so <code class="docutils literal notranslate"><span class="pre">inputs</span></code> / <code class="docutils literal notranslate"><span class="pre">model_inputs</span></code> cannot be in the form of dynamic shapes (some dimensions of Tensors are None) when calling <code class="docutils literal notranslate"><span class="pre">export()</span></code> / <code class="docutils literal notranslate"><span class="pre">obfuscate_model()</span></code>. For example, <code class="docutils literal notranslate"><span class="pre">inputs=Tensor(shape=[1,</span> <span class="pre">1,</span> <span class="pre">None,</span> <span class="pre">None],</span> <span class="pre">dtype=ms.float32)</span></code> is not allowed.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="evaluation_of_CNNCTC.html" class="btn btn-neutral float-left" title="Evaluating the Robustness of the OCR Model CNN-CTC" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="model_encrypt_protection.html" class="btn btn-neutral float-right" title="Model Encryption Protection" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, MindSpore.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 
</body>
</html>