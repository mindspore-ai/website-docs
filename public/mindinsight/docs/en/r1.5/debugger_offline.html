

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Using the Offline Debugger &mdash; MindSpore master documentation</title>
  

  
   
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  
  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Explain Models" href="model_explanation.html" />
    <link rel="prev" title="Using Online Debugger" href="debugger_online.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> MindSpore
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Installation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="mindinsight_install.html">MindInsight Installation</a></li>
</ul>
<p class="caption"><span class="caption-text">Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="summary_record.html">Collecting Summary Record</a></li>
<li class="toctree-l1"><a class="reference internal" href="dashboard.html">Viewing Dashboard</a></li>
<li class="toctree-l1"><a class="reference internal" href="lineage_and_scalars_comparison.html">Viewing Lineage and Scalars Comparison</a></li>
<li class="toctree-l1"><a class="reference internal" href="hyper_parameters_auto_tuning.html">Use Mindoptimizer to Tune Hyperparameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="migrate_3rd_scripts_mindconverter.html">Migrating From Third Party Frameworks With MindConverter</a></li>
<li class="toctree-l1"><a class="reference internal" href="performance_profiling.html">Performance Profiling</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="debugger.html">Debugger</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="debugger_online.html">Using Online Debugger</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Using the Offline Debugger</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l3"><a class="reference internal" href="#operation-process">Operation Process</a></li>
<li class="toctree-l3"><a class="reference internal" href="#environment-preparation">Environment Preparation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#ui-introduction">UI Introduction</a></li>
<li class="toctree-l3"><a class="reference internal" href="#usage-example">Usage Example</a></li>
<li class="toctree-l3"><a class="reference internal" href="#precautions">Precautions</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="model_explanation.html">Explain Models</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindinsight_commands.html">MindInsight Commands</a></li>
</ul>
<p class="caption"><span class="caption-text">References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="training_visual_design.html">Overall Design of Training Visualization</a></li>
<li class="toctree-l1"><a class="reference internal" href="graph_visual_design.html">Computational Graph Visualization Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="tensor_visual_design.html">Tensor Visualization Design</a></li>
<li class="toctree-l1"><a class="reference internal" href="profiler_design.html">Performance Profiling Design</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">MindSpore</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="debugger.html">Debugger</a> &raquo;</li>
        
      <li>Using the Offline Debugger</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/debugger_offline.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="using-the-offline-debugger">
<h1>Using the Offline Debugger<a class="headerlink" href="#using-the-offline-debugger" title="Permalink to this headline">¶</a></h1>
<!-- TOC -->
<ul class="simple">
<li><p><a class="reference external" href="#using-the-offline-debugger">Using the Offline Debugger</a></p>
<ul>
<li><p><a class="reference external" href="#overview">Overview</a></p></li>
<li><p><a class="reference external" href="#operation-process">Operation Process</a></p></li>
<li><p><a class="reference external" href="#environment-preparation">Environment Preparation</a></p></li>
<li><p><a class="reference external" href="#ui-introduction">UI Introduction</a></p></li>
<li><p><a class="reference external" href="#usage-example">Usage Example</a></p></li>
<li><p><a class="reference external" href="#precautions">Precautions</a></p></li>
</ul>
</li>
</ul>
<!-- /TOC -->
<p><a href="https://gitee.com/mindspore/docs/blob/r1.5/docs/mindinsight/docs/source_en/debugger_offline.md" target="_blank"><img src="https://gitee.com/mindspore/docs/raw/r1.5/resource/_static/logo_source_en.png"></a></p>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>This article describes how to use Debugger in offline mode.</p>
</div>
<div class="section" id="operation-process">
<h2>Operation Process<a class="headerlink" href="#operation-process" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p>Prepare dump data. For details about how to use the dump function, see <a class="reference external" href="https://www.mindspore.cn/docs/programming_guide/en/r1.5/dump_in_graph_mode.html">Using Dump in the Graph Mode</a>.</p></li>
<li><p>Start MindInsight and set summary-base-dir to the summary-dir(summary-dir is the father directory of the path in the dump configuration) of one training or the father directory of more training using startup parameters.</p></li>
<li><p>Find the offline debugger entry from the Summary list, and click Offline Debugger. The debugger UI is displayed, and debugging analysis starts.</p></li>
</ol>
</div>
<div class="section" id="environment-preparation">
<h2>Environment Preparation<a class="headerlink" href="#environment-preparation" title="Permalink to this headline">¶</a></h2>
<p>Use the dump function of MindSpore to prepare offline data. For details about how to use the dump function, see <a class="reference external" href="https://www.mindspore.cn/docs/programming_guide/en/r1.5/dump_in_graph_mode.html">Using Dump in the Graph Mode</a>.</p>
<p>It should be noted that only one dump path can be included in a summary-dir. For example, if the path in the Dump configuration file is “/home/workspace/data/dump_dir” in one training, after the dump data of this training is stored,  the other trainnings cannot set the path in the Dump configuration file as the children directory of “/home/workspace/data”.</p>
<p>Start MindInsight and set summary-base-dir to the summary-dir of one training or the father directory of more training. Then, you can query the offline debugger entry on the UI.</p>
<p>MindInsight startup command:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>mindinsight start --port {PORT} --summary-base-dir {SUMMARY_BASE_DIR} --offline-debugger-mem-limit {OFFLINE_DEBUGGER_MEMORY_LIMIT} --max-offline-debugger-session-num {MAX_OFFLINE_DEBUGGER_SESSION_NUMBER}
</pre></div>
</div>
<p>Parameters are described as follows:</p>
<table border="1" class="docutils">
<thead>
<tr>
<th>Name</th>
<th>Attribute</th>
<th>Description</th>
<th>Type</th>
<th>Default Value</th>
<th>Range</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>--port {PORT}</code></td>
<td>Optional</td>
<td>Specifies the port number of the web visualization service.</td>
<td>Integer</td>
<td>8080</td>
<td>1–65535</td>
</tr>
<tr>
<td><code>--summary-base-dir {SUMMARY_BASE_DIR}</code></td>
<td>Mandatory</td>
<td>Specifies the upper one or two layers of a path in the Dump configuration. For example, if the path in the dump configuration file is set to <code>/home/workspace/data/dump_dir</code>, summary-base-dir can be set to <code>/home/workspace/data</code> or <code>/home/workspace</code>.</td>
<td>String</td>
<td>./</td>
<td>-</td>
</tr>
<tr>
<td><code>--offline-debugger-mem-limit &lt;OFFLINE_DEBUGGER_MEMORY_LIMIT&gt;</code></td>
<td>Optional</td>
<td>Specifies the maximum memory limit of a single offline debugger session. When the offline debugger cannot be executed due to insufficient memory, set it according to the device memory.</td>
<td>Integer</td>
<td>16*1024</td>
<td>6*1024~The upper limit of int32</td>
</tr>
<tr>
<td><code>--max-offline-debugger-session-num &lt;MAX_OFFLINE_DEBUGGER_SESSION_NUMBER&gt;</code></td>
<td>Optional</td>
<td>Specifies the maximum session number of the offline debugger. The session number refers to the amount of training jobs that can be debugged at the same time.</td>
<td>Integer</td>
<td>2</td>
<td>1~2</td>
</tr>
</tbody>
</table>
<p>For details about more startup parameters, see <a class="reference external" href="https://www.mindspore.cn/mindinsight/docs/en/r1.5/mindinsight_commands.html">MindInsight Commands</a>.</p>
<p>Open MindInsight and access the debugger UI from the offline debugger entry.</p>
<p><img alt="debugger_offline_entry" src="_images/debugger_offline_entry.png" /></p>
<p>Figure 1: Offline debugger entry</p>
</div>
<div class="section" id="ui-introduction">
<h2>UI Introduction<a class="headerlink" href="#ui-introduction" title="Permalink to this headline">¶</a></h2>
<p>The UI of the offline debugger is the same as that of the online debugger. For details about the online debugger UI, see <a class="reference external" href="https://www.mindspore.cn/mindinsight/docs/en/r1.5/debugger_online.html#debugger-ui-introduction">Debugger UI Introduction</a>.</p>
</div>
<div class="section" id="usage-example">
<h2>Usage Example<a class="headerlink" href="#usage-example" title="Permalink to this headline">¶</a></h2>
<ol>
<li><p>After the debugger environment is prepared, open the debugger UI, as shown in the following figure:</p>
<p><img alt="debugger_waiting" src="_images/debugger_offline_waiting.png" /></p>
<p>Figure 2: Debugger waiting for training connection</p>
<p>At this point, the debugger is in a state of loading offline data.</p>
</li>
<li><p>Wait for a moment. A dialog box is displayed on the MindInsight UI, asking you whether to use the recommended watchpoints. The following procedures are the same as that for online debugging. <a class="reference external" href="https://www.mindspore.cn/mindinsight/docs/en/r1.5/debugger.html#debugger-usage-example">Debugger Usage Example</a>.</p></li>
<li><p>Compared with the online debugger, the offline debugger can reset the training step. As shown in Figure 3, click the edit icon on the right, and an edit box will appear, as shown in Figure 4. Enter the step id to be reset and click the tick icon.</p>
<p><img alt="debugger_offline_reset" src="_images/debugger_offline_reset.png" /></p>
<p>Figure 3: Resetting the training step</p>
<p><img alt="debugger_offline_edit" src="_images/debugger_offline_edit.png" /></p>
<p>Figure 4: Resetting the trainning step in edit status</p>
</li>
</ol>
</div>
<div class="section" id="precautions">
<h2>Precautions<a class="headerlink" href="#precautions" title="Permalink to this headline">¶</a></h2>
<ul class="simple">
<li><p>Scenarios:</p>
<ul>
<li><p>The offline debugger does not support the CPU scenario currently.</p></li>
<li><p>The offline debugger supports the single-node multi-device scenario. To analyze the multi-node multi-device scenario, you need to summarize the data of multiple nodes.</p></li>
<li><p>The offline debugger does not support checking the initial weight.</p></li>
<li><p>The offline debugger does not support checking watchpoints in multi-graph scenario.</p></li>
</ul>
</li>
<li><p>GPU scenario:</p>
<ul>
<li><p>Different from the online debugger, the offline debugger does not support node-by-node execution.</p></li>
</ul>
</li>
<li><p>If there are more than one dump files of the same tensor in the same directory, offline debugger will only show the latest tensor.</p></li>
<li><p>When using the offline debugger, make sure that the version numbers of MindInsight and MindSpore are the same.</p></li>
<li><p>Only watchpoints that have tensor values are rechecked.</p></li>
<li><p>The graph displayed by the debugger is the finally optimized execution graph. The called operator may have been integrated with other operators, or the name of the called operator is changed after optimization.</p></li>
<li><p>If the asynchronous dump data in the Ascend scenario is used, you can use the <code class="docutils literal notranslate"><span class="pre">convert_all_data_to_host</span></code> API of MindInsight DumpParser to convert the asynchronous dump data into the <code class="docutils literal notranslate"><span class="pre">.npy</span></code> file to improve the data analysis efficiency. For details about how to use DumpParser, see <a class="reference external" href="https://gitee.com/mindspore/mindinsight/tree/r1.5/mindinsight/parser">DumpParser Introduction</a>.</p></li>
</ul>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="model_explanation.html" class="btn btn-neutral float-right" title="Explain Models" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="debugger_online.html" class="btn btn-neutral float-left" title="Using Online Debugger" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, MindSpore.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   
</body>
</html>