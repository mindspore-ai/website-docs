<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Initial Experience of Quantum Neural Network &mdash; MindSpore master documentation</title><script>;(()=>{const e=localStorage.getItem("ms-theme"),t=window.matchMedia("(prefers-color-scheme: dark)").matches;(e?"dark"===e:t)&&document.documentElement.setAttribute("data-o-theme","dark")})();</script><link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script><script src="../_static/jquery.js"></script>
        <script src="../_static/js/theme.js"></script><script src="../_static/underscore.js"></script><script src="../_static/doctools.js"></script><script crossorigin="anonymous" integrity="sha256-1fEPhSsRKlFKGfK3eO710tEweHh1fwokU5wFGDHO+vg=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js"></script><script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script><script async="async" src="https://mindspore-website.obs.cn-north-4.myhuaweicloud.com/mathjax/MathJax-3.2.2/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Equivalence Checking of Parameterized Quantum Circuits" href="equivalence_checking_of_PQC.html" />
    <link rel="prev" title="Advanced Gradient Calculation of Variational Quantum Circuits" href="get_gradient_of_PQC_with_mindquantum.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> MindSpore
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Beginner Tutorial</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../beginner/beginner.html">Beginner Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../beginner/parameterized_quantum_circuit.html">Variational Quantum Circuit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../beginner/quantum_simulator.html">Quantum Simulator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../beginner/quantum_measurement.html">Quantum Measurement</a></li>
<li class="toctree-l1"><a class="reference internal" href="../beginner/advanced_operations_of_quantum_circuit.html">Advanced Operations of Quantum Circuit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../beginner/bloch_sphere.html">Bloch Sphere</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Middle Level Tutorial</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../middle_level/middle_level.html">Middle Level Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../middle_level/noise.html">Noisy Quantum Circuit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../middle_level/noise_simulator.html">Noise Simulator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../middle_level/qubit_mapping.html">Qubit Mapping</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Advanced Tutorial</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="advanced.html">Advanced Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="get_gradient_of_PQC_with_mindquantum.html">Advanced Gradient Calculation of Variational Quantum Circuits</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Initial Experience of Quantum Neural Network</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#structure-of-quantum-neural-network">Structure of Quantum Neural Network</a></li>
<li class="toctree-l2"><a class="reference internal" href="#simple-example">Simple Example</a></li>
<li class="toctree-l2"><a class="reference internal" href="#environment-preparation">Environment Preparation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#building-encoder">Building Encoder</a></li>
<li class="toctree-l2"><a class="reference internal" href="#building-ansatz">Building Ansatz</a></li>
<li class="toctree-l2"><a class="reference internal" href="#building-hamiltonian">Building Hamiltonian</a></li>
<li class="toctree-l2"><a class="reference internal" href="#generate-variational-quantum-circuit-simulation-operators">Generate Variational Quantum Circuit Simulation Operators</a></li>
<li class="toctree-l2"><a class="reference internal" href="#building-a-quantum-neural-network">Building a Quantum Neural Network</a></li>
<li class="toctree-l2"><a class="reference internal" href="#training">Training</a></li>
<li class="toctree-l2"><a class="reference internal" href="#result-presentation">Result Presentation</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="equivalence_checking_of_PQC.html">Equivalence Checking of Parameterized Quantum Circuits</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Case Library</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../case_library/case_library.html">Case Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="../case_library/grover_search_algorithm.html">Grover Search and Long Algorithms Based on MindSpore Quantum</a></li>
<li class="toctree-l1"><a class="reference internal" href="../case_library/shor_algorithm.html">Shor’s Algorithm Based on MindSpore Quantum</a></li>
<li class="toctree-l1"><a class="reference internal" href="../case_library/hhl_algorithm.html">HHL Algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../case_library/quantum_phase_estimation.html">Quantum Phase Estimation Algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../case_library/quantum_approximate_optimization_algorithm.html">Quantum Approximate Optimization Algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../case_library/classification_of_iris_by_qnn.html">Classification of IRIS by Quantum Neural Network</a></li>
<li class="toctree-l1"><a class="reference internal" href="../case_library/vqe_for_quantum_chemistry.html">VQE Application in Quantum Chemistry Computing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../case_library/qnn_for_nlp.html">The Application of Quantum Neural Network in NLP</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../overview.html">overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mindquantum.dtype.html">mindquantum.dtype</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mindquantum.core.html">mindquantum.core</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mindquantum.simulator.html">mindquantum.simulator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mindquantum.framework.html">mindquantum.framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mindquantum.algorithm.html">mindquantum.algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mindquantum.device.html">mindquantum.device</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mindquantum.io.html">mindquantum.io</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mindquantum.engine.html">mindquantum.engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mindquantum.utils.html">mindquantum.utils</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Paper with Code</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../paper_with_code.html">Paper with Code</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">RELEASE NOTES</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../RELEASE.html">Release Notes</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Installation Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../mindquantum_install.html">MindSpore Quantum Installation</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MindSpore</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Initial Experience of Quantum Neural Network</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/advanced/initial_experience_of_quantum_neural_network.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars and line breaks on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
    white-space: pre;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
.jp-RenderedHTMLCommon table,
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
.jp-RenderedHTMLCommon thead,
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
.jp-RenderedHTMLCommon tr,
.jp-RenderedHTMLCommon th,
.jp-RenderedHTMLCommon td,
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
.jp-RenderedHTMLCommon th,
div.rendered_html th {
  font-weight: bold;
}
.jp-RenderedHTMLCommon tbody tr:nth-child(odd),
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.jp-RenderedHTMLCommon tbody tr:hover,
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="initial-experience-of-quantum-neural-network">
<h1>Initial Experience of Quantum Neural Network<a class="headerlink" href="#initial-experience-of-quantum-neural-network" title="Permalink to this headline"></a></h1>
<p>Translator: <a class="reference external" href="https://gitee.com/unseenme">unseenme</a></p>
<p><a class="reference external" href="https://mindspore-website.obs.cn-north-4.myhuaweicloud.com/notebook/master/mindquantum/en/advanced/mindspore_initial_experience_of_quantum_neural_network.ipynb"><img alt="Download Notebook" src="https://mindspore-website.obs.cn-north-4.myhuaweicloud.com/website-images/master/resource/_static/logo_notebook_en.svg" /></a>  <a class="reference external" href="https://mindspore-website.obs.cn-north-4.myhuaweicloud.com/notebook/master/mindquantum/en/advanced/mindspore_initial_experience_of_quantum_neural_network.py"><img alt="Download Code" src="https://mindspore-website.obs.cn-north-4.myhuaweicloud.com/website-images/master/resource/_static/logo_download_code_en.svg" /></a>  <a class="reference external" href="https://gitee.com/mindspore/docs/blob/master/docs/mindquantum/docs/source_en/advanced/initial_experience_of_quantum_neural_network.ipynb"><img alt="View source on Gitee" src="https://mindspore-website.obs.cn-north-4.myhuaweicloud.com/website-images/master/resource/_static/logo_source_en.svg" /></a></p>
<section id="structure-of-quantum-neural-network">
<h2>Structure of Quantum Neural Network<a class="headerlink" href="#structure-of-quantum-neural-network" title="Permalink to this headline"></a></h2>
<p>In MindSpore Quantum, the structure of the Quantum Neural Network (QNN) is shown in the figure below, which usually consists of three parts:</p>
<ol class="arabic simple">
<li><p>One (or more) encoding circuit(s) for encoding classical data to quantum data (usually called Encoder);</p></li>
<li><p>One (or more) training circuit(s) for training parameters in a quantum gate with parameters (usually called Ansatz);</p></li>
<li><p>One (or more) measurement(s) for detecting whether the measurement value (for example, the measurement in the Z direction is the projection of the quantum state of a qubit on the Z axis, and the measurement obtains the expected value of the quantum state with respect to the Pauli Z operator (not limited to the Pauli Z operator, it can be replaced by other operators)) is close to the target expected value.</p></li>
</ol>
<p><img alt="mindquantum" src="https://mindspore-website.obs.cn-north-4.myhuaweicloud.com/website-images/master/docs/mindquantum/docs/source_en/images/mindquantum.png" /></p>
<p>Below, we use a simple example to experience how to use MindSpore Quantum.</p>
</section>
<section id="simple-example">
<h2>Simple Example<a class="headerlink" href="#simple-example" title="Permalink to this headline"></a></h2>
<p><img alt="example circuit" src="https://mindspore-website.obs.cn-north-4.myhuaweicloud.com/website-images/master/docs/mindquantum/docs/source_en/images/example_circuit.png" /></p>
<p>We build a quantum neural network as shown in the figure above, where the Encoder consists of an <a class="reference external" href="https://www.mindspore.cn/mindquantum/docs/en/master/core/gates/mindquantum.core.gates.HGate.html">H</a> gate, an <a class="reference external" href="https://www.mindspore.cn/mindquantum/docs/en/master/core/gates/mindquantum.core.gates.RX.html">RX</a> gate, an <a class="reference external" href="https://www.mindspore.cn/mindquantum/docs/en/master/core/gates/mindquantum.core.gates.RY.html">RY</a> gate and an
<a class="reference external" href="https://www.mindspore.cn/mindquantum/docs/en/master/core/gates/mindquantum.core.gates.RZ.html">RZ</a> gate, Ansatz consists of an <a class="reference external" href="https://www.mindspore.cn/mindquantum/docs/en/master/core/gates/mindquantum.core.gates.RX.html">RX</a> gate and an <a class="reference external" href="https://www.mindspore.cn/mindquantum/docs/en/master/core/gates/mindquantum.core.gates.RY.html">RY</a> gate, and the measurement is The Pauli <code class="docutils literal notranslate"><span class="pre">Z</span></code> operator acting on the 0th qubit.</p>
<p>Problem description: We regard the Encoder as the error effect of the system on the initial quantum state (the parameters <span class="math notranslate nohighlight">\(\alpha_0, \alpha_1\)</span> and <span class="math notranslate nohighlight">\(\alpha_2\)</span> are a fixed value obtained by preprocessing the original classical data (optional), that is, the known value, which is set to 0.2, 0.3 and 0.4 here respectively). We need to train an Ansatz to cancel out this error, so that the final quantum state is still in the <span class="math notranslate nohighlight">\(|0\rangle\)</span> state.</p>
<p>Idea: Perform the Pauli <code class="docutils literal notranslate"><span class="pre">Z</span></code> operator measurement in the final state, and the measurement value at this time is the expected value of the quantum state at this time about the Pauli <code class="docutils literal notranslate"><span class="pre">Z</span></code> operator. Since <span class="math notranslate nohighlight">\(|0\rangle\)</span> is the eigenstate of operator <code class="docutils literal notranslate"><span class="pre">Z</span></code>, and the eigenvalue is 1, it is easy to know $ <span class="math">\langle 0</span>|Z|0:nbsphinx-math:<cite>rangle=1`$. That is, the target expectation is 1. Whether the state at this time is :math:`|0rangle</cite> can be verified by measuring the expected
value.</p>
<p>Solution: By training the parameters in the Ansatz, we hope that the measurement value is close to the target expected value. In other words, we only need to make the measurement value as close as possible to the expected value corresponding to the <span class="math notranslate nohighlight">\(|0\rangle\)</span> state with respect to the Pauli <code class="docutils literal notranslate"><span class="pre">Z</span></code> operator, then the state is <span class="math notranslate nohighlight">\(|0\rangle\)</span>, that is, the Ansatz cancels the error generated by the Encoder on the initial quantum state.</p>
</section>
<section id="environment-preparation">
<h2>Environment Preparation<a class="headerlink" href="#environment-preparation" title="Permalink to this headline"></a></h2>
<p>Import the modules that this tutorial depends on.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>                                          <span class="c1"># Import the numpy library and abbreviated as np</span>
<span class="kn">from</span> <span class="nn">mindquantum.core.circuit</span> <span class="kn">import</span> <span class="n">Circuit</span>                <span class="c1"># Import the Circuit module for building quantum circuits</span>
<span class="kn">from</span> <span class="nn">mindquantum.core.gates</span> <span class="kn">import</span> <span class="n">H</span><span class="p">,</span> <span class="n">RX</span><span class="p">,</span> <span class="n">RY</span><span class="p">,</span> <span class="n">RZ</span>            <span class="c1"># Import quantum gates H, RX, RY, RZ</span>
<span class="kn">from</span> <span class="nn">mindquantum.core.parameterresolver</span> <span class="kn">import</span> <span class="n">PRGenerator</span>  <span class="c1"># import a parameter generator</span>
</pre></div>
</div>
</div>
</section>
<section id="building-encoder">
<h2>Building Encoder<a class="headerlink" href="#building-encoder" title="Permalink to this headline"></a></h2>
<p>According to the quantum circuit diagram shown, we can build the Encoder in MindSpore Quantum.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># pylint: disable=W0104</span>
<span class="n">alpha</span> <span class="o">=</span> <span class="n">PRGenerator</span><span class="p">(</span><span class="s1">&#39;alpha&#39;</span><span class="p">)</span>          <span class="c1"># Initialize a parameter generator</span>
<span class="n">encoder</span> <span class="o">=</span> <span class="n">Circuit</span><span class="p">()</span>                   <span class="c1"># Initialize the quantum circuit</span>
<span class="n">encoder</span> <span class="o">+=</span> <span class="n">H</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>                    <span class="c1"># The H gate acts on the 0th qubit</span>
<span class="n">encoder</span> <span class="o">+=</span> <span class="n">RX</span><span class="p">(</span><span class="n">alpha</span><span class="o">.</span><span class="n">new</span><span class="p">())</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>      <span class="c1"># The RX(alpha_0) gate acts on the 0th qubit</span>
<span class="n">encoder</span> <span class="o">+=</span> <span class="n">RY</span><span class="p">(</span><span class="n">alpha</span><span class="o">.</span><span class="n">new</span><span class="p">())</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>      <span class="c1"># The RY(alpha_1) gate acts on the 0th qubit</span>
<span class="n">encoder</span> <span class="o">+=</span> <span class="n">RZ</span><span class="p">(</span><span class="n">alpha</span><span class="o">.</span><span class="n">new</span><span class="p">())</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>      <span class="c1"># The RZ(alpha_2) gate acts on the 0th qubit</span>
<span class="n">encoder</span> <span class="o">=</span> <span class="n">encoder</span><span class="o">.</span><span class="n">no_grad</span><span class="p">()</span>           <span class="c1"># As the first layer of the entire quantum neural network, the Encoder does not need to take the derivative of the gradient in the encoding circuit, so no_grad() is added.</span>
<span class="n">encoder</span><span class="o">.</span><span class="n">as_encoder</span><span class="p">()</span>
<span class="n">encoder</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>                     <span class="c1"># Print the summary of Encoder</span>
<span class="n">encoder</span><span class="o">.</span><span class="n">svg</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #ff0000; text-decoration-color: #ff0000; font-weight: bold">                 Circuit Summary                 </span>
╭──────────────────────┬────────────────────────╮
│<span style="font-weight: bold"> </span><span style="color: #3b3b95; text-decoration-color: #3b3b95; font-weight: bold">Info</span><span style="font-weight: bold">                 </span>│<span style="font-weight: bold"> </span><span style="color: #3b3b95; text-decoration-color: #3b3b95; font-weight: bold">value</span><span style="font-weight: bold">                  </span>│
├──────────────────────┼────────────────────────┤
│ <span style="font-weight: bold">Number of qubit</span>      │ 1                      │
├──────────────────────┼────────────────────────┤
│ <span style="font-weight: bold">Total number of gate</span> │ 4                      │
│ Barrier              │ 0                      │
│ Noise Channel        │ 0                      │
│ Measurement          │ 0                      │
├──────────────────────┼────────────────────────┤
│ <span style="font-weight: bold">Parameter gate</span>       │ 3                      │
│ 3 encoder parameters │ <span style="color: #ffc857; text-decoration-color: #ffc857">alpha0, alpha1, alpha2</span> │
╰──────────────────────┴────────────────────────╯
</pre></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/advanced_initial_experience_of_quantum_neural_network_3_1.svg" src="../_images/advanced_initial_experience_of_quantum_neural_network_3_1.svg" /></div>
</div>
<p>As can be seen from the Summary of Encoder, the quantum circuit consists of 4 quantum gates, of which there are 3 quantum gates with parameters and the parameters are <span class="math notranslate nohighlight">\(\alpha_0,\alpha_1,\alpha_2\)</span>​​​​, and the number of qubits regulated by the quantum circuit is 1.</p>
<p>Then, we need to assign values to the parameters in the Encoder. Since the parameters <span class="math notranslate nohighlight">\(\alpha_0, \alpha_1\)</span> and <span class="math notranslate nohighlight">\(\alpha_2\)</span>​ in the Encoder are known values of 0.2, 0.3 and 0.4, respectively, the values are assigned direactly on the parameters and the state at this time can be printed.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">alpha0</span><span class="p">,</span> <span class="n">alpha1</span><span class="p">,</span> <span class="n">alpha2</span> <span class="o">=</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.4</span>              <span class="c1"># alpha0, alpha1, alpha2 are known fixed values, assigned 0.2, 0.3 and 0.4 respectively</span>
<span class="n">state</span> <span class="o">=</span> <span class="n">encoder</span><span class="o">.</span><span class="n">get_qs</span><span class="p">(</span><span class="n">pr</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;alpha0&#39;</span><span class="p">:</span> <span class="n">alpha0</span><span class="p">,</span> <span class="s1">&#39;alpha1&#39;</span><span class="p">:</span> <span class="n">alpha1</span><span class="p">,</span> <span class="s1">&#39;alpha2&#39;</span><span class="p">:</span> <span class="n">alpha2</span><span class="p">},</span> <span class="n">ket</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(0.5669903122552596-0.1753906567580312j)¦0⟩
(0.800814626197614+0.08034947292077024j)¦1⟩
</pre></div></div>
</div>
<p>The above steps are in order to show that MindSpore Quantum can evolve the quantum circuit (if the quantum gate in the quantum circuit has parameters, you need to assign values to the parameters) and obtain the final state after evolution. It can be seen from the above printing that the final state obtained after evolution is a superposition state composed of <span class="math notranslate nohighlight">\(|0\rangle\)</span> ​​​and <span class="math notranslate nohighlight">\(|1\rangle\)</span>, and the corresponding amplitude of each item is the value corresponding to the left side of
the above-printed state.</p>
<p>Note:</p>
<ol class="arabic simple">
<li><p>By calling the <a class="reference external" href="https://www.mindspore.cn/mindquantum/docs/en/master/core/circuit/mindquantum.core.circuit.Circuit.html#mindquantum.core.circuit.Circuit.get_qs">get_qs</a> function of the quantum circuit, we can obtain the quantum state evolved from the quantum circuit based on the all-zero state.</p></li>
<li><p>The <code class="docutils literal notranslate"><span class="pre">pr</span></code> parameter of the <a class="reference external" href="https://www.mindspore.cn/mindquantum/docs/en/master/core/circuit/mindquantum.core.circuit.Circuit.html#mindquantum.core.circuit.Circuit.get_qs">get_qs</a> represents the parameter value in the variational quantum circuit, and the <code class="docutils literal notranslate"><span class="pre">ket</span></code> represents whether to output the quantum state as a right vector form.</p></li>
</ol>
</section>
<section id="building-ansatz">
<h2>Building Ansatz<a class="headerlink" href="#building-ansatz" title="Permalink to this headline"></a></h2>
<p>Similarly, we can also build Ansatz in MindSpore Quantum.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># pylint: disable=W0104</span>
<span class="n">theta</span> <span class="o">=</span> <span class="n">PRGenerator</span><span class="p">(</span><span class="s1">&#39;theta&#39;</span><span class="p">)</span>                 <span class="c1"># Initialize a parameter generator</span>
<span class="n">ansatz</span> <span class="o">=</span> <span class="n">Circuit</span><span class="p">()</span>                           <span class="c1"># Initialize the quantum circuit</span>
<span class="n">ansatz</span> <span class="o">+=</span> <span class="n">RX</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;theta</span><span class="si">{</span><span class="mi">0</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>              <span class="c1"># The RX(theta_0) gate acts on the 0th qubit</span>
<span class="n">ansatz</span> <span class="o">+=</span> <span class="n">RY</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;theta</span><span class="si">{</span><span class="mi">1</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>              <span class="c1"># The RY(theta_1) gate acts on the 0th qubit</span>
<span class="n">ansatz</span><span class="o">.</span><span class="n">as_ansatz</span><span class="p">()</span>                           <span class="c1"># Printing quantum circuits</span>
<span class="n">ansatz</span><span class="o">.</span><span class="n">svg</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/advanced_initial_experience_of_quantum_neural_network_7_0.svg" src="../_images/advanced_initial_experience_of_quantum_neural_network_7_0.svg" /></div>
</div>
<p>It can be seen from the summary of Ansatz that the quantum circuit consists of 2 quantum gates, of which there are 2 quantum gates with parameters and the parameters are <span class="math notranslate nohighlight">\(\theta_0,\theta_1\)</span>, and the number of qubits regulated by the quantum circuit is 1.</p>
<p>Then, assigning values to the parameters in Ansatz. Since Ansatz is a quantum circuit that needs to be trained, the parameters <span class="math notranslate nohighlight">\(\theta_0\)</span>​​ and <span class="math notranslate nohighlight">\(\theta_1\)</span>​​ in Ansatz can be set randomly, and are usually set to the initial value of 0 by default. We can also print the quantum state at this time, but this is not a necessary step, just to get familiar with the get_qs function again.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">theta0</span><span class="p">,</span> <span class="n">theta1</span> <span class="o">=</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span>                        <span class="c1"># Assign theta0, theta1 to the initial value 0, 0</span>
<span class="n">state</span> <span class="o">=</span> <span class="n">ansatz</span><span class="o">.</span><span class="n">get_qs</span><span class="p">(</span><span class="n">pr</span><span class="o">=</span><span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">ansatz</span><span class="o">.</span><span class="n">params_name</span><span class="p">,</span> <span class="p">[</span><span class="n">theta0</span><span class="p">,</span> <span class="n">theta1</span><span class="p">])),</span> <span class="n">ket</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
1¦0⟩
</pre></div></div>
</div>
<p>As you can see from the above print, the state at this time is <span class="math notranslate nohighlight">\(|0\rangle\)</span> ​​and the amplitude is 1. This is because for Ansatz, the default input quantum state is <span class="math notranslate nohighlight">\(|0\rangle\)</span>​​, and the parameters <span class="math notranslate nohighlight">\(\theta_0\)</span>​​ and <span class="math notranslate nohighlight">\(\theta_1\)</span> are both 0. At this time, the <a class="reference external" href="https://www.mindspore.cn/mindquantum/docs/en/master/core/gates/mindquantum.core.gates.RX.html">RX(0)</a> gate and the
<a class="reference external" href="https://www.mindspore.cn/mindquantum/docs/en/master/core/gates/mindquantum.core.gates.RY.html">RY(0)</a> gate are both equivalent to the <a class="reference external" href="https://www.mindspore.cn/mindquantum/docs/en/master/core/gates/mindquantum.core.gates.IGate.html">I</a> gate, so the entire circuit evolution process is <span class="math notranslate nohighlight">\(|0\rangle\)</span> ​​passing after <span class="math notranslate nohighlight">\(I\cdot I\)</span>, then the final output state is of course <span class="math notranslate nohighlight">\(|0\rangle\)</span>​​​.</p>
<p>Then the complete quantum circuit is Encoder plus Ansatz.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># pylint: disable=W0104</span>
<span class="n">circuit</span> <span class="o">=</span> <span class="n">encoder</span><span class="o">.</span><span class="n">as_encoder</span><span class="p">()</span> <span class="o">+</span> <span class="n">ansatz</span><span class="o">.</span><span class="n">as_ansatz</span><span class="p">()</span>                   <span class="c1"># The complete quantum circuit consists of Encoder and Ansatz</span>
<span class="n">circuit</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
<span class="n">circuit</span><span class="o">.</span><span class="n">svg</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #ff0000; text-decoration-color: #ff0000; font-weight: bold">                 Circuit Summary                 </span>
╭──────────────────────┬────────────────────────╮
│<span style="font-weight: bold"> </span><span style="color: #3b3b95; text-decoration-color: #3b3b95; font-weight: bold">Info</span><span style="font-weight: bold">                 </span>│<span style="font-weight: bold"> </span><span style="color: #3b3b95; text-decoration-color: #3b3b95; font-weight: bold">value</span><span style="font-weight: bold">                  </span>│
├──────────────────────┼────────────────────────┤
│ <span style="font-weight: bold">Number of qubit</span>      │ 1                      │
├──────────────────────┼────────────────────────┤
│ <span style="font-weight: bold">Total number of gate</span> │ 6                      │
│ Barrier              │ 0                      │
│ Noise Channel        │ 0                      │
│ Measurement          │ 0                      │
├──────────────────────┼────────────────────────┤
│ <span style="font-weight: bold">Parameter gate</span>       │ 5                      │
│ 3 encoder parameters │ <span style="color: #ffc857; text-decoration-color: #ffc857">alpha0, alpha1, alpha2</span> │
│ 2 ansatz parameters  │ <span style="color: #48c9b0; text-decoration-color: #48c9b0">theta0, theta1</span>         │
╰──────────────────────┴────────────────────────╯
</pre></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/advanced_initial_experience_of_quantum_neural_network_11_1.svg" src="../_images/advanced_initial_experience_of_quantum_neural_network_11_1.svg" /></div>
</div>
<p>From the summary of the complete quantum circuit, it can be seen that the quantum circuit consists of 6 quantum gates, of which there are 5 quantum gates with parameters and the parameters are <span class="math notranslate nohighlight">\(\alpha_0,\alpha_1,\alpha_2,\theta_0,\theta_1\)</span>​​​, and the number of qubits regulated by the quantum circuit is 1.</p>
</section>
<section id="building-hamiltonian">
<h2>Building Hamiltonian<a class="headerlink" href="#building-hamiltonian" title="Permalink to this headline"></a></h2>
<p>We perform a Pauli <code class="docutils literal notranslate"><span class="pre">Z</span></code> operator measurement on the 0th qubit to construct the corresponding <a class="reference external" href="https://www.mindspore.cn/mindquantum/docs/en/master/core/operators/mindquantum.core.operators.Hamiltonian.html">Hamiltonian</a>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mindquantum.core.operators</span> <span class="kn">import</span> <span class="n">QubitOperator</span>           <span class="c1"># Import the QubitOperator module for constructing the Pauli operator</span>
<span class="kn">from</span> <span class="nn">mindquantum.core.operators</span> <span class="kn">import</span> <span class="n">Hamiltonian</span>             <span class="c1"># Import the Hamiltonian module for building the Hamiltonian</span>

<span class="n">ham</span> <span class="o">=</span> <span class="n">Hamiltonian</span><span class="p">(</span><span class="n">QubitOperator</span><span class="p">(</span><span class="s1">&#39;Z0&#39;</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">))</span>           <span class="c1"># Perform the Pauli Z operator measurement on the 0th qubit and set the coefficient to -1 to construct the corresponding Hamiltonian</span>
<span class="nb">print</span><span class="p">(</span><span class="n">ham</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
-1 [Z0]
</pre></div></div>
</div>
<p>As can be seen from the above printing, the Hamiltonian constructed at this time is to perform the Pauli <code class="docutils literal notranslate"><span class="pre">Z</span></code> operator measurement on the 0th qubit, and the coefficient is -1. The reason why the coefficient is set to -1 is that during the training of the quantum neural network, the gradient of the parameters in Ansatz will always decrease, and the measurement value will always decrease. If it finally converges to -1, the corresponding quantum state is <span class="math notranslate nohighlight">\(|1\rangle\)</span> instead of
<span class="math notranslate nohighlight">\(|0\rangle\)</span>​, as shown below</p>
<div class="math notranslate nohighlight">
\[\langle 1|Z|1\rangle=-1.\]</div>
<p>What we want is the <span class="math notranslate nohighlight">\(|0\rangle\)</span> state. Therefore, set the coefficient to -1, then when the measurement value is -1, the corresponding quantum state is the <span class="math notranslate nohighlight">\(|0\rangle\)</span> state, as shown below</p>
<div class="math notranslate nohighlight">
\[\langle 0|(-Z)|0\rangle=-1.\]</div>
<p>Note:</p>
<ol class="arabic simple">
<li><p><a class="reference external" href="https://www.mindspore.cn/mindquantum/docs/en/master/core/operators/mindquantum.core.operators.QubitOperator.html">QubitOperator</a> is the sum of operators acting on qubits and is mainly used to construct Pauli operators; the general format is as follows: <code class="docutils literal notranslate"><span class="pre">QubitOperator(term=None,</span> <span class="pre">coefficient=1.0)</span></code>;</p></li>
<li><p><a class="reference external" href="https://www.mindspore.cn/mindquantum/docs/en/master/core/operators/mindquantum.core.operators.Hamiltonian.html">Hamiltonian</a> is a Hamiltonian wrapper, which is mainly used to construct a Hamiltonian. The general format is as follows: <code class="docutils literal notranslate"><span class="pre">Hamiltonian(QubitOperator('X0</span> <span class="pre">Y2',</span> <span class="pre">0.5))</span></code>, <code class="docutils literal notranslate"><span class="pre">X0</span></code> and <code class="docutils literal notranslate"><span class="pre">Y2</span></code> indicate that the Pauli <code class="docutils literal notranslate"><span class="pre">X</span></code> operator acts on the 0th position Qubit, and the Pauli <code class="docutils literal notranslate"><span class="pre">Y</span></code> operator acts on the second qubit with a coefficient of 0.5.</p></li>
</ol>
</section>
<section id="generate-variational-quantum-circuit-simulation-operators">
<h2>Generate Variational Quantum Circuit Simulation Operators<a class="headerlink" href="#generate-variational-quantum-circuit-simulation-operators" title="Permalink to this headline"></a></h2>
<p>For the quantum circuit built above, we can generate a variational quantum circuit simulation operator in MindSpore Quantum to simulate it.</p>
<p>First, for convenience, we name the parameter arrays in Encoder and Ansatz as encoder_names and ansatz_names, respectively.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">encoder_names</span> <span class="o">=</span> <span class="n">encoder</span><span class="o">.</span><span class="n">params_name</span>                   <span class="c1"># An array of all parameters in the Encoder, the system will automatically generate encoder.para_name</span>
<span class="n">ansatz_names</span> <span class="o">=</span> <span class="n">ansatz</span><span class="o">.</span><span class="n">params_name</span>                     <span class="c1"># An array of all parameters in the Ansatz, the system will automatically generate ansatz.para_name</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;encoder_names = &#39;</span><span class="p">,</span> <span class="n">encoder</span><span class="o">.</span><span class="n">params_name</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">ansatz_names =&#39;</span><span class="p">,</span> <span class="n">ansatz</span><span class="o">.</span><span class="n">params_name</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
encoder_names =  [&#39;alpha0&#39;, &#39;alpha1&#39;, &#39;alpha2&#39;]
ansatz_names = [&#39;theta0&#39;, &#39;theta1&#39;]
</pre></div></div>
</div>
<p>As can be seen from the above print, encoder_names is an array composed of all parameters <span class="math notranslate nohighlight">\(\alpha_0, \alpha_1, \alpha_2\)</span>​ in Encoder, ansatz_names is an array composed of all parameters <span class="math notranslate nohighlight">\(\theta_0,\theta_1\)</span> in Ansatz, these two arrays will be used to generate variational quantum circuit simulation operators.</p>
<p>Then, we obtain the operator for the evolution of the variational quantum circuit and the gradient solution by the <a class="reference external" href="https://www.mindspore.cn/mindquantum/docs/en/master/simulator/mindquantum.simulator.Simulator.html">Simulator</a> module.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import Simulator module</span>
<span class="kn">from</span> <span class="nn">mindquantum.simulator</span> <span class="kn">import</span> <span class="n">Simulator</span>

<span class="c1"># Generate a simulator based on the mqvector backend, and set the number of bits of the simulator to the number of bits of the quantum circuit.</span>
<span class="n">sim</span> <span class="o">=</span> <span class="n">Simulator</span><span class="p">(</span><span class="s1">&#39;mqvector&#39;</span><span class="p">,</span> <span class="n">circuit</span><span class="o">.</span><span class="n">n_qubits</span><span class="p">)</span>

<span class="c1"># Obtain the evolution of the quantum circuit based on the current quantum state of the simulator and the expectation and gradient solution operators</span>
<span class="n">grad_ops</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">get_expectation_with_grad</span><span class="p">(</span><span class="n">ham</span><span class="p">,</span>
                                         <span class="n">circuit</span><span class="p">)</span>

<span class="c1"># An array of three parameters alpha0, alpha1, alpha2 in Encoder,</span>
<span class="c1"># Convert its data type to float32 and store it in encoder_data.</span>
<span class="c1"># MindSpore Quantum supports batch training with multiple samples. The Encoder array is two dimensions.</span>
<span class="c1"># The first dimension is the sample, and the second dimension is the feature (ie parameter)</span>
<span class="n">encoder_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">alpha0</span><span class="p">,</span> <span class="n">alpha1</span><span class="p">,</span> <span class="n">alpha2</span><span class="p">]])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

<span class="c1"># The array composed of theta0 and theta1 parameters in Ansatz, convert its data type to float32,</span>
<span class="c1"># And stored in ansatzr_data, Ansatz data has only one dimension, features (ie parameters)</span>
<span class="n">ansatz_data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">theta0</span><span class="p">,</span> <span class="n">theta1</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

<span class="c1"># According to the data of the Encoder and Ansatz, output the measurement value of the variable sub-circuit, the derivative of the parameter in the Encoder and the derivative of the parameter in Ansatz</span>
<span class="n">measure_result</span><span class="p">,</span> <span class="n">encoder_grad</span><span class="p">,</span> <span class="n">ansatz_grad</span> <span class="o">=</span> <span class="n">grad_ops</span><span class="p">(</span><span class="n">encoder_data</span><span class="p">,</span> <span class="n">ansatz_data</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Measurement result: &#39;</span><span class="p">,</span> <span class="n">measure_result</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Gradient of encoder parameters: &#39;</span><span class="p">,</span> <span class="n">encoder_grad</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Gradient of ansatz parameters: &#39;</span><span class="p">,</span> <span class="n">ansatz_grad</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Measurement result:  [[0.29552022+0.j]]
Gradient of encoder parameters:  [[[0.+0.j 0.+0.j 0.+0.j]]]
Gradient of ansatz parameters:  [[[-0.37202556+0.j  0.87992317+0.j]]]
</pre></div></div>
</div>
<p>As can be seen from the above print, the measurement result (expected value) is 0.29552022, the derivatives of the 3 parameters in the Encoder are 0, 0, 0 (because we called <a class="reference external" href="https://www.mindspore.cn/mindquantum/docs/en/master/core/circuit/mindquantum.core.circuit.Circuit.html#mindquantum.core.circuit.Circuit.no_grad">no_grad()</a> of the Encoder), and the derivatives of the 2 parameters in Ansatz are -0.37202555 and -0.87992316.</p>
<p>Here, what is generated by <a class="reference external" href="https://www.mindspore.cn/mindquantum/docs/en/master/simulator/mindquantum.simulator.Simulator.html#mindquantum.simulator.Simulator.get_expectation_with_grad">get_expectation_with_grad</a> is just an operator, which cannot be trained yet. It can only be trained by putting it in the quantum neural network. By training the parameters in Ansatz, the derivative of the parameters in Ansatz can be kept decreasing and close to 0, so the measurement value will be close to -1.</p>
<p>Note:</p>
<ol class="arabic simple">
<li><p>The <a class="reference external" href="https://www.mindspore.cn/mindquantum/docs/en/master/simulator/mindquantum.simulator.Simulator.html#mindquantum.simulator.Simulator.get_expectation_with_grad">get_expectation_with_grad</a> of the <a class="reference external" href="https://www.mindspore.cn/mindquantum/docs/en/master/simulator/mindquantum.simulator.Simulator.html">Simulator</a> is used to generate a variational quantum circuit to simulate the operator. The general format is as follows:</p></li>
</ol>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">Simulator</span><span class="o">.</span><span class="n">get_expectation_with_grad</span><span class="p">(</span><span class="n">ham</span><span class="p">,</span>
                                    <span class="n">circ_right</span><span class="p">,</span>
                                    <span class="n">circ_left</span><span class="p">,</span>
                                    <span class="n">simulator_left</span><span class="p">,</span>
                                    <span class="n">parallel_worker</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
<p>This function is suitable for computing the following models: <span class="math notranslate nohighlight">\(E=\left&lt;\varphi\right|U^\dagger_l(\theta) H U_r(\theta)\left|\psi\right&gt;\)</span> Where <code class="docutils literal notranslate"><span class="pre">circ_right</span></code> is <span class="math notranslate nohighlight">\(U_r\)</span>, <code class="docutils literal notranslate"><span class="pre">circ_left</span></code> is <span class="math notranslate nohighlight">\(U_l\)</span>, when not provided, the default is the same circuit as <code class="docutils literal notranslate"><span class="pre">circ_right</span></code>, <code class="docutils literal notranslate"><span class="pre">parallel_worker</span></code> specifies the number of parallels, <span class="math notranslate nohighlight">\(\left|\psi\right&gt;\)</span> is the quantum state of this simulator, and <span class="math notranslate nohighlight">\(\left|\varphi\right&gt;\)</span> is the quantum state of <code class="docutils literal notranslate"><span class="pre">simulator_left</span></code>. When the classical
data to be encoded is a batch, setting this parameter reasonably can improve the calculation efficiency.</p>
<ol class="arabic simple" start="2">
<li><p>MindSpore is a full-scene deep learning framework, aiming to achieve three goals of easy development, efficient execution, and unified deployment for all scenarios, provides tensor-differentiable programmability that supports heterogeneous acceleration, supports cloud, server, edge and end multiple hardware platforms.</p></li>
</ol>
</section>
<section id="building-a-quantum-neural-network">
<h2>Building a Quantum Neural Network<a class="headerlink" href="#building-a-quantum-neural-network" title="Permalink to this headline"></a></h2>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># pylint: disable=W0104</span>
<span class="kn">from</span> <span class="nn">mindquantum.framework</span> <span class="kn">import</span> <span class="n">MQLayer</span>          <span class="c1"># Import MQLayer</span>
<span class="kn">import</span> <span class="nn">mindspore</span> <span class="k">as</span> <span class="nn">ms</span>                             <span class="c1"># Import mindspore</span>

<span class="n">ms</span><span class="o">.</span><span class="n">set_seed</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>                                     <span class="c1"># Set the seed for generating random numbers</span>
<span class="n">ms</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">PYNATIVE_MODE</span><span class="p">,</span> <span class="n">device_target</span><span class="o">=</span><span class="s2">&quot;CPU&quot;</span><span class="p">)</span>

<span class="n">QuantumNet</span> <span class="o">=</span> <span class="n">MQLayer</span><span class="p">(</span><span class="n">grad_ops</span><span class="p">)</span>
<span class="n">QuantumNet</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
MQLayer&lt;
  (evolution): MQOps&lt;1 qubit mqvector VQA Operator&gt;
  &gt;
</pre></div></div>
</div>
<p>As can be seen from the above printing, we have successfully built a quantum machine learning layer, which can seamlessly form a larger machine learning network with other operators in MindSpore.</p>
<p>Note:</p>
<ol class="arabic simple">
<li><p>The quantum circuit gradient calculation operators in MindSpore Quantum are all under <code class="docutils literal notranslate"><span class="pre">PYNATIVE_MODE</span></code>, so the operation mode of MindSpore needs to be set.</p></li>
<li><p>We can also build the quantum machine learning layer by the following code, but in MindSpore Quantum, the following code has been packaged, so that we can directly use the <a class="reference external" href="https://www.mindspore.cn/mindquantum/docs/en/master/framework/layer/mindquantum.framework.MQLayer.html">MQLayer</a> module to build the quantum machine learning layer. For more complex quantum-classical hybrid neural networks, the following construction will demonstrate its advantages.</p></li>
</ol>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mindspore</span> <span class="kn">import</span> <span class="n">nn</span>

<span class="k">class</span> <span class="nc">MQLayer</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Cell</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">expectation_with_grad</span><span class="p">,</span> <span class="n">weight</span><span class="o">=</span><span class="s1">&#39;normal&#39;</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">MQLayer</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">evolution</span> <span class="o">=</span> <span class="n">MQOps</span><span class="p">(</span><span class="n">expectation_with_grad</span><span class="p">)</span>
        <span class="n">weight_size</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">evolution</span><span class="o">.</span><span class="n">expectation_with_grad</span><span class="o">.</span><span class="n">ansatz_params_name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">weight</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="n">initializer</span><span class="p">(</span><span class="n">weight</span><span class="p">,</span>
                                            <span class="n">weight_size</span><span class="p">,</span>
                                            <span class="n">dtype</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span>
                                <span class="n">name</span><span class="o">=</span><span class="s1">&#39;ansatz_weight&#39;</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">construct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">evolution</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">weight</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="training">
<h2>Training<a class="headerlink" href="#training" title="Permalink to this headline"></a></h2>
<p>We use the <a class="reference external" href="https://www.mindspore.cn/docs/en/master/api_python/nn/mindspore.nn.Adam.html#mindspore.nn.Adam">Adam</a> optimizer to optimize the parameters in Ansatz.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mindspore.nn</span> <span class="kn">import</span> <span class="n">Adam</span><span class="p">,</span> <span class="n">TrainOneStepCell</span>                   <span class="c1"># Import Adam module and TrainOneStepCell module</span>

<span class="n">opti</span> <span class="o">=</span> <span class="n">Adam</span><span class="p">(</span><span class="n">QuantumNet</span><span class="o">.</span><span class="n">trainable_params</span><span class="p">(),</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.5</span><span class="p">)</span>     <span class="c1"># What needs to be optimized is the trainable parameters in Quantumnet, and the learning rate is set to 0.5</span>
<span class="n">net</span> <span class="o">=</span> <span class="n">TrainOneStepCell</span><span class="p">(</span><span class="n">QuantumNet</span><span class="p">,</span> <span class="n">opti</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">200</span><span class="p">):</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">net</span><span class="p">(</span><span class="n">ms</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><span class="n">encoder_data</span><span class="p">))</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">%</span> <span class="mi">10</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="s1">&#39;: &#39;</span><span class="p">,</span> <span class="n">res</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0 :  [[0.30633032]]
10 :  [[-0.87929225]]
20 :  [[-0.9726834]]
30 :  [[-0.9935059]]
40 :  [[-0.9934296]]
50 :  [[-0.996459]]
60 :  [[-0.99859095]]
70 :  [[-0.9995031]]
80 :  [[-0.9998626]]
90 :  [[-0.9999718]]
100 :  [[-0.9999983]]
110 :  [[-0.9999993]]
120 :  [[-0.99999785]]
130 :  [[-0.9999986]]
140 :  [[-0.9999997]]
150 :  [[-1.]]
160 :  [[-0.99999994]]
170 :  [[-1.]]
180 :  [[-1.]]
190 :  [[-1.]]
</pre></div></div>
</div>
<p>As you can see from the above print, finally the measured value converges to -1.</p>
<p>Note:</p>
<ol class="arabic simple">
<li><p>The <a class="reference external" href="https://www.mindspore.cn/docs/en/master/api_python/nn/mindspore.nn.Adam.html#mindspore.nn.Adam">Adam</a> module updates the gradient by the adaptive moment estimation algorithm, which can optimize the parameters in Ansazt, and the input is the trainable parameters in the neural network; the general format is as follows: <code class="docutils literal notranslate"><span class="pre">nn.Adam(net.trainable_params(),</span> <span class="pre">learning_rate=0.5)</span></code>;</p></li>
<li><p>The <a class="reference external" href="https://www.mindspore.cn/docs/en/master/api_python/nn/mindspore.nn.TrainOneStepCell.html#mindspore.nn.TrainOneStepCell">TrainOneStepCell</a> module is a network training package class that wraps the network with an optimizer. The resulting cells are trained with the input “inputs”, an inverse graph will be generated in the constructor to update the parameters, and there are different parallel modes available for training. The general format is as follows:
<code class="docutils literal notranslate"><span class="pre">nn.TrainOneStepCell(network,</span> <span class="pre">optimizer,</span> <span class="pre">sens=1.0)</span></code>.</p></li>
</ol>
</section>
<section id="result-presentation">
<h2>Result Presentation<a class="headerlink" href="#result-presentation" title="Permalink to this headline"></a></h2>
<p>Since the measurements have converged to -1, we can print the parameters in Ansatz at this time.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">theta0</span><span class="p">,</span> <span class="n">theta1</span> <span class="o">=</span> <span class="n">QuantumNet</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">asnumpy</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="n">QuantumNet</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">asnumpy</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
[ 2.241999  -1.0756955]
</pre></div></div>
</div>
<p>As can be seen from the above printing, the parameters <span class="math notranslate nohighlight">\(\theta_1\)</span> and <span class="math notranslate nohighlight">\(\theta_2\)</span> in Ansatz at this time are 2.2420275 and -1.0756909 respectively.</p>
<p>By <a class="reference external" href="https://www.mindspore.cn/mindquantum/docs/en/master/core/circuit/mindquantum.core.circuit.Circuit.html#mindquantum.core.circuit.Circuit.get_qs">get_qs</a>, the quantum state of the quantum circuit at the optimal parameters can be output.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">pr</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;alpha0&#39;</span><span class="p">:</span> <span class="n">alpha0</span><span class="p">,</span> <span class="s1">&#39;alpha1&#39;</span><span class="p">:</span> <span class="n">alpha1</span><span class="p">,</span> <span class="s1">&#39;alpha2&#39;</span><span class="p">:</span> <span class="n">alpha2</span><span class="p">,</span> <span class="s1">&#39;theta0&#39;</span><span class="p">:</span> <span class="n">theta0</span><span class="p">,</span> <span class="s1">&#39;theta1&#39;</span><span class="p">:</span> <span class="n">theta1</span><span class="p">}</span>
<span class="n">state</span> <span class="o">=</span> <span class="n">circuit</span><span class="o">.</span><span class="n">get_qs</span><span class="p">(</span><span class="n">pr</span><span class="o">=</span><span class="n">pr</span><span class="p">,</span> <span class="n">ket</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(0.371309288022958-0.9285092418490042j)¦0⟩
(2.0012262153618066e-05+5.327365456997413e-06j)¦1⟩
</pre></div></div>
</div>
<p>As can be seen from the above printing, this is the quantum state of the quantum circuit at the optimal parameters. As can be seen from its numerical representation, this is a state close to the target state <span class="math notranslate nohighlight">\(|0\rangle\)</span>. Finally, we calculate the fidelity of this quantum state to the target state <span class="math notranslate nohighlight">\(|0\rangle\)</span> (to verify how similar the two quantum states are), and print the fidelity.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">state</span> <span class="o">=</span> <span class="n">circuit</span><span class="o">.</span><span class="n">get_qs</span><span class="p">(</span><span class="n">pr</span><span class="o">=</span><span class="n">pr</span><span class="p">)</span>
<span class="n">fid</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">vdot</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]))</span><span class="o">**</span><span class="mi">2</span>            <span class="c1"># Fidelity is the modulus square of the absolute value of the vector inner product, that is, the modulus square of the inner product of the vector corresponding to the quantum state and the vector [1,0] corresponding to the |0&gt; state at this time is calculated.</span>

<span class="nb">print</span><span class="p">(</span><span class="n">fid</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.9999999995711284
</pre></div></div>
</div>
<p>It can be seen that the fidelity at this time is 100.00%, that is to say, the similarity between this state and the target state <span class="math notranslate nohighlight">\(|0\rangle\)</span> is 100.00%.</p>
<p>To sum up, we built a simple quantum neural network. By training the parameters in Ansatz, the error generated by the Encoder on the initial quantum state was offset, so that the final quantum state was still <span class="math notranslate nohighlight">\(|0\rangle\)</span>, and the fidelity reached 100.00%.</p>
<p>So far, we have completed the first experience of quantum neural network by MindSpore Quantum! Hurry up and experience the fun of quantum programming!</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mindquantum.utils.show_info</span> <span class="kn">import</span> <span class="n">InfoTable</span>

<span class="n">InfoTable</span><span class="p">(</span><span class="s1">&#39;mindquantum&#39;</span><span class="p">,</span> <span class="s1">&#39;scipy&#39;</span><span class="p">,</span> <span class="s1">&#39;numpy&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<table border="1">
  <tr>
    <th>Software</th>
    <th>Version</th>
  </tr>
<tr><td>mindquantum</td><td>0.9.11</td></tr>
<tr><td>scipy</td><td>1.10.1</td></tr>
<tr><td>numpy</td><td>1.23.5</td></tr>
<tr>
    <th>System</th>
    <th>Info</th>
</tr>
<tr><td>Python</td><td>3.9.16</td></tr><tr><td>OS</td><td>Linux x86_64</td></tr><tr><td>Memory</td><td>8.3 GB</td></tr><tr><td>CPU Max Thread</td><td>8</td></tr><tr><td>Date</td><td>Sun Dec 31 21:30:32 2023</td></tr>
</table></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="get_gradient_of_PQC_with_mindquantum.html" class="btn btn-neutral float-left" title="Advanced Gradient Calculation of Variational Quantum Circuits" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="equivalence_checking_of_PQC.html" class="btn btn-neutral float-right" title="Equivalence Checking of Parameterized Quantum Circuits" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright MindSpore.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 
</body>
</html>