

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Quantum Approximate Optimization Algorithm &mdash; MindSpore master documentation</title>
  

  
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
   
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  
  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="The Application of Quantum Neural Network in NLP" href="qnn_for_nlp.html" />
    <link rel="prev" title="Classification of iris by quantum neural network" href="classification_of_iris_by_qnn.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> MindSpore
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Installation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="mindquantum_install.html">MindQuantum Installation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="parameterized_quantum_circuit.html">Variational Quantum Circuit</a></li>
<li class="toctree-l1"><a class="reference internal" href="initial_experience_of_quantum_neural_network.html">Initial experience of quantum neural network</a></li>
<li class="toctree-l1"><a class="reference internal" href="get_gradient_of_PQC_with_mindquantum.html">Advanced gradient calculation of variational quantum circuits</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Variational Quantum Algorithm</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="classification_of_iris_by_qnn.html">Classification of iris by quantum neural network</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Quantum Approximate Optimization Algorithm</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#environment-preparation">Environment Preparation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#max-cut-problem-description">Max-Cut Problem Description</a></li>
<li class="toctree-l2"><a class="reference internal" href="#max-cut-problem-quantization">Max-Cut Problem Quantization</a></li>
<li class="toctree-l2"><a class="reference internal" href="#importing-dependencies">Importing Dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="#building-a-graph-to-be-solved">Building a Graph to Be Solved</a></li>
<li class="toctree-l2"><a class="reference internal" href="#setting-up-a-qaoa-circuit">Setting up a QAOA Circuit</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#circuit-setup">Circuit Setup</a></li>
<li class="toctree-l3"><a class="reference internal" href="#generating-a-complete-quantum-circuit-and-the-hamiltonian-corresponding-to-the-graph">Generating a Complete Quantum Circuit and the Hamiltonian Corresponding to the Graph</a></li>
<li class="toctree-l3"><a class="reference internal" href="#building-a-quantum-neural-network-to-be-trained">Building a Quantum Neural Network to Be Trained</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#displaying-training-results">Displaying Training Results</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#displaying-quantum-state">Displaying Quantum State</a></li>
<li class="toctree-l3"><a class="reference internal" href="#probabilistic-graph">Probabilistic Graph</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#summary">Summary</a></li>
<li class="toctree-l2"><a class="reference internal" href="#references">References</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="qnn_for_nlp.html">The Application of Quantum Neural Network in NLP</a></li>
<li class="toctree-l1"><a class="reference internal" href="vqe_for_quantum_chemistry.html">VQE Application in Quantum Chemistry Computing</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">General Quantum Algorithm</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="quantum_phase_estimation.html">Quantum Phase Estimation Algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="grover_search_algorithm.html">Grover search algorithm based on MindQuantum</a></li>
<li class="toctree-l1"><a class="reference internal" href="shor_algorithm.html">Shor’s algorithm based on MindQuantum</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="mindquantum.core.html">mindquantum.core</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindquantum.simulator.html">mindquantum.simulator</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindquantum.framework.html">mindquantum.framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindquantum.algorithm.html">mindquantum.algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindquantum.io.html">mindquantum.io</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindquantum.engine.html">mindquantum.engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindquantum.utils.html">mindquantum.utils</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">RELEASE NOTES</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="RELEASE.html">Release Notes</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">MindSpore</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Quantum Approximate Optimization Algorithm</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/quantum_approximate_optimization_algorithm.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section class="tex2jax_ignore mathjax_ignore" id="quantum-approximate-optimization-algorithm">
<h1>Quantum Approximate Optimization Algorithm<a class="headerlink" href="#quantum-approximate-optimization-algorithm" title="Permalink to this headline"></a></h1>
<p><a href="https://gitee.com/mindspore/docs/blob/r1.8/docs/mindquantum/docs/source_en/quantum_approximate_optimization_algorithm.md" target="_blank"><img src="https://mindspore-website.obs.cn-north-4.myhuaweicloud.com/website-images/r1.8/resource/_static/logo_source_en.png"></a></p>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline"></a></h2>
<p>Quantum approximate optimization algorithm (QAOA) is a quantum algorithm that uses quantum computers to solve combination optimization problems. It was first proposed by Farhi et al. in 2014. In this tutorial, we will use QAOA to solve the Max-Cut problem and get familiar with the construction and training of quantum circuits in MindQuantum.</p>
</section>
<section id="environment-preparation">
<h2>Environment Preparation<a class="headerlink" href="#environment-preparation" title="Permalink to this headline"></a></h2>
<p>This tutorial requires the following library:</p>
<ul class="simple">
<li><p>networkx</p></li>
</ul>
<blockquote>
<div><p><code class="docutils literal notranslate"><span class="pre">NetworkX</span></code> is a library for the creation, manipulation, and study of the structure, dynamics, and functions of complex networks. You can run the <code class="docutils literal notranslate"><span class="pre">pip3</span> <span class="pre">install</span> <span class="pre">networkx</span></code> command to install it.</p>
</div></blockquote>
</section>
<section id="max-cut-problem-description">
<h2>Max-Cut Problem Description<a class="headerlink" href="#max-cut-problem-description" title="Permalink to this headline"></a></h2>
<p>The Max-Cut problem is an NP-complete problem in the graph theory. It needs to divide vertices of a graph into two parts and make the most edges be cut. As shown in the following figure (a), a graph consists of five vertices, and the interconnected edges are <code class="docutils literal notranslate"><span class="pre">(0,</span> <span class="pre">1),</span> <span class="pre">(0,</span> <span class="pre">2),</span> <span class="pre">(1,</span> <span class="pre">2),</span> <span class="pre">(2,</span> <span class="pre">3),</span> <span class="pre">(3,</span> <span class="pre">4),</span> <span class="pre">and</span> <span class="pre">(0,</span> <span class="pre">4)</span></code>. To maximize the number of edges to be cut, we divide 1, 2, and 4 into one group, and 0 and 3 into another group, as shown in the figure (b). Therefore, five edges are to be cut. When the number of vertices in a graph increases, it is difficult to find an effective typical algorithm to solve the Max-Cut problem. The following describes how to transform the Max-Cut problem into a Hamiltonian ground state capability solution problem.</p>
<p><img alt="max cut" src="_images/Max_Cut.png" /></p>
</section>
<section id="max-cut-problem-quantization">
<h2>Max-Cut Problem Quantization<a class="headerlink" href="#max-cut-problem-quantization" title="Permalink to this headline"></a></h2>
<p>Assign each vertex a quantum bit. If the vertex is allocated to the left side, its quantum bit is set to the <span class="math notranslate nohighlight">\(\left|0\right&gt;\)</span> state. If the vertex is on the right side, its quantum bit is set to the <span class="math notranslate nohighlight">\(\left|1\right&gt;\)</span> state. When two vertices are in different sets, the bits on the two vertices are in different quantum states. For the vertex 0 and the vertex 1, when their connection line is cut, quantum states corresponding to bits on the two vertices may be <span class="math notranslate nohighlight">\(\left|\psi\right&gt;=\left|0_11_0\right&gt;\)</span> or <span class="math notranslate nohighlight">\(\left|\psi\right&gt;=\left|1_10_0\right&gt;\)</span>, where the subscript represents the vertex number. Select the Hamiltonian <span class="math notranslate nohighlight">\(H=(Z_1Z_0-1)/2\)</span>, where <span class="math notranslate nohighlight">\(Z\)</span> is the Pauli <span class="math notranslate nohighlight">\(Z\)</span> operator. You can find that:</p>
<div class="math notranslate nohighlight">
\[\left&lt;\psi\right|H\left|\psi\right&gt;=-1\]</div>
<p>When vertices are in the same set, you can verify that:</p>
<div class="math notranslate nohighlight">
\[\left&lt;\psi\right|H\left|\psi\right&gt;=0\]</div>
<p>Therefore, we only need to write the Hamiltonian <span class="math notranslate nohighlight">\(H\)</span> corresponding to the graph according to the preceding rule, and obtain the ground state energy and the ground state of <span class="math notranslate nohighlight">\(H\)</span> by using a quantum computer. Then, we can obtain the Max-Cut cutting solution and the maximum number of cut edges of the graph. Assuming that the set of all edges is <span class="math notranslate nohighlight">\(C\)</span> and the number of all edges is <span class="math notranslate nohighlight">\(c\)</span>, the Hamiltonian can be written as follows:</p>
<div class="math notranslate nohighlight">
\[H=\sum_{(i,j)\in C}(Z_iZ_j-1)/2\]</div>
</section>
<section id="importing-dependencies">
<h2>Importing Dependencies<a class="headerlink" href="#importing-dependencies" title="Permalink to this headline"></a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mindquantum.core.circuit</span> <span class="kn">import</span> <span class="n">Circuit</span><span class="p">,</span> <span class="n">UN</span>
<span class="kn">from</span> <span class="nn">mindquantum.core.gates</span> <span class="kn">import</span> <span class="n">H</span><span class="p">,</span> <span class="n">ZZ</span><span class="p">,</span> <span class="n">RX</span>
<span class="kn">from</span> <span class="nn">mindquantum.core.operators</span> <span class="kn">import</span> <span class="n">Hamiltonian</span><span class="p">,</span> <span class="n">QubitOperator</span>
<span class="kn">from</span> <span class="nn">mindquantum.framework</span> <span class="kn">import</span> <span class="n">MQAnsatzOnlyLayer</span>
<span class="kn">from</span> <span class="nn">mindquantum.simulator</span> <span class="kn">import</span> <span class="n">Simulator</span>
<span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="nn">nx</span>
<span class="kn">import</span> <span class="nn">mindspore.nn</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</section>
<section id="building-a-graph-to-be-solved">
<h2>Building a Graph to Be Solved<a class="headerlink" href="#building-a-graph-to-be-solved" title="Permalink to this headline"></a></h2>
<p>Use <code class="docutils literal notranslate"><span class="pre">add_path</span></code> to add edges to a graph. Then, the graph structure is drawn.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">g</span> <span class="o">=</span> <span class="n">nx</span><span class="o">.</span><span class="n">Graph</span><span class="p">()</span>
<span class="n">nx</span><span class="o">.</span><span class="n">add_path</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">])</span>
<span class="n">nx</span><span class="o">.</span><span class="n">add_path</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">nx</span><span class="o">.</span><span class="n">add_path</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span><span class="mi">3</span><span class="p">])</span>
<span class="n">nx</span><span class="o">.</span><span class="n">add_path</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="n">nx</span><span class="o">.</span><span class="n">add_path</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">])</span>
<span class="n">nx</span><span class="o">.</span><span class="n">add_path</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span><span class="mi">2</span><span class="p">])</span>
<span class="n">nx</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">with_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">font_weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p><img alt="png" src="_images/maxcut_graph.png" /></p>
<p>As shown in the preceding figure, a graph structure consisting of five vertices and six edges is obtained.</p>
</section>
<section id="setting-up-a-qaoa-circuit">
<h2>Setting up a QAOA Circuit<a class="headerlink" href="#setting-up-a-qaoa-circuit" title="Permalink to this headline"></a></h2>
<section id="circuit-setup">
<h3>Circuit Setup<a class="headerlink" href="#circuit-setup" title="Permalink to this headline"></a></h3>
<p>We use the quantum adiabatic approximation algorithm to evolve the quantum state from the eigenstate of <span class="math notranslate nohighlight">\(X^{\otimes n}\)</span> to the ground state of Hamiltonian corresponding to the graph.</p>
<p>Build the time-dependent evolution circuit of Hamiltonian corresponding to the graph:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">build_hc</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="n">para</span><span class="p">):</span>
    <span class="n">hc</span> <span class="o">=</span> <span class="n">Circuit</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="p">:</span>
        <span class="n">hc</span> <span class="o">+=</span> <span class="n">ZZ</span><span class="p">(</span><span class="n">para</span><span class="p">)</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">hc</span>
</pre></div>
</div>
<p>Build the time-dependent quantum circuit for <span class="math notranslate nohighlight">\(X^{\otimes n}\)</span>:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span>
<span class="k">def</span> <span class="nf">build_hb</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">para</span><span class="p">):</span>
    <span class="n">hc</span> <span class="o">=</span> <span class="n">Circuit</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">nodes</span><span class="p">:</span>
        <span class="n">hc</span> <span class="o">+=</span> <span class="n">RX</span><span class="p">(</span><span class="n">para</span><span class="p">)</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">hc</span>
</pre></div>
</div>
<p>To ensure that the final optimization result is accurate, the quantum circuit needs to be repeated for multiple times. Therefore, a multi-layer training network is built by using the following functions:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">build_ansatz</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">p</span><span class="p">):</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">Circuit</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">p</span><span class="p">):</span>
        <span class="n">c</span> <span class="o">+=</span> <span class="n">build_hc</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="sa">f</span><span class="s1">&#39;g</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
        <span class="n">c</span> <span class="o">+=</span> <span class="n">build_hb</span><span class="p">(</span><span class="n">g</span><span class="p">,</span><span class="sa">f</span><span class="s1">&#39;b</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">c</span>
</pre></div>
</div>
<p>Build Hamiltonian corresponding to the graph:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">build_ham</span><span class="p">(</span><span class="n">g</span><span class="p">):</span>
    <span class="n">hc</span> <span class="o">=</span> <span class="n">QubitOperator</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="p">:</span>
        <span class="n">hc</span> <span class="o">+=</span> <span class="n">QubitOperator</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Z</span><span class="si">{</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="si">}</span><span class="s1"> Z</span><span class="si">{</span><span class="n">i</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">hc</span>
</pre></div>
</div>
</section>
<section id="generating-a-complete-quantum-circuit-and-the-hamiltonian-corresponding-to-the-graph">
<h3>Generating a Complete Quantum Circuit and the Hamiltonian Corresponding to the Graph<a class="headerlink" href="#generating-a-complete-quantum-circuit-and-the-hamiltonian-corresponding-to-the-graph" title="Permalink to this headline"></a></h3>
<p>In this example, <code class="docutils literal notranslate"><span class="pre">p</span> <span class="pre">=</span> <span class="pre">4</span></code> is selected, indicating that the four-layer QAOA quantum circuit is used. <code class="docutils literal notranslate"><span class="pre">ansatz</span></code> is a quantum circuit for solving the problem, and <code class="docutils literal notranslate"><span class="pre">init_state_circ</span></code> is a quantum circuit for preparing a quantum state on a uniformly superposed state.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">p</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">ham</span> <span class="o">=</span> <span class="n">Hamiltonian</span><span class="p">(</span><span class="n">build_ham</span><span class="p">(</span><span class="n">g</span><span class="p">))</span>
<span class="n">ansatz</span> <span class="o">=</span> <span class="n">build_ansatz</span><span class="p">(</span><span class="n">g</span><span class="p">,</span> <span class="n">p</span><span class="p">)</span>
<span class="n">init_state_circ</span> <span class="o">=</span> <span class="n">UN</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">nodes</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="building-a-quantum-neural-network-to-be-trained">
<h3>Building a Quantum Neural Network to Be Trained<a class="headerlink" href="#building-a-quantum-neural-network-to-be-trained" title="Permalink to this headline"></a></h3>
<p>This problem does not require a coding-layer quantum circuit, so we use <code class="docutils literal notranslate"><span class="pre">MQAnsatzOnlyLayer</span></code> as a quantum neural network to be trained and an <code class="docutils literal notranslate"><span class="pre">Adam</span></code> optimizer.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mindspore</span> <span class="k">as</span> <span class="nn">ms</span>
<span class="n">ms</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">PYNATIVE_MODE</span><span class="p">,</span> <span class="n">device_target</span><span class="o">=</span><span class="s2">&quot;CPU&quot;</span><span class="p">)</span>

<span class="n">total_circuit</span> <span class="o">=</span> <span class="n">init_state_circ</span> <span class="o">+</span> <span class="n">ansatz</span>
<span class="n">sim</span> <span class="o">=</span> <span class="n">Simulator</span><span class="p">(</span><span class="s1">&#39;projectq&#39;</span><span class="p">,</span> <span class="n">total_circuit</span><span class="o">.</span><span class="n">n_qubits</span><span class="p">)</span>
<span class="n">grad_ops</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">get_expectation_with_grad</span><span class="p">(</span><span class="n">ham</span><span class="p">,</span> <span class="n">total_circuit</span><span class="p">)</span>
<span class="n">net</span> <span class="o">=</span> <span class="n">MQAnsatzOnlyLayer</span><span class="p">(</span><span class="n">grad_ops</span><span class="p">)</span>
<span class="n">opti</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Adam</span><span class="p">(</span><span class="n">net</span><span class="o">.</span><span class="n">trainable_params</span><span class="p">(),</span> <span class="n">learning_rate</span><span class="o">=</span><span class="mf">0.05</span><span class="p">)</span>
<span class="n">train_net</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">TrainOneStepCell</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="n">opti</span><span class="p">)</span>
</pre></div>
</div>
</section>
</section>
<section id="displaying-training-results">
<h2>Displaying Training Results<a class="headerlink" href="#displaying-training-results" title="Permalink to this headline"></a></h2>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">600</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">i</span><span class="o">%</span><span class="mi">10</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
        <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;train step:&quot;</span><span class="p">,</span> <span class="n">i</span><span class="p">,</span> <span class="s2">&quot;, cut:&quot;</span><span class="p">,</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">g</span><span class="o">.</span><span class="n">edges</span><span class="p">)</span><span class="o">-</span><span class="n">train_net</span><span class="p">())</span><span class="o">/</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>train<span class="w"> </span>step:<span class="w"> </span><span class="m">0</span><span class="w"> </span>,<span class="w"> </span>cut:<span class="w"> </span><span class="o">[[</span><span class="m">3</span>.0059216<span class="o">]]</span>
train<span class="w"> </span>step:<span class="w"> </span><span class="m">10</span><span class="w"> </span>,<span class="w"> </span>cut:<span class="w"> </span><span class="o">[[</span><span class="m">3</span>.3262742<span class="o">]]</span>
train<span class="w"> </span>step:<span class="w"> </span><span class="m">20</span><span class="w"> </span>,<span class="w"> </span>cut:<span class="w"> </span><span class="o">[[</span><span class="m">3</span>.7228582<span class="o">]]</span>
train<span class="w"> </span>step:<span class="w"> </span><span class="m">30</span><span class="w"> </span>,<span class="w"> </span>cut:<span class="w"> </span><span class="o">[[</span><span class="m">3</span>.983411<span class="o">]]</span>
train<span class="w"> </span>step:<span class="w"> </span><span class="m">40</span><span class="w"> </span>,<span class="w"> </span>cut:<span class="w"> </span><span class="o">[[</span><span class="m">4</span>.135832<span class="o">]]</span>
train<span class="w"> </span>step:<span class="w"> </span><span class="m">50</span><span class="w"> </span>,<span class="w"> </span>cut:<span class="w"> </span><span class="o">[[</span><span class="m">4</span>.216693<span class="o">]]</span>
train<span class="w"> </span>step:<span class="w"> </span><span class="m">60</span><span class="w"> </span>,<span class="w"> </span>cut:<span class="w"> </span><span class="o">[[</span><span class="m">4</span>.2141833<span class="o">]]</span>
train<span class="w"> </span>step:<span class="w"> </span><span class="m">70</span><span class="w"> </span>,<span class="w"> </span>cut:<span class="w"> </span><span class="o">[[</span><span class="m">4</span>.2036085<span class="o">]]</span>
train<span class="w"> </span>step:<span class="w"> </span><span class="m">80</span><span class="w"> </span>,<span class="w"> </span>cut:<span class="w"> </span><span class="o">[[</span><span class="m">4</span>.260594<span class="o">]]</span>
train<span class="w"> </span>step:<span class="w"> </span><span class="m">90</span><span class="w"> </span>,<span class="w"> </span>cut:<span class="w"> </span><span class="o">[[</span><span class="m">4</span>.373112<span class="o">]]</span>
train<span class="w"> </span>step:<span class="w"> </span><span class="m">100</span><span class="w"> </span>,<span class="w"> </span>cut:<span class="w"> </span><span class="o">[[</span><span class="m">4</span>.4853263<span class="o">]]</span>
train<span class="w"> </span>step:<span class="w"> </span><span class="m">110</span><span class="w"> </span>,<span class="w"> </span>cut:<span class="w"> </span><span class="o">[[</span><span class="m">4</span>.5553446<span class="o">]]</span>
train<span class="w"> </span>step:<span class="w"> </span><span class="m">120</span><span class="w"> </span>,<span class="w"> </span>cut:<span class="w"> </span><span class="o">[[</span><span class="m">4</span>.587566<span class="o">]]</span>
train<span class="w"> </span>step:<span class="w"> </span><span class="m">130</span><span class="w"> </span>,<span class="w"> </span>cut:<span class="w"> </span><span class="o">[[</span><span class="m">4</span>.611128<span class="o">]]</span>
train<span class="w"> </span>step:<span class="w"> </span><span class="m">140</span><span class="w"> </span>,<span class="w"> </span>cut:<span class="w"> </span><span class="o">[[</span><span class="m">4</span>.637698<span class="o">]]</span>
train<span class="w"> </span>step:<span class="w"> </span><span class="m">150</span><span class="w"> </span>,<span class="w"> </span>cut:<span class="w"> </span><span class="o">[[</span><span class="m">4</span>.6584387<span class="o">]]</span>
train<span class="w"> </span>step:<span class="w"> </span><span class="m">160</span><span class="w"> </span>,<span class="w"> </span>cut:<span class="w"> </span><span class="o">[[</span><span class="m">4</span>.66508<span class="o">]]</span>
train<span class="w"> </span>step:<span class="w"> </span><span class="m">170</span><span class="w"> </span>,<span class="w"> </span>cut:<span class="w"> </span><span class="o">[[</span><span class="m">4</span>.663408<span class="o">]]</span>
train<span class="w"> </span>step:<span class="w"> </span><span class="m">180</span><span class="w"> </span>,<span class="w"> </span>cut:<span class="w"> </span><span class="o">[[</span><span class="m">4</span>.6678705<span class="o">]]</span>
train<span class="w"> </span>step:<span class="w"> </span><span class="m">190</span><span class="w"> </span>,<span class="w"> </span>cut:<span class="w"> </span><span class="o">[[</span><span class="m">4</span>.6875486<span class="o">]]</span>
train<span class="w"> </span>step:<span class="w"> </span><span class="m">200</span><span class="w"> </span>,<span class="w"> </span>cut:<span class="w"> </span><span class="o">[[</span><span class="m">4</span>.7206187<span class="o">]]</span>
train<span class="w"> </span>step:<span class="w"> </span><span class="m">210</span><span class="w"> </span>,<span class="w"> </span>cut:<span class="w"> </span><span class="o">[[</span><span class="m">4</span>.7580614<span class="o">]]</span>
train<span class="w"> </span>step:<span class="w"> </span><span class="m">220</span><span class="w"> </span>,<span class="w"> </span>cut:<span class="w"> </span><span class="o">[[</span><span class="m">4</span>.7893686<span class="o">]]</span>
train<span class="w"> </span>step:<span class="w"> </span><span class="m">230</span><span class="w"> </span>,<span class="w"> </span>cut:<span class="w"> </span><span class="o">[[</span><span class="m">4</span>.8074245<span class="o">]]</span>
train<span class="w"> </span>step:<span class="w"> </span><span class="m">240</span><span class="w"> </span>,<span class="w"> </span>cut:<span class="w"> </span><span class="o">[[</span><span class="m">4</span>.8116426<span class="o">]]</span>
train<span class="w"> </span>step:<span class="w"> </span><span class="m">250</span><span class="w"> </span>,<span class="w"> </span>cut:<span class="w"> </span><span class="o">[[</span><span class="m">4</span>.8077316<span class="o">]]</span>
train<span class="w"> </span>step:<span class="w"> </span><span class="m">260</span><span class="w"> </span>,<span class="w"> </span>cut:<span class="w"> </span><span class="o">[[</span><span class="m">4</span>.803544<span class="o">]]</span>
train<span class="w"> </span>step:<span class="w"> </span><span class="m">270</span><span class="w"> </span>,<span class="w"> </span>cut:<span class="w"> </span><span class="o">[[</span><span class="m">4</span>.8039436<span class="o">]]</span>
train<span class="w"> </span>step:<span class="w"> </span><span class="m">280</span><span class="w"> </span>,<span class="w"> </span>cut:<span class="w"> </span><span class="o">[[</span><span class="m">4</span>.8088512<span class="o">]]</span>
train<span class="w"> </span>step:<span class="w"> </span><span class="m">290</span><span class="w"> </span>,<span class="w"> </span>cut:<span class="w"> </span><span class="o">[[</span><span class="m">4</span>.8154163<span class="o">]]</span>
train<span class="w"> </span>step:<span class="w"> </span><span class="m">300</span><span class="w"> </span>,<span class="w"> </span>cut:<span class="w"> </span><span class="o">[[</span><span class="m">4</span>.821649<span class="o">]]</span>
train<span class="w"> </span>step:<span class="w"> </span><span class="m">310</span><span class="w"> </span>,<span class="w"> </span>cut:<span class="w"> </span><span class="o">[[</span><span class="m">4</span>.8281393<span class="o">]]</span>
train<span class="w"> </span>step:<span class="w"> </span><span class="m">320</span><span class="w"> </span>,<span class="w"> </span>cut:<span class="w"> </span><span class="o">[[</span><span class="m">4</span>.8366113<span class="o">]]</span>
train<span class="w"> </span>step:<span class="w"> </span><span class="m">330</span><span class="w"> </span>,<span class="w"> </span>cut:<span class="w"> </span><span class="o">[[</span><span class="m">4</span>.847317<span class="o">]]</span>
train<span class="w"> </span>step:<span class="w"> </span><span class="m">340</span><span class="w"> </span>,<span class="w"> </span>cut:<span class="w"> </span><span class="o">[[</span><span class="m">4</span>.858108<span class="o">]]</span>
train<span class="w"> </span>step:<span class="w"> </span><span class="m">350</span><span class="w"> </span>,<span class="w"> </span>cut:<span class="w"> </span><span class="o">[[</span><span class="m">4</span>.865946<span class="o">]]</span>
train<span class="w"> </span>step:<span class="w"> </span><span class="m">360</span><span class="w"> </span>,<span class="w"> </span>cut:<span class="w"> </span><span class="o">[[</span><span class="m">4</span>.8693476<span class="o">]]</span>
train<span class="w"> </span>step:<span class="w"> </span><span class="m">370</span><span class="w"> </span>,<span class="w"> </span>cut:<span class="w"> </span><span class="o">[[</span><span class="m">4</span>.869488<span class="o">]]</span>
train<span class="w"> </span>step:<span class="w"> </span><span class="m">380</span><span class="w"> </span>,<span class="w"> </span>cut:<span class="w"> </span><span class="o">[[</span><span class="m">4</span>.868954<span class="o">]]</span>
train<span class="w"> </span>step:<span class="w"> </span><span class="m">390</span><span class="w"> </span>,<span class="w"> </span>cut:<span class="w"> </span><span class="o">[[</span><span class="m">4</span>.8695197<span class="o">]]</span>
train<span class="w"> </span>step:<span class="w"> </span><span class="m">400</span><span class="w"> </span>,<span class="w"> </span>cut:<span class="w"> </span><span class="o">[[</span><span class="m">4</span>.8711824<span class="o">]]</span>
train<span class="w"> </span>step:<span class="w"> </span><span class="m">410</span><span class="w"> </span>,<span class="w"> </span>cut:<span class="w"> </span><span class="o">[[</span><span class="m">4</span>.8730283<span class="o">]]</span>
train<span class="w"> </span>step:<span class="w"> </span><span class="m">420</span><span class="w"> </span>,<span class="w"> </span>cut:<span class="w"> </span><span class="o">[[</span><span class="m">4</span>.874686<span class="o">]]</span>
train<span class="w"> </span>step:<span class="w"> </span><span class="m">430</span><span class="w"> </span>,<span class="w"> </span>cut:<span class="w"> </span><span class="o">[[</span><span class="m">4</span>.8768916<span class="o">]]</span>
train<span class="w"> </span>step:<span class="w"> </span><span class="m">440</span><span class="w"> </span>,<span class="w"> </span>cut:<span class="w"> </span><span class="o">[[</span><span class="m">4</span>.880748<span class="o">]]</span>
train<span class="w"> </span>step:<span class="w"> </span><span class="m">450</span><span class="w"> </span>,<span class="w"> </span>cut:<span class="w"> </span><span class="o">[[</span><span class="m">4</span>.8865013<span class="o">]]</span>
train<span class="w"> </span>step:<span class="w"> </span><span class="m">460</span><span class="w"> </span>,<span class="w"> </span>cut:<span class="w"> </span><span class="o">[[</span><span class="m">4</span>.8930907<span class="o">]]</span>
train<span class="w"> </span>step:<span class="w"> </span><span class="m">470</span><span class="w"> </span>,<span class="w"> </span>cut:<span class="w"> </span><span class="o">[[</span><span class="m">4</span>.898922<span class="o">]]</span>
train<span class="w"> </span>step:<span class="w"> </span><span class="m">480</span><span class="w"> </span>,<span class="w"> </span>cut:<span class="w"> </span><span class="o">[[</span><span class="m">4</span>.9031305<span class="o">]]</span>
train<span class="w"> </span>step:<span class="w"> </span><span class="m">490</span><span class="w"> </span>,<span class="w"> </span>cut:<span class="w"> </span><span class="o">[[</span><span class="m">4</span>.906122<span class="o">]]</span>
train<span class="w"> </span>step:<span class="w"> </span><span class="m">500</span><span class="w"> </span>,<span class="w"> </span>cut:<span class="w"> </span><span class="o">[[</span><span class="m">4</span>.9088955<span class="o">]]</span>
train<span class="w"> </span>step:<span class="w"> </span><span class="m">510</span><span class="w"> </span>,<span class="w"> </span>cut:<span class="w"> </span><span class="o">[[</span><span class="m">4</span>.9119415<span class="o">]]</span>
train<span class="w"> </span>step:<span class="w"> </span><span class="m">520</span><span class="w"> </span>,<span class="w"> </span>cut:<span class="w"> </span><span class="o">[[</span><span class="m">4</span>.9149566<span class="o">]]</span>
train<span class="w"> </span>step:<span class="w"> </span><span class="m">530</span><span class="w"> </span>,<span class="w"> </span>cut:<span class="w"> </span><span class="o">[[</span><span class="m">4</span>.9175825<span class="o">]]</span>
train<span class="w"> </span>step:<span class="w"> </span><span class="m">540</span><span class="w"> </span>,<span class="w"> </span>cut:<span class="w"> </span><span class="o">[[</span><span class="m">4</span>.920064<span class="o">]]</span>
train<span class="w"> </span>step:<span class="w"> </span><span class="m">550</span><span class="w"> </span>,<span class="w"> </span>cut:<span class="w"> </span><span class="o">[[</span><span class="m">4</span>.9228735<span class="o">]]</span>
train<span class="w"> </span>step:<span class="w"> </span><span class="m">560</span><span class="w"> </span>,<span class="w"> </span>cut:<span class="w"> </span><span class="o">[[</span><span class="m">4</span>.925872<span class="o">]]</span>
train<span class="w"> </span>step:<span class="w"> </span><span class="m">570</span><span class="w"> </span>,<span class="w"> </span>cut:<span class="w"> </span><span class="o">[[</span><span class="m">4</span>.9282985<span class="o">]]</span>
train<span class="w"> </span>step:<span class="w"> </span><span class="m">580</span><span class="w"> </span>,<span class="w"> </span>cut:<span class="w"> </span><span class="o">[[</span><span class="m">4</span>.929679<span class="o">]]</span>
train<span class="w"> </span>step:<span class="w"> </span><span class="m">590</span><span class="w"> </span>,<span class="w"> </span>cut:<span class="w"> </span><span class="o">[[</span><span class="m">4</span>.930426<span class="o">]]</span>
</pre></div>
</div>
<p>Based on the above training results, we find that the number of cut edges corresponding to the ground state energy of Hamiltonian is close to 5.</p>
<section id="displaying-quantum-state">
<h3>Displaying Quantum State<a class="headerlink" href="#displaying-quantum-state" title="Permalink to this headline"></a></h3>
<p>We have obtained the optimal values of the parameters in the quantum circuit through training. Next, we use the <code class="docutils literal notranslate"><span class="pre">final_state</span></code> of the <code class="docutils literal notranslate"><span class="pre">StateEvolution</span></code> class to output the quantum state of the quantum circuit in the case of optimal parameters. The <code class="docutils literal notranslate"><span class="pre">ket</span></code> parameter indicates whether to represent the final quantum state as the right vector.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pr</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">(</span><span class="nb">zip</span><span class="p">(</span><span class="n">ansatz</span><span class="o">.</span><span class="n">params_name</span><span class="p">,</span> <span class="n">net</span><span class="o">.</span><span class="n">weight</span><span class="o">.</span><span class="n">asnumpy</span><span class="p">()))</span>
<span class="nb">print</span><span class="p">(</span><span class="n">total_circuit</span><span class="o">.</span><span class="n">get_qs</span><span class="p">(</span><span class="n">pr</span><span class="o">=</span><span class="n">pr</span><span class="p">,</span> <span class="n">ket</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="o">(</span><span class="m">0</span>.017737679183483124-0.03180303797125816j<span class="o">)</span>¦00000⟩
<span class="o">(</span>-0.02683155983686447+0.0012889178469777107j<span class="o">)</span>¦00001⟩
<span class="o">(</span><span class="m">0</span>.011993971653282642+0.006973826792091131j<span class="o">)</span>¦00010⟩
<span class="o">(</span>-0.014608755707740784-0.003942559473216534j<span class="o">)</span>¦00011⟩
<span class="o">(</span>-0.02683155983686447+0.0012889178469777107j<span class="o">)</span>¦00100⟩
<span class="o">(</span><span class="m">0</span>.00725862430408597+0.10942266136407852j<span class="o">)</span>¦00101⟩
<span class="o">(</span>-0.014608755707740784-0.003942559473216534j<span class="o">)</span>¦00110⟩
<span class="o">(</span><span class="m">0</span>.008969870395958424-0.004171415697783232j<span class="o">)</span>¦00111⟩
<span class="o">(</span><span class="m">0</span>.00950924027711153-0.00026544960564933717j<span class="o">)</span>¦01000⟩
<span class="o">(</span>-0.37196943163871765-0.3156493902206421j<span class="o">)</span>¦01001⟩
<span class="o">(</span>-0.040885526686906815+0.037214867770671844j<span class="o">)</span>¦01010⟩
<span class="o">(</span>-0.37196943163871765-0.3156493902206421j<span class="o">)</span>¦01011⟩
<span class="o">(</span>-0.03160367161035538+0.009305878542363644j<span class="o">)</span>¦01100⟩
<span class="o">(</span>-0.040885526686906815+0.037214867770671844j<span class="o">)</span>¦01101⟩
<span class="o">(</span>-0.03160367161035538+0.009305878542363644j<span class="o">)</span>¦01110⟩
<span class="o">(</span><span class="m">0</span>.00950924027711153-0.00026544960564933717j<span class="o">)</span>¦01111⟩
<span class="o">(</span><span class="m">0</span>.00950924027711153-0.00026544960564933717j<span class="o">)</span>¦10000⟩
<span class="o">(</span>-0.03160367161035538+0.009305878542363644j<span class="o">)</span>¦10001⟩
<span class="o">(</span>-0.040885526686906815+0.037214867770671844j<span class="o">)</span>¦10010⟩
<span class="o">(</span>-0.03160367161035538+0.009305878542363644j<span class="o">)</span>¦10011⟩
<span class="o">(</span>-0.37196943163871765-0.3156493902206421j<span class="o">)</span>¦10100⟩
<span class="o">(</span>-0.040885526686906815+0.037214867770671844j<span class="o">)</span>¦10101⟩
<span class="o">(</span>-0.37196943163871765-0.3156493902206421j<span class="o">)</span>¦10110⟩
<span class="o">(</span><span class="m">0</span>.00950924027711153-0.00026544960564933717j<span class="o">)</span>¦10111⟩
<span class="o">(</span><span class="m">0</span>.008969870395958424-0.004171415697783232j<span class="o">)</span>¦11000⟩
<span class="o">(</span>-0.014608755707740784-0.003942559473216534j<span class="o">)</span>¦11001⟩
<span class="o">(</span><span class="m">0</span>.00725862430408597+0.10942266136407852j<span class="o">)</span>¦11010⟩
<span class="o">(</span>-0.02683155983686447+0.0012889178469777107j<span class="o">)</span>¦11011⟩
<span class="o">(</span>-0.014608755707740784-0.003942559473216534j<span class="o">)</span>¦11100⟩
<span class="o">(</span><span class="m">0</span>.011993971653282642+0.006973826792091131j<span class="o">)</span>¦11101⟩
<span class="o">(</span>-0.02683155983686447+0.0012889178469777107j<span class="o">)</span>¦11110⟩
<span class="o">(</span><span class="m">0</span>.017737679183483124-0.03180303797125816j<span class="o">)</span>¦11111⟩
</pre></div>
</div>
</section>
<section id="probabilistic-graph">
<h3>Probabilistic Graph<a class="headerlink" href="#probabilistic-graph" title="Permalink to this headline"></a></h3>
<p>We draw the probability distribution of the final quantum state under the calculated basis vector.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">show_amp</span><span class="p">(</span><span class="n">state</span><span class="p">):</span>
    <span class="n">amp</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">state</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span>
    <span class="n">n_qubits</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log2</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">amp</span><span class="p">)))</span>
    <span class="n">labels</span> <span class="o">=</span> <span class="p">[</span><span class="nb">bin</span><span class="p">(</span><span class="n">i</span><span class="p">)[</span><span class="mi">2</span><span class="p">:]</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="n">n_qubits</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">amp</span><span class="p">))]</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">labels</span><span class="p">,</span> <span class="n">amp</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
<span class="n">state</span> <span class="o">=</span> <span class="n">total_circuit</span><span class="o">.</span><span class="n">get_qs</span><span class="p">(</span><span class="n">pr</span><span class="o">=</span><span class="n">pr</span><span class="p">)</span>
<span class="n">show_amp</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
</pre></div>
</div>
<p><img alt="png" src="_images/maxcut_dist.png" /></p>
<p>According to the probability distribution diagram, the Max-Cut problem has four degenerate solutions, and the probability corresponding to each solution is about 25%.</p>
</section>
</section>
<section id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this headline"></a></h2>
<p>We use the quantum approximation optimization algorithm to solve the Max-Cut problem and obtain the Max-Cut solution corresponding to the graph in the case.</p>
</section>
<section id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline"></a></h2>
<p>[1] Edward Farhi, Jeffrey Goldstone, and Sam Gutmann. <a class="reference external" href="https://arxiv.org/pdf/1411.4028.pdf">A Quantum Approximate Optimization Algorithm</a></p>
</section>
</section>


           </div>
           
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="classification_of_iris_by_qnn.html" class="btn btn-neutral float-left" title="Classification of iris by quantum neural network" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="qnn_for_nlp.html" class="btn btn-neutral float-right" title="The Application of Quantum Neural Network in NLP" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, MindSpore.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   
	<script async="async" src="https://cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</body>
</html>