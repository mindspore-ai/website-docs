<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>mindquantum.io.display.bloch_plt_drawer &mdash; MindSpore master documentation</title><script>;(()=>{const e=localStorage.getItem("ms-theme"),t=window.matchMedia("(prefers-color-scheme: dark)").matches;(e?"dark"===e:t)&&document.documentElement.setAttribute("data-o-theme","dark")})();</script><link rel="stylesheet" href="../../../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../../../_static/pygments.css" type="text/css" />
  <script data-url_root="../../../../" id="documentation_options" src="../../../../_static/documentation_options.js"></script><script src="../../../../_static/jquery.js"></script>
        <script src="../../../../_static/js/theme.js"></script><script src="../../../../_static/underscore.js"></script><script src="../../../../_static/doctools.js"></script><script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="../../../../genindex.html" />
    <link rel="search" title="Search" href="../../../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../../../index.html" class="icon icon-home"> MindSpore
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Installation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../mindquantum_install.html">MindQuantum Installation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../parameterized_quantum_circuit.html">Variational Quantum Circuit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../initial_experience_of_quantum_neural_network.html">Initial experience of quantum neural network</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../get_gradient_of_PQC_with_mindquantum.html">Advanced gradient calculation of variational quantum circuits</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Variational Quantum Algorithm</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../classification_of_iris_by_qnn.html">Classification of iris by quantum neural network</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../quantum_approximate_optimization_algorithm.html">Quantum Approximate Optimization Algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../qnn_for_nlp.html">The Application of Quantum Neural Network in NLP</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../vqe_for_quantum_chemistry.html">VQE Application in Quantum Chemistry Computing</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">General Quantum Algorithm</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../quantum_phase_estimation.html">Quantum Phase Estimation Algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../grover_search_algorithm.html">Grover search and Long algorithms based on MindQuantum</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../shor_algorithm.html">Shorâ€™s algorithm based on MindQuantum</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../mindquantum.core.html">mindquantum.core</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../mindquantum.simulator.html">mindquantum.simulator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../mindquantum.framework.html">mindquantum.framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../mindquantum.algorithm.html">mindquantum.algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../mindquantum.io.html">mindquantum.io</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../mindquantum.engine.html">mindquantum.engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../../../mindquantum.utils.html">mindquantum.utils</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">RELEASE NOTES</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../../../RELEASE.html">Release Notes</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../../../index.html">MindSpore</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../../../index.html">Module code</a> &raquo;</li>
      <li>mindquantum.io.display.bloch_plt_drawer</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for mindquantum.io.display.bloch_plt_drawer</h1><div class="highlight"><pre>
<span></span><span class="c1"># Copyright 2021 Huawei Technologies Co., Ltd</span>
<span class="c1">#</span>
<span class="c1"># Licensed under the Apache License, Version 2.0 (the &quot;License&quot;);</span>
<span class="c1"># you may not use this file except in compliance with the License.</span>
<span class="c1"># You may obtain a copy of the License at</span>
<span class="c1">#</span>
<span class="c1"># http://www.apache.org/licenses/LICENSE-2.0</span>
<span class="c1">#</span>
<span class="c1"># Unless required by applicable law or agreed to in writing, software</span>
<span class="c1"># distributed under the License is distributed on an &quot;AS IS&quot; BASIS,</span>
<span class="c1"># WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.</span>
<span class="c1"># See the License for the specific language governing permissions and</span>
<span class="c1"># limitations under the License.</span>
<span class="c1"># ============================================================================</span>
<span class="sd">&quot;&quot;&quot;Display one qubit state in bloch sphere.&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">numbers</span>
<span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">from</span> <span class="nn">collections</span> <span class="kn">import</span> <span class="n">deque</span>

<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">rich</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">animation</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">pyplot</span> <span class="k">as</span> <span class="n">plt</span>
<span class="kn">from</span> <span class="nn">matplotlib</span> <span class="kn">import</span> <span class="n">ticker</span>
<span class="kn">from</span> <span class="nn">matplotlib.figure</span> <span class="kn">import</span> <span class="n">Figure</span>
<span class="kn">from</span> <span class="nn">matplotlib.patches</span> <span class="kn">import</span> <span class="n">FancyArrowPatch</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d.axes3d</span> <span class="kn">import</span> <span class="n">Axes3D</span>
<span class="kn">from</span> <span class="nn">mpl_toolkits.mplot3d.proj3d</span> <span class="kn">import</span> <span class="n">proj_transform</span>

<span class="kn">from</span> <span class="nn">mindquantum.io.display._config</span> <span class="kn">import</span> <span class="p">(</span>
    <span class="n">_bloch_default_style_</span><span class="p">,</span>
    <span class="n">_bloch_default_style_dark_</span><span class="p">,</span>
<span class="p">)</span>
<span class="kn">from</span> <span class="nn">mindquantum.utils.type_value_check</span> <span class="kn">import</span> <span class="n">_check_input_type</span><span class="p">,</span> <span class="n">_check_int_type</span>


<span class="k">class</span> <span class="nc">Arrow3D</span><span class="p">(</span><span class="n">FancyArrowPatch</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;3D arrow.&quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="n">dz</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>  <span class="c1"># pylint: disable=too-many-arguments</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize an Arrow3D object.&quot;&quot;&quot;</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">((</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_xyz</span> <span class="o">=</span> <span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">_dxdydz</span> <span class="o">=</span> <span class="p">(</span><span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="n">dz</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">draw</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Draw artist.&quot;&quot;&quot;</span>
        <span class="c1"># pylint: disable=invalid-name</span>
        <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">z1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xyz</span>
        <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="n">dz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dxdydz</span>
        <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">z2</span> <span class="o">=</span> <span class="p">(</span><span class="n">x1</span> <span class="o">+</span> <span class="n">dx</span><span class="p">,</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">dy</span><span class="p">,</span> <span class="n">z1</span> <span class="o">+</span> <span class="n">dz</span><span class="p">)</span>

        <span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">proj_transform</span><span class="p">((</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">),</span> <span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">),</span> <span class="p">(</span><span class="n">z1</span><span class="p">,</span> <span class="n">z2</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">M</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_positions</span><span class="p">((</span><span class="n">xs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ys</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="p">(</span><span class="n">xs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ys</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">renderer</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">do_3d_projection</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">renderer</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>  <span class="c1"># pylint: disable=unused-argument</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Do 3d projection.&quot;&quot;&quot;</span>
        <span class="c1"># pylint: disable=invalid-name</span>
        <span class="n">x1</span><span class="p">,</span> <span class="n">y1</span><span class="p">,</span> <span class="n">z1</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_xyz</span>
        <span class="n">dx</span><span class="p">,</span> <span class="n">dy</span><span class="p">,</span> <span class="n">dz</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">_dxdydz</span>
        <span class="n">x2</span><span class="p">,</span> <span class="n">y2</span><span class="p">,</span> <span class="n">z2</span> <span class="o">=</span> <span class="p">(</span><span class="n">x1</span> <span class="o">+</span> <span class="n">dx</span><span class="p">,</span> <span class="n">y1</span> <span class="o">+</span> <span class="n">dy</span><span class="p">,</span> <span class="n">z1</span> <span class="o">+</span> <span class="n">dz</span><span class="p">)</span>

        <span class="n">xs</span><span class="p">,</span> <span class="n">ys</span><span class="p">,</span> <span class="n">zs</span> <span class="o">=</span> <span class="n">proj_transform</span><span class="p">((</span><span class="n">x1</span><span class="p">,</span> <span class="n">x2</span><span class="p">),</span> <span class="p">(</span><span class="n">y1</span><span class="p">,</span> <span class="n">y2</span><span class="p">),</span> <span class="p">(</span><span class="n">z1</span><span class="p">,</span> <span class="n">z2</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">axes</span><span class="o">.</span><span class="n">M</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_positions</span><span class="p">((</span><span class="n">xs</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">ys</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="p">(</span><span class="n">xs</span><span class="p">[</span><span class="mi">1</span><span class="p">],</span> <span class="n">ys</span><span class="p">[</span><span class="mi">1</span><span class="p">]))</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">zs</span><span class="p">)</span>


<div class="viewcode-block" id="BlochScene"><a class="viewcode-back" href="../../../../mindquantum.io.html#mindquantum.io.BlochScene">[docs]</a><span class="k">class</span> <span class="nc">BlochScene</span><span class="p">:</span>  <span class="c1"># pylint: disable=too-many-instance-attributes</span>
<span class="w">    </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Display a one qubit quantum state in bloch sphere.</span>

<span class="sd">    Args:</span>
<span class="sd">        config (Union[dict, str]): The bloch sphere style configuration. If None, a built-in style configuration</span>
<span class="sd">            will be used. Beside built-in style, we also support a `dark` style. Default: None.</span>

<span class="sd">    Examples:</span>
<span class="sd">        &gt;&gt;&gt; import matplotlib.pyplot as plt</span>
<span class="sd">        &gt;&gt;&gt; import numpy as np</span>
<span class="sd">        &gt;&gt;&gt; from mindquantum.core.gates import RX, RZ</span>
<span class="sd">        &gt;&gt;&gt; from mindquantum.io.display import BlochScene</span>
<span class="sd">        &gt;&gt;&gt; state = np.array([1, 1 + 1j])/np.sqrt(3)</span>
<span class="sd">        &gt;&gt;&gt; scene = BlochScene()</span>
<span class="sd">        &gt;&gt;&gt; fig, ax = scene.create_scene()</span>
<span class="sd">        &gt;&gt;&gt; scene.add_state(ax, state)</span>
<span class="sd">        &gt;&gt;&gt; plt.show()</span>
<span class="sd">        &gt;&gt;&gt; n_step = 100</span>
<span class="sd">        &gt;&gt;&gt; amps = np.zeros((n_step, 2), dtype=np.complex128)</span>
<span class="sd">        &gt;&gt;&gt; for i, angle in enumerate(np.linspace(0, np.pi * 2, n_step)):</span>
<span class="sd">        ...     state = RZ(angle).matrix() @ RX(np.pi / 4).matrix() @ np.array([[1], [0]])</span>
<span class="sd">        ...     state = state.T[0]</span>
<span class="sd">        ...     amps[i] = state</span>
<span class="sd">        &gt;&gt;&gt; scene = BlochScene(&#39;dark&#39;)</span>
<span class="sd">        &gt;&gt;&gt; fig, ax = scene.create_scene()</span>
<span class="sd">        &gt;&gt;&gt; scene.add_state(ax, np.array([1, 1 - 1j])/np.sqrt(3), with_proj=False)</span>
<span class="sd">        &gt;&gt;&gt; objs = scene.add_state(ax, amps[0], linecolor=&#39;r&#39;)</span>
<span class="sd">        &gt;&gt;&gt; anim = scene.animation(fig, ax, objs, amps,history_len=10)</span>
<span class="sd">        &gt;&gt;&gt; plt.show()</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">config</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Initialize a BlochScene object.&quot;&quot;&quot;</span>
        <span class="n">supported_style</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;default&#39;</span><span class="p">:</span> <span class="n">_bloch_default_style_</span><span class="p">,</span> <span class="s1">&#39;dark&#39;</span><span class="p">:</span> <span class="n">_bloch_default_style_dark_</span><span class="p">}</span>
        <span class="k">if</span> <span class="n">config</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">config</span> <span class="o">=</span> <span class="s1">&#39;default&#39;</span>
        <span class="k">if</span> <span class="nb">isinstance</span><span class="p">(</span><span class="n">config</span><span class="p">,</span> <span class="nb">str</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">config</span> <span class="ow">not</span> <span class="ow">in</span> <span class="n">supported_style</span><span class="p">:</span>
                <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Support style: </span><span class="si">{</span><span class="nb">list</span><span class="p">(</span><span class="n">supported_style</span><span class="o">.</span><span class="n">keys</span><span class="p">())</span><span class="si">}</span><span class="s2">, but get </span><span class="si">{</span><span class="n">config</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
            <span class="n">config</span> <span class="o">=</span> <span class="n">supported_style</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
        <span class="n">_check_input_type</span><span class="p">(</span><span class="s2">&quot;config&quot;</span><span class="p">,</span> <span class="p">(</span><span class="nb">dict</span><span class="p">,</span> <span class="nb">str</span><span class="p">),</span> <span class="n">config</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">config</span> <span class="o">=</span> <span class="n">config</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c_ang</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">c_ang</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">c_ang</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">c_z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">c_x</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plane_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plane_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plane_z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">3</span><span class="p">))</span>

<div class="viewcode-block" id="BlochScene.add_ket_label"><a class="viewcode-back" href="../../../../mindquantum.io.html#mindquantum.io.BlochScene.add_ket_label">[docs]</a>    <span class="k">def</span> <span class="nf">add_ket_label</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Set ket label in given axes.</span>

<span class="sd">        Args:</span>
<span class="sd">            ax (mpl_toolkits.mplot3d.axes3d.Axes3D): The three dimension axes you</span>
<span class="sd">                want add ket label.</span>
<span class="sd">            args (tuple): The args for ket label of text object in matplotlib.</span>
<span class="sd">            kwargs (dict): The key word args for ket label of text object in matplotlib.</span>
<span class="sd">            fontsize (int): The fontsize of label. If None, the fontsize will be</span>
<span class="sd">                found in config of `BlochScene` with key `ket_label_fs`. Default: None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">fontsize</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">fontsize</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;ket_label_fs&#39;</span><span class="p">]</span>
        <span class="n">_check_input_type</span><span class="p">(</span><span class="s2">&quot;ax&quot;</span><span class="p">,</span> <span class="n">Axes3D</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>
        <span class="n">_check_int_type</span><span class="p">(</span><span class="s2">&quot;fontsize&quot;</span><span class="p">,</span> <span class="n">fontsize</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\hat{{z}}=\left|0\right&gt;$&#39;</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mf">1.2</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\hat{{y}}$&#39;</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">text</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.2</span><span class="p">,</span> <span class="sa">r</span><span class="s1">&#39;$\hat{{x}}$&#39;</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">fontsize</span><span class="o">=</span><span class="n">fontsize</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="BlochScene.circle_yz"><a class="viewcode-back" href="../../../../mindquantum.io.html#mindquantum.io.BlochScene.circle_yz">[docs]</a>    <span class="k">def</span> <span class="nf">circle_yz</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">angle</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot circle in yz plane.</span>

<span class="sd">        Args:</span>
<span class="sd">            ax (mpl_toolkits.mplot3d.axes3d.Axes3D): The three dimension axes you</span>
<span class="sd">                want add ket label.</span>
<span class="sd">            args (tuple): The args of `Axes3D.plot`.</span>
<span class="sd">            angle (numbers.Number): Rotate angle of circle around z axis. Default: 0.</span>
<span class="sd">            kwargs (dict): The key word args for `Axes3D.plot`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_check_input_type</span><span class="p">(</span><span class="s2">&quot;ax&quot;</span><span class="p">,</span> <span class="n">Axes3D</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>
        <span class="n">_check_input_type</span><span class="p">(</span><span class="s2">&quot;angle&quot;</span><span class="p">,</span> <span class="n">numbers</span><span class="o">.</span><span class="n">Number</span><span class="p">,</span> <span class="n">angle</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">c_x</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_x</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_y</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="BlochScene.circle_xy"><a class="viewcode-back" href="../../../../mindquantum.io.html#mindquantum.io.BlochScene.circle_xy">[docs]</a>    <span class="k">def</span> <span class="nf">circle_xy</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="n">angle</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot circle in xy plane.</span>

<span class="sd">        Args:</span>
<span class="sd">            ax (mpl_toolkits.mplot3d.axes3d.Axes3D): The three dimension axes you</span>
<span class="sd">                want add circle parallel with xy plane.</span>
<span class="sd">            args (tuple): The args of `Axes3D.plot`.</span>
<span class="sd">            angle (numbers.Number): Elevation angle of circle along z axis. Default: Ï€ / 2.</span>
<span class="sd">            kwargs (dict): The key word args for `Axes3D.plot`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_check_input_type</span><span class="p">(</span><span class="s2">&quot;ax&quot;</span><span class="p">,</span> <span class="n">Axes3D</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>
        <span class="n">_check_input_type</span><span class="p">(</span><span class="s2">&quot;angle&quot;</span><span class="p">,</span> <span class="n">numbers</span><span class="o">.</span><span class="n">Number</span><span class="p">,</span> <span class="n">angle</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">c_x</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">),</span> <span class="bp">self</span><span class="o">.</span><span class="n">c_y</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">angle</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">angle</span><span class="p">),</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div>

    <span class="c1"># pylint: disable=too-many-arguments</span>
<div class="viewcode-block" id="BlochScene.plot_slice"><a class="viewcode-back" href="../../../../mindquantum.io.html#mindquantum.io.BlochScene.plot_slice">[docs]</a>    <span class="k">def</span> <span class="nf">plot_slice</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ax</span><span class="p">,</span>
        <span class="n">x</span><span class="p">,</span>
        <span class="n">y</span><span class="p">,</span>
        <span class="n">z</span><span class="p">,</span>
        <span class="n">frame_color</span><span class="p">,</span>
        <span class="n">frame_alpha</span><span class="p">,</span>
        <span class="n">surface_color</span><span class="p">,</span>
        <span class="n">surface_alpha</span><span class="p">,</span>
        <span class="n">frame_args</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">frame_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">surface_args</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">surface_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Plot reference surface in xy, yz and zx plane.</span>

<span class="sd">        Args:</span>
<span class="sd">            ax (mpl_toolkits.mplot3d.axes3d.Axes3D): The three dimension axes you</span>
<span class="sd">                want to add reference surface.</span>
<span class="sd">            x (numpy.ndarray): The x coordinate of reference plane.</span>
<span class="sd">            y (numpy.ndarray): The y coordinate of reference plane.</span>
<span class="sd">            z (numpy.ndarray): The z coordinate of reference plane.</span>
<span class="sd">            frame_color (str): The wire frame color.</span>
<span class="sd">            frame_alpha (numbers.Number): The frame transparency.</span>
<span class="sd">            surface_color (str): The surface color.</span>
<span class="sd">            surface_alpha (numbers.Number): The surface transparency.</span>
<span class="sd">            frame_args (tuple): The other args for `Axes3D.plot_wireframe`.</span>
<span class="sd">            frame_kwargs (dict): The other key word args for `Axes3D.plot_wireframe`.</span>
<span class="sd">            surface_args (tuple): The other args for `Axes3D.plot_surface`.</span>
<span class="sd">            surface_kwargs (dict): The other key word args for `Axes3D.plot_surface`.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_check_input_type</span><span class="p">(</span><span class="s2">&quot;ax&quot;</span><span class="p">,</span> <span class="n">Axes3D</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">frame_args</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">frame_args</span> <span class="o">=</span> <span class="p">()</span>
        <span class="k">if</span> <span class="n">frame_kwargs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">frame_kwargs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">surface_args</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">surface_args</span> <span class="o">=</span> <span class="p">()</span>
        <span class="k">if</span> <span class="n">surface_kwargs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">surface_kwargs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">_check_input_type</span><span class="p">(</span><span class="s2">&quot;frame_args&quot;</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">,</span> <span class="n">frame_args</span><span class="p">)</span>
        <span class="n">_check_input_type</span><span class="p">(</span><span class="s2">&quot;surface_args&quot;</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">,</span> <span class="n">surface_args</span><span class="p">)</span>
        <span class="n">_check_input_type</span><span class="p">(</span><span class="s2">&quot;frame_kwargs&quot;</span><span class="p">,</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">frame_kwargs</span><span class="p">)</span>
        <span class="n">_check_input_type</span><span class="p">(</span><span class="s2">&quot;surface_kwargs&quot;</span><span class="p">,</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">surface_kwargs</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot_wireframe</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="o">*</span><span class="n">frame_args</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">frame_color</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">frame_alpha</span><span class="p">,</span> <span class="o">**</span><span class="n">frame_kwargs</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">plot_surface</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">,</span> <span class="o">*</span><span class="n">surface_args</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="n">surface_color</span><span class="p">,</span> <span class="n">alpha</span><span class="o">=</span><span class="n">surface_alpha</span><span class="p">,</span> <span class="o">**</span><span class="n">surface_kwargs</span><span class="p">)</span></div>

<div class="viewcode-block" id="BlochScene.set_view"><a class="viewcode-back" href="../../../../mindquantum.io.html#mindquantum.io.BlochScene.set_view">[docs]</a>    <span class="k">def</span> <span class="nf">set_view</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">elev</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">azim</span><span class="o">=</span><span class="mi">0</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Fit the view to bloch sphere.</span>

<span class="sd">        Args:</span>
<span class="sd">            ax (mpl_toolkits.mplot3d.axes3d.Axes3D): The three dimension axes you</span>
<span class="sd">                want to set view.</span>
<span class="sd">            elev (numbers.Number): stores the elevation angle in the z plane (in degrees).</span>
<span class="sd">                Default: 0.</span>
<span class="sd">            azim (numbers.Number): stores the azimuth angle in the (x, y) plane (in degrees).</span>
<span class="sd">                Default: 0.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlim3d</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylim3d</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_zlim3d</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_xlabel</span><span class="p">(</span><span class="s1">&#39;X&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="s1">&#39;Y&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_zlabel</span><span class="p">(</span><span class="s1">&#39;Z&#39;</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_box_aspect</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">view_init</span><span class="p">(</span><span class="n">elev</span><span class="o">=</span><span class="n">elev</span><span class="p">,</span> <span class="n">azim</span><span class="o">=</span><span class="n">azim</span><span class="p">)</span></div>

<div class="viewcode-block" id="BlochScene.gen_fig_ax"><a class="viewcode-back" href="../../../../mindquantum.io.html#mindquantum.io.BlochScene.gen_fig_ax">[docs]</a>    <span class="k">def</span> <span class="nf">gen_fig_ax</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">boxes</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add three dimension scene.</span>

<span class="sd">        Args:</span>
<span class="sd">            boxes (list): A float list with 4 elements that are left, bottom, width, height</span>
<span class="sd">                of this scene. If None, then left and bottom will be 0 and width and height</span>
<span class="sd">                will be 1. Default: None.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">boxes</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">boxes</span> <span class="o">=</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>
        <span class="n">_check_input_type</span><span class="p">(</span><span class="s2">&quot;boxes&quot;</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="n">boxes</span><span class="p">)</span>
        <span class="n">fig</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">()</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">fig</span><span class="o">.</span><span class="n">add_axes</span><span class="p">(</span><span class="n">boxes</span><span class="p">,</span> <span class="n">projection</span><span class="o">=</span><span class="s1">&#39;3d&#39;</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span></div>

<div class="viewcode-block" id="BlochScene.add_3d_arrow"><a class="viewcode-back" href="../../../../mindquantum.io.html#mindquantum.io.BlochScene.add_3d_arrow">[docs]</a>    <span class="k">def</span> <span class="nf">add_3d_arrow</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">data</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add a three dimension arrow in given axes.</span>

<span class="sd">        Args:</span>
<span class="sd">            ax (mpl_toolkits.mplot3d.axes3d.Axes3D): The three dimension axes you</span>
<span class="sd">                want set 3d arrow.</span>
<span class="sd">            data (list): A 6 elements list that include start point coordinate (first three)</span>
<span class="sd">                and the displacement of this arrow.</span>
<span class="sd">            args (tuple): The other args for FancyArrowPatch.</span>
<span class="sd">            kwargs (dict): The other key word args for FancyArrowPatch.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">arrow</span> <span class="o">=</span> <span class="n">Arrow3D</span><span class="p">(</span><span class="o">*</span><span class="n">data</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">add_artist</span><span class="p">(</span><span class="n">arrow</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">arrow</span></div>

<div class="viewcode-block" id="BlochScene.create_scene"><a class="viewcode-back" href="../../../../mindquantum.io.html#mindquantum.io.BlochScene.create_scene">[docs]</a>    <span class="k">def</span> <span class="nf">create_scene</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;Create default layout with `BlochScene.config`.&quot;&quot;&quot;</span>
        <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">gen_fig_ax</span><span class="p">()</span>
        <span class="n">arrowstyle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;arrowstyle&#39;</span><span class="p">]</span>
        <span class="n">mutation_scale</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;mutation_scale&#39;</span><span class="p">]</span>
        <span class="n">linestyle</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;arrow_ls&#39;</span><span class="p">]</span>
        <span class="n">delta</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;axis_delta&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_3d_arrow</span><span class="p">(</span>
            <span class="n">ax</span><span class="p">,</span>
            <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span> <span class="o">-</span> <span class="n">delta</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">delta</span><span class="p">],</span>
            <span class="n">arrowstyle</span><span class="o">=</span><span class="n">arrowstyle</span><span class="p">,</span>
            <span class="n">mutation_scale</span><span class="o">=</span><span class="n">mutation_scale</span><span class="p">,</span>
            <span class="n">linestyle</span><span class="o">=</span><span class="n">linestyle</span><span class="p">,</span>
        <span class="p">)</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;arrow_c&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_3d_arrow</span><span class="p">(</span>
            <span class="n">ax</span><span class="p">,</span>
            <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span> <span class="o">-</span> <span class="n">delta</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">delta</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="n">arrowstyle</span><span class="o">=</span><span class="n">arrowstyle</span><span class="p">,</span>
            <span class="n">mutation_scale</span><span class="o">=</span><span class="n">mutation_scale</span><span class="p">,</span>
            <span class="n">linestyle</span><span class="o">=</span><span class="n">linestyle</span><span class="p">,</span>
        <span class="p">)</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;arrow_c&#39;</span><span class="p">])</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_3d_arrow</span><span class="p">(</span>
            <span class="n">ax</span><span class="p">,</span>
            <span class="p">[</span><span class="o">-</span><span class="mi">1</span> <span class="o">-</span> <span class="n">delta</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">+</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">delta</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span>
            <span class="n">arrowstyle</span><span class="o">=</span><span class="n">arrowstyle</span><span class="p">,</span>
            <span class="n">mutation_scale</span><span class="o">=</span><span class="n">mutation_scale</span><span class="p">,</span>
            <span class="n">linestyle</span><span class="o">=</span><span class="n">linestyle</span><span class="p">,</span>
        <span class="p">)</span><span class="o">.</span><span class="n">set_color</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;arrow_c&#39;</span><span class="p">])</span>
        <span class="n">plane_alpha</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;plane_alpha&#39;</span><span class="p">]</span>
        <span class="n">xy_plane_color</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;xy_plane_color&#39;</span><span class="p">]</span>
        <span class="n">yz_plane_color</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;yz_plane_color&#39;</span><span class="p">]</span>
        <span class="n">zx_plane_color</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;zx_plane_color&#39;</span><span class="p">]</span>
        <span class="n">frame_alpha</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;frame_alpha&#39;</span><span class="p">]</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_slice</span><span class="p">(</span>
            <span class="n">ax</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">plane_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">plane_y</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">plane_z</span><span class="p">,</span> <span class="n">xy_plane_color</span><span class="p">,</span> <span class="n">frame_alpha</span><span class="p">,</span> <span class="n">xy_plane_color</span><span class="p">,</span> <span class="n">plane_alpha</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_slice</span><span class="p">(</span>
            <span class="n">ax</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">plane_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">plane_z</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">plane_y</span><span class="p">,</span> <span class="n">yz_plane_color</span><span class="p">,</span> <span class="n">frame_alpha</span><span class="p">,</span> <span class="n">yz_plane_color</span><span class="p">,</span> <span class="n">plane_alpha</span>
        <span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">plot_slice</span><span class="p">(</span>
            <span class="n">ax</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">plane_z</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">plane_x</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">plane_y</span><span class="p">,</span> <span class="n">zx_plane_color</span><span class="p">,</span> <span class="n">frame_alpha</span><span class="p">,</span> <span class="n">zx_plane_color</span><span class="p">,</span> <span class="n">plane_alpha</span>
        <span class="p">)</span>

        <span class="k">for</span> <span class="n">angle</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">7</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">circle_xy</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">angle</span><span class="o">=</span><span class="n">angle</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#cdcdcd&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="k">for</span> <span class="n">angle</span> <span class="ow">in</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span><span class="p">,</span> <span class="mi">4</span><span class="p">):</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">circle_yz</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="s1">&#39;--&#39;</span><span class="p">,</span> <span class="n">angle</span><span class="o">=</span><span class="n">angle</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s1">&#39;#cdcdcd&#39;</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">circle_xy</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;#999999&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">circle_yz</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;#999999&#39;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">circle_yz</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="s1">&#39;#999999&#39;</span><span class="p">,</span> <span class="n">angle</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">set_view</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">elev</span><span class="o">=</span><span class="mi">10</span><span class="p">,</span> <span class="n">azim</span><span class="o">=</span><span class="mi">40</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">add_ket_label</span><span class="p">(</span><span class="n">ax</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;axis_label_c&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">ticker</span><span class="o">.</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mf">0.5</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">yaxis</span><span class="o">.</span><span class="n">set_major_locator</span><span class="p">(</span><span class="n">ticker</span><span class="o">.</span><span class="n">MultipleLocator</span><span class="p">(</span><span class="mf">0.5</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_axis_off</span><span class="p">()</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;fig_color&#39;</span><span class="p">])</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_facecolor</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;fig_color&#39;</span><span class="p">])</span>
        <span class="n">fig</span><span class="o">.</span><span class="n">set_size_inches</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;fig_w&#39;</span><span class="p">],</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;fig_h&#39;</span><span class="p">])</span>
        <span class="k">return</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span></div>

<div class="viewcode-block" id="BlochScene.state_to_cor"><a class="viewcode-back" href="../../../../mindquantum.io.html#mindquantum.io.BlochScene.state_to_cor">[docs]</a>    <span class="nd">@staticmethod</span>
    <span class="k">def</span> <span class="nf">state_to_cor</span><span class="p">(</span><span class="n">amp</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Convert one qubit state to three dimension coordinate.</span>

<span class="sd">        Args:</span>
<span class="sd">            amp (numpy.ndarray): One qubit quantum state.</span>

<span class="sd">        Returns:</span>
<span class="sd">            numpy.ndarray, three dimension coordinate.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">_check_input_type</span><span class="p">(</span><span class="s1">&#39;amp&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">amp</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">amp</span><span class="o">.</span><span class="n">shape</span> <span class="o">!=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;amp requires shape (2, ), but get </span><span class="si">{</span><span class="n">amp</span><span class="o">.</span><span class="n">shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="n">amp</span> <span class="o">=</span> <span class="n">amp</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">vdot</span><span class="p">(</span><span class="n">amp</span><span class="p">,</span> <span class="n">amp</span><span class="p">))</span>
        <span class="n">global_phase</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">amp</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
        <span class="n">amp</span> <span class="o">=</span> <span class="n">amp</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="mi">1</span><span class="n">j</span> <span class="o">*</span> <span class="n">global_phase</span><span class="p">)</span>
        <span class="n">theta</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">amp</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
        <span class="n">phi</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">angle</span><span class="p">(</span><span class="n">amp</span><span class="p">[</span><span class="mi">1</span><span class="p">])</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">phi</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">phi</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">cos</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">])</span></div>

    <span class="c1"># pylint: disable=too-many-arguments,too-many-locals,too-many-branches,too-many-statements</span>
<div class="viewcode-block" id="BlochScene.add_state"><a class="viewcode-back" href="../../../../mindquantum.io.html#mindquantum.io.BlochScene.add_state">[docs]</a>    <span class="k">def</span> <span class="nf">add_state</span><span class="p">(</span>
        <span class="bp">self</span><span class="p">,</span>
        <span class="n">ax</span><span class="p">,</span>
        <span class="n">amp</span><span class="p">,</span>
        <span class="n">linecolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">linewidth</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">pointcolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">pointsize</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">marker</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">projcolor</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">mode</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">with_proj</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">stick_args</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">stick_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">point_args</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">point_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">proj_args</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">proj_kwargs</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
    <span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Add one quantum state on bloch sphere.</span>

<span class="sd">        Args:</span>
<span class="sd">            ax (mpl_toolkits.mplot3d.axes3d.Axes3D): The three dimension axes you</span>
<span class="sd">                want add quantum state.</span>
<span class="sd">            amp (numpy.ndarray): The quantum state.</span>
<span class="sd">            linecolor (str): The color for stick. If None, it will be found in `config`</span>
<span class="sd">                in `BlochScene` with key `stick_c`. Default: None.</span>
<span class="sd">            linewidth (numbers.Number): The line width for stick. If None, it will be found</span>
<span class="sd">                in `config` in `BlochScene` with `stick_w`. Default: None.</span>
<span class="sd">            pointcolor (str): The color for point. If None, it will be found in `config`</span>
<span class="sd">                in `BlochScene` with key `point_c`. Default: None.</span>
<span class="sd">            pointsize (numbers.Number): The size of point. If None it will be found in `config`</span>
<span class="sd">                in `BlochScene` with key `point_s`. Default: None.</span>
<span class="sd">            marker (str): Point marker. If None, it will be found in `config` in `BlochScene` with</span>
<span class="sd">                key `point_m`. Default: None.</span>
<span class="sd">            projcolor (str): Project line color. If None it will be found in `config` in `BlochScene`</span>
<span class="sd">                with key `proj_c`. Default: None.</span>
<span class="sd">            mode (str): How to display the quantum state. Can be one of &#39;stick&#39;, &#39;point&#39;, &#39;both&#39;.</span>
<span class="sd">                If None, if will be found in `config` of `BlochScene` with key `state_mode`.</span>
<span class="sd">                Default: None.</span>
<span class="sd">            with_proj (bool): Whether to display the projection line alone x, y and z axis. If None,</span>
<span class="sd">                it will be found in `config` in `BlochScene` with key `with_proj`. Default: None.</span>
<span class="sd">            stick_args (tuple): The other args for stick. These args will be send to `Axes3D.plot`.</span>
<span class="sd">                Default: None.</span>
<span class="sd">            stick_kwargs (dict): The other key word args for stick. These args will be send to `Axes3D.plot`.</span>
<span class="sd">                Default: None.</span>
<span class="sd">            point_args (tuple): The other args for point. These args will be send to `Axes3D.scatter`.</span>
<span class="sd">                Default: None.</span>
<span class="sd">            point_kwargs (dict): The other key word args for point. These args will be send to</span>
<span class="sd">                `Axes3D.scatter`. Default: None.</span>
<span class="sd">            proj_args (tuple): The other args for projection line. These args will be send</span>
<span class="sd">                to `Axes3D.plot`. Default: None.</span>
<span class="sd">            proj_kwargs (dict): The other key word args for projection line. These args will be send to</span>
<span class="sd">                `Axes3D.plot`. Default: None.</span>

<span class="sd">        Returns:</span>
<span class="sd">            dict, a dict of object of stick, point, and projection line.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="k">if</span> <span class="n">linecolor</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">linecolor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;stick_c&#39;</span><span class="p">]</span>
        <span class="n">_check_input_type</span><span class="p">(</span><span class="s1">&#39;linecolor&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">linecolor</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">linewidth</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">linewidth</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;stick_w&#39;</span><span class="p">]</span>
        <span class="n">_check_input_type</span><span class="p">(</span><span class="s1">&#39;linewidth&#39;</span><span class="p">,</span> <span class="n">numbers</span><span class="o">.</span><span class="n">Number</span><span class="p">,</span> <span class="n">linewidth</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pointcolor</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">pointcolor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;point_c&#39;</span><span class="p">]</span>
        <span class="n">_check_input_type</span><span class="p">(</span><span class="s1">&#39;pointcolor&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">pointcolor</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">pointsize</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">pointsize</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;point_s&#39;</span><span class="p">]</span>
        <span class="n">_check_input_type</span><span class="p">(</span><span class="s1">&#39;pointsize&#39;</span><span class="p">,</span> <span class="n">numbers</span><span class="o">.</span><span class="n">Number</span><span class="p">,</span> <span class="n">pointsize</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">marker</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">marker</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;point_m&#39;</span><span class="p">]</span>
        <span class="n">_check_input_type</span><span class="p">(</span><span class="s1">&#39;marker&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">marker</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">projcolor</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">projcolor</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;proj_c&#39;</span><span class="p">]</span>
        <span class="n">_check_input_type</span><span class="p">(</span><span class="s1">&#39;projcolor&#39;</span><span class="p">,</span> <span class="nb">str</span><span class="p">,</span> <span class="n">projcolor</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">mode</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">mode</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;state_mode&#39;</span><span class="p">]</span>
        <span class="k">if</span> <span class="n">mode</span> <span class="ow">not</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="s1">&#39;stick&#39;</span><span class="p">,</span> <span class="s1">&#39;point&#39;</span><span class="p">):</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;mode should be one of &#39;both&#39;, &#39;stick&#39; or &#39;point&#39;. But get </span><span class="si">{</span><span class="n">mode</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">with_proj</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">with_proj</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;with_proj&#39;</span><span class="p">]</span>
        <span class="n">_check_input_type</span><span class="p">(</span><span class="s1">&#39;with_proj&#39;</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">with_proj</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">stick_args</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">stick_args</span> <span class="o">=</span> <span class="p">()</span>
        <span class="n">_check_input_type</span><span class="p">(</span><span class="s1">&#39;stick_args&#39;</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">,</span> <span class="n">stick_args</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">point_args</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">point_args</span> <span class="o">=</span> <span class="p">()</span>
        <span class="n">_check_input_type</span><span class="p">(</span><span class="s1">&#39;point_args&#39;</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">,</span> <span class="n">point_args</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">proj_args</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">proj_args</span> <span class="o">=</span> <span class="p">()</span>
        <span class="n">_check_input_type</span><span class="p">(</span><span class="s1">&#39;proj_args&#39;</span><span class="p">,</span> <span class="nb">tuple</span><span class="p">,</span> <span class="n">proj_args</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">stick_kwargs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">stick_kwargs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">_check_input_type</span><span class="p">(</span><span class="s1">&#39;stick_kwargs&#39;</span><span class="p">,</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">stick_kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">point_kwargs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">point_kwargs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">_check_input_type</span><span class="p">(</span><span class="s1">&#39;point_kwargs&#39;</span><span class="p">,</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">point_kwargs</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">proj_kwargs</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
            <span class="n">proj_kwargs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="n">_check_input_type</span><span class="p">(</span><span class="s1">&#39;proj_kwargs&#39;</span><span class="p">,</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">proj_kwargs</span><span class="p">)</span>

        <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">state_to_cor</span><span class="p">(</span><span class="n">amp</span><span class="p">)</span>
        <span class="n">objs</span> <span class="o">=</span> <span class="p">{}</span>
        <span class="k">if</span> <span class="n">with_proj</span><span class="p">:</span>
            <span class="n">line_x</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">projcolor</span><span class="p">,</span> <span class="o">*</span><span class="n">proj_args</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">,</span> <span class="o">**</span><span class="n">proj_kwargs</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">line_y</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="n">projcolor</span><span class="p">,</span> <span class="o">*</span><span class="n">proj_args</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">,</span> <span class="o">**</span><span class="n">proj_kwargs</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">line_z</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">z</span><span class="p">],</span> <span class="n">projcolor</span><span class="p">,</span> <span class="o">*</span><span class="n">proj_args</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">,</span> <span class="o">**</span><span class="n">proj_kwargs</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">objs</span><span class="p">[</span><span class="s1">&#39;line_x&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">line_x</span>
            <span class="n">objs</span><span class="p">[</span><span class="s1">&#39;line_y&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">line_y</span>
            <span class="n">objs</span><span class="p">[</span><span class="s1">&#39;line_z&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">line_z</span>
        <span class="k">if</span> <span class="n">mode</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="s1">&#39;stick&#39;</span><span class="p">):</span>
            <span class="n">vec</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">z</span><span class="p">],</span> <span class="n">linecolor</span><span class="p">,</span> <span class="o">*</span><span class="n">stick_args</span><span class="p">,</span> <span class="n">linewidth</span><span class="o">=</span><span class="n">linewidth</span><span class="p">,</span> <span class="o">**</span><span class="n">stick_kwargs</span><span class="p">)[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">objs</span><span class="p">[</span><span class="s1">&#39;vec&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">vec</span>
        <span class="k">if</span> <span class="n">mode</span> <span class="ow">in</span> <span class="p">(</span><span class="s1">&#39;both&#39;</span><span class="p">,</span> <span class="s1">&#39;dot&#39;</span><span class="p">):</span>
            <span class="n">point</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">([</span><span class="n">x</span><span class="p">],</span> <span class="p">[</span><span class="n">y</span><span class="p">],</span> <span class="p">[</span><span class="n">z</span><span class="p">],</span> <span class="o">*</span><span class="n">point_args</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="n">pointsize</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">marker</span><span class="p">,</span> <span class="n">c</span><span class="o">=</span><span class="n">pointcolor</span><span class="p">,</span> <span class="o">**</span><span class="n">point_kwargs</span><span class="p">)</span>
            <span class="n">objs</span><span class="p">[</span><span class="s1">&#39;point&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">point</span>
        <span class="k">return</span> <span class="n">objs</span></div>

<div class="viewcode-block" id="BlochScene.update"><a class="viewcode-back" href="../../../../mindquantum.io.html#mindquantum.io.BlochScene.update">[docs]</a>    <span class="k">def</span> <span class="nf">update</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">objs</span><span class="p">:</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">new_amp</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Update quantum state in bloch sphere.</span>

<span class="sd">        Update the quantum state in bloch sphere for a given objs generated</span>
<span class="sd">        by :class:`mindquantum.io.BlochScene.add_state` and a given quantum state.</span>

<span class="sd">        Args:</span>
<span class="sd">            objs (dict): The objects generated by :class:`mindquantum.io.BlochScene.add_state`.</span>
<span class="sd">            new_amp (numpy.ndarray): The new quantum state.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">state_to_cor</span><span class="p">(</span><span class="n">new_amp</span><span class="p">)</span>
        <span class="k">if</span> <span class="s1">&#39;vec&#39;</span> <span class="ow">in</span> <span class="n">objs</span><span class="p">:</span>
            <span class="n">vec</span> <span class="o">=</span> <span class="n">objs</span><span class="p">[</span><span class="s1">&#39;vec&#39;</span><span class="p">]</span>
            <span class="n">vec</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="p">]]))</span>
            <span class="n">vec</span><span class="o">.</span><span class="n">set_3d_properties</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">z</span><span class="p">]))</span>
        <span class="k">if</span> <span class="s1">&#39;point&#39;</span> <span class="ow">in</span> <span class="n">objs</span><span class="p">:</span>
            <span class="n">point</span> <span class="o">=</span> <span class="n">objs</span><span class="p">[</span><span class="s1">&#39;point&#39;</span><span class="p">]</span>
            <span class="n">point</span><span class="o">.</span><span class="n">_offsets3d</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span><span class="p">]])</span><span class="o">.</span><span class="n">T</span>  <span class="c1"># pylint: disable=protected-access</span>
        <span class="k">if</span> <span class="s1">&#39;line_x&#39;</span> <span class="ow">in</span> <span class="n">objs</span><span class="p">:</span>
            <span class="n">line_x</span> <span class="o">=</span> <span class="n">objs</span><span class="p">[</span><span class="s1">&#39;line_x&#39;</span><span class="p">]</span>
            <span class="n">line_x</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="n">x</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]))</span>
            <span class="n">line_x</span><span class="o">.</span><span class="n">set_3d_properties</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]))</span>
        <span class="k">if</span> <span class="s1">&#39;line_y&#39;</span> <span class="ow">in</span> <span class="n">objs</span><span class="p">:</span>
            <span class="n">line_y</span> <span class="o">=</span> <span class="n">objs</span><span class="p">[</span><span class="s1">&#39;line_y&#39;</span><span class="p">]</span>
            <span class="n">line_y</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="n">y</span><span class="p">]]))</span>
            <span class="n">line_y</span><span class="o">.</span><span class="n">set_3d_properties</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]))</span>
        <span class="k">if</span> <span class="s1">&#39;line_z&#39;</span> <span class="ow">in</span> <span class="n">objs</span><span class="p">:</span>
            <span class="n">line_z</span> <span class="o">=</span> <span class="n">objs</span><span class="p">[</span><span class="s1">&#39;line_z&#39;</span><span class="p">]</span>
            <span class="n">line_z</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]]))</span>
            <span class="n">line_z</span><span class="o">.</span><span class="n">set_3d_properties</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="n">z</span><span class="p">]))</span></div>

    <span class="c1"># pylint: disable=too-many-arguments,too-many-locals</span>
<div class="viewcode-block" id="BlochScene.animation"><a class="viewcode-back" href="../../../../mindquantum.io.html#mindquantum.io.BlochScene.animation">[docs]</a>    <span class="k">def</span> <span class="nf">animation</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span><span class="p">,</span> <span class="n">objs</span><span class="p">,</span> <span class="n">new_amps</span><span class="p">:</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">interval</span><span class="o">=</span><span class="mi">15</span><span class="p">,</span> <span class="n">with_trace</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">history_len</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
<span class="w">        </span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">        Animate a quantum state on bolch sphere.</span>

<span class="sd">        Args:</span>
<span class="sd">            fig (matplotlib.figure.Figure): The bloch sphere scene figure.</span>
<span class="sd">            ax (mpl_toolkits.mplot3d.axes3d.Axes3D): The axes of bloch sphere scene.</span>
<span class="sd">            objs (dict): The objects generated by `BlochScene.add_state`.</span>
<span class="sd">            new_amps (numpy.ndarray): All quantum state you want to animate.</span>
<span class="sd">            interval (int): Delay between frames in milliseconds. Default: 15.</span>
<span class="sd">            with_trace (bool): Whether to display the trace of quantum state. Default: True.</span>
<span class="sd">            history_len (int): The trace length. If None, it will be the length of given</span>
<span class="sd">                quantum states. Defaults: None.</span>
<span class="sd">            kwargs (dict): The other key word args for `animation.FuncAnimation`.</span>

<span class="sd">        Returns:</span>
<span class="sd">            animation.FuncAnimation, the animation object in matplotlib.</span>
<span class="sd">        &quot;&quot;&quot;</span>
        <span class="n">console</span> <span class="o">=</span> <span class="n">rich</span><span class="o">.</span><span class="n">console</span><span class="o">.</span><span class="n">Console</span><span class="p">()</span>
        <span class="k">if</span> <span class="n">console</span><span class="o">.</span><span class="n">is_jupyter</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="s2">&quot;jupyter environment detected, if animation not work, please install ipympl with &quot;</span>
                <span class="s2">&quot;&#39;!pip install ipympl&#39; in jupyter notebook and run &#39;%matplotlib ipympl&#39; in cell.&quot;</span>
            <span class="p">)</span>
        <span class="n">_check_input_type</span><span class="p">(</span><span class="s1">&#39;fig&#39;</span><span class="p">,</span> <span class="n">Figure</span><span class="p">,</span> <span class="n">fig</span><span class="p">)</span>
        <span class="n">_check_input_type</span><span class="p">(</span><span class="s1">&#39;ax&#39;</span><span class="p">,</span> <span class="n">Axes3D</span><span class="p">,</span> <span class="n">ax</span><span class="p">)</span>
        <span class="n">_check_input_type</span><span class="p">(</span><span class="s1">&#39;objs&#39;</span><span class="p">,</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">objs</span><span class="p">)</span>
        <span class="n">_check_input_type</span><span class="p">(</span><span class="s1">&#39;new_amps&#39;</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">ndarray</span><span class="p">,</span> <span class="n">new_amps</span><span class="p">)</span>
        <span class="n">_check_int_type</span><span class="p">(</span><span class="s1">&#39;interval&#39;</span><span class="p">,</span> <span class="n">interval</span><span class="p">)</span>
        <span class="n">_check_input_type</span><span class="p">(</span><span class="s1">&#39;with_trace&#39;</span><span class="p">,</span> <span class="nb">bool</span><span class="p">,</span> <span class="n">with_trace</span><span class="p">)</span>
        <span class="n">amps_shape</span> <span class="o">=</span> <span class="n">new_amps</span><span class="o">.</span><span class="n">shape</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">amps_shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">2</span> <span class="ow">or</span> <span class="n">amps_shape</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">!=</span> <span class="mi">2</span><span class="p">:</span>
            <span class="k">raise</span> <span class="ne">ValueError</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;new_amps requires two dimension with second dimension size to 2, but get </span><span class="si">{</span><span class="n">amps_shape</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">with_trace</span><span class="p">:</span>
            <span class="n">trace_color</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;trace_c&#39;</span><span class="p">]</span>
            <span class="n">trace_marker</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;trace_m&#39;</span><span class="p">]</span>
            <span class="n">trace_lw</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;trace_lw&#39;</span><span class="p">]</span>
            <span class="n">trace_ms</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;trace_ms&#39;</span><span class="p">]</span>
            <span class="n">trace_ls</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">config</span><span class="p">[</span><span class="s1">&#39;trace_ls&#39;</span><span class="p">]</span>
            <span class="p">(</span><span class="n">trace</span><span class="p">,)</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span>
                <span class="p">[],</span> <span class="p">[],</span> <span class="p">[],</span> <span class="n">color</span><span class="o">=</span><span class="n">trace_color</span><span class="p">,</span> <span class="n">linestyle</span><span class="o">=</span><span class="n">trace_ls</span><span class="p">,</span> <span class="n">marker</span><span class="o">=</span><span class="n">trace_marker</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="n">trace_lw</span><span class="p">,</span> <span class="n">ms</span><span class="o">=</span><span class="n">trace_ms</span>
            <span class="p">)</span>
            <span class="k">if</span> <span class="n">history_len</span> <span class="ow">is</span> <span class="kc">None</span><span class="p">:</span>
                <span class="n">history_len</span> <span class="o">=</span> <span class="n">new_amps</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
            <span class="n">_check_int_type</span><span class="p">(</span><span class="s1">&#39;history_len&#39;</span><span class="p">,</span> <span class="n">history_len</span><span class="p">)</span>
            <span class="n">his_x</span><span class="p">,</span> <span class="n">his_y</span><span class="p">,</span> <span class="n">his_z</span> <span class="o">=</span> <span class="n">deque</span><span class="p">(</span><span class="n">maxlen</span><span class="o">=</span><span class="n">history_len</span><span class="p">),</span> <span class="n">deque</span><span class="p">(</span><span class="n">maxlen</span><span class="o">=</span><span class="n">history_len</span><span class="p">),</span> <span class="n">deque</span><span class="p">(</span><span class="n">maxlen</span><span class="o">=</span><span class="n">history_len</span><span class="p">)</span>

            <span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
<span class="w">                </span><span class="sd">&quot;&quot;&quot;Update func with projection lines.&quot;&quot;&quot;</span>
                <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">z</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">state_to_cor</span><span class="p">(</span><span class="n">new_amps</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
                    <span class="n">his_x</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
                    <span class="n">his_y</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
                    <span class="n">his_z</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
                <span class="n">his_x</span><span class="o">.</span><span class="n">appendleft</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
                <span class="n">his_y</span><span class="o">.</span><span class="n">appendleft</span><span class="p">(</span><span class="n">y</span><span class="p">)</span>
                <span class="n">his_z</span><span class="o">.</span><span class="n">appendleft</span><span class="p">(</span><span class="n">z</span><span class="p">)</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">objs</span><span class="p">,</span> <span class="n">new_amps</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
                <span class="n">trace</span><span class="o">.</span><span class="n">set_data</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">his_x</span><span class="p">,</span> <span class="n">his_y</span><span class="p">]))</span>
                <span class="n">trace</span><span class="o">.</span><span class="n">set_3d_properties</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">his_z</span><span class="p">))</span>

        <span class="k">else</span><span class="p">:</span>

            <span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">i</span><span class="p">):</span>
                <span class="bp">self</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">objs</span><span class="p">,</span> <span class="n">new_amps</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

        <span class="k">return</span> <span class="n">animation</span><span class="o">.</span><span class="n">FuncAnimation</span><span class="p">(</span><span class="n">fig</span><span class="p">,</span> <span class="n">func</span><span class="p">,</span> <span class="n">new_amps</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">interval</span><span class="o">=</span><span class="n">interval</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">)</span></div></div>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, MindSpore.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 
</body>
</html>