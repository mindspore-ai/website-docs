<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Grover search and Long algorithms based on MindQuantum &mdash; MindSpore master documentation</title><script>;(()=>{const e=localStorage.getItem("ms-theme"),t=window.matchMedia("(prefers-color-scheme: dark)").matches;(e?"dark"===e:t)&&document.documentElement.setAttribute("data-o-theme","dark")})();</script><link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script><script src="_static/jquery.js"></script>
        <script src="_static/js/theme.js"></script><script src="_static/underscore.js"></script><script src="_static/doctools.js"></script><script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script><script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script><script async="async" src="https://cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Shor’s algorithm based on MindQuantum" href="shor_algorithm.html" />
    <link rel="prev" title="Quantum Phase Estimation Algorithm" href="quantum_phase_estimation.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> MindSpore
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Installation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="mindquantum_install.html">MindQuantum Installation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="parameterized_quantum_circuit.html">Variational Quantum Circuit</a></li>
<li class="toctree-l1"><a class="reference internal" href="initial_experience_of_quantum_neural_network.html">Initial experience of quantum neural network</a></li>
<li class="toctree-l1"><a class="reference internal" href="get_gradient_of_PQC_with_mindquantum.html">Advanced gradient calculation of variational quantum circuits</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Variational Quantum Algorithm</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="classification_of_iris_by_qnn.html">Classification of iris by quantum neural network</a></li>
<li class="toctree-l1"><a class="reference internal" href="quantum_approximate_optimization_algorithm.html">Quantum Approximate Optimization Algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="qnn_for_nlp.html">The Application of Quantum Neural Network in NLP</a></li>
<li class="toctree-l1"><a class="reference internal" href="vqe_for_quantum_chemistry.html">VQE Application in Quantum Chemistry Computing</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">General Quantum Algorithm</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="quantum_phase_estimation.html">Quantum Phase Estimation Algorithm</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Grover search and Long algorithms based on MindQuantum</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#problem-description">Problem description</a></li>
<li class="toctree-l2"><a class="reference internal" href="#fundamentals-of-grover-search-algorithm">Fundamentals of Grover search algorithm</a></li>
<li class="toctree-l2"><a class="reference internal" href="#constructing-a-unitary-operator-that-flips-the-phase-of-a-qubit">Constructing a unitary operator that flips the phase of a qubit</a></li>
<li class="toctree-l2"><a class="reference internal" href="#examples-of-grover-search-algorithm-using-mindquantum">Examples of Grover search algorithm using MindQuantum</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#example-1-n3-\omega\rangle2\rangle-single-target">Example 1: <span class="math notranslate nohighlight">\(n=3\)</span>, <span class="math notranslate nohighlight">\(|\omega\rangle=|2\rangle\)</span> (single target)</a></li>
<li class="toctree-l3"><a class="reference internal" href="#example-2-n5-\omega\rangle5\rangle-and-11\rangle-multi-target">Example 2: <span class="math notranslate nohighlight">\(n=5\)</span>, <span class="math notranslate nohighlight">\(|\omega\rangle=|5\rangle\)</span> and <span class="math notranslate nohighlight">\(|11\rangle\)</span> (multi-target)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#long-algorithm">Long Algorithm</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#quntum-circuit-for-general-angle-phase-rotation">Quntum circuit for general angle phase rotation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#constructing-the-long-operator">Constructing the Long operator</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#performing-the-quantum-exact-search-algorithm-long-algorithm">Performing the quantum exact search algorithm: Long algorithm</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#references-"><strong>References:</strong></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="shor_algorithm.html">Shor’s algorithm based on MindQuantum</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="mindquantum.core.html">mindquantum.core</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindquantum.simulator.html">mindquantum.simulator</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindquantum.framework.html">mindquantum.framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindquantum.algorithm.html">mindquantum.algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindquantum.io.html">mindquantum.io</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindquantum.engine.html">mindquantum.engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindquantum.utils.html">mindquantum.utils</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">RELEASE NOTES</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="RELEASE.html">Release Notes</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">MindSpore</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Grover search and Long algorithms based on MindQuantum</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/grover_search_algorithm.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars and line breaks on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
    white-space: pre;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
.jp-RenderedHTMLCommon table,
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
.jp-RenderedHTMLCommon thead,
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
.jp-RenderedHTMLCommon tr,
.jp-RenderedHTMLCommon th,
.jp-RenderedHTMLCommon td,
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
.jp-RenderedHTMLCommon th,
div.rendered_html th {
  font-weight: bold;
}
.jp-RenderedHTMLCommon tbody tr:nth-child(odd),
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.jp-RenderedHTMLCommon tbody tr:hover,
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="grover-search-and-long-algorithms-based-on-mindquantum">
<h1>Grover search and Long algorithms based on MindQuantum<a class="headerlink" href="#grover-search-and-long-algorithms-based-on-mindquantum" title="Permalink to this headline"></a></h1>
<p>Translators: <a class="reference external" href="https://gitee.com/unseenme">unseenme</a> and <a class="reference external" href="https://gitee.com/herunhong">Waikikilick</a></p>
<p><a class="reference external" href="https://mindspore-website.obs.cn-north-4.myhuaweicloud.com/notebook/r2.0.0-alpha/mindquantum/en/mindspore_grover_search_algorithm.ipynb"><img alt="下载Notebook" src="https://mindspore-website.obs.cn-north-4.myhuaweicloud.com/website-images/r2.0.0-alpha/resource/_static/logo_notebook_en.png" /></a>  <a class="reference external" href="https://mindspore-website.obs.cn-north-4.myhuaweicloud.com/notebook/r2.0.0-alpha/mindquantum/en/mindspore_grover_search_algorithm.py"><img alt="下载样例代码" src="https://mindspore-website.obs.cn-north-4.myhuaweicloud.com/website-images/r2.0.0-alpha/resource/_static/logo_download_code_en.png" /></a>  <a class="reference external" href="https://gitee.com/mindspore/docs/blob/r2.0.0-alpha/docs/mindquantum/docs/source_en/grover_search_algorithm.ipynb"><img alt="查看源文件" src="https://mindspore-website.obs.cn-north-4.myhuaweicloud.com/website-images/r2.0.0-alpha/resource/_static/logo_source_en.png" /></a></p>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline"></a></h2>
<p>If you have heard of quantum computing, you must have heard of the Grover search algorithm. In 1996, Lov Grover [1] proposed the Grover search algorithm, which is an algorithm that uses the superposition of quantum states to perform parallel computing and achieve acceleration. The Grover search algorithm is recognized as the second great quantum algorithm after Shor algorithm, and it is also the first quantum algorithm to be fully experimentally implemented, which solves the problem of unordered
database search. In 1997, Bennett [2] et al. proved that for the unstructured quantum search problem, at least <span class="math notranslate nohighlight">\(\Omega(\sqrt{N})\)</span> quantum queries are required, so the Grover search algorithm is the optimal algorithm in the asymptotic sense.</p>
<p>The Unordered Database Search problem is to find some elements that meet the requirements from an unordered database with a large number of elements. Since the number of elements in the database is huge and the elements are unordered, it is easy to verify that a given element satisfies the requirements, but conversely, it is not easy to find these elements.</p>
<p>To solve the unordered database search problem (it may be assumed that there is only one target search data), the time complexity required by the classical algorithm is <span class="math notranslate nohighlight">\(\mathcal{O}(N)\)</span>, while the time complexity required by the Grover search algorithm is only <span class="math notranslate nohighlight">\(\mathcal{O}(\sqrt{N})\)</span>, compared with the classical algorithm, it has a quadratic speedup, showing the powerful performance of quantum computing. In addition, the amplitude expansion technique used in Grover search algorithm
can accelerate many heuristic classical search algorithms, so it has a wide range of applications.</p>
<p>This document will introduce the basic principles of Grover search algorithm, and show how to use MindQuantum to implement the algorithm by two specific simple examples.</p>
</section>
<section id="problem-description">
<h2>Problem description<a class="headerlink" href="#problem-description" title="Permalink to this headline"></a></h2>
<p>We need to search in an unordered set of <span class="math notranslate nohighlight">\(N\)</span> elements (database). Establish one-to-one correspondence between elements in the database and indexes (integers from <span class="math notranslate nohighlight">\(0\)</span> to <span class="math notranslate nohighlight">\(N-1\)</span>), and we focus on searching the indices of these elements. Consider formulating this search problem as a function <span class="math notranslate nohighlight">\(f(x)\)</span> over an input <span class="math notranslate nohighlight">\(x\)</span>, where <span class="math notranslate nohighlight">\(x\)</span> is an integer between <span class="math notranslate nohighlight">\(0\)</span> and <span class="math notranslate nohighlight">\(N-1\)</span>. Then, the function <span class="math notranslate nohighlight">\(f\)</span> is defined as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{equation}
f(x)=\begin{cases}0,x\neq x_{target}\\\\
1,x=x_{target}
\end{cases}
\end{equation}.\end{split}\]</div>
<p>Without loss of generality, assuming <span class="math notranslate nohighlight">\(N=2^n\)</span>, then in a quantum system, the index is in the quantum state <span class="math notranslate nohighlight">\(|0\rangle,|1\rangle,...,|N-1\rangle\)</span> (or <span class="math notranslate nohighlight">\(|00...0\rangle,|00...1\rangle,...,|11...1\rangle\)</span>), that is, we can use <span class="math notranslate nohighlight">\(n\)</span> qubits to store these indices.</p>
<p>At the same time, it is assumed that the search problem has only one target state <span class="math notranslate nohighlight">\(|\omega\rangle\)</span>. The goal of Grover search algorithm is to search for <span class="math notranslate nohighlight">\(|\omega\rangle\)</span> with great probability.</p>
</section>
<section id="fundamentals-of-grover-search-algorithm">
<h2>Fundamentals of Grover search algorithm<a class="headerlink" href="#fundamentals-of-grover-search-algorithm" title="Permalink to this headline"></a></h2>
<p>The basic principle of Grover search algorithm: First, a uniform superposition state is generated by the Hadamard gate, and then the Grover iteration (or <span class="math notranslate nohighlight">\(G\)</span> operator) is repeatedly called to amplify the probability amplitude of the target item and suppress the probability amplitude of the non-target item (this method is called is the amplitude amplification), and finally the final state is measured, so that the target state <span class="math notranslate nohighlight">\(|\omega\rangle\)</span> can be obtained with great probability.</p>
<p>The Grover search algorithm mainly includes the following steps:</p>
<ul>
<li><p>Step 1: Database initialization</p>
<p>Perform the <span class="math notranslate nohighlight">\(H^{\otimes n}\)</span> operation on <span class="math notranslate nohighlight">\(|0\rangle^{\otimes n}\)</span>, so that the database is initially in a uniform superposition state, that is</p>
<div class="math notranslate nohighlight">
\[|\psi_0\rangle=H^{\otimes n}|0\rangle^{\otimes n}=\frac{1}{\sqrt{N}}\sum_{i=0}^{N-1}|i\rangle.\]</div>
</li>
<li><p>Step 2: Grover Iteration</p>
<p>Grover iteration can be further decomposed into four steps:</p>
<ol class="arabic">
<li><p>Execute the Oracle operator <span class="math notranslate nohighlight">\(U_{\omega}\)</span>, and flip the phase of the target state <span class="math notranslate nohighlight">\(|\omega \rangle\)</span></p>
<p>In order to distinguish the data to be found from other data, the easiest way is to flip the phase of the target state (add a negative sign). At this time, we need to construct an Oracle operator <span class="math notranslate nohighlight">\(U_{\omega}\)</span>, which works as follows:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{equation} U_{\omega}|x\rangle=\begin{cases} &amp;|x\rangle,x\neq \omega&amp;\\\\ -&amp;|x\rangle,x=\omega&amp; \end{cases} \end{equation}.\end{split}\]</div>
<p>Since when <span class="math notranslate nohighlight">\(x=\omega\)</span>, <span class="math notranslate nohighlight">\(f(\omega)=1\)</span>, the effect of <span class="math notranslate nohighlight">\(U_{\omega}\)</span> can also be expressed as:</p>
<div class="math notranslate nohighlight">
\[U_{\omega}|x\rangle=(-1)^{f(x)}|x\rangle,\]</div>
<p>Its matrix expression is</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{equation}U_{\omega}=\left[\begin{array}{ccc}(-1)^{f(0)} &amp;0&amp; \dots  &amp; 0            \\\\     0           &amp; (-1)^{f(1)} &amp; \dots  &amp; 0            \\\\     \vdots      &amp; \vdots      &amp; \ddots &amp; \vdots       \\\\     0           &amp; 0           &amp; \dots  &amp; (-1)^{f(N-1)}\end{array}\right]\end{equation}.\end{split}\]</div>
</li>
<li><p>Perform <span class="math notranslate nohighlight">\(H^{\otimes n}\)</span> operation</p>
<p>Perform <span class="math notranslate nohighlight">\(H^{\otimes n}\)</span> operation on <span class="math notranslate nohighlight">\(n\)</span> qubits.</p>
</li>
<li><p>Execute conditional phase shift operator <span class="math notranslate nohighlight">\(P\)</span></p>
<p>The conditional phase shift operator <span class="math notranslate nohighlight">\(P\)</span> can flip the phase of each state except the <span class="math notranslate nohighlight">\(|0\rangle\)</span> state, and its effect is as follows:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{equation}P|x\rangle=\begin{cases}&amp;|0\rangle,x= 0&amp;\\\\-&amp;|x\rangle,x\neq0&amp;\end{cases}\end{equation}.\end{split}\]</div>
<p>Its matrix expression is</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{equation}P = 2(|0\rangle\langle0|)^{\otimes n} - I_n =\left[\begin{array}{ccc}     1      &amp; 0      &amp; \dots  &amp; 0            \\\\     0      &amp; -1     &amp; \dots  &amp; 0            \\\\     \vdots &amp; \vdots &amp; \ddots &amp; \vdots       \\\\     0      &amp; 0      &amp; \dots  &amp; -1\end{array}\right]\end{equation}.\end{split}\]</div>
</li>
<li><p>Perform <span class="math notranslate nohighlight">\(H^{\otimes n}\)</span> operation again</p>
<p>So far, the complete <span class="math notranslate nohighlight">\(G\)</span> operator can be expressed as</p>
<div class="math notranslate nohighlight">
\[G = H^{\otimes n} [2(|0\rangle\langle0|)^{\otimes n} - I_n] H^{\otimes n} U_{\omega}.\]</div>
<p>Note: The number of iterations required for the <span class="math notranslate nohighlight">\(G\)</span> operator is</p>
<div class="math notranslate nohighlight">
\[r = \left[ \frac{\pi}{4} \sqrt{\frac{N}{M}} \right] \sim O(\sqrt{N}),\]</div>
<p>where, <span class="math notranslate nohighlight">\(M\)</span> represents the number of target states.</p>
</li>
</ol>
</li>
<li><p>Step 3: Measurement</p>
<p>By performing <span class="math notranslate nohighlight">\(\{|0\rangle,|1\rangle\}\)</span> basis measurements on the final state, the target state <span class="math notranslate nohighlight">\(|\omega \rangle\)</span> can be obtained with great probability.</p>
</li>
</ul>
<p>The complete quantum circuit model of Grover search algorithm is shown below:</p>
<p><img alt="grover algorithm circuit" src="https://mindspore-website.obs.cn-north-4.myhuaweicloud.com/website-images/r2.0.0-alpha/docs/mindquantum/docs/source_en/images/grover_algorithm_circuit.png" /></p>
</section>
<section id="constructing-a-unitary-operator-that-flips-the-phase-of-a-qubit">
<h2>Constructing a unitary operator that flips the phase of a qubit<a class="headerlink" href="#constructing-a-unitary-operator-that-flips-the-phase-of-a-qubit" title="Permalink to this headline"></a></h2>
<p>By the above introduction, we found that the most critical part of the Grover search algorithm is that there is a unitary operator that can flip the phase of the qubit, the Oracle operator <span class="math notranslate nohighlight">\(U_{\omega}\)</span> can flip the phase of the target state, and the conditional phase shift operator <span class="math notranslate nohighlight">\(P\)</span> can flip the phase of every state except <span class="math notranslate nohighlight">\(|0\rangle\)</span> state.</p>
<p>Next, we will construct a unitary operator that can flip the phase of a qubit, defined as follows:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mindquantum.core.circuit</span> <span class="kn">import</span> <span class="n">Circuit</span>
<span class="kn">from</span> <span class="nn">mindquantum.core.gates</span> <span class="kn">import</span> <span class="n">Z</span>
<span class="k">def</span> <span class="nf">bitphaseflip_operator</span><span class="p">(</span><span class="n">phase_inversion_qubit</span><span class="p">,</span> <span class="n">n_qubits</span><span class="p">):</span>   <span class="c1"># Define a function that flips the phase of a qubit</span>
    <span class="n">s</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">n_qubits</span><span class="p">)]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">phase_inversion_qubit</span><span class="p">:</span>
        <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span>
    <span class="k">if</span> <span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)):</span>
            <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
    <span class="n">circuit</span> <span class="o">=</span> <span class="n">Circuit</span><span class="p">()</span>
    <span class="n">length</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
    <span class="n">cz</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">length</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">s</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="o">==</span> <span class="o">-</span><span class="mi">1</span><span class="p">:</span>
            <span class="n">cz</span><span class="o">.</span><span class="n">append</span><span class="p">([])</span>
            <span class="n">current</span> <span class="o">=</span> <span class="n">i</span>
            <span class="n">t</span> <span class="o">=</span> <span class="mi">0</span>
            <span class="k">while</span> <span class="n">current</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="k">if</span> <span class="p">(</span><span class="n">current</span> <span class="o">&amp;</span> <span class="mi">1</span><span class="p">)</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
                    <span class="n">cz</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">t</span><span class="p">)</span>
                <span class="n">t</span> <span class="o">+=</span> <span class="mi">1</span>
                <span class="n">current</span> <span class="o">=</span> <span class="n">current</span> <span class="o">&gt;&gt;</span> <span class="mi">1</span>
            <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">i</span> <span class="o">+</span> <span class="mi">1</span><span class="p">,</span> <span class="n">length</span><span class="p">):</span>
                <span class="k">if</span> <span class="n">i</span> <span class="o">&amp;</span> <span class="n">j</span> <span class="o">==</span> <span class="n">i</span><span class="p">:</span>
                    <span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="mi">1</span> <span class="o">*</span> <span class="n">s</span><span class="p">[</span><span class="n">j</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">cz</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">i</span><span class="p">:</span>
            <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">1</span><span class="p">:</span>
                <span class="n">circuit</span> <span class="o">+=</span> <span class="n">Z</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">i</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
            <span class="k">else</span><span class="p">:</span>
                <span class="n">circuit</span> <span class="o">+=</span> <span class="n">Z</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="n">i</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="k">return</span> <span class="n">circuit</span>
</pre></div>
</div>
</div>
<p>Now, the <code class="docutils literal notranslate"><span class="pre">bitphaseflip_operator()</span></code> function can flip the phase of a qubit, and users only need to input the target quantum state and the total number of qubits that need to flip the phase.</p>
<p>As an example, we now generate a uniform superposition of 3 qubits by running the following code:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># pylint: disable=W0104</span>
<span class="kn">from</span> <span class="nn">mindquantum.core.circuit</span> <span class="kn">import</span> <span class="n">UN</span>
<span class="kn">from</span> <span class="nn">mindquantum.core.gates</span> <span class="kn">import</span> <span class="n">H</span>
<span class="kn">from</span> <span class="nn">mindquantum.simulator</span> <span class="kn">import</span> <span class="n">Simulator</span>

<span class="n">n_qubits</span> <span class="o">=</span> <span class="mi">3</span>                                 <span class="c1"># Set the number of qubits to 3</span>
<span class="n">sim</span> <span class="o">=</span> <span class="n">Simulator</span><span class="p">(</span><span class="s1">&#39;mqvector&#39;</span><span class="p">,</span> <span class="n">n_qubits</span><span class="p">)</span>        <span class="c1"># Use the mqvector simulator, named sim</span>

<span class="n">circuit</span> <span class="o">=</span> <span class="n">Circuit</span><span class="p">()</span>                          <span class="c1"># Initialize the quantum circuit, named circuit</span>
<span class="n">circuit</span> <span class="o">+=</span> <span class="n">UN</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">n_qubits</span><span class="p">)</span>                   <span class="c1"># H-gate operations are performed on each qubit</span>

<span class="n">sim</span><span class="o">.</span><span class="n">apply_circuit</span><span class="p">(</span><span class="n">circuit</span><span class="p">)</span>                   <span class="c1"># Run the built quantum circuit circuit by the simulator sim</span>

<span class="n">circuit</span><span class="o">.</span><span class="n">svg</span><span class="p">()</span>                                <span class="c1"># Print the quantum circuit circuit at this time                               # 打印此时的量子线路circuit</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="_images/grover_search_algorithm_3_0.svg" src="_images/grover_search_algorithm_3_0.svg" /></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">get_qs</span><span class="p">(</span><span class="kc">True</span><span class="p">))</span>                      <span class="c1"># Print the final state after running the quantum circuit circuit in the simulator sim</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
√2/4¦000⟩
√2/4¦001⟩
√2/4¦010⟩
√2/4¦011⟩
√2/4¦100⟩
√2/4¦101⟩
√2/4¦110⟩
√2/4¦111⟩
</pre></div></div>
</div>
<p>From the running results, we can see the quantum circuit at this time, and a uniform superposition state of 3 qubits has been generated successfully.</p>
<p>Suppose we need to flip the phase of the <span class="math notranslate nohighlight">\(|4\rangle\)</span> state, just call the <code class="docutils literal notranslate"><span class="pre">bitphaseflip_operator()</span></code> function we defined and run the following code:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># pylint: disable=W0104</span>
<span class="n">sim</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>                                                      <span class="c1"># Reset the quantum state maintained by the simulator sim so that the initialized quantum state is |000&gt;</span>

<span class="n">phase_inversion_qubit</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">]</span>                                      <span class="c1"># Invert the phase of the |4&gt; state</span>
<span class="n">operator</span> <span class="o">=</span> <span class="n">bitphaseflip_operator</span><span class="p">(</span><span class="n">phase_inversion_qubit</span><span class="p">,</span> <span class="n">n_qubits</span><span class="p">)</span><span class="c1"># Call our defined bitphaseflip_operator() function</span>

<span class="n">circuit</span> <span class="o">+=</span> <span class="n">operator</span>                                              <span class="c1"># Add the quantum gate required to flip the phase of the |4&gt; state in the quantum circuit circuit</span>

<span class="n">sim</span><span class="o">.</span><span class="n">apply_circuit</span><span class="p">(</span><span class="n">circuit</span><span class="p">)</span>                                       <span class="c1"># Run the built quantum circuit circuit again by the simulator sim</span>

<span class="n">circuit</span><span class="o">.</span><span class="n">svg</span><span class="p">()</span>                                                    <span class="c1"># Print the quantum circuit circuit at this time</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="_images/grover_search_algorithm_6_0.svg" src="_images/grover_search_algorithm_6_0.svg" /></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">sim</span><span class="o">.</span><span class="n">get_qs</span><span class="p">(</span><span class="kc">True</span><span class="p">))</span>                                          <span class="c1"># Print the final state after running the quantum circuit in the simulator sim</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
√2/4¦000⟩
√2/4¦001⟩
√2/4¦010⟩
√2/4¦011⟩
-√2/4¦100⟩
√2/4¦101⟩
√2/4¦110⟩
√2/4¦111⟩
</pre></div></div>
</div>
<p>From the running results, we can see that the quantum circuit at this time, and the phase of <span class="math notranslate nohighlight">\(|100\rangle\)</span> is flipped to -1, run the following code:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="s1">&#39;100&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
4
</pre></div></div>
</div>
<p>It can be seen from the running results that the <span class="math notranslate nohighlight">\(|100\rangle\)</span> state where the phase is flipped is the <span class="math notranslate nohighlight">\(|4\rangle\)</span> state where we want the phase to flipped.</p>
<p>Assuming we need to flip the phase of every state except the <span class="math notranslate nohighlight">\(|0\rangle\)</span> state, run the following code:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># pylint: disable=W0104</span>
<span class="n">n_qubits</span> <span class="o">=</span> <span class="mi">3</span>                                                     <span class="c1"># Set the number of qubits to 3</span>
<span class="n">sim1</span> <span class="o">=</span> <span class="n">Simulator</span><span class="p">(</span><span class="s1">&#39;mqvector&#39;</span><span class="p">,</span> <span class="n">n_qubits</span><span class="p">)</span>                           <span class="c1"># Use the mqvector simulator, named sim1</span>

<span class="n">operator1</span> <span class="o">=</span> <span class="n">bitphaseflip_operator</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_qubits</span><span class="p">))],</span> <span class="n">n_qubits</span><span class="p">)</span> <span class="c1"># Call our defined bitphaseflip_operator() function to flip the phase of each state except |0&gt; state, named operator1</span>

<span class="n">circuit1</span> <span class="o">=</span> <span class="n">Circuit</span><span class="p">()</span>                                             <span class="c1"># Initialize the quantum circuit, named circuit1</span>
<span class="n">circuit1</span> <span class="o">+=</span> <span class="n">UN</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">n_qubits</span><span class="p">)</span>                                      <span class="c1"># H-gate operations are performed on each qubit</span>
<span class="n">circuit1</span> <span class="o">+=</span> <span class="n">operator1</span>                                            <span class="c1"># Add the quantum gates required to flip the phase of each state except the |0&gt; state in the quantum circuit circuit1</span>

<span class="n">sim1</span><span class="o">.</span><span class="n">apply_circuit</span><span class="p">(</span><span class="n">circuit1</span><span class="p">)</span>                                     <span class="c1"># Run the built quantum circuit circuit1 by the simulator sim1</span>

<span class="n">circuit1</span><span class="o">.</span><span class="n">svg</span><span class="p">()</span>                                                   <span class="c1"># Print the quantum circuit circuit1 at this time                                                   # 打印此时的量子线路circuit1</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="_images/grover_search_algorithm_11_0.svg" src="_images/grover_search_algorithm_11_0.svg" /></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">sim1</span><span class="o">.</span><span class="n">get_qs</span><span class="p">(</span><span class="kc">True</span><span class="p">))</span>                                         <span class="c1"># Print the final state after running the quantum circuit circuit1 in the simulator sim1</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
√2/4¦000⟩
-√2/4¦001⟩
-√2/4¦010⟩
-√2/4¦011⟩
-√2/4¦100⟩
-√2/4¦101⟩
-√2/4¦110⟩
-√2/4¦111⟩
</pre></div></div>
</div>
<p>From the running results, we can see the quantum circuit at this time, and we successfully flip the phase of every state except the <span class="math notranslate nohighlight">\(|0\rangle\)</span> state.</p>
<p>That is to say, the function <code class="docutils literal notranslate"><span class="pre">bitphaseflip_operator()</span></code> we define can implement the Oracle operator <span class="math notranslate nohighlight">\(U_{\omega}\)</span> and the conditional phase shift operator <span class="math notranslate nohighlight">\(P\)</span> in the Grover search algorithm.</p>
</section>
<section id="examples-of-grover-search-algorithm-using-mindquantum">
<h2>Examples of Grover search algorithm using MindQuantum<a class="headerlink" href="#examples-of-grover-search-algorithm-using-mindquantum" title="Permalink to this headline"></a></h2>
<section id="example-1-n3-\omega\rangle2\rangle-single-target">
<h3>Example 1: <span class="math notranslate nohighlight">\(n=3\)</span>, <span class="math notranslate nohighlight">\(|\omega\rangle=|2\rangle\)</span> (single target)<a class="headerlink" href="#example-1-n3-\omega\rangle2\rangle-single-target" title="Permalink to this headline"></a></h3>
<p>First, we need to define the <span class="math notranslate nohighlight">\(G\)</span> operator and run the following code:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">G</span><span class="p">(</span><span class="n">phase_inversion_qubit</span><span class="p">,</span> <span class="n">n_qubits</span><span class="p">):</span>           <span class="c1"># Define the G operator in Grover search algorithm</span>
    <span class="n">operator</span> <span class="o">=</span> <span class="n">bitphaseflip_operator</span><span class="p">(</span><span class="n">phase_inversion_qubit</span><span class="p">,</span> <span class="n">n_qubits</span><span class="p">)</span>
    <span class="n">operator</span> <span class="o">+=</span> <span class="n">UN</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">n_qubits</span><span class="p">)</span>
    <span class="n">operator</span> <span class="o">+=</span> <span class="n">bitphaseflip_operator</span><span class="p">([</span><span class="n">i</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="nb">pow</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="n">n_qubits</span><span class="p">))],</span> <span class="n">n_qubits</span><span class="p">)</span>
    <span class="n">operator</span> <span class="o">+=</span> <span class="n">UN</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">n_qubits</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">operator</span>
</pre></div>
</div>
</div>
<p>Then, we build the corresponding quantum circuit in MindQuantum according to the quantum circuit model of Grover search algorithm:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># pylint: disable=W0104</span>
<span class="kn">from</span> <span class="nn">numpy</span> <span class="kn">import</span> <span class="n">pi</span><span class="p">,</span> <span class="n">sqrt</span>

<span class="n">n_qubits</span> <span class="o">=</span> <span class="mi">3</span>                                      <span class="c1"># Set the number of qubits to 3</span>
<span class="n">phase_inversion_qubit</span> <span class="o">=</span> <span class="p">[</span><span class="mi">2</span><span class="p">]</span>                       <span class="c1"># Set the target state that needs to flip the phase, and flip the phase of the |2&gt; state here</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="n">n_qubits</span><span class="p">)</span>                               <span class="c1"># Calculate the total number of elements in the database</span>
<span class="n">M</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">phase_inversion_qubit</span><span class="p">)</span>                    <span class="c1"># Calculate the total number of target states</span>

<span class="n">r</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">N</span> <span class="o">/</span> <span class="n">M</span><span class="p">))</span>                     <span class="c1"># Set the number of iterations of the G operator to r</span>

<span class="n">sim2</span> <span class="o">=</span> <span class="n">Simulator</span><span class="p">(</span><span class="s1">&#39;mqvector&#39;</span><span class="p">,</span> <span class="n">n_qubits</span><span class="p">)</span>            <span class="c1"># Use the mqvector simulator, named sim2</span>

<span class="n">circuit2</span> <span class="o">=</span> <span class="n">Circuit</span><span class="p">()</span>                              <span class="c1"># Initialize the quantum circuit, named circuit2</span>
<span class="n">circuit2</span> <span class="o">+=</span> <span class="n">UN</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">n_qubits</span><span class="p">)</span>                       <span class="c1"># H-gate operations are performed on each qubit</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">r</span><span class="p">):</span>                                <span class="c1"># Execute the G operator r times in a loop</span>
    <span class="n">circuit2</span> <span class="o">+=</span> <span class="n">G</span><span class="p">(</span><span class="n">phase_inversion_qubit</span><span class="p">,</span> <span class="n">n_qubits</span><span class="p">)</span>

<span class="n">sim2</span><span class="o">.</span><span class="n">apply_circuit</span><span class="p">(</span><span class="n">circuit2</span><span class="p">)</span>                      <span class="c1"># Run the built quantum circuit circuit2 by the simulator sim2</span>

<span class="n">circuit2</span><span class="o">.</span><span class="n">svg</span><span class="p">()</span>                                        <span class="c1"># Print the quantum circuit circuit2 at this time</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="_images/grover_search_algorithm_16_0.svg" src="_images/grover_search_algorithm_16_0.svg" /></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">sim2</span><span class="o">.</span><span class="n">get_qs</span><span class="p">(</span><span class="kc">True</span><span class="p">))</span>                          <span class="c1"># Print the final state after running the quantum circuit circuit2 in the simulator sim2</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
-√2/16¦000⟩
-√2/16¦001⟩
0.9722718241315036¦010⟩
-√2/16¦011⟩
-√2/16¦100⟩
-√2/16¦101⟩
-√2/16¦110⟩
-√2/16¦111⟩
</pre></div></div>
</div>
<p>From the results of the operation, we can see that the amplitude of the <span class="math notranslate nohighlight">\(|010\rangle\)</span> state is 0.9722718241315036, which is a very large amplitude compared to other quantum states, that is to say, if we measure the state at this time, it will be with a great probability get the target state <span class="math notranslate nohighlight">\(|010\rangle\)</span>, run the following code to measure:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># pylint: disable=W0104</span>
<span class="kn">from</span> <span class="nn">mindquantum.core.gates</span> <span class="kn">import</span> <span class="n">Measure</span>

<span class="n">sim2</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>                                      <span class="c1"># Reset the quantum state maintained by the simulator sim2, so that the initialized quantum state is |000&gt;</span>

<span class="n">circuit2</span> <span class="o">+=</span> <span class="n">UN</span><span class="p">(</span><span class="n">Measure</span><span class="p">(),</span> <span class="n">circuit2</span><span class="o">.</span><span class="n">n_qubits</span><span class="p">)</span>      <span class="c1"># Add a measurement gate to each qubit in the quantum circuit circuit2</span>

<span class="n">result</span> <span class="o">=</span> <span class="n">sim2</span><span class="o">.</span><span class="n">sampling</span><span class="p">(</span><span class="n">circuit2</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>      <span class="c1"># Sampling the quantum circuit circuit2 1000 times by the simulator sim2</span>
<span class="n">result</span><span class="o">.</span><span class="n">svg</span><span class="p">()</span>                                      <span class="c1"># print sampling results</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="_images/grover_search_algorithm_19_0.svg" src="_images/grover_search_algorithm_19_0.svg" /></div>
</div>
<p>It can be seen from the running results that 949 of the 1000 samples have the sampling result of 010. Convert it to a decimal number and run the following code:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="s1">&#39;010&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2
</pre></div></div>
</div>
<p>It can be seen from the running results that we successfully search for the <span class="math notranslate nohighlight">\(|2\rangle\)</span> state.</p>
</section>
<section id="example-2-n5-\omega\rangle5\rangle-and-11\rangle-multi-target">
<h3>Example 2: <span class="math notranslate nohighlight">\(n=5\)</span>, <span class="math notranslate nohighlight">\(|\omega\rangle=|5\rangle\)</span> and <span class="math notranslate nohighlight">\(|11\rangle\)</span> (multi-target)<a class="headerlink" href="#example-2-n5-\omega\rangle5\rangle-and-11\rangle-multi-target" title="Permalink to this headline"></a></h3>
<p>In Example 1, single-target search is implemented, and now we try to achieve multi-target search. First, the <span class="math notranslate nohighlight">\(G\)</span> operator has been defined. We only need to set the number of qubits and the target state that needs to flip the phase, and then build the corresponding quantum circuit. Run the following code:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># pylint: disable=W0104</span>
<span class="n">n_qubits</span> <span class="o">=</span> <span class="mi">5</span>                                      <span class="c1"># Set the number of qubits to 5</span>
<span class="n">phase_inversion_qubit</span> <span class="o">=</span> <span class="p">[</span><span class="mi">5</span><span class="p">,</span> <span class="mi">11</span><span class="p">]</span>                   <span class="c1"># Set the target state to be phase-flipped, and flip the phases of the |5&gt; state and |11&gt; state here</span>

<span class="n">N</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">**</span> <span class="p">(</span><span class="n">n_qubits</span><span class="p">)</span>                               <span class="c1"># Calculate the total number of elements in the database</span>
<span class="n">M</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">phase_inversion_qubit</span><span class="p">)</span>                    <span class="c1"># Calculate the total number of target states</span>

<span class="n">r</span> <span class="o">=</span> <span class="nb">int</span><span class="p">(</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">4</span> <span class="o">*</span> <span class="n">sqrt</span><span class="p">(</span><span class="n">N</span> <span class="o">/</span> <span class="n">M</span><span class="p">))</span>                     <span class="c1"># Set the number of iterations of the G operator to r</span>

<span class="n">sim3</span> <span class="o">=</span> <span class="n">Simulator</span><span class="p">(</span><span class="s1">&#39;mqvector&#39;</span><span class="p">,</span> <span class="n">n_qubits</span><span class="p">)</span>            <span class="c1"># Use the mqvector simulator, named sim3</span>

<span class="n">circuit3</span> <span class="o">=</span> <span class="n">Circuit</span><span class="p">()</span>                              <span class="c1"># Initialize the quantum circuit, named circuit3</span>
<span class="n">circuit3</span> <span class="o">+=</span> <span class="n">UN</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">n_qubits</span><span class="p">)</span>                       <span class="c1"># H-gate operations are performed on each qubit</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">r</span><span class="p">):</span>                                <span class="c1"># Execute the G operator r times in a loop</span>
    <span class="n">circuit3</span> <span class="o">+=</span> <span class="n">G</span><span class="p">(</span><span class="n">phase_inversion_qubit</span><span class="p">,</span> <span class="n">n_qubits</span><span class="p">)</span>

<span class="n">sim3</span><span class="o">.</span><span class="n">apply_circuit</span><span class="p">(</span><span class="n">circuit3</span><span class="p">)</span>                      <span class="c1"># Run the built quantum circuit circuit3 by the simulator sim3</span>

<span class="n">circuit3</span><span class="o">.</span><span class="n">svg</span><span class="p">()</span>                                    <span class="c1"># Print the quantum circuit circuit3 at this time</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="_images/grover_search_algorithm_23_0.svg" src="_images/grover_search_algorithm_23_0.svg" /></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">sim3</span><span class="o">.</span><span class="n">get_qs</span><span class="p">(</span><span class="kc">True</span><span class="p">))</span>                          <span class="c1"># Print the final state after running the quantum circuit circuit3 in the simulator sim3</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
-0.035907766232129455¦00000⟩
-0.035907766232129365¦00001⟩
-0.03590776623212947¦00010⟩
-0.035907766232129254¦00011⟩
-0.03590776623212947¦00100⟩
0.6932961018664989¦00101⟩
-0.035907766232129455¦00110⟩
-0.035907766232129365¦00111⟩
-0.035907766232129455¦01000⟩
-0.035907766232129365¦01001⟩
-0.03590776623212947¦01010⟩
0.6932961018664989¦01011⟩
-0.03590776623212947¦01100⟩
-0.035907766232129254¦01101⟩
-0.035907766232129455¦01110⟩
-0.035907766232129365¦01111⟩
-0.0359077662321294¦10000⟩
-0.03590776623212939¦10001⟩
-0.03590776623212936¦10010⟩
-0.03590776623212949¦10011⟩
-0.03590776623212936¦10100⟩
-0.03590776623212949¦10101⟩
-0.0359077662321294¦10110⟩
-0.03590776623212939¦10111⟩
-0.0359077662321294¦11000⟩
-0.03590776623212939¦11001⟩
-0.03590776623212936¦11010⟩
-0.03590776623212949¦11011⟩
-0.03590776623212936¦11100⟩
-0.03590776623212949¦11101⟩
-0.0359077662321294¦11110⟩
-0.03590776623212939¦11111⟩
</pre></div></div>
</div>
<p>It can be seen from the running results that the amplitudes of the <span class="math notranslate nohighlight">\(|00101\rangle\)</span> and <span class="math notranslate nohighlight">\(|01011\rangle\)</span> states are both 0.6932961018664989, which are extremely large amplitudes compared to other quantum states, that is, if we measure the current state, the target states <span class="math notranslate nohighlight">\(|00101\rangle\)</span> and <span class="math notranslate nohighlight">\(|01011\rangle\)</span> states will be obtained with a great probability, run the following code to measure:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># pylint: disable=W0104</span>
<span class="n">sim3</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>                                      <span class="c1"># Reset the quantum state maintained by the simulator sim3 so that the initialized quantum state is |00000&gt;</span>

<span class="n">circuit3</span> <span class="o">+=</span> <span class="n">UN</span><span class="p">(</span><span class="n">Measure</span><span class="p">(),</span> <span class="n">circuit3</span><span class="o">.</span><span class="n">n_qubits</span><span class="p">)</span>      <span class="c1"># Add a measurement gate to each qubit in the quantum circuit circuit3</span>

<span class="n">result1</span> <span class="o">=</span> <span class="n">sim3</span><span class="o">.</span><span class="n">sampling</span><span class="p">(</span><span class="n">circuit3</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="mi">1000</span><span class="p">)</span>     <span class="c1"># The quantum circuit circuit3 is sampled 1000 times by the simulator sim3</span>
<span class="n">result1</span><span class="o">.</span><span class="n">svg</span><span class="p">()</span>                                     <span class="c1"># print sampling results</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="_images/grover_search_algorithm_26_0.svg" src="_images/grover_search_algorithm_26_0.svg" /></div>
</div>
<p>It can be seen from the running results that 516 of the 1000 samplings have the sampling result of 00101 and 450 samplings have the result of 01011. Convert it to a decimal number and run the following code:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="s1">&#39;00101&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">int</span><span class="p">(</span><span class="s1">&#39;01011&#39;</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
5
11
</pre></div></div>
</div>
<p>It can be seen from the running results that we successfully search for the <span class="math notranslate nohighlight">\(|5\rangle\)</span> and <span class="math notranslate nohighlight">\(|11\rangle\)</span> states.</p>
<p>So far, we have introduced the basic principles of Grover search algorithm, and shown how to use MindQuantum to implement the algorithm by two specific small examples! Hurry up and experience the fun of quantum programming!</p>
</section>
</section>
<section id="long-algorithm">
<h2>Long Algorithm<a class="headerlink" href="#long-algorithm" title="Permalink to this headline"></a></h2>
<p>Except for the scenario of finding one data in a database of size 4, the Grover algorithm is not able to search the marked state precisely. Professor Guilu Long of Tsinghua University proposed the quantum exact search algorithm - Long algorithm [3] on the base of Grover’s algorithm, which is able to search the target state in all scenarios with the accuracy of 1. The main idea is to rewrite the Grover operator as the follows,</p>
<div class="math notranslate nohighlight">
\[L = -H^{\otimes n} R_0 H^{\otimes n} R_\tau,\]</div>
<p>where <span class="math notranslate nohighlight">\(R_0 = (I+(e^{i\theta}-1)\left|0\right&gt;\left&lt;0\right|)\)</span>, <span class="math notranslate nohighlight">\(R_\tau = (I+(e^{i\theta}-1)\left|\tau\right&gt;\left&lt;\tau\right|)\)</span>. When the phase matching condition is satisfied,</p>
<div class="math notranslate nohighlight">
\[\theta = 2\arcsin\left(\sin\beta\sin\left(\frac{\pi}{4J_s+6}\right)\right)\]</div>
<p>To find the target state with probability 1, we only need to perform the Long operator <span class="math notranslate nohighlight">\(J_s+1\)</span> times. Here <span class="math notranslate nohighlight">\(\beta=\arcsin{\sqrt{M/N}}\)</span>, <span class="math notranslate nohighlight">\(M\)</span> is the number of labeled states, <span class="math notranslate nohighlight">\(N\)</span> is the database size, and <span class="math notranslate nohighlight">\(J_s&gt;=[((\pi/2)-\beta)/\beta]\)</span>. In the following, we use MindQuantum to implement it.</p>
<section id="quntum-circuit-for-general-angle-phase-rotation">
<h3>Quntum circuit for general angle phase rotation<a class="headerlink" href="#quntum-circuit-for-general-angle-phase-rotation" title="Permalink to this headline"></a></h3>
<p>With the aid of auxiliary bits, we build a quantum circuit for general angle phase rotation on a certain basis vector.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mindquantum.core.gates</span> <span class="kn">import</span> <span class="n">X</span><span class="p">,</span> <span class="n">PhaseShift</span>
<span class="kn">from</span> <span class="nn">mindquantum.core.circuit</span> <span class="kn">import</span> <span class="n">Circuit</span>
<span class="k">def</span> <span class="nf">change_phase_with_anclia</span><span class="p">(</span><span class="n">which</span><span class="p">,</span> <span class="n">n_qubits</span><span class="p">,</span> <span class="n">phase</span><span class="p">):</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">Circuit</span><span class="p">()</span>
    <span class="n">which_bit</span> <span class="o">=</span> <span class="nb">bin</span><span class="p">(</span><span class="n">which</span><span class="p">)[</span><span class="mi">2</span><span class="p">:]</span><span class="o">.</span><span class="n">zfill</span><span class="p">(</span><span class="n">n_qubits</span><span class="p">)[::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">polarity_circ</span> <span class="o">=</span> <span class="n">Circuit</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">idx</span><span class="p">,</span> <span class="n">bit</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">which_bit</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">bit</span> <span class="o">==</span> <span class="s2">&quot;0&quot;</span><span class="p">:</span>
            <span class="n">polarity_circ</span> <span class="o">+=</span> <span class="n">X</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="n">idx</span><span class="p">)</span>
    <span class="n">c</span> <span class="o">+=</span> <span class="n">polarity_circ</span>
    <span class="n">c</span> <span class="o">+=</span> <span class="n">PhaseShift</span><span class="p">(</span><span class="n">phase</span><span class="p">)</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="n">n_qubits</span><span class="p">,</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="n">n_qubits</span><span class="p">)))</span>
    <span class="n">c</span> <span class="o">+=</span> <span class="n">polarity_circ</span>
    <span class="k">return</span> <span class="n">c</span>
</pre></div>
</div>
</div>
</section>
<section id="constructing-the-long-operator">
<h3>Constructing the Long operator<a class="headerlink" href="#constructing-the-long-operator" title="Permalink to this headline"></a></h3>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mindquantum.core.gates</span> <span class="kn">import</span> <span class="n">BARRIER</span><span class="p">,</span> <span class="n">Z</span>

<span class="k">def</span> <span class="nf">L</span><span class="p">(</span><span class="n">which</span><span class="p">,</span> <span class="n">n_qubits</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">):</span>
    <span class="n">U</span> <span class="o">=</span> <span class="n">UN</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">n_qubits</span><span class="p">)</span>
    <span class="n">R0</span> <span class="o">=</span> <span class="n">change_phase_with_anclia</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">n_qubits</span><span class="p">,</span> <span class="n">theta</span><span class="p">)</span>
    <span class="n">R_t</span> <span class="o">=</span> <span class="n">change_phase_with_anclia</span><span class="p">(</span><span class="n">which</span><span class="p">,</span> <span class="n">n_qubits</span><span class="p">,</span> <span class="n">phi</span><span class="p">)</span>
    <span class="n">g_ops</span> <span class="o">=</span> <span class="n">R_t</span> <span class="o">+</span> <span class="n">BARRIER</span> <span class="o">+</span> <span class="n">U</span> <span class="o">+</span> <span class="n">BARRIER</span> <span class="o">+</span> <span class="n">R0</span> <span class="o">+</span> <span class="n">BARRIER</span> <span class="o">+</span> <span class="n">U</span> <span class="o">+</span> <span class="n">BARRIER</span>
    <span class="n">g_ops</span> <span class="o">+=</span> <span class="n">Z</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="n">n_qubits</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">g_ops</span>
</pre></div>
</div>
</div>
</section>
</section>
<section id="performing-the-quantum-exact-search-algorithm-long-algorithm">
<h2>Performing the quantum exact search algorithm: Long algorithm<a class="headerlink" href="#performing-the-quantum-exact-search-algorithm-long-algorithm" title="Permalink to this headline"></a></h2>
<p>Here we take the example of searching <span class="math notranslate nohighlight">\(\left|2\right&gt;\)</span> state in the 3-bit database to perform the Long algorithm.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">mindquantum.core.gates</span> <span class="kn">import</span> <span class="n">H</span>
<span class="kn">from</span> <span class="nn">mindquantum.core.circuit</span> <span class="kn">import</span> <span class="n">UN</span>
<span class="n">n_qubits</span> <span class="o">=</span> <span class="mi">3</span>
<span class="n">will_find</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">beta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="mi">1</span> <span class="o">/</span> <span class="mi">2</span><span class="o">**</span><span class="n">n_qubits</span><span class="p">))</span>
<span class="n">Js</span> <span class="o">=</span> <span class="nb">int</span><span class="p">((</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">-</span> <span class="n">beta</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">beta</span><span class="p">)</span>
<span class="n">theta</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="p">(</span><span class="mi">4</span> <span class="o">*</span> <span class="n">Js</span> <span class="o">+</span> <span class="mi">6</span><span class="p">))</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">beta</span><span class="p">))</span>
<span class="n">phi</span> <span class="o">=</span> <span class="n">theta</span>

<span class="n">g</span> <span class="o">=</span> <span class="n">L</span><span class="p">(</span><span class="n">will_find</span><span class="p">,</span> <span class="n">n_qubits</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">phi</span><span class="p">)</span>            <span class="c1"># Constructing the Long operator for exact search</span>

<span class="n">circ</span> <span class="o">=</span> <span class="n">UN</span><span class="p">(</span><span class="n">H</span><span class="p">,</span> <span class="n">n_qubits</span><span class="p">)</span> <span class="o">+</span> <span class="n">X</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="n">n_qubits</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">Js</span> <span class="o">+</span> <span class="mi">1</span><span class="p">):</span>
    <span class="n">circ</span> <span class="o">+=</span> <span class="n">g</span>
<span class="n">circ</span><span class="o">.</span><span class="n">svg</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="_images/grover_search_algorithm_34_0.svg" src="_images/grover_search_algorithm_34_0.svg" /></div>
</div>
<p>Next, we calculate the quantum state of the circuit.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">circ</span><span class="o">.</span><span class="n">get_qs</span><span class="p">(</span><span class="n">ket</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(0.048708136684586345-0.9988130542902997j)¦1010⟩
</pre></div></div>
</div>
<p>It is found that by removing the phase, we can get the target state exactly. By sampling, we can also obtain similar results as follows.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mindquantum.simulator</span> <span class="kn">import</span> <span class="n">Simulator</span>
<span class="kn">from</span> <span class="nn">mindquantum.core</span> <span class="kn">import</span> <span class="n">Measure</span>

<span class="n">sim</span> <span class="o">=</span> <span class="n">Simulator</span><span class="p">(</span><span class="s1">&#39;mqvector&#39;</span><span class="p">,</span> <span class="n">circ</span><span class="o">.</span><span class="n">n_qubits</span><span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">sampling</span><span class="p">(</span><span class="n">circ</span> <span class="o">+</span> <span class="n">UN</span><span class="p">(</span><span class="n">Measure</span><span class="p">(),</span> <span class="n">circ</span><span class="o">.</span><span class="n">n_qubits</span><span class="p">),</span> <span class="n">shots</span><span class="o">=</span><span class="mi">100</span><span class="p">)</span>
<span class="n">res</span><span class="o">.</span><span class="n">svg</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="_images/grover_search_algorithm_38_0.svg" src="_images/grover_search_algorithm_38_0.svg" /></div>
</div>
<p>To find out more about MindQuantum’s API, please click: <a class="reference external" href="https://mindspore.cn/mindquantum/">https://mindspore.cn/mindquantum/</a>.</p>
<section id="references-">
<h3><strong>References:</strong><a class="headerlink" href="#references-" title="Permalink to this headline"></a></h3>
<p>[1] L. K. Grover, A fast quantum mechanical algorithm for database search[C]// Proceedings of the twenty-eighth annual ACM symposium on Theory of computing. ACM, 1996: 212-219.</p>
<p>[2] G. Brassard, P. Hoyer, M. Mosca, et al. Quantum amplitude amplification and estimation[J]. Contemporary Mathematics, 2002, 305: 53-74.</p>
<p>[3] Long G L. Grover algorithm with zero theoretical failure rate. Physical Rev A, 2001, 64: 022307.</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="quantum_phase_estimation.html" class="btn btn-neutral float-left" title="Quantum Phase Estimation Algorithm" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="shor_algorithm.html" class="btn btn-neutral float-right" title="Shor’s algorithm based on MindQuantum" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright MindSpore.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 
</body>
</html>