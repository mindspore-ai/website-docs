<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>HHL Algorithm &mdash; MindSpore master documentation</title><script>;(()=>{const e=localStorage.getItem("ms-theme"),t=window.matchMedia("(prefers-color-scheme: dark)").matches;(e?"dark"===e:t)&&document.documentElement.setAttribute("data-o-theme","dark")})();</script><link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script><script src="../_static/jquery.js"></script>
        <script src="../_static/js/theme.js"></script><script src="../_static/underscore.js"></script><script src="../_static/doctools.js"></script><script crossorigin="anonymous" integrity="sha256-1fEPhSsRKlFKGfK3eO710tEweHh1fwokU5wFGDHO+vg=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js"></script><script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script><script async="async" src="https://mindspore-website.obs.cn-north-4.myhuaweicloud.com/mathjax/MathJax-3.2.2/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Quantum Phase Estimation Algorithm" href="quantum_phase_estimation.html" />
    <link rel="prev" title="Shor’s Algorithm Based on MindSpore Quantum" href="shor_algorithm.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> MindSpore
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Beginner Tutorial</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../beginner/beginner.html">Beginner Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../beginner/parameterized_quantum_circuit.html">Variational Quantum Circuit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../beginner/quantum_simulator.html">Quantum Simulator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../beginner/quantum_measurement.html">Quantum Measurement</a></li>
<li class="toctree-l1"><a class="reference internal" href="../beginner/advanced_operations_of_quantum_circuit.html">Advanced Operations of Quantum Circuit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../beginner/bloch_sphere.html">Bloch Sphere</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Middle Level Tutorial</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../middle_level/middle_level.html">Middle Level Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../middle_level/noise.html">Noisy Quantum Circuit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../middle_level/noise_simulator.html">Noise Simulator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../middle_level/qubit_mapping.html">Qubit Mapping</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Advanced Tutorial</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../advanced/advanced.html">Advanced Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/get_gradient_of_PQC_with_mindquantum.html">Advanced Gradient Calculation of Variational Quantum Circuits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/initial_experience_of_quantum_neural_network.html">Initial Experience of Quantum Neural Network</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/equivalence_checking_of_PQC.html">Equivalence Checking of Parameterized Quantum Circuits</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Case Library</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="case_library.html">Case Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="grover_search_algorithm.html">Grover Search and Long Algorithms Based on MindSpore Quantum</a></li>
<li class="toctree-l1"><a class="reference internal" href="shor_algorithm.html">Shor’s Algorithm Based on MindSpore Quantum</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">HHL Algorithm</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#steps-of-the-hhl-algorithm">Steps of the HHL Algorithm</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#data-preprocessing">Data Preprocessing</a></li>
<li class="toctree-l3"><a class="reference internal" href="#preparation-of-operator-u-e^i-a-\delta-t">Preparation of Operator <span class="math notranslate nohighlight">\(U = e^{i A \Delta t}\)</span></a></li>
<li class="toctree-l3"><a class="reference internal" href="#conditional-rotation">Conditional Rotation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#measurement">Measurement</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#implementation-with-mindquantum">Implementation with MindQuantum</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="quantum_phase_estimation.html">Quantum Phase Estimation Algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="quantum_approximate_optimization_algorithm.html">Quantum Approximate Optimization Algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="classification_of_iris_by_qnn.html">Classification of IRIS by Quantum Neural Network</a></li>
<li class="toctree-l1"><a class="reference internal" href="vqe_for_quantum_chemistry.html">VQE Application in Quantum Chemistry Computing</a></li>
<li class="toctree-l1"><a class="reference internal" href="qnn_for_nlp.html">The Application of Quantum Neural Network in NLP</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../overview.html">overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mindquantum.dtype.html">mindquantum.dtype</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mindquantum.core.html">mindquantum.core</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mindquantum.simulator.html">mindquantum.simulator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mindquantum.framework.html">mindquantum.framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mindquantum.algorithm.html">mindquantum.algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mindquantum.device.html">mindquantum.device</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mindquantum.io.html">mindquantum.io</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mindquantum.engine.html">mindquantum.engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mindquantum.utils.html">mindquantum.utils</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Paper with Code</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../paper_with_code.html">Paper with Code</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">RELEASE NOTES</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../RELEASE.html">Release Notes</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Installation Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../mindquantum_install.html">MindSpore Quantum Installation</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MindSpore</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>HHL Algorithm</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/case_library/hhl_algorithm.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars and line breaks on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
    white-space: pre;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
.jp-RenderedHTMLCommon table,
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
.jp-RenderedHTMLCommon thead,
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
.jp-RenderedHTMLCommon tr,
.jp-RenderedHTMLCommon th,
.jp-RenderedHTMLCommon td,
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
.jp-RenderedHTMLCommon th,
div.rendered_html th {
  font-weight: bold;
}
.jp-RenderedHTMLCommon tbody tr:nth-child(odd),
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.jp-RenderedHTMLCommon tbody tr:hover,
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="hhl-algorithm">
<h1>HHL Algorithm<a class="headerlink" href="#hhl-algorithm" title="Permalink to this headline"></a></h1>
<p><a class="reference external" href="https://mindspore-website.obs.cn-north-4.myhuaweicloud.com/notebook/r2.2/mindquantum/en/case_library/mindspore_hhl_algorithm.ipynb"><img alt="Download Notebook" src="https://mindspore-website.obs.cn-north-4.myhuaweicloud.com/website-images/r2.2/resource/_static/logo_notebook_en.svg" /></a>  <a class="reference external" href="https://mindspore-website.obs.cn-north-4.myhuaweicloud.com/notebook/r2.2/mindquantum/en/case_library/mindspore_hhl_algorithm.py"><img alt="Download Code" src="https://mindspore-website.obs.cn-north-4.myhuaweicloud.com/website-images/r2.2/resource/_static/logo_download_code_en.svg" /></a>  <a class="reference external" href="https://gitee.com/mindspore/docs/blob/r2.2/docs/mindquantum/docs/source_en/case_library/hhl_algorithm.ipynb"><img alt="View source on Gitee" src="https://mindspore-website.obs.cn-north-4.myhuaweicloud.com/website-images/r2.2/resource/_static/logo_source_en.svg" /></a>  <a class="reference external" href="https://authoring-modelarts-cnnorth4.huaweicloud.com/console/lab?share-url-b64=aHR0cHM6Ly9taW5kc3BvcmUtd2Vic2l0ZS5vYnMuY24tbm9ydGgtNC5teWh1YXdlaWNsb3VkLmNvbS9ub3RlYm9vay9yMi4yL21pbmRxdWFudHVtL3poX2NuL2Nhc2VfbGlicmFyeS9taW5kc3BvcmVfaGhsX2FsZ29yaXRobS5pcHluYg%3D%3D&amp;imageid=73522c7f-6d98-43d8-b306-8ff374c7d3a7"><img alt="Run in ModelArts" src="https://mindspore-website.obs.cn-north-4.myhuaweicloud.com/website-images/r2.2/resource/_static/logo_modelarts_en.svg" /></a></p>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline"></a></h2>
<p><strong>Objective of the HHL algorithm:</strong> Given a Hermitian matrix <span class="math notranslate nohighlight">\(A\)</span> and a unit vector <span class="math notranslate nohighlight">\(\vec{b}\)</span>, the goal is to solve the equation <span class="math notranslate nohighlight">\(A \vec{x} = \vec{b}\)</span>.</p>
<p>Let <span class="math notranslate nohighlight">\(\left| b \right\rangle = \sum_{j=1}^{N} b_{j} \left| j \right\rangle\)</span>, where <span class="math notranslate nohighlight">\(\left| j \right\rangle\)</span> represents the basis states. The key of the algorithm lies in simulating <span class="math notranslate nohighlight">\(e^{i A \Delta t}\)</span> on <span class="math notranslate nohighlight">\(\left| b \right\rangle\)</span>.</p>
<p>Assume the spectral decomposition of <span class="math notranslate nohighlight">\(A\)</span> is as follows:</p>
<div class="math notranslate nohighlight">
\[A = \sum_{j=1}^{N} \lambda_{j} \left| u_{j} \right\rangle \left\langle u_{j} \right|\]</div>
<p>Then,</p>
<div class="math notranslate nohighlight">
\[e^{i A \Delta t} = \sum_{j=1}^{N} e^{i \lambda_{j} \Delta t} \left| u_{j} \right\rangle \left\langle u_{j} \right|\]</div>
<p>Express <span class="math notranslate nohighlight">\(\left| b \right\rangle\)</span> in terms of the basis <span class="math notranslate nohighlight">\(\left\lbrace \left| u_{j} \right\rangle \right\rbrace\)</span>: <span class="math notranslate nohighlight">\(\left| b \right\rangle = \sum_{j=1}^{N} \beta_{j} \left| u_{j} \right\rangle\)</span>.</p>
<p>Using Quantum Phase Estimation (QPE), where <span class="math notranslate nohighlight">\(U = e^{i A \Delta t}\)</span>, the resulting transformation is as follows:</p>
<div class="math notranslate nohighlight">
\[\left| b \right\rangle \xrightarrow{\text{QPE}} \sum_{j=1}^{N} \beta_{j} \left| u_{j} \right\rangle | \widetilde{\lambda_j} \rangle\]</div>
<p>Here, <span class="math notranslate nohighlight">\(| \widetilde{\lambda_j} \rangle\)</span> is the estimation of the eigenvalue <span class="math notranslate nohighlight">\(\lambda_{j}\)</span> (the tilde represents an estimation, the same applies in the following).</p>
<p>It is easy to see that the solution to the equation is:</p>
<div class="math notranslate nohighlight">
\[\left| x \right\rangle = A^{-1} \left| b \right\rangle = \sum_{j} \beta_{j} (\lambda_{j})^{-1} \left| u_{j} \right\rangle\]</div>
<p>Therefore, we only need to extract the information from the quantum state <span class="math notranslate nohighlight">\(| \widetilde{\lambda_j} \rangle\)</span>.</p>
</section>
<section id="steps-of-the-hhl-algorithm">
<h2>Steps of the HHL Algorithm<a class="headerlink" href="#steps-of-the-hhl-algorithm" title="Permalink to this headline"></a></h2>
<p>Below, we provide a detailed explanation of the steps involved in the HHL algorithm, including the mathematical derivations.</p>
<section id="data-preprocessing">
<h3>Data Preprocessing<a class="headerlink" href="#data-preprocessing" title="Permalink to this headline"></a></h3>
<p>As mentioned earlier, <span class="math notranslate nohighlight">\(A\)</span> needs to be Hermitian, i.e., <span class="math notranslate nohighlight">\(A^\dagger = A\)</span>. However, this condition can be relaxed. If <span class="math notranslate nohighlight">\(A\)</span> is not Hermitian, we can construct <span class="math notranslate nohighlight">\(\tilde{A}\)</span> as follows:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\tilde{A} = \begin{pmatrix}
0 &amp; A \\
A^{\dagger } &amp; 0 \\
\end{pmatrix}\end{split}\]</div>
<p>Then, we solve the equation:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\tilde{A} \vec{y} = \begin{pmatrix}
\vec{b} \\
0 \\
\end{pmatrix}\end{split}\]</div>
<p>It can be easily verified that the solution to this equation, <span class="math notranslate nohighlight">\(\vec{y}\)</span>, has the following form:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\vec{y} = \begin{pmatrix}
0 \\
\vec{x} \\
\end{pmatrix}\end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(A \vec{x} = \vec{b}\)</span>.</p>
<p>For <span class="math notranslate nohighlight">\(\vec{b}\)</span>, since HHL is a quantum algorithm, the input should be a quantum state <span class="math notranslate nohighlight">\(|b\rangle = \sum_{j=1}^N b_j |j\rangle\)</span>. The details of how to prepare such a quantum state and encode classical information into quantum information are beyond the scope of this algorithm. Here, we assume that the quantum state has been prepared accordingly.</p>
</section>
<section id="preparation-of-operator-u-e^i-a-\delta-t">
<h3>Preparation of Operator <span class="math notranslate nohighlight">\(U = e^{i A \Delta t}\)</span><a class="headerlink" href="#preparation-of-operator-u-e^i-a-\delta-t" title="Permalink to this headline"></a></h3>
<p>The efficient preparation of the operator <span class="math notranslate nohighlight">\(U = e^{i A \Delta t}\)</span> is a core problem. As we will see later, the complexity of the entire HHL algorithm mainly depends on the operator <span class="math notranslate nohighlight">\(U\)</span>, so it is necessary to efficiently simulate <span class="math notranslate nohighlight">\(U\)</span>.</p>
<p>The preparation of this time evolution operator <span class="math notranslate nohighlight">\(U = e^{i A \Delta t}\)</span> belongs to the problem of quantum system simulation (Hamiltonian simulation), which is an important quantum problem that will not be discussed in detail here.</p>
<p>In the original paper, a <strong>sparsity</strong> constraint was imposed on the matrix <span class="math notranslate nohighlight">\(A\)</span> in order to efficiently simulate <span class="math notranslate nohighlight">\(e^{i A \Delta t}\)</span>. For general dense matrices <span class="math notranslate nohighlight">\(A\)</span>, simulating their evolution can be computationally expensive.</p>
<p>Here, we won’t go into the proof of the correctness of QPE. Readers only need to know that the input of QPE is a unitary operator <span class="math notranslate nohighlight">\(U\)</span> and its eigenvector <span class="math notranslate nohighlight">\(|u\rangle\)</span>, and the output is an estimate <span class="math notranslate nohighlight">\(\tilde{\varphi}\)</span> of the phase <span class="math notranslate nohighlight">\(\varphi\)</span> such that <span class="math notranslate nohighlight">\(U |u\rangle = e^{2 \pi i \varphi} |u\rangle\)</span>.</p>
<p>Specifically, using <span class="math notranslate nohighlight">\(t\)</span> auxiliary qubits, the action of QPE is as follows:</p>
<div class="math notranslate nohighlight">
\[\left| b \right\rangle \left| 0 \right\rangle^{\otimes t} \left| 0 \right\rangle = \sum_{j=1}^{N} \beta_{j} \left| u_{j} \right\rangle \left| 0 \right\rangle^{\otimes t} \left| 0 \right\rangle
\xrightarrow{\text{QPE}} \sum_{j=1}^{N} \beta_{j} \left| u_{j} \right\rangle \left| \widetilde{\varphi_j} \right\rangle \left| 0 \right\rangle\]</div>
<p>Here, <span class="math notranslate nohighlight">\(\left| \widetilde{\varphi_j} \right\rangle\)</span> is the estimate of the phase <span class="math notranslate nohighlight">\(\varphi_{j}\)</span>. An additional auxiliary qubit is added after the <span class="math notranslate nohighlight">\(t\)</span> auxiliary qubits for the subsequent rotation step.</p>
<p>To better understand, let’s take an example: Take</p>
<div class="math notranslate nohighlight">
\[A = Z = \left| 0 \right\rangle \left\langle 0 \right| - \left| 1 \right\rangle \left\langle 1 \right|\]</div>
<p>Then</p>
<div class="math notranslate nohighlight">
\[U = e^{i A \Delta t } = e^{i \Delta t} \left| 0 \right\rangle \left\langle 0 \right| + e^{-i \Delta t} \left| 1 \right\rangle \left\langle 1 \right|\]</div>
<p>The two phases are <span class="math notranslate nohighlight">\(\varphi_{1} = \Delta t / 2 \pi\)</span> and <span class="math notranslate nohighlight">\(\varphi_{2} = -\Delta t / 2 \pi\)</span>.</p>
<p>If we use <span class="math notranslate nohighlight">\(t = 4\)</span> auxiliary qubits and take <span class="math notranslate nohighlight">\(\Delta t = \pi / 4\)</span>, then <span class="math notranslate nohighlight">\(\varphi_{1} = 1 / 8\)</span> and <span class="math notranslate nohighlight">\(\varphi_{2} = - 1 / 8\)</span>.</p>
<p>The estimated values of the two phases are <span class="math notranslate nohighlight">\(\widetilde{\varphi_1} = 0.0010 \times 2^4 = 2\)</span> and <span class="math notranslate nohighlight">\(\widetilde{\varphi_2} = 0.1110 \times 2^4 = 14\)</span>. Since the phase is a decimal between <span class="math notranslate nohighlight">\([0, 1)\)</span>, multiplying it by <span class="math notranslate nohighlight">\(2^t\)</span> gives its corresponding quantum state <span class="math notranslate nohighlight">\(|q_{t_1} \ldots q_{t_t} \rangle\)</span>. It should be noted that because the phase is a decimal modulo <span class="math notranslate nohighlight">\(1\)</span>, <span class="math notranslate nohighlight">\(-0.0010\)</span> is mapped to <span class="math notranslate nohighlight">\(0.1110\)</span>. To restore the phase (to restore <span class="math notranslate nohighlight">\(\lambda\)</span>), we first
select a small enough <span class="math notranslate nohighlight">\(\Delta t\)</span> such that <span class="math notranslate nohighlight">\(|\varphi| &lt; 1 / 2\)</span>. This way, if <span class="math notranslate nohighlight">\(|q_{t_1} \ldots q_{t_t}\rangle &lt; 2^{t-1}\)</span> corresponds to a positive number, <span class="math notranslate nohighlight">\(|q_{t_1}\ldots q_{t_t}\rangle &gt; 2^{t-1}\)</span> corresponds to a negative number.</p>
<p>Through simple quantitative calculations, we obtain the following mapping relationship:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\frac{\lambda \Delta t}{2 \pi} =   \varphi = \begin{cases}
\tilde{\varphi} / 2^{t} &amp;  , \varphi &gt; 0 &amp; , \tilde{\varphi} &lt; 2^{t-1} \\
\tilde{\varphi} / 2^{t} - 1 &amp; , \varphi &lt; 0 &amp; , \tilde{\varphi} &gt; 2^{t-1}\\
\end{cases}\end{split}\]</div>
<p>Here, <span class="math notranslate nohighlight">\(\lambda\)</span> is the eigenvalue of <span class="math notranslate nohighlight">\(A\)</span>, <span class="math notranslate nohighlight">\(\varphi\)</span> is the phase of <span class="math notranslate nohighlight">\(U = e^{i A \Delta t}\)</span>, and <span class="math notranslate nohighlight">\(\tilde{\varphi}\)</span> is the estimate of <span class="math notranslate nohighlight">\(\varphi\)</span>.</p>
</section>
<section id="conditional-rotation">
<h3>Conditional Rotation<a class="headerlink" href="#conditional-rotation" title="Permalink to this headline"></a></h3>
<p>After QPE, the overall quantum state is as follows:</p>
<div class="math notranslate nohighlight">
\[\sum_{j=1}^{N} \beta_{j} \left| u_{j} \right\rangle \left| \widetilde{\varphi_j} \right\rangle \left| 0 \right\rangle\]</div>
<p>To extract the information of <span class="math notranslate nohighlight">\(\lambda_j\)</span> from the quantum state <span class="math notranslate nohighlight">\(\left| \widetilde{\varphi_j} \right\rangle\)</span>, we need to use conditional rotation gates <span class="math notranslate nohighlight">\(CR(k)\)</span>, which have the following effect:</p>
<div class="math notranslate nohighlight">
\[\begin{split}CR(k) \left| \tilde{\varphi} \right\rangle \left| b \right\rangle = \begin{cases}
\left| \tilde{\varphi} \right\rangle \left| b \right\rangle &amp; ,  k \neq \tilde{\varphi}  \\
\left| \tilde{\varphi} \right\rangle R_y \left( 2 \arcsin \frac{C}{\lambda} \right) \left| b \right\rangle &amp; , k = \tilde{\varphi} \\
\end{cases}\end{split}\]</div>
<p>In simple terms, the rotation operation is only applied to the subsequent qubits when <span class="math notranslate nohighlight">\(k\)</span> selects the correct <span class="math notranslate nohighlight">\(\tilde{\varphi}\)</span>.</p>
<p>Since we don’t know the correct <span class="math notranslate nohighlight">\(\tilde{\varphi}\)</span>, we brute force all possible <span class="math notranslate nohighlight">\(CR(k)\)</span>, where <span class="math notranslate nohighlight">\(k = 1, \ldots , 2^{t}-1\)</span>.</p>
<p>The effect of the rotation is straightforward:</p>
<div class="math notranslate nohighlight">
\[\prod_{k=1}^{2^{t} - 1} I\otimes CR(k) \sum_{j=1}^{N} \beta_{j} \left| u_{j} \right\rangle \left| \widetilde{\varphi_j} \right\rangle \left| 0 \right\rangle
= \sum_{j=1}^{N} \beta_{j} \left| u_{j} \right\rangle \left| \widetilde{\varphi_j} \right\rangle \left( \sqrt{1 - \left( \frac{C}{\lambda_{j}} \right)^{2}} \left| 0 \right\rangle + \frac{C}{\lambda_{j}} \left| 1 \right\rangle \right)\]</div>
<p>After applying inverse QPE once again, the overall quantum state is as follows:</p>
<div class="math notranslate nohighlight">
\[\left| \psi \right\rangle = \sum_{j=1}^{N} \beta_{j} \left| u_{j} \right\rangle \left| 0 \right\rangle^{\otimes t} \left( \sqrt{1 - \left( \frac{C}{\lambda_{j}} \right)^{2}} \left| 0 \right\rangle + \frac{C}{\lambda_{j}} \left| 1 \right\rangle \right)\]</div>
</section>
<section id="measurement">
<h3>Measurement<a class="headerlink" href="#measurement" title="Permalink to this headline"></a></h3>
<p>Measure the last qubit. When the measurement result is <span class="math notranslate nohighlight">\(\left| 1 \right\rangle\)</span>, the probability is</p>
<div class="math notranslate nohighlight">
\[p_1 = C^{2} \sum_{j=1}^{N} ( \beta_{j} / \lambda_{j} )^{2}\]</div>
<p>After the measurement, the quantum state becomes</p>
<div class="math notranslate nohighlight">
\[\left| \psi_{1} \right\rangle = \frac{1}{\left( \sum_{j=1}^{N} \left( \beta_{j} / \lambda_{j} \right)^{2} \right)^{-1}} \sum_{j=1}^{N} \frac{\beta_{j}}{\lambda_{j}} \left| u_{j} \right\rangle \left| 0 \right\rangle^{\otimes t} \left| 1 \right\rangle\]</div>
<p>Clearly, there is no entanglement between the three quantum registers at this point. If we only look at the first quantum register, it is already in the state <span class="math notranslate nohighlight">\(|x\rangle\)</span> (ignoring a normalization factor).</p>
<p>It should be noted that there is a parameter <span class="math notranslate nohighlight">\(C\)</span> in the rotation operation. We see that <span class="math notranslate nohighlight">\(C\)</span> does not affect the correctness of the final result, but it does affect the probability <span class="math notranslate nohighlight">\(p_1\)</span> of obtaining the result. We certainly hope that <span class="math notranslate nohighlight">\(C\)</span> can be as large as possible, so that <span class="math notranslate nohighlight">\(p_1\)</span> can be maximized. However, <span class="math notranslate nohighlight">\(C \leq \left\vert \lambda_{j} \right\vert\)</span>, it is smaller than the absolute value of all eigenvalues. If there is no prior information about the smallest
absolute value of <span class="math notranslate nohighlight">\(\lambda\)</span>, we can only conservatively choose a very small <span class="math notranslate nohighlight">\(C\)</span> and then use amplitude amplification techniques to increase the probability of obtaining the result.</p>
</section>
</section>
<section id="implementation-with-mindquantum">
<h2>Implementation with MindQuantum<a class="headerlink" href="#implementation-with-mindquantum" title="Permalink to this headline"></a></h2>
<p>Here, we use MindQuantum to implement a simple example to illustrate the process and correctness of the HHL algorithm.</p>
<p>For convenience, we choose a simple matrix <span class="math notranslate nohighlight">\(A = Z = \begin{bmatrix} 1 &amp; 0 \\ 0 &amp; -1 \end{bmatrix}\)</span>, because its time evolution operator <span class="math notranslate nohighlight">\(e^{i Z \Delta t} = R_z(- 2 \Delta t)\)</span> is relatively easy to implement.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">A</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]])</span>
<span class="n">es</span><span class="p">,</span> <span class="n">vs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">eig</span><span class="p">(</span><span class="n">A</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;eigenvalues of A:</span><span class="se">\n</span><span class="s2"> </span><span class="si">{</span><span class="n">es</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;eigenvectors of A:</span><span class="se">\n</span><span class="s2"> </span><span class="si">{</span><span class="n">vs</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;b: </span><span class="si">{</span><span class="n">b</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Solution of Ax=b is: </span><span class="si">{</span><span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">solve</span><span class="p">(</span><span class="n">A</span><span class="p">,</span><span class="w"> </span><span class="n">b</span><span class="p">)</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
eigenvalues of A:
 [ 1. -1.]
eigenvectors of A:
 [[1. 0.]
 [0. 1.]]
b: [0.6 0.8]
Solution of Ax=b is: [ 0.6 -0.8]
</pre></div></div>
</div>
<p>Here, we import various required functions:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mindquantum.core.gates</span> <span class="kn">import</span> <span class="n">H</span><span class="p">,</span> <span class="n">X</span><span class="p">,</span> <span class="n">RY</span><span class="p">,</span> <span class="n">RZ</span><span class="p">,</span> <span class="n">Measure</span><span class="p">,</span> <span class="n">Power</span><span class="p">,</span> <span class="n">BARRIER</span>
<span class="kn">from</span> <span class="nn">mindquantum.core.circuit</span> <span class="kn">import</span> <span class="n">Circuit</span>
<span class="kn">from</span> <span class="nn">mindquantum.simulator</span> <span class="kn">import</span> <span class="n">Simulator</span>
</pre></div>
</div>
</div>
<p>For the preparation of the quantum state <span class="math notranslate nohighlight">\(|b\rangle = \cos\theta |0\rangle + \sin\theta |1\rangle\)</span>, it can be achieved using an <span class="math notranslate nohighlight">\(R_y(2 \theta)\)</span> gate.</p>
<p>The following code prepares the state <span class="math notranslate nohighlight">\(|b\rangle = 0.6 |0\rangle + 0.8 |1\rangle\)</span> and performs a measurement.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">circ</span> <span class="o">=</span> <span class="n">Circuit</span><span class="p">()</span>
<span class="n">circ</span> <span class="o">+=</span> <span class="n">RY</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span><span class="mf">0.8</span><span class="p">))</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">circ</span> <span class="o">+=</span> <span class="n">Measure</span><span class="p">()</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>

<span class="n">sim</span> <span class="o">=</span> <span class="n">Simulator</span><span class="p">(</span><span class="n">backend</span><span class="o">=</span><span class="s2">&quot;mqvector&quot;</span><span class="p">,</span> <span class="n">n_qubits</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">sampling</span><span class="p">(</span><span class="n">circ</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span>
<span class="n">res</span><span class="o">.</span><span class="n">svg</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/case_library_hhl_algorithm_9_0.svg" src="../_images/case_library_hhl_algorithm_9_0.svg" /></div>
</div>
<p>The following is the step-by-step construction of the complete quantum circuit, with <span class="math notranslate nohighlight">\(t = 4\)</span>, <span class="math notranslate nohighlight">\(\Delta t = \pi / 4\)</span>, and <span class="math notranslate nohighlight">\(C = 0.5\)</span>.</p>
<ul class="simple">
<li><p>First is QPE.</p></li>
<li><p>Then comes <span class="math notranslate nohighlight">\(CR(k)\)</span>, <span class="math notranslate nohighlight">\(k = 1, \ldots, 15\)</span>.</p></li>
<li><p>Next is inverse QPE.</p></li>
<li><p>Finally, measurement is performed.</p></li>
</ul>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mindquantum.algorithm.library</span> <span class="kn">import</span> <span class="n">qft</span>

<span class="c1"># q1 ~ q4 : for QPE</span>
<span class="n">t</span> <span class="o">=</span> <span class="mi">4</span>
<span class="n">qc</span> <span class="o">=</span> <span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]</span>

<span class="c1"># store |b&gt; , and store the result |x&gt;</span>
<span class="n">qb</span> <span class="o">=</span> <span class="mi">5</span>

<span class="c1"># use for conditional rotation</span>
<span class="n">qs</span> <span class="o">=</span> <span class="mi">0</span>

<span class="c1"># choose a time evolution</span>
<span class="n">dt</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="mi">4</span>

<span class="c1"># choose a small C</span>
<span class="n">C</span> <span class="o">=</span> <span class="mf">0.5</span>

<span class="n">circ</span> <span class="o">=</span> <span class="n">Circuit</span><span class="p">()</span>

<span class="c1"># prepare b</span>
<span class="n">circ</span> <span class="o">+=</span> <span class="n">RY</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span><span class="mf">0.8</span><span class="p">))</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="n">qb</span><span class="p">)</span>

<span class="c1"># QPE</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">qc</span><span class="p">:</span>
    <span class="n">circ</span> <span class="o">+=</span> <span class="n">H</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

<span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">qc</span><span class="p">):</span>
    <span class="n">circ</span> <span class="o">+=</span> <span class="n">Power</span><span class="p">(</span><span class="n">RZ</span><span class="p">(</span><span class="o">-</span><span class="mi">2</span> <span class="o">*</span> <span class="n">dt</span><span class="p">),</span> <span class="mi">2</span><span class="o">**</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="n">qb</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>

<span class="c1"># apply inverse QFT</span>
<span class="n">circ</span> <span class="o">+=</span> <span class="n">qft</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">qc</span><span class="p">)))</span><span class="o">.</span><span class="n">hermitian</span><span class="p">()</span>

<span class="c1"># conditional rotate</span>
<span class="n">circ</span> <span class="o">+=</span> <span class="n">BARRIER</span>
<span class="k">for</span> <span class="n">k</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="o">**</span><span class="n">t</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">k</span> <span class="o">&amp;</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">i</span><span class="p">))</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">circ</span> <span class="o">+=</span> <span class="n">X</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="n">qc</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">phi</span> <span class="o">=</span> <span class="n">k</span> <span class="o">/</span> <span class="p">(</span><span class="mi">2</span><span class="o">**</span><span class="n">t</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">k</span> <span class="o">&gt;</span> <span class="mi">2</span><span class="o">**</span><span class="p">(</span><span class="n">t</span><span class="o">-</span><span class="mi">1</span><span class="p">):</span>
        <span class="n">phi</span> <span class="o">-=</span> <span class="mf">1.0</span>
    <span class="n">l</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span> <span class="o">/</span> <span class="n">dt</span> <span class="o">*</span> <span class="n">phi</span>
    <span class="n">circ</span> <span class="o">+=</span> <span class="n">RY</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span><span class="n">C</span> <span class="o">/</span> <span class="n">l</span><span class="p">))</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="n">qs</span><span class="p">,</span> <span class="n">qc</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">t</span><span class="p">):</span>
        <span class="k">if</span> <span class="p">(</span><span class="n">k</span> <span class="o">&amp;</span> <span class="p">(</span><span class="mi">1</span> <span class="o">&lt;&lt;</span> <span class="n">i</span><span class="p">))</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">circ</span> <span class="o">+=</span> <span class="n">X</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="n">qc</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">circ</span> <span class="o">+=</span> <span class="n">BARRIER</span>

<span class="c1"># apply inverse QPE</span>
<span class="n">circ</span> <span class="o">+=</span> <span class="n">qft</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="nb">reversed</span><span class="p">(</span><span class="n">qc</span><span class="p">)))</span>

<span class="k">for</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">qc</span><span class="p">):</span>
    <span class="n">circ</span> <span class="o">+=</span> <span class="n">Power</span><span class="p">(</span><span class="n">RZ</span><span class="p">(</span><span class="mi">2</span> <span class="o">*</span> <span class="n">dt</span><span class="p">),</span> <span class="mi">2</span><span class="o">**</span><span class="n">i</span><span class="p">)</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="n">qb</span><span class="p">,</span> <span class="n">q</span><span class="p">)</span>

<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">qc</span><span class="p">:</span>
    <span class="n">circ</span> <span class="o">+=</span> <span class="n">H</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>

<span class="n">circ</span><span class="o">.</span><span class="n">svg</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/case_library_hhl_algorithm_11_0.svg" src="../_images/case_library_hhl_algorithm_11_0.svg" /></div>
</div>
<p>How do we verify the correctness of our results? Through measurement. Since the result is a quantum state <span class="math notranslate nohighlight">\(|x\rangle\)</span>, currently MindQuantum does not have a method to directly extract the internal values of a specific qubit. Therefore, we can only obtain information about the state through measurement.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span> <span class="o">=</span> <span class="n">Simulator</span><span class="p">(</span><span class="n">backend</span><span class="o">=</span><span class="s2">&quot;mqvector&quot;</span><span class="p">,</span> <span class="n">n_qubits</span><span class="o">=</span><span class="mi">2</span> <span class="o">+</span> <span class="n">t</span><span class="p">)</span>
<span class="n">sim</span><span class="o">.</span><span class="n">apply_circuit</span><span class="p">(</span><span class="n">circ</span><span class="p">)</span>

<span class="n">circ_m</span> <span class="o">=</span> <span class="n">Circuit</span><span class="p">()</span>
<span class="n">circ_m</span> <span class="o">+=</span> <span class="n">Measure</span><span class="p">()</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="n">qs</span><span class="p">)</span>
<span class="n">circ_m</span> <span class="o">+=</span> <span class="n">Measure</span><span class="p">()</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="n">qb</span><span class="p">)</span>

<span class="n">res</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">sampling</span><span class="p">(</span><span class="n">circ_m</span><span class="p">,</span> <span class="n">shots</span><span class="o">=</span><span class="mi">100000</span><span class="p">)</span>
<span class="n">res</span><span class="o">.</span><span class="n">svg</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="output_area docutils container">
<img alt="../_images/case_library_hhl_algorithm_13_0.svg" src="../_images/case_library_hhl_algorithm_13_0.svg" /></div>
</div>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">res</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;01&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="n">res</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;01&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span> <span class="o">+</span> <span class="n">res</span><span class="o">.</span><span class="n">data</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;11&quot;</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
0.3612780010344965
</pre></div></div>
</div>
<p>By statistically analyzing the measurement results of <code class="docutils literal notranslate"><span class="pre">q5</span></code> when <code class="docutils literal notranslate"><span class="pre">q0</span></code> is 1, we observe that the proportion of <code class="docutils literal notranslate"><span class="pre">q5</span> <span class="pre">=</span> <span class="pre">0</span></code> is <code class="docutils literal notranslate"><span class="pre">0.36</span></code>, which is consistent with the expected answer.</p>
<p>However, this method only provides information about the magnitude of the amplitudes. To obtain more information, such as phase, adjustments to the measurement would be required, but we won’t discuss that here.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mindquantum.utils.show_info</span> <span class="kn">import</span> <span class="n">InfoTable</span>

<span class="n">InfoTable</span><span class="p">(</span><span class="s1">&#39;mindquantum&#39;</span><span class="p">,</span> <span class="s1">&#39;scipy&#39;</span><span class="p">,</span> <span class="s1">&#39;numpy&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<table border="1">
  <tr>
    <th>Software</th>
    <th>Version</th>
  </tr>
<tr><td>mindquantum</td><td>0.9.11</td></tr>
<tr><td>scipy</td><td>1.10.1</td></tr>
<tr><td>numpy</td><td>1.23.5</td></tr>
<tr>
    <th>System</th>
    <th>Info</th>
</tr>
<tr><td>Python</td><td>3.9.16</td></tr><tr><td>OS</td><td>Linux x86_64</td></tr><tr><td>Memory</td><td>8.3 GB</td></tr><tr><td>CPU Max Thread</td><td>8</td></tr><tr><td>Date</td><td>Sat Dec 30 23:19:52 2023</td></tr>
</table></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="shor_algorithm.html" class="btn btn-neutral float-left" title="Shor’s Algorithm Based on MindSpore Quantum" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="quantum_phase_estimation.html" class="btn btn-neutral float-right" title="Quantum Phase Estimation Algorithm" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright MindSpore.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 
</body>
</html>