<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>VQE Application in Quantum Chemistry Computing &mdash; MindSpore master documentation</title><script>;(()=>{const e=localStorage.getItem("ms-theme"),t=window.matchMedia("(prefers-color-scheme: dark)").matches;(e?"dark"===e:t)&&document.documentElement.setAttribute("data-o-theme","dark")})();</script><link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script><script src="../_static/jquery.js"></script>
        <script src="../_static/js/theme.js"></script><script src="../_static/underscore.js"></script><script src="../_static/doctools.js"></script><script crossorigin="anonymous" integrity="sha256-1fEPhSsRKlFKGfK3eO710tEweHh1fwokU5wFGDHO+vg=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js"></script><script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script><script async="async" src="https://mindspore-website.obs.cn-north-4.myhuaweicloud.com/mathjax/MathJax-3.2.2/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="The Application of Quantum Neural Network in NLP" href="qnn_for_nlp.html" />
    <link rel="prev" title="Classification of IRIS by Quantum Neural Network" href="classification_of_iris_by_qnn.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> MindSpore
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Beginner Tutorial</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../beginner/beginner.html">Beginner Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../beginner/parameterized_quantum_circuit.html">Variational Quantum Circuit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../beginner/quantum_simulator.html">Quantum Simulator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../beginner/quantum_measurement.html">Quantum Measurement</a></li>
<li class="toctree-l1"><a class="reference internal" href="../beginner/advanced_operations_of_quantum_circuit.html">Advanced Operations of Quantum Circuit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../beginner/bloch_sphere.html">Bloch Sphere</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Middle Level Tutorial</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../middle_level/middle_level.html">Middle Level Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../middle_level/noise.html">Noisy Quantum Circuit</a></li>
<li class="toctree-l1"><a class="reference internal" href="../middle_level/noise_simulator.html">Noise Simulator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../middle_level/qubit_mapping.html">Qubit Mapping</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Advanced Tutorial</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../advanced/advanced.html">Advanced Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/get_gradient_of_PQC_with_mindquantum.html">Advanced Gradient Calculation of Variational Quantum Circuits</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/initial_experience_of_quantum_neural_network.html">Initial Experience of Quantum Neural Network</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/equivalence_checking_of_PQC.html">Equivalence Checking of Parameterized Quantum Circuits</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Case Library</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="case_library.html">Case Library</a></li>
<li class="toctree-l1"><a class="reference internal" href="grover_search_algorithm.html">Grover Search and Long Algorithms Based on MindSpore Quantum</a></li>
<li class="toctree-l1"><a class="reference internal" href="shor_algorithm.html">Shor’s Algorithm Based on MindSpore Quantum</a></li>
<li class="toctree-l1"><a class="reference internal" href="hhl_algorithm.html">HHL Algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="quantum_phase_estimation.html">Quantum Phase Estimation Algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="quantum_approximate_optimization_algorithm.html">Quantum Approximate Optimization Algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="classification_of_iris_by_qnn.html">Classification of IRIS by Quantum Neural Network</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">VQE Application in Quantum Chemistry Computing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#environment-preparation">Environment Preparation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#importing-dependencies">Importing Dependencies</a></li>
<li class="toctree-l2"><a class="reference internal" href="#quantum-chemistry-computing-method">Quantum Chemistry Computing Method</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#wave-function">Wave Function</a></li>
<li class="toctree-l3"><a class="reference internal" href="#second-quantization">Second Quantization</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#variational-quantum-eigensolver-vqe">Variational Quantum Eigensolver (VQE)</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#variational-principle">Variational Principle</a></li>
<li class="toctree-l3"><a class="reference internal" href="#initial-state-preparation">Initial State Preparation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#wave-function-ansatz">Wave Function Ansatz</a></li>
<li class="toctree-l3"><a class="reference internal" href="#vqe-procedure">VQE Procedure</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#building-a-unitary-coupled-cluster-ansatz-step-by-step">Building a Unitary Coupled-Cluster Ansatz Step by Step</a></li>
<li class="toctree-l2"><a class="reference internal" href="#summary">Summary</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="qnn_for_nlp.html">The Application of Quantum Neural Network in NLP</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../overview.html">overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mindquantum.dtype.html">mindquantum.dtype</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mindquantum.core.html">mindquantum.core</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mindquantum.simulator.html">mindquantum.simulator</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mindquantum.framework.html">mindquantum.framework</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mindquantum.algorithm.html">mindquantum.algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mindquantum.device.html">mindquantum.device</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mindquantum.io.html">mindquantum.io</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mindquantum.engine.html">mindquantum.engine</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mindquantum.utils.html">mindquantum.utils</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Paper with Code</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../paper_with_code.html">Paper with Code</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">RELEASE NOTES</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../RELEASE.html">Release Notes</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Installation Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../mindquantum_install.html">MindSpore Quantum Installation</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MindSpore</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>VQE Application in Quantum Chemistry Computing</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/case_library/vqe_for_quantum_chemistry.ipynb.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars and line breaks on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
    white-space: pre;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
.jp-RenderedHTMLCommon table,
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
.jp-RenderedHTMLCommon thead,
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
.jp-RenderedHTMLCommon tr,
.jp-RenderedHTMLCommon th,
.jp-RenderedHTMLCommon td,
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
.jp-RenderedHTMLCommon th,
div.rendered_html th {
  font-weight: bold;
}
.jp-RenderedHTMLCommon tbody tr:nth-child(odd),
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.jp-RenderedHTMLCommon tbody tr:hover,
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="vqe-application-in-quantum-chemistry-computing">
<h1>VQE Application in Quantum Chemistry Computing<a class="headerlink" href="#vqe-application-in-quantum-chemistry-computing" title="Permalink to this headline"></a></h1>
<p><a class="reference external" href="https://mindspore-website.obs.cn-north-4.myhuaweicloud.com/notebook/r2.2/mindquantum/en/case_library/mindspore_vqe_for_quantum_chemistry.ipynb"><img alt="Download Notebook" src="https://mindspore-website.obs.cn-north-4.myhuaweicloud.com/website-images/r2.2/resource/_static/logo_notebook_en.svg" /></a>  <a class="reference external" href="https://mindspore-website.obs.cn-north-4.myhuaweicloud.com/notebook/r2.2/mindquantum/en/case_library/mindspore_vqe_for_quantum_chemistry.py"><img alt="Download Code" src="https://mindspore-website.obs.cn-north-4.myhuaweicloud.com/website-images/r2.2/resource/_static/logo_download_code_en.svg" /></a>  <a class="reference external" href="https://gitee.com/mindspore/docs/blob/r2.2/docs/mindquantum/docs/source_en/case_library/vqe_for_quantum_chemistry.ipynb"><img alt="View source on Gitee" src="https://mindspore-website.obs.cn-north-4.myhuaweicloud.com/website-images/r2.2/resource/_static/logo_source_en.svg" /></a>  <a class="reference external" href="https://authoring-modelarts-cnnorth4.huaweicloud.com/console/lab?share-url-b64=aHR0cHM6Ly9taW5kc3BvcmUtd2Vic2l0ZS5vYnMuY24tbm9ydGgtNC5teWh1YXdlaWNsb3VkLmNvbS9ub3RlYm9vay9yMi4yL21pbmRxdWFudHVtL3poX2NuL2Nhc2VfbGlicmFyeS9taW5kc3BvcmVfdnFlX2Zvcl9xdWFudHVtX2NoZW1pc3RyeS5pcHluYg%3D%3D&amp;imageid=73522c7f-6d98-43d8-b306-8ff374c7d3a7"><img alt="Run in ModelArts" src="https://mindspore-website.obs.cn-north-4.myhuaweicloud.com/website-images/r2.2/resource/_static/logo_modelarts_en.svg" /></a></p>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline"></a></h2>
<p>Quantum chemistry refers to solving the numerical values of the time-dependent or time-independent Schrödinger equations by using the basic theory and method of quantum mechanics. Quantum chemical simulation on high-performance computers has become an important method to study the physical and chemical properties of materials. However, the exact solution of the Schrödinger equation has exponential complexity, which severely constrains the scale of the chemical system that can be simulated. The
development of quantum computing in recent years provides a feasible way to solve this problem. It is expected that the Schrödinger equation can be solved with high accuracy on quantum computers under the complexity of polynomials.</p>
<p><a class="reference external" href="https://doi.org/10.1038/ncomms5213">Peruzzo et al.</a> first applied the VQE and <a class="reference external" href="https://linkinghub.elsevier.com/retrieve/pii/S0009261489873725">unitary coupled-cluster theory</a> to quantum chemistry simulation in 2014 to solve the ground state energy of He-H+. The VQE is a hybrid quantum-classical algorithm and is widely used in chemical simulation based on quantum algorithms. This tutorial describes how to use the VQE to solve the ground-state energy of a molecular system.</p>
<p>This tutorial consists of the following parts:</p>
<ol class="arabic simple">
<li><p>Introduction to the quantum chemistry</p></li>
<li><p>VQE application</p></li>
<li><p>Using MindSpore Quantum to perform VQE simulation with efficient and automatic derivation</p></li>
</ol>
<blockquote>
<div><p>This document applies to the CPU environment.</p>
</div></blockquote>
</section>
<section id="environment-preparation">
<h2>Environment Preparation<a class="headerlink" href="#environment-preparation" title="Permalink to this headline"></a></h2>
<p>In this tutorial, the following environments need to be installed:</p>
<ul class="simple">
<li><p>NumPy</p></li>
<li><p>SciPy</p></li>
<li><p><a class="reference external" href="https://gitee.com/mindspore/mindquantum">MindSpore Quantum</a></p></li>
<li><p><a class="reference external" href="https://gitee.com/mindspore/mindspore">MindSpore</a></p></li>
<li><p>PySCF</p></li>
<li><p>OpenFermion</p></li>
<li><p>OpenFermion-PySCF</p></li>
</ul>
<blockquote>
<div><p>The preceding dependencies can be installed by running the <code class="docutils literal notranslate"><span class="pre">pip</span></code> command.</p>
</div></blockquote>
</section>
<section id="importing-dependencies">
<h2>Importing Dependencies<a class="headerlink" href="#importing-dependencies" title="Permalink to this headline"></a></h2>
<p>Import the modules on which this tutorial depends.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">openfermion.chem</span> <span class="kn">import</span> <span class="n">MolecularData</span>
<span class="kn">from</span> <span class="nn">openfermionpyscf</span> <span class="kn">import</span> <span class="n">run_pyscf</span>
<span class="kn">from</span> <span class="nn">mindquantum.core.gates</span> <span class="kn">import</span> <span class="n">X</span>
<span class="kn">from</span> <span class="nn">mindquantum.core.circuit</span> <span class="kn">import</span> <span class="n">Circuit</span>
<span class="kn">from</span> <span class="nn">mindquantum.core.operators</span> <span class="kn">import</span> <span class="n">Hamiltonian</span>
<span class="kn">from</span> <span class="nn">mindquantum.simulator</span> <span class="kn">import</span> <span class="n">Simulator</span>
<span class="kn">from</span> <span class="nn">mindquantum.algorithm.nisq</span> <span class="kn">import</span> <span class="n">generate_uccsd</span>
<span class="kn">import</span> <span class="nn">mindspore</span> <span class="k">as</span> <span class="nn">ms</span>

<span class="n">ms</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">PYNATIVE_MODE</span><span class="p">,</span> <span class="n">device_target</span><span class="o">=</span><span class="s2">&quot;CPU&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</section>
<section id="quantum-chemistry-computing-method">
<h2>Quantum Chemistry Computing Method<a class="headerlink" href="#quantum-chemistry-computing-method" title="Permalink to this headline"></a></h2>
<p>The core of quantum chemistry is to solve the Schrödinger equation. In general, the solution of time-dependent Schrödinger equation is more complex, so Born-Oppenheimer approximation (BO approximation) is introduced. In BO approximation, the mass of the nucleus is far greater than that of electrons, and the velocity of the nucleus is far lower than that of electrons. Therefore, the nucleus and electrons can be separated from each other, and the time-independent electron motion equation (also
called the time-independent Schrödinger equation) can be obtained as follows:</p>
<div class="math notranslate nohighlight">
\[\hat{H} |\Psi\rangle = E |\Psi\rangle\]</div>
<p><span class="math notranslate nohighlight">\(\hat{H}\)</span> contains the following three items:</p>
<div class="math notranslate nohighlight">
\[\hat{H} = \hat{K} _{e} + \hat{V} _{ee} + \hat{V} _{Ne}\]</div>
<p>They are electron kinetic energy, electron-electron potential energy and electron-nuclear potential energy.</p>
<p>There are many numerical algorithms that can be used to solve the time-independent Schrödinger equation. This tutorial introduces one of these methods: the wave function. Wave function directly solves the eigenfunction and eigenenergy of a given molecular Hamiltonian. At present, there are a large number of open-source software packages, such as <a class="reference external" href="http://pyscf.org/">PySCF</a>, which can be implemented. Here is a simple example: lithium hydride molecules, using the OpenFermion and
OpenFermion-PySCF plug-ins. First, define the molecular structure:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">dist</span> <span class="o">=</span> <span class="mf">1.5</span>
<span class="n">geometry</span> <span class="o">=</span> <span class="p">[</span>
    <span class="p">[</span><span class="s2">&quot;Li&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span> <span class="o">*</span> <span class="n">dist</span><span class="p">]],</span>
    <span class="p">[</span><span class="s2">&quot;H&quot;</span><span class="p">,</span> <span class="p">[</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span> <span class="o">*</span> <span class="n">dist</span><span class="p">]],</span>
<span class="p">]</span>
<span class="n">basis</span> <span class="o">=</span> <span class="s2">&quot;sto3g&quot;</span>
<span class="n">spin</span> <span class="o">=</span> <span class="mi">0</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Geometry: </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">geometry</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Geometry:
 [[&#39;Li&#39;, [0.0, 0.0, 0.0]], [&#39;H&#39;, [0.0, 0.0, 1.5]]]
</pre></div></div>
</div>
<p>The code above defines a Li-H key with a length of 1.5Å molecules. The STO-3G basis set is used for computing. Then, OpenFermion-PySCF is used to call PySCF to perform Hartree-Fock (HF), coupled-cluster with singles and doubles (CCSD), and full configuration interaction (FCI) computing. These three methods belong to the wave function. Before starting the computing, first make a brief introduction to these methods.</p>
<section id="wave-function">
<h3>Wave Function<a class="headerlink" href="#wave-function" title="Permalink to this headline"></a></h3>
<p>One of the methods to solve the time-independent Schrödinger equation is the <a class="reference external" href="https://doi.org/10.1098/rspa.1935.0085">Hartree-Fock (HF)</a> method, which was proposed by Hartree et al. in the 1930s and is the basic method in quantum chemistry computing. The HF method introduces a single determinant approximation, that is, a wave function of the <span class="math notranslate nohighlight">\(N\)</span>-electronic system is represented by a wave function in a determinant form:</p>
<div class="math notranslate nohighlight">
\[| \Psi \rangle = | \psi_{1} \psi_{2} \psi_{3} \dots \psi_{N} \rangle\]</div>
<p>Where <span class="math notranslate nohighlight">\(| \psi_{1} \psi_{2} \psi_{3} \dots \rangle\)</span> represents the Nth-order determinants formed by a set of spin-orbit wave functions <span class="math notranslate nohighlight">\(\{ \pi_{i} \}\)</span>. The spin-orbit wave function <span class="math notranslate nohighlight">\(\psi_{i}\)</span> may be further expanded with a set of basis functions in known forms:</p>
<div class="math notranslate nohighlight">
\[\psi_{i} = \phi_{i} \eta_{i}\]</div>
<div class="math notranslate nohighlight">
\[\phi_{i} = \sum_{\mu}{C_{\mu i} \chi_{\mu}}\]</div>
<p><span class="math notranslate nohighlight">\(\{\chi_{\mu}\}\)</span> is referred to as a basis function, and may be a Gaussian function or the like. This approximation considers the exchange between electrons, but neglects the correlation between electrons, so it cannot correctly compute the properties such as dissociation energy.</p>
<p>The improvement of the HF method can be derived from the wave function expansion theorem. The wave function expansion theorem can be expressed as follows: if <span class="math notranslate nohighlight">\(\{ \psi_{i} \}\)</span> is a complete set of spin-orbit wave functions, the <span class="math notranslate nohighlight">\(N\)</span>-electronic system wave function may be accurately expanded by a determinant wave function formed by <span class="math notranslate nohighlight">\(\{ \psi_{i} \}\)</span>:</p>
<div class="math notranslate nohighlight">
\[| \Psi \rangle = \sum^{\infty} _ {i_{1} &lt; i_{2} &lt; \dots &lt; i_{N}} {C_{i_{1} i_{2} \dots i_{N}} | \psi_{i_{1}} \psi_{i_{2}} \dots \psi_{i_{N}} \rangle}\]</div>
<p>You can obtain the configuration interaction (CI) method:</p>
<div class="math notranslate nohighlight">
\[| \Psi_{CI} \rangle = C_{0} | \Psi_{HF} \rangle + \sum^{a\rightarrow\infty} _{i\in occ, a\not\in occ}{C^{a} _{i} | \Psi^{a} _{i} \rangle } + \sum^{ab\rightarrow\infty} _{ij\in occ, ab\not\in occ}{C^{ab} _{ij} | \Psi^{ab} _{ij} \rangle }\]</div>
<p><span class="math notranslate nohighlight">\(| \Psi^{a}_{i} \rangle + \dots\)</span> in the preceding formula represents a single excitation wave function of the electron from the orbit <span class="math notranslate nohighlight">\(i\)</span> to the orbit <span class="math notranslate nohighlight">\(a\)</span>, and so on. A CI that considers only single excitation and double excitation is called a configuration interaction with singles and doubles (CISD). The CI that takes into account all the ground-state HF wave functions to N excitation wave functions is called full configuration interaction (FCI). The FCI wave function is the
exact solution of the time-independent Schrödinger equation under the given basis function.</p>
</section>
<section id="second-quantization">
<h3>Second Quantization<a class="headerlink" href="#second-quantization" title="Permalink to this headline"></a></h3>
<p>Under the second quantization expression, the Hamiltonian of the system has the following form:</p>
<div class="math notranslate nohighlight">
\[\hat{H} = \sum_{p, q}{h^p_q E^p_q} + \sum_{p, q, r, s}{\frac{1}{2} g^{pq} _ {rs} E^{pq}_{rs}}\]</div>
<p><span class="math notranslate nohighlight">\(E^{p} _{q}\)</span> and <span class="math notranslate nohighlight">\(E^{pq}_ {rs}\)</span> are as follows:</p>
<div class="math notranslate nohighlight">
\[\begin{split}\begin{align*}
E^{pq} _{rs} &amp;= a^{\dagger} _{p} a^{\dagger} _{q} a _ {r} a _ {s}\\
E^p_q &amp;= a^{\dagger}_pa_q
\end{align*}\end{split}\]</div>
<p><span class="math notranslate nohighlight">\(a^{\dagger} _{p}\)</span> and <span class="math notranslate nohighlight">\(a_ {q}\)</span> are creation operator and annihilation operator, respectively.</p>
<p>The excited-state wave function can be expressed conveniently by using a second quantization expression method:</p>
<div class="math notranslate nohighlight">
\[| \Psi^{abc\dots} _ {ijk\dots} \rangle = a^{\dagger} _ {a} a^{\dagger} _ {b} a^{\dagger} _ {c} \dots a _ {i} a_{j} a_{k} \dots | \Psi \rangle\]</div>
<p>An improvement to the CI method is the coupled-cluster theory (CC). Exponential operators are introduced to CC:</p>
<div class="math notranslate nohighlight">
\[| \Psi_{CC} \rangle = \exp{(\hat{T})} | \Psi_{HF} \rangle\]</div>
<p>The coupled-cluster operator <span class="math notranslate nohighlight">\(\hat{T}\)</span> is the sum of excitation operators.</p>
<div class="math notranslate nohighlight">
\[\hat{T} = \sum_{p\not\in occ, q\in occ}{\theta^{p} _ {q} E^{p} _ {q}} + \sum_{pq\not\in occ, rs\in occ}{\theta^{pq} _ {rs} E^{pq} _ {rs}} + \dots\]</div>
<p><span class="math notranslate nohighlight">\(\theta\)</span> is similar to <span class="math notranslate nohighlight">\(C\)</span> in the CI method, and is the parameter to be solved. It is easy to know from the Taylor’s expansion of the exponent that even if the coupled-cluster operator <span class="math notranslate nohighlight">\(\hat{T}\)</span> includes only a low-order excitation term, the <span class="math notranslate nohighlight">\(\exp{(\hat{T})}\)</span> may also implicitly include a high-order excitation term. This also makes a convergence speed of the CC method to the FCI wave function much faster than that of the CI. For truncation to K excitation, for example,
K=2, the accuracy of the CCSD exceeds that of the CISD.</p>
<!--
Generally, if a method can achieve chemical accuracy, that is, the difference between the energy computed by this method and the FCI energy is less than 1 kcal/mol, it is considered that the method has good accuracy. Truncation to three-excited CCSD(T) can meet this standard in most cases.
--><p>The effect of electron correlation is to reduce the total energy, so the ground state energy of HF is slightly higher than that of CCSD and FCI. In addition, it is easy to find that the computing volume of FCI is much greater than that of CCSD and HF. The <code class="docutils literal notranslate"><span class="pre">MolecularData</span></code> function encapsulated by OpenFermion and the <code class="docutils literal notranslate"><span class="pre">run_pyscf</span></code> function encapsulated by OpenFermion-PySCF are used for demonstration.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">molecule_of</span> <span class="o">=</span> <span class="n">MolecularData</span><span class="p">(</span>
    <span class="n">geometry</span><span class="p">,</span>
    <span class="n">basis</span><span class="p">,</span>
    <span class="n">multiplicity</span><span class="o">=</span><span class="mi">2</span> <span class="o">*</span> <span class="n">spin</span> <span class="o">+</span> <span class="mi">1</span>
<span class="p">)</span>
<span class="n">molecule_of</span> <span class="o">=</span> <span class="n">run_pyscf</span><span class="p">(</span>
    <span class="n">molecule_of</span><span class="p">,</span>
    <span class="n">run_scf</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">run_ccsd</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
    <span class="n">run_fci</span><span class="o">=</span><span class="mi">1</span>
<span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Hartree-Fock energy: </span><span class="si">%20.16f</span><span class="s2"> Ha&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">molecule_of</span><span class="o">.</span><span class="n">hf_energy</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;CCSD energy: </span><span class="si">%20.16f</span><span class="s2"> Ha&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">molecule_of</span><span class="o">.</span><span class="n">ccsd_energy</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;FCI energy: </span><span class="si">%20.16f</span><span class="s2"> Ha&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">molecule_of</span><span class="o">.</span><span class="n">fci_energy</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Hartree-Fock energy:  -7.8633576215351182 Ha
CCSD energy:  -7.8823529091526794 Ha
FCI energy:  -7.8823622867987284 Ha
</pre></div></div>
</div>
<p>In the preceding example, HF, CCSD, and FCI are used to compute the total energy. If you collect statistics on the runtime, you will find that <span class="math notranslate nohighlight">\(T_{HF}&lt;T_{CCSD}\ll T_{FCI}\)</span>. It is more obvious if you use the system with larger calculation amount, such as ethylene molecule. In addition, for the total computed energy, you will find that <span class="math notranslate nohighlight">\(E_{HF}&gt;E_{CCSD}&gt;E_{FCI}\)</span>. After the computing is complete, save the result to the <code class="docutils literal notranslate"><span class="pre">molecule_file</span></code> file (<code class="docutils literal notranslate"><span class="pre">molecule_of.filename</span></code>).</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">molecule_of</span><span class="o">.</span><span class="n">save</span><span class="p">()</span>
<span class="n">molecule_file</span> <span class="o">=</span> <span class="n">molecule_of</span><span class="o">.</span><span class="n">filename</span>
<span class="nb">print</span><span class="p">(</span><span class="n">molecule_file</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;/&#39;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
H1-Li1_sto3g_singlet
</pre></div></div>
</div>
<p>One of the major obstacles to quantum chemistry is the volume of computation. As the system size (electron number and atomic number) increases, the time required for solving the FCI wave function and ground state energy increases by about <span class="math notranslate nohighlight">\(2^{N}\)</span>. Even for small molecules such as ethylene molecules, FCI computing is not easy. Quantum computers provide a possible solution to this problem. Research shows that quantum computers can simulate the time-dependent evolution of Hamiltonian in terms
of polynomial time complexity. Compared with classical computers, quantum computers exponentially accelerate the chemical simulation on quantum processors. This tutorial introduces one of the quantum algorithms: VQE.</p>
</section>
</section>
<section id="variational-quantum-eigensolver-vqe">
<h2>Variational Quantum Eigensolver (VQE)<a class="headerlink" href="#variational-quantum-eigensolver-vqe" title="Permalink to this headline"></a></h2>
<p>The VQE is a hybrid quantum-classical algorithm. It uses the variational principle to solve the ground state wave function. The optimization of variational parameters is carried out on the classical computer.</p>
<section id="variational-principle">
<h3>Variational Principle<a class="headerlink" href="#variational-principle" title="Permalink to this headline"></a></h3>
<p>The variational principle may be expressed in the following form:</p>
<div class="math notranslate nohighlight">
\[E_{0} \le \frac{\langle \Psi_{t} | \hat{H} | \Psi_{t} \rangle}{\langle \Psi_{t} | \Psi_{t} \rangle}\]</div>
<p>In the preceding formula, <span class="math notranslate nohighlight">\(| \Psi_{t} \rangle\)</span> indicates the probe wave function. The variational principle shows that the ground state energy obtained by any probe wave function is always greater than or equal to the real ground state energy under certain conditions. The variational principle provides a method for solving the molecular ground state Schrödinger equation. A parameterized function <span class="math notranslate nohighlight">\(f(\theta)\)</span> is used as an approximation of the accurate ground state wave function, and
the accurate ground state energy is approximated by optimizing the parameter <span class="math notranslate nohighlight">\(\theta\)</span>.</p>
</section>
<section id="initial-state-preparation">
<h3>Initial State Preparation<a class="headerlink" href="#initial-state-preparation" title="Permalink to this headline"></a></h3>
<p>The <span class="math notranslate nohighlight">\(N\)</span>-electron HF wave function also has a very concise form under the quadratic quantization expression:</p>
<div class="math notranslate nohighlight">
\[| \Psi_{HF} \rangle = \prod^{i=0} _{N-1}{a^{\dagger} _{i}| 0 \rangle}\]</div>
<p>The above formula builds a bridge from quantum chemical wave function to quantum computing: <span class="math notranslate nohighlight">\(|0\rangle\)</span> is used to represent a non-occupied orbit, and <span class="math notranslate nohighlight">\(|1\rangle\)</span> is used to represent an orbit occupied by an electron. Therefore, the <span class="math notranslate nohighlight">\(N\)</span>-electron HF wave function may be mapped to a string of <span class="math notranslate nohighlight">\(M+N\)</span> quantum bits <span class="math notranslate nohighlight">\(| 00\dots 11\dots \rangle\)</span>. <span class="math notranslate nohighlight">\(M\)</span> indicates the number of unoccupied tracks.</p>
<p>The following code builds an HF initial state wave function corresponding to the LiH molecule. In Jordan-Wigner transformation, <span class="math notranslate nohighlight">\(N\)</span> <span class="math notranslate nohighlight">\(\text{X}\)</span> gates are applied to <span class="math notranslate nohighlight">\(|000\dots\rangle\)</span>.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hartreefock_wfn_circuit</span> <span class="o">=</span> <span class="n">Circuit</span><span class="p">([</span><span class="n">X</span><span class="o">.</span><span class="n">on</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">molecule_of</span><span class="o">.</span><span class="n">n_electrons</span><span class="p">)])</span>
<span class="nb">print</span><span class="p">(</span><span class="n">hartreefock_wfn_circuit</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
      ┏━━━┓
q0: ──┨╺╋╸┠───
      ┗━━━┛
      ┏━━━┓
q1: ──┨╺╋╸┠───
      ┗━━━┛
      ┏━━━┓
q2: ──┨╺╋╸┠───
      ┗━━━┛
      ┏━━━┓
q3: ──┨╺╋╸┠───
      ┗━━━┛
</pre></div></div>
</div>
<p>We can build a probe wave function in the following form:</p>
<div class="math notranslate nohighlight">
\[| \Psi_{t} \rangle = U(\theta) | \Psi_{HF} \rangle\]</div>
<p><span class="math notranslate nohighlight">\(U(\theta)\)</span> represents a unitary transformation that may be simulated by using a quantum circuit. <span class="math notranslate nohighlight">\(| \Psi_{HF} \rangle\)</span> is used as an initial state, and may be conveniently prepared by using a plurality of single-bit <span class="math notranslate nohighlight">\(\text{X}\)</span> gates. A specific form of the <span class="math notranslate nohighlight">\(U(\theta) | \Psi_{HF} \rangle\)</span> is also referred to as wave function ansatz.</p>
</section>
<section id="wave-function-ansatz">
<h3>Wave Function Ansatz<a class="headerlink" href="#wave-function-ansatz" title="Permalink to this headline"></a></h3>
<p>The coupled-cluster theory mentioned above is a very efficient wave function ansatz. To use it on a quantum computer, you need to make the following modifications:</p>
<div class="math notranslate nohighlight">
\[| \Psi_{UCC} \rangle = \exp{(\hat{T} - \hat{T}^{\dagger})} | \Psi_{HF} \rangle\]</div>
<p>UCC is short for unitary coupled-cluster theory. <span class="math notranslate nohighlight">\(\hat{T}^{\dagger}\)</span> represents the Hermite conjugate of <span class="math notranslate nohighlight">\(\hat{T}\)</span>. In this way, <span class="math notranslate nohighlight">\(\exp{(\hat{T} - \hat{T}^{\dagger})}\)</span> is the unitary operator. <a class="reference external" href="https://doi.org/10.1038/ncomms5213">Peruzzo et al.</a> first performed chemical simulation experiments on quantum computers using VQE and unitary coupled-cluster with singles and doubles (UCCSD) in 2014. It should be noted that, by default, the parameter <span class="math notranslate nohighlight">\(\{\theta\}\)</span> in the
coupled-cluster operator is a real number. There is no problem with this hypothesis in molecular systems. In periodic systems, the study of <a class="reference external" href="https://doi.org/10.1021/acs.jctc.0c00881">Liu Jie et al.</a> suggests that a unitary coupled-cluster can result in errors due to the neglect of the complex numbers. This tutorial does not discuss the application of unitary coupled-cluster in periodic systems.</p>
<p>The <a class="reference external" href="https://www.mindspore.cn/mindquantum/docs/en/r0.9/algorithm/nisq/mindquantum.algorithm.nisq.generate_uccsd.html">generate_uccsd</a> function in the circuit module of MindSpore Quantum can be used to read the computing result saved in <code class="docutils literal notranslate"><span class="pre">molecule_file</span></code>, build the UCCSD wave function by one click, and obtain the corresponding quantum circuit.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ansatz_circuit</span><span class="p">,</span> \
<span class="n">init_amplitudes</span><span class="p">,</span> \
<span class="n">ansatz_parameter_names</span><span class="p">,</span> \
<span class="n">hamiltonian_QubitOp</span><span class="p">,</span> \
<span class="n">n_qubits</span><span class="p">,</span> <span class="n">n_electrons</span> <span class="o">=</span> <span class="n">generate_uccsd</span><span class="p">(</span><span class="n">molecule_file</span><span class="p">,</span> <span class="n">threshold</span><span class="o">=-</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
ccsd:-7.882352909152679.
fci:-7.882362286798728.
</pre></div></div>
</div>
<p><a class="reference external" href="https://www.mindspore.cn/mindquantum/docs/en/r0.9/algorithm/nisq/mindquantum.algorithm.nisq.generate_uccsd.html">generate_uccsd</a> packs functions related to the unitary coupled-cluster, including multiple steps such as deriving a molecular Hamiltonian, building a unitary coupled-cluster ansatz operator, and extracting a coupled-cluster coefficient computed by CCSD. This function reads the molecule by entering its file path. The parameter <code class="docutils literal notranslate"><span class="pre">th</span></code> indicates the to-be-updated gradient threshold
of a parameter in the quantum circuit. In the section <a class="reference external" href="#building-a-unitary-coupled-cluster-ansatz-step-by-step">Building a Unitary Coupled-Cluster Ansatz Step by Step</a>, we will demonstrate how to use the related interfaces of MindSpore Quantum to complete the steps. A complete quantum circuit includes an HF initial state and a UCCSD ansatz, as shown in the following code:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">total_circuit</span> <span class="o">=</span> <span class="n">hartreefock_wfn_circuit</span> <span class="o">+</span> <span class="n">ansatz_circuit</span>
<span class="n">total_circuit</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Number of parameters: </span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ansatz_parameter_names</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="nboutput docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #ff0000; text-decoration-color: #ff0000; font-weight: bold">                            Circuit Summary                            </span>
╭──────────────────────┬──────────────────────────────────────────────╮
│<span style="font-weight: bold"> </span><span style="color: #3b3b95; text-decoration-color: #3b3b95; font-weight: bold">Info</span><span style="font-weight: bold">                 </span>│<span style="font-weight: bold"> </span><span style="color: #3b3b95; text-decoration-color: #3b3b95; font-weight: bold">value</span><span style="font-weight: bold">                                        </span>│
├──────────────────────┼──────────────────────────────────────────────┤
│ <span style="font-weight: bold">Number of qubit</span>      │ 12                                           │
├──────────────────────┼──────────────────────────────────────────────┤
│ <span style="font-weight: bold">Total number of gate</span> │ 12612                                        │
│ Barrier              │ 2560                                         │
│ Noise Channel        │ 0                                            │
│ Measurement          │ 0                                            │
├──────────────────────┼──────────────────────────────────────────────┤
│ <span style="font-weight: bold">Parameter gate</span>       │ 640                                          │
│ 44 ansatz parameters │ <span style="color: #48c9b0; text-decoration-color: #48c9b0">p0, p8, p1, p9, p2, p10, p3, p11, p4, p12...</span> │
╰──────────────────────┴──────────────────────────────────────────────╯
</pre></div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Number of parameters: 44
</pre></div></div>
</div>
<p>For the LiH molecule, the UCCSD wave function ansatz includes 44 variational parameters. The total number of quantum bit gates of the circuit is 12612, and a total of 12 quantum bits are needed for simulation.</p>
</section>
<section id="vqe-procedure">
<h3>VQE Procedure<a class="headerlink" href="#vqe-procedure" title="Permalink to this headline"></a></h3>
<p>The procedure for solving the molecular ground state by using the VQE is as follows:</p>
<ol class="arabic simple">
<li><p>Prepare the HF initial state: <span class="math notranslate nohighlight">\(| 00\dots11\dots \rangle\)</span>.</p></li>
<li><p>Define the wave function ansatz, such as UCCSD.</p></li>
<li><p>Convert the wave function into a variational quantum circuit.</p></li>
<li><p>Initialize the variational parameters, for example, set all parameters to 0.</p></li>
<li><p>Obtain the energy <span class="math notranslate nohighlight">\(E(\theta)\)</span> of the molecular Hamiltonian under the set of variational parameters and the derivative <span class="math notranslate nohighlight">\(\{ {\partial E} / {\partial \theta_{i}} \}\)</span> of the energy about the parameters by means of multiple measurements on the quantum computer.</p></li>
<li><p>Use optimization algorithms, such as gradient descent and BFGS, to update variational parameters on classical computers.</p></li>
<li><p>Transfer the new variational parameters to the quantum circuit for updating.</p></li>
<li><p>Repeat steps 5 to 7 until the convergence criteria are met.</p></li>
<li><p>End.</p></li>
</ol>
<p>In step 5, the derivative <span class="math notranslate nohighlight">\(\{ {\partial E} / {\partial \theta_{i}} \}\)</span> of the energy about the parameter may be computed by using a parameter-shift rule on a quantum computer, or may be computed by simulating a parameter-shift rule or a finite difference method in a simulator. This is a relatively time-consuming process. Based on the MindSpore framework, MindSpore Quantum provides the automatic derivation function similar to machine learning, which can efficiently compute the derivatives
of variational quantum circuits in simulation. The following uses MindSpore Quantum to build a parameterized UCCSD quantum circuit with an automatic derivation function:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[8]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">sim</span> <span class="o">=</span> <span class="n">Simulator</span><span class="p">(</span><span class="s1">&#39;mqvector&#39;</span><span class="p">,</span> <span class="n">total_circuit</span><span class="o">.</span><span class="n">n_qubits</span><span class="p">)</span>
<span class="n">molecule_pqc</span> <span class="o">=</span> <span class="n">sim</span><span class="o">.</span><span class="n">get_expectation_with_grad</span><span class="p">(</span><span class="n">Hamiltonian</span><span class="p">(</span><span class="n">hamiltonian_QubitOp</span><span class="p">),</span> <span class="n">total_circuit</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>You can obtain the energy <span class="math notranslate nohighlight">\(E(\theta)=\langle \Psi_{UCC}(\theta) | \hat{H} | \Psi_{UCC}(\theta) \rangle\)</span> corresponding to the variational parameter and the derivative of each variational parameter by transferring a specific value of the parameter to <code class="docutils literal notranslate"><span class="pre">molecule_pqc</span></code>.</p>
<p>For example, we can use the following code to get the expectation of hamiltonian and the corresponding gradient when initial parameters of variational quantum circuit is zero.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[9]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="n">n_params</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">total_circuit</span><span class="o">.</span><span class="n">params_name</span><span class="p">)</span>
<span class="n">p0</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">n_params</span><span class="p">)</span>
<span class="n">f</span><span class="p">,</span> <span class="n">g</span> <span class="o">=</span> <span class="n">molecule_pqc</span><span class="p">(</span><span class="n">p0</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Energy: &quot;</span><span class="p">,</span> <span class="n">f</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">shape: &quot;</span><span class="p">,</span> <span class="n">f</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="s1">&#39;</span><span class="se">\n</span><span class="s1">&#39;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Gradient: &quot;</span><span class="p">,</span> <span class="n">g</span><span class="p">,</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">shape: &quot;</span><span class="p">,</span> <span class="n">g</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Energy:  [[-7.86335762+0.j]]
shape:  (1, 1)

Gradient:  [[[-5.76761758e-11+0.j -8.60518134e-02+0.j  1.19275904e-08+0.j
   -4.85545124e-02+0.j -1.24342308e-14+0.j -3.92769093e-02+0.j
   -3.28108247e-15+0.j -9.59481745e-02+0.j  1.24424913e-14+0.j
   -3.92769093e-02+0.j -3.82408561e-15+0.j -9.59481745e-02+0.j
   -8.60105773e-11+0.j -2.89649669e-02+0.j  2.97699096e-10+0.j
   -4.91813233e-01+0.j -9.35293242e-04+0.j -1.63755737e-16+0.j
   -3.35024598e-17+0.j  1.55629243e-17+0.j  1.59462515e-16+0.j
    2.67655514e-17+0.j -2.16577662e-17+0.j  5.06813117e-03+0.j
    1.08542346e-02+0.j -1.28614265e-02+0.j -4.90653908e-17+0.j
    1.71728860e-17+0.j  1.33973787e-01+0.j -3.03063680e-02+0.j
   -3.37324552e-18+0.j  9.19976050e-19+0.j -1.05649122e-28+0.j
    5.33586109e-17+0.j -3.68357159e-17+0.j  3.33490478e-17+0.j
    1.09202635e-28+0.j  1.15391965e-16+0.j -3.03063680e-02+0.j
   -5.27452935e-17+0.j  4.81071347e-17+0.j -4.22508288e-17+0.j
   -2.44510199e-17+0.j -1.68035039e-03+0.j]]]
shape:  (1, 1, 44)
</pre></div></div>
</div>
<p>Throw the above calculation, we get the energy and gradient value and the user can use these data according their practical needs. Now we following the step of (5)~(7) of optimization of VQE, to optimize of variational quantum circuit. Here we use the optimizer in scipy to optimize our quantum circuit. First, we need to define the optimization function that scipy required:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">fun</span><span class="p">(</span><span class="n">p0</span><span class="p">,</span> <span class="n">molecule_pqc</span><span class="p">,</span> <span class="n">energy_list</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
    <span class="n">f</span><span class="p">,</span> <span class="n">g</span> <span class="o">=</span> <span class="n">molecule_pqc</span><span class="p">(</span><span class="n">p0</span><span class="p">)</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">f</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="n">g</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">real</span><span class="p">(</span><span class="n">g</span><span class="p">)[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
    <span class="k">if</span> <span class="n">energy_list</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">energy_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
        <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">energy_list</span><span class="p">)</span> <span class="o">%</span> <span class="mi">5</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Step: </span><span class="si">{</span><span class="nb">len</span><span class="p">(</span><span class="n">energy_list</span><span class="p">)</span><span class="si">}</span><span class="s2">,</span><span class="se">\t</span><span class="s2">energy: </span><span class="si">{</span><span class="n">f</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">f</span><span class="p">,</span> <span class="n">g</span>

<span class="n">fun</span><span class="p">(</span><span class="n">p0</span><span class="p">,</span> <span class="n">molecule_pqc</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[10]:
</pre></div>
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
(-7.863357621536964,
 array([-5.76761758e-11, -8.60518134e-02,  1.19275904e-08, -4.85545124e-02,
        -1.24342308e-14, -3.92769093e-02, -3.28108247e-15, -9.59481745e-02,
         1.24424913e-14, -3.92769093e-02, -3.82408561e-15, -9.59481745e-02,
        -8.60105773e-11, -2.89649669e-02,  2.97699096e-10, -4.91813233e-01,
        -9.35293242e-04, -1.63755737e-16, -3.35024598e-17,  1.55629243e-17,
         1.59462515e-16,  2.67655514e-17, -2.16577662e-17,  5.06813117e-03,
         1.08542346e-02, -1.28614265e-02, -4.90653908e-17,  1.71728860e-17,
         1.33973787e-01, -3.03063680e-02, -3.37324552e-18,  9.19976050e-19,
        -1.05649122e-28,  5.33586109e-17, -3.68357159e-17,  3.33490478e-17,
         1.09202635e-28,  1.15391965e-16, -3.03063680e-02, -5.27452935e-17,
         4.81071347e-17, -4.22508288e-17, -2.44510199e-17, -1.68035039e-03]))
</pre></div></div>
</div>
<p>Here, the <code class="docutils literal notranslate"><span class="pre">fun</span></code> that we define can correctly to return the data that we need: a real energy value, and a array of gradient value with the same size of parameters. Now, we use <code class="docutils literal notranslate"><span class="pre">bfgs</span></code> optimizer in scipy to finish the optimization.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[11]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.optimize</span> <span class="kn">import</span> <span class="n">minimize</span>

<span class="n">energy_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">p0</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">molecule_pqc</span><span class="p">,</span> <span class="n">energy_list</span><span class="p">),</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;bfgs&#39;</span><span class="p">,</span> <span class="n">jac</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Step: 5,        energy: -7.880227726111826
Step: 10,       energy: -7.8818171240648365
Step: 15,       energy: -7.882213242905283
Step: 20,       energy: -7.8823453369936445
Step: 25,       energy: -7.8823524949903465
Step: 30,       energy: -7.8823526912721755
Step: 35,       energy: -7.882352703403696
Step: 40,       energy: -7.882352708341612
</pre></div></div>
</div>
<p>So, we finished the gradient optimization of variational quantum circuit. Here, <code class="docutils literal notranslate"><span class="pre">energy_list</span></code> is going to store the energy during optimization. Here, we briefly introduce the usage of <code class="docutils literal notranslate"><span class="pre">minimize</span></code>:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">fun</span></code>: The first arg is the function you want to optimize.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">p0</span></code>: The second arg is the initial value of variables.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">args</span></code>: The other argument of <code class="docutils literal notranslate"><span class="pre">fun</span></code> except the first argument. According the definition of <code class="docutils literal notranslate"><span class="pre">fun</span></code>, we choose <code class="docutils literal notranslate"><span class="pre">args=(molecule_pqc,</span> <span class="pre">energy_list)</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">method</span></code>: The optimization algorithm. Here we use a second order optimization algorithm <code class="docutils literal notranslate"><span class="pre">bfgs</span></code>. For more optimization algorithm, please refer: <a class="reference external" href="https://docs.scipy.org/doc/scipy/reference/generated/scipy.optimize.minimize.html">scipy tutorial</a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">jac</span></code>: To info that whether <code class="docutils literal notranslate"><span class="pre">fun</span></code> return gradient. Here we use <code class="docutils literal notranslate"><span class="pre">True</span></code>, because MindSpore Quantum can calculate the accuracy gradient value of variational quantum circuit. If use <code class="docutils literal notranslate"><span class="pre">False</span></code>, <code class="docutils literal notranslate"><span class="pre">minimize</span></code> framework will calculate the approximated gradient value base on difference method.</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">res</span></code> is the optimization result of <code class="docutils literal notranslate"><span class="pre">scipy</span></code>, including optimized parameters, the optimized value and evolution steps.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[12]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Ground state: </span><span class="se">\n</span><span class="si">{</span><span class="n">res</span><span class="o">.</span><span class="n">fun</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;FCI: </span><span class="se">\n</span><span class="s2">-7.882362286798721</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Optimized amplitudes: </span><span class="se">\n</span><span class="si">{</span><span class="n">res</span><span class="o">.</span><span class="n">x</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Ground state:
-7.882352708341612

FCI:
-7.882362286798721

Optimized amplitudes:
[ 2.38815317e-04  1.89073105e-03  3.52372251e-02  1.60368559e-02
 -4.30846145e-09  9.09437670e-04 -5.45444468e-10  1.41627870e-02
  3.62569484e-09  9.08701303e-04 -1.05938178e-10  1.41711693e-02
 -5.47703644e-04  4.26818370e-04  2.87168405e-03  5.38109720e-02
  2.34920831e-04 -9.88498886e-08 -2.51432020e-07  2.54936335e-07
 -2.65409411e-08  4.64583011e-08 -4.42267421e-08  1.32809550e-05
 -1.04167881e-04  7.98983208e-04  5.39567507e-10 -2.28346700e-10
 -5.50005419e-02  3.09112487e-03 -4.88778663e-10 -4.89650670e-09
  4.92879467e-09  1.13389943e-07  4.45780819e-09 -1.85315776e-08
 -1.42394064e-12  4.57319777e-10  3.09100040e-03  5.36042785e-08
 -3.87192856e-09  9.99056234e-10  1.51453640e-10  3.72805204e-04]
</pre></div></div>
</div>
<p>We can see here the result of ucc method is very close to FCI method with very good accuracy.</p>
</section>
</section>
<section id="building-a-unitary-coupled-cluster-ansatz-step-by-step">
<h2>Building a Unitary Coupled-Cluster Ansatz Step by Step<a class="headerlink" href="#building-a-unitary-coupled-cluster-ansatz-step-by-step" title="Permalink to this headline"></a></h2>
<p>In the preceding part, the <a class="reference external" href="https://www.mindspore.cn/mindquantum/docs/en/r0.9/algorithm/nisq/mindquantum.algorithm.nisq.generate_uccsd.html">generate_uccsd</a> is used to build all the content required for designing the unitary coupled-cluster. In this section, the steps are split, we get the coupled-cluster operator, the corresponding quantum circuit and the initial guess of the variational parameters from the classical CCSD results. First, import some extra dependencies, including the related
functions in MindSpore Quantum.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[13]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mindquantum.algorithm.nisq</span> <span class="kn">import</span> <span class="n">Transform</span>
<span class="kn">from</span> <span class="nn">mindquantum.algorithm.nisq</span> <span class="kn">import</span> <span class="n">get_qubit_hamiltonian</span>
<span class="kn">from</span> <span class="nn">mindquantum.algorithm.nisq</span> <span class="kn">import</span> <span class="n">uccsd_singlet_generator</span><span class="p">,</span> <span class="n">uccsd_singlet_get_packed_amplitudes</span>
<span class="kn">from</span> <span class="nn">mindquantum.core.operators</span> <span class="kn">import</span> <span class="n">TimeEvolution</span>
</pre></div>
</div>
</div>
<p>The molecule Hamiltonian uses <a class="reference external" href="https://www.mindspore.cn/mindquantum/docs/en/r0.9/algorithm/nisq/mindquantum.algorithm.nisq.get_qubit_hamiltonian.html">get_qubit_hamiltonian</a> to read the previous computing result. The result is as follows:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[14]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">hamiltonian_QubitOp</span> <span class="o">=</span> <span class="n">get_qubit_hamiltonian</span><span class="p">(</span><span class="n">molecule_of</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The unitary coupled-cluster operator <span class="math notranslate nohighlight">\(\hat{T} - \hat{T}^{\dagger}\)</span> can be built using <a class="reference external" href="https://www.mindspore.cn/mindquantum/docs/en/r0.9/algorithm/nisq/mindquantum.algorithm.nisq.uccsd_singlet_generator.html">uccsd_singlet_generator</a>. Provide the total number of quantum bits (total number of spin orbits) and the total number of electrons, and set <code class="docutils literal notranslate"><span class="pre">anti_hermitian=True</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[15]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ucc_fermion_ops</span> <span class="o">=</span> <span class="n">uccsd_singlet_generator</span><span class="p">(</span>
    <span class="n">molecule_of</span><span class="o">.</span><span class="n">n_qubits</span><span class="p">,</span> <span class="n">molecule_of</span><span class="o">.</span><span class="n">n_electrons</span><span class="p">,</span> <span class="n">anti_hermitian</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">ucc_fermion_ops</span></code> built in the previous step is parameterized. Use the <a class="reference external" href="https://www.mindspore.cn/mindquantum/docs/en/r0.9/algorithm/nisq/mindquantum.algorithm.nisq.Transform.html#mindquantum.algorithm.nisq.Transform.jordan_wigner">Jordan-Wigner transformation</a> to map the Fermi excitation operator to the Pauli operator:</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[16]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ucc_qubit_ops</span> <span class="o">=</span> <span class="n">Transform</span><span class="p">(</span><span class="n">ucc_fermion_ops</span><span class="p">)</span><span class="o">.</span><span class="n">jordan_wigner</span><span class="p">()</span>
</pre></div>
</div>
</div>
<p>Next, we need to obtain the quantum circuit corresponding to the unitary operator <span class="math notranslate nohighlight">\(\exp{(\hat{T} - \hat{T}^{\dagger})}\)</span>. <a class="reference external" href="https://www.mindspore.cn/mindquantum/docs/en/r0.9/core/operators/mindquantum.core.operators.TimeEvolution.html">TimeEvolution</a> can generate the circuit corresponding to <span class="math notranslate nohighlight">\(\exp{(-i\hat{H}t)}\)</span>, where <span class="math notranslate nohighlight">\(\hat{H}\)</span> is a Hermitian operator, and <span class="math notranslate nohighlight">\(t\)</span> is a real number. Note that when
<a class="reference external" href="https://www.mindspore.cn/mindquantum/docs/en/r0.9/core/operators/mindquantum.core.operators.TimeEvolution.html">TimeEvolution</a> is used, <code class="docutils literal notranslate"><span class="pre">ucc_qubit_ops</span></code> already contains the complex number factor <span class="math notranslate nohighlight">\(i\)</span>. Therefore, you need to divide <code class="docutils literal notranslate"><span class="pre">ucc_qubit_ops</span></code> by <span class="math notranslate nohighlight">\(i\)</span> or extract the imaginary part of <code class="docutils literal notranslate"><span class="pre">ucc_qubit_ops</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[17]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ansatz_circuit</span> <span class="o">=</span> <span class="n">TimeEvolution</span><span class="p">(</span><span class="n">ucc_qubit_ops</span><span class="o">.</span><span class="n">imag</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">)</span><span class="o">.</span><span class="n">circuit</span>
<span class="n">ansatz_parameter_names</span> <span class="o">=</span> <span class="n">ansatz_circuit</span><span class="o">.</span><span class="n">params_name</span>
</pre></div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">ansatz_parameter_names</span></code> is used to record the parameter names in the circuit. So far, we have obtained the contents required by the VQE quantum circuit, including the Hamiltonian <code class="docutils literal notranslate"><span class="pre">hamiltonian_QubitOp</span></code> and the parameterized wave function ansatz <code class="docutils literal notranslate"><span class="pre">ansatz_circuit</span></code>. By referring to the preceding steps, we can obtain a complete state preparation circuit. <code class="docutils literal notranslate"><span class="pre">hartreefock_wfn_circuit</span></code> mentioned above is used as the Hartree-Fock reference state:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[18]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">total_circuit</span> <span class="o">=</span> <span class="n">hartreefock_wfn_circuit</span> <span class="o">+</span> <span class="n">ansatz_circuit</span>
<span class="n">total_circuit</span><span class="o">.</span><span class="n">summary</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area rendered_html docutils container">
<pre style="white-space:pre;overflow-x:auto;line-height:normal;font-family:Menlo,'DejaVu Sans Mono',consolas,'Courier New',monospace"><span style="color: #ff0000; text-decoration-color: #ff0000; font-weight: bold">                                  Circuit Summary                                  </span>
╭──────────────────────┬──────────────────────────────────────────────────────────╮
│<span style="font-weight: bold"> </span><span style="color: #3b3b95; text-decoration-color: #3b3b95; font-weight: bold">Info</span><span style="font-weight: bold">                 </span>│<span style="font-weight: bold"> </span><span style="color: #3b3b95; text-decoration-color: #3b3b95; font-weight: bold">value</span><span style="font-weight: bold">                                                    </span>│
├──────────────────────┼──────────────────────────────────────────────────────────┤
│ <span style="font-weight: bold">Number of qubit</span>      │ 12                                                       │
├──────────────────────┼──────────────────────────────────────────────────────────┤
│ <span style="font-weight: bold">Total number of gate</span> │ 12612                                                    │
│ Barrier              │ 2560                                                     │
│ Noise Channel        │ 0                                                        │
│ Measurement          │ 0                                                        │
├──────────────────────┼──────────────────────────────────────────────────────────┤
│ <span style="font-weight: bold">Parameter gate</span>       │ 640                                                      │
│ 44 ansatz parameters │ <span style="color: #48c9b0; text-decoration-color: #48c9b0">s_0, d1_0, s_1, d1_1, s_2, d1_2, s_3, d1_3, s_4, d1_4...</span> │
╰──────────────────────┴──────────────────────────────────────────────────────────╯
</pre></div>
</div>
<p>Next, you need to provide a reasonable initial value for the variational parameter. The <code class="docutils literal notranslate"><span class="pre">PQCNet</span></code> built in the preceding text uses 0 as the initial guess by default, which is feasible in most cases. However, using CCSD’s computational data as a starting point for UCC may be better. Use the <a class="reference external" href="https://www.mindspore.cn/mindquantum/docs/en/r0.9/algorithm/nisq/mindquantum.algorithm.nisq.uccsd_singlet_get_packed_amplitudes.html">uccsd_singlet_get_packed_amplitudes</a> function to extract CCSD
parameters from <code class="docutils literal notranslate"><span class="pre">molecule_of</span></code>.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[19]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">init_amplitudes_ccsd</span> <span class="o">=</span> <span class="n">uccsd_singlet_get_packed_amplitudes</span><span class="p">(</span>
    <span class="n">molecule_of</span><span class="o">.</span><span class="n">ccsd_single_amps</span><span class="p">,</span> <span class="n">molecule_of</span><span class="o">.</span><span class="n">ccsd_double_amps</span><span class="p">,</span> <span class="n">molecule_of</span><span class="o">.</span><span class="n">n_qubits</span><span class="p">,</span> <span class="n">molecule_of</span><span class="o">.</span><span class="n">n_electrons</span><span class="p">)</span>
<span class="n">init_amplitudes_ccsd</span> <span class="o">=</span> <span class="p">[</span><span class="n">init_amplitudes_ccsd</span><span class="p">[</span><span class="n">param_i</span><span class="p">]</span> <span class="k">for</span> <span class="n">param_i</span> <span class="ow">in</span> <span class="n">ansatz_parameter_names</span><span class="p">]</span>
</pre></div>
</div>
</div>
<p>Just like the previous method, we can get the <code class="docutils literal notranslate"><span class="pre">grad_ops</span></code> with MindSpore Quantum, and optimize it with scipy.</p>
<div class="nbinput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[20]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">grad_ops</span> <span class="o">=</span> <span class="n">Simulator</span><span class="p">(</span><span class="s1">&#39;mqvector&#39;</span><span class="p">,</span> <span class="n">total_circuit</span><span class="o">.</span><span class="n">n_qubits</span><span class="p">)</span><span class="o">.</span><span class="n">get_expectation_with_grad</span><span class="p">(</span>
    <span class="n">Hamiltonian</span><span class="p">(</span><span class="n">hamiltonian_QubitOp</span><span class="o">.</span><span class="n">real</span><span class="p">),</span>
    <span class="n">total_circuit</span><span class="p">)</span>
</pre></div>
</div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">init_amplitudes_ccsd</span></code> (coupled-cluster coefficient computed by CCSD) is used as an initial variational parameter:</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[21]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">energy_list</span> <span class="o">=</span> <span class="p">[]</span>
<span class="n">res</span> <span class="o">=</span> <span class="n">minimize</span><span class="p">(</span><span class="n">fun</span><span class="p">,</span> <span class="n">init_amplitudes_ccsd</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="p">(</span><span class="n">grad_ops</span><span class="p">,</span> <span class="n">energy_list</span><span class="p">),</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;bfgs&#39;</span><span class="p">,</span> <span class="n">jac</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Step: 5,        energy: -7.878223283110822
Step: 10,       energy: -7.880288481802435
Step: 15,       energy: -7.8820356683191415
Step: 20,       energy: -7.882302370884269
Step: 25,       energy: -7.882349803535784
Step: 30,       energy: -7.882352702053716
Step: 35,       energy: -7.88235270792034
Step: 40,       energy: -7.882352708346457
</pre></div></div>
</div>
<p>The final optimized result is shown as below.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[22]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Ground state: </span><span class="se">\n</span><span class="si">{</span><span class="n">res</span><span class="o">.</span><span class="n">fun</span><span class="si">}</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;FCI: </span><span class="se">\n</span><span class="s2">-7.882362286798721</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Optimized amplitudes: </span><span class="se">\n</span><span class="si">{</span><span class="n">res</span><span class="o">.</span><span class="n">x</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
Ground state:
-7.882352708346457

FCI:
-7.882362286798721

Optimized amplitudes:
[-2.38636816e-04  1.89071890e-03 -3.52372349e-02  1.60368129e-02
  1.34665623e-08  9.09430837e-04 -4.17115460e-10  1.41641317e-02
 -1.28144111e-08  9.08694024e-04  4.20204892e-10  1.41698036e-02
  5.47710797e-04  4.26820871e-04 -2.87169433e-03  5.38109417e-02
  2.34627619e-04  4.32417990e-07 -1.26325933e-08 -1.39715964e-08
 -4.27213491e-07  1.24814811e-08  1.37984739e-08  1.32946010e-05
  7.99032002e-04 -1.04121599e-04  1.25575236e-09 -1.24558942e-09
 -5.50005457e-02  3.09142613e-03  1.53511697e-08 -3.40030804e-08
  3.29912584e-08  3.67660373e-07 -2.59584687e-08  2.22720149e-10
  4.47254154e-11  1.06718989e-09  3.09086800e-03 -3.54929776e-07
  1.95048358e-08  5.27817957e-09 -1.03614664e-09  3.72830373e-04]
</pre></div></div>
</div>
</section>
<section id="summary">
<h2>Summary<a class="headerlink" href="#summary" title="Permalink to this headline"></a></h2>
<p>In this case, the ground state energy of the LiH molecule is obtained by using scipy in two methods. In the first method, we use the <a class="reference external" href="https://www.mindspore.cn/mindquantum/docs/en/r0.9/algorithm/nisq/mindquantum.algorithm.nisq.generate_uccsd.html">generate_uccsd</a> function packaged by MindSpore Quantum to generate a quantum neural network that can solve this problem. In the second method, we build a similar gradient operator step by step. The final results are the same.</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mindquantum.utils.show_info</span> <span class="kn">import</span> <span class="n">InfoTable</span>

<span class="n">InfoTable</span><span class="p">(</span><span class="s1">&#39;mindquantum&#39;</span><span class="p">,</span> <span class="s1">&#39;scipy&#39;</span><span class="p">,</span> <span class="s1">&#39;numpy&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[23]:
</pre></div>
</div>
<div class="output_area rendered_html docutils container">
<table border="1">
  <tr>
    <th>Software</th>
    <th>Version</th>
  </tr>
<tr><td>mindquantum</td><td>0.9.11</td></tr>
<tr><td>scipy</td><td>1.10.1</td></tr>
<tr><td>numpy</td><td>1.23.5</td></tr>
<tr>
    <th>System</th>
    <th>Info</th>
</tr>
<tr><td>Python</td><td>3.9.16</td></tr><tr><td>OS</td><td>Linux x86_64</td></tr><tr><td>Memory</td><td>8.3 GB</td></tr><tr><td>CPU Max Thread</td><td>8</td></tr><tr><td>Date</td><td>Mon Jan  1 00:25:57 2024</td></tr>
</table></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="classification_of_iris_by_qnn.html" class="btn btn-neutral float-left" title="Classification of IRIS by Quantum Neural Network" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="qnn_for_nlp.html" class="btn btn-neutral float-right" title="The Application of Quantum Neural Network in NLP" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright MindSpore.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 
</body>
</html>