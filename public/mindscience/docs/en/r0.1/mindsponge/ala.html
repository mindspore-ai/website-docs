

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>MindSPONGE Molecular Simulation Practice &mdash; MindSpore master documentation</title>
  

  
   
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  
  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        
        
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="MindElec Introduction and Installation" href="../mindelec/intro_and_install.html" />
    <link rel="prev" title="MindSPONGE Introduction and Installation" href="intro_and_install.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> MindSpore
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">MindSPONGE</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro_and_install.html">MindSPONGE Introduction and Installation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">MindSPONGE Molecular Simulation Practice</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#overall-execution">Overall Execution</a></li>
<li class="toctree-l2"><a class="reference internal" href="#preparation">Preparation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#example-of-simulated-polypeptide-aqueous-solution-system">Example of Simulated Polypeptide Aqueous Solution System</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#preparing-input-files">Preparing Input Files</a></li>
<li class="toctree-l3"><a class="reference internal" href="#loading-data">Loading Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#constructing-simulation-process">Constructing Simulation Process</a></li>
<li class="toctree-l3"><a class="reference internal" href="#running-script">Running Script</a></li>
<li class="toctree-l3"><a class="reference internal" href="#running-result">Running Result</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#performance">Performance</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">MindElec</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../mindelec/intro_and_install.html">MindElec Introduction and Installation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mindelec/physics_driven.html">Physics Informed Deep Learning Method for Electromagnetic Simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mindelec/data_driven.html">Data Driven Deep Learning Method for Electromagnetic Simulation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mindelec/visualization.html">Visualizing Electromagnetic Simulation Results</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MindSpore</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>MindSPONGE Molecular Simulation Practice</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/mindsponge/ala.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="mindsponge-molecular-simulation-practice">
<h1>MindSPONGE Molecular Simulation Practice<a class="headerlink" href="#mindsponge-molecular-simulation-practice" title="Permalink to this headline">¶</a></h1>
<p>Translator: <a class="reference external" href="https://gitee.com/liangrio">LiangRio</a></p>
<!-- TOC -->
<ul class="simple">
<li><p><a class="reference external" href="#mindsponge-molecular-simulation-practice">MindSPONGE Molecular Simulation Practice</a></p>
<ul>
<li><p><a class="reference external" href="#overview">Overview</a></p></li>
<li><p><a class="reference external" href="#overall-execution">Overall Execution</a></p></li>
<li><p><a class="reference external" href="#preparation">Preparation</a></p></li>
<li><p><a class="reference external" href="#example-of-simulated-polypeptide-aqueous-solution-system">Example of Simulated Polypeptide Aqueous Solution System</a></p>
<ul>
<li><p><a class="reference external" href="#preparing-input-files">Preparing Input Files</a></p></li>
<li><p><a class="reference external" href="#loading-data">Loading Data</a></p></li>
<li><p><a class="reference external" href="#constructing-simulation-process">Constructing Simulation Process</a></p></li>
<li><p><a class="reference external" href="#running-script">Running Script</a></p></li>
<li><p><a class="reference external" href="#running-result">Running Result</a></p></li>
</ul>
</li>
<li><p><a class="reference external" href="#performance">Performance</a></p></li>
</ul>
</li>
</ul>
<!-- /TOC -->
<p><a href="https://gitee.com/mindspore/docs/blob/r1.5/docs/mindscience/docs/source_zh_cn/mindsponge/ala.md" target="_blank"><img src="https://gitee.com/mindspore/docs/raw/r1.5/resource/_static/logo_source_en.png"></a></p>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>Molecular simulation is a method of exploiting computer to simulate the structure and behavior of molecules by using the molecular model at the atomic-level, and then simulate the physical and chemical properties of the molecular system. It builds a set of models and algorithms based on the experiment and through the basic principles, so as to calculate the reasonable molecular structure and molecular behavior.</p>
<p>In recent years, molecular simulation technology has been developed rapidly and widely used in many fields. In the field of medical design, it can be used to study the mechanism of action of virus and drugs. In the field of biological science, it can be used to characterize the multi-level structure and properties of proteins. In the field of materials science, it can be used to study the structure and mechanical properties, material optimization design. In the field of chemistry, it can be used to study surface catalysis and mechanism. In the field of petrochemical industry, it can be used for structure characterization, synthesis design, adsorption and diffusion of molecular sieve catalyst, construction and characterization of polymer chain and structure of crystalline or amorphous bulk polymer, and prediction of important properties including blending behavior, mechanical properties, diffusion, cohesion and so on.</p>
<p>MindSPONGE in MindSpore is molecular simulation library jointly developed by the Gao Yiqin research group of PKU and Shenzhen Bay Laboratory and Huawei MindSpore team. MindSPONGE has the features like high-performance, modularization, etc. MindSPONGE can complete the traditional molecular simulation process efficiently based on MindSpore’s automatic parallelism, graph-computing fusion and other features. MindSPONGE can combine AI methods such as neural networks with traditional molecular simulations by utilizing MindSpore’s feature of automatic differentiation.</p>
<p>This tutorial mainly introduces how to use MindSPONGE, which is built in MindSpore, to perform high performance molecular simulation on the GPU.</p>
<blockquote>
<div><p>Here you can download the complete sample code: <a class="reference external" href="https://gitee.com/mindspore/mindscience/tree/r0.1/MindSPONGE/examples/polypeptide">https://gitee.com/mindspore/mindscience/tree/r0.1/MindSPONGE/examples/polypeptide</a>.</p>
</div></blockquote>
</div>
<div class="section" id="overall-execution">
<h2>Overall Execution<a class="headerlink" href="#overall-execution" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p>Prepare input files of molecular simulation, load data, and determine the molecular system of calculation;</p></li>
<li><p>Define and initialize the MindSPONGE module, make sure the calculation process;</p></li>
<li><p>Run training script, output thermodynamic information of the simulation, and check the result.</p></li>
</ol>
</div>
<div class="section" id="preparation">
<h2>Preparation<a class="headerlink" href="#preparation" title="Permalink to this headline">¶</a></h2>
<p>Before practicing, make sure you have MindSpore installed correctly. If not, you can turn to <a class="reference external" href="https://www.mindspore.cn/install/en">MindSpore Installation</a>.</p>
</div>
<div class="section" id="example-of-simulated-polypeptide-aqueous-solution-system">
<h2>Example of Simulated Polypeptide Aqueous Solution System<a class="headerlink" href="#example-of-simulated-polypeptide-aqueous-solution-system" title="Permalink to this headline">¶</a></h2>
<p>MindSPONGE has advantages of high-performance and usability, and this tutorial uses MindSPONGE to simulate polypeptide aqueous solution system. The simulated system is an alanine tripeptide aqueous solution system.</p>
<div class="section" id="preparing-input-files">
<h3>Preparing Input Files<a class="headerlink" href="#preparing-input-files" title="Permalink to this headline">¶</a></h3>
<p>The simulated system of this tutorial requires 3 input files:</p>
<ul class="simple">
<li><p>Property file (file suffix<code class="docutils literal notranslate"><span class="pre">.in</span></code>), declares the basic conditions for the simulation, parameter control to the whole simulation process.</p></li>
<li><p>Topology file (file suffix<code class="docutils literal notranslate"><span class="pre">.param7</span></code>), describes the topological relations and parameters of the internal molecules in the system.</p></li>
<li><p>Coordinate file (file suffix<code class="docutils literal notranslate"><span class="pre">.rst7</span></code>), describes the initial coordinates of each atom in the system.</p></li>
</ul>
<p>Topology and Coordinate files can be modeling completed by tleap (download address <a class="reference external" href="http://ambermd.org/GetAmber.php">http://ambermd.org/GetAmber.php</a>, comply with the GPL), which is a built-in tool in AmberTools, through the modeling process.</p>
<p>The modeling process is as follows:</p>
<ul class="simple">
<li><p>Open tleap</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>tleap
</pre></div>
</div>
<ul class="simple">
<li><p>Load force field ff14SB that built-in in tleap</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>&gt; <span class="nb">source</span> leaprc.protein.ff14SB
</pre></div>
</div>
<ul class="simple">
<li><p>Build model of alanine tripeptide</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>&gt; <span class="nv">ala</span> <span class="o">=</span> sequence <span class="o">{</span>ALA ALA ALA<span class="o">}</span>
</pre></div>
</div>
<ul class="simple">
<li><p>Use tleap to load its force field tip3p</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>&gt; <span class="nb">source</span> leaprc.water.tip3p
</pre></div>
</div>
<ul class="simple">
<li><p>Use <code class="docutils literal notranslate"><span class="pre">slovatebox</span></code> in tleap to dissolve alanine tripeptide chain, complete the system construction. <code class="docutils literal notranslate"><span class="pre">10.0</span></code>, represents the water we add is over 10 Angstrom far away from the border of molecular we dissolve and the system.</p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>&gt; solvatebox ala TIP3PBOX <span class="m">10</span>.0
</pre></div>
</div>
<ul class="simple">
<li><p>Save constructed system as file suffix <code class="docutils literal notranslate"><span class="pre">parm7</span></code> and <code class="docutils literal notranslate"><span class="pre">rst7</span></code></p></li>
</ul>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>&gt; saveamberparm ala ala.parm7 ala_350_cool_290.rst7
</pre></div>
</div>
<p>After constructing the Topology file(<code class="docutils literal notranslate"><span class="pre">WATER_ALA.parm7</span></code>) and Coordinate file(<code class="docutils literal notranslate"><span class="pre">WATER_ALA_350_COOL_290.RST7</span></code>) that needed through tleap, it is required to declare basic conditions of simulation by Property file, which executes parameter control to the whole simulation process. Take Property file <code class="docutils literal notranslate"><span class="pre">NVT_299_10ns.in</span></code> in this tutorial as an example, contents are as follows:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>NVT 290k
   mode = 1,                              # Simulation mode ; mode=1 for NVT ensemble
   dt= 0.001,                             # Time step in picoseconds (ps). The time length of each MD step
   step_limit = 1,                        # Total step limit, number of MD steps run
   thermostat=1,                          # Thermostat for temperature ; thermostat=0 for Langevin thermostat
   langevin_gamma=1.0,                    # Gamma_ln for Langevin thermostat represents coupling strength between thermostat and system
   target_temperature=290,                # Target temperature
   write_information_interval=1000,       # Output frequency
   amber_irest=0,                         # Input style ;  amber_irest=1 for using amber style input &amp; rst7 file contains veclocity
   cut=10.0,                              # Nonbonded cutoff distance in Angstroms
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">mode</span></code>, Molecular Dynamics (MD) mode, <code class="docutils literal notranslate"><span class="pre">1</span></code> represents the simulation uses <code class="docutils literal notranslate"><span class="pre">NVT</span></code> ensemble.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dt</span></code>, represents the step size in the simulation.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">step_limit</span></code>, represents total steps in the simulation.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">thermostat</span></code>, represents the method of temperature control, <code class="docutils literal notranslate"><span class="pre">1</span></code> represents to use <code class="docutils literal notranslate"><span class="pre">Liujian-Langevin</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">langevin_gamma</span></code>, represents <code class="docutils literal notranslate"><span class="pre">Gamma_In</span></code> parameters in the thermostat.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">target_temperature</span></code>, represents the target temperature.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">amber_irest</span></code>, represents the input mode, <code class="docutils literal notranslate"><span class="pre">0</span></code> represents to use the amber mode to input, and files suffix <code class="docutils literal notranslate"><span class="pre">rst7</span></code> do not include the attribute <code class="docutils literal notranslate"><span class="pre">veclocity</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cut</span></code>, represents the distance of non-bonding interaction.</p></li>
</ul>
</div>
<div class="section" id="loading-data">
<h3>Loading Data<a class="headerlink" href="#loading-data" title="Permalink to this headline">¶</a></h3>
<p>After completing the construction of input files, save files under the path <code class="docutils literal notranslate"><span class="pre">data</span></code> to local workplace, the directory structure is as follows:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>└─polypeptide
    ├─data
    │      NVT_290_10ns.in                 # specific MD simulation setting
    │      WATER_ALA.parm7                 # topology file include atom &amp; residue &amp; bond &amp; nonbond information
    │      WATER_ALA_350_cool_290.rst7     # restart file record atom coordinate &amp; velocity and box information
</pre></div>
</div>
<p>Read the parameters needed by the simulation system from three input files, and use them for calculation in MindSpore. The loading code is as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">argparse</span>
<span class="kn">from</span> <span class="nn">mindspore</span> <span class="kn">import</span> <span class="n">context</span>

<span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s1">&#39;Sponge Controller&#39;</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--i&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;input file&#39;</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--amber_parm&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;paramter file in AMBER type&#39;</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--c&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;initial coordinates file&#39;</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--r&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;restrt&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--x&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;mdcrd&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--o&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;mdout&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--box&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;mdbox&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--device_id&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">args_opt</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>

<span class="n">context</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="n">context</span><span class="o">.</span><span class="n">GRAPH_MODE</span><span class="p">,</span> <span class="n">device_target</span><span class="o">=</span><span class="s2">&quot;GPU&quot;</span><span class="p">,</span> <span class="n">device_id</span><span class="o">=</span><span class="n">args_opt</span><span class="o">.</span><span class="n">device_id</span><span class="p">,</span> <span class="n">save_graphs</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="constructing-simulation-process">
<h3>Constructing Simulation Process<a class="headerlink" href="#constructing-simulation-process" title="Permalink to this headline">¶</a></h3>
<p>By using computational force module and computational energy module defined in MindSPONGE, the system reaches the equilibrium state we need through multiple iterations of molecular dynamics process evolves, and energy and other data obtained in each simulation step is recorded. For convenience, this tutorial set <code class="docutils literal notranslate"><span class="pre">1</span></code> as the number of iterations, the code for constructing the simulation process is as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mindsponge.md.simulation</span> <span class="kn">import</span> <span class="n">Simulation</span>
<span class="kn">from</span> <span class="nn">mindspore</span> <span class="kn">import</span> <span class="n">Tensor</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">simulation</span> <span class="o">=</span> <span class="n">Simulation</span><span class="p">(</span><span class="n">args_opt</span><span class="p">)</span>
    <span class="n">save_path</span> <span class="o">=</span> <span class="n">args_opt</span><span class="o">.</span><span class="n">o</span>
    <span class="k">for</span> <span class="n">steps</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">simulation</span><span class="o">.</span><span class="n">md_info</span><span class="o">.</span><span class="n">step_limit</span><span class="p">):</span>
        <span class="n">print_step</span> <span class="o">=</span> <span class="n">steps</span> <span class="o">%</span> <span class="n">simulation</span><span class="o">.</span><span class="n">ntwx</span>
        <span class="k">if</span> <span class="n">steps</span> <span class="o">==</span> <span class="n">simulation</span><span class="o">.</span><span class="n">md_info</span><span class="o">.</span><span class="n">step_limit</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">print_step</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">temperature</span><span class="p">,</span> <span class="n">total_potential_energy</span><span class="p">,</span> <span class="n">sigma_of_bond_ene</span><span class="p">,</span> <span class="n">sigma_of_angle_ene</span><span class="p">,</span> <span class="n">sigma_of_dihedral_ene</span><span class="p">,</span> \
        <span class="n">nb14_lj_energy_sum</span><span class="p">,</span> <span class="n">nb14_cf_energy_sum</span><span class="p">,</span> <span class="n">LJ_energy_sum</span><span class="p">,</span> <span class="n">ee_ene</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">simulation</span><span class="p">(</span><span class="n">Tensor</span><span class="p">(</span><span class="n">steps</span><span class="p">),</span> <span class="n">Tensor</span><span class="p">(</span><span class="n">print_step</span><span class="p">))</span>
        <span class="c1"># compute energy and temperature</span>

</pre></div>
</div>
</div>
<div class="section" id="running-script">
<h3>Running Script<a class="headerlink" href="#running-script" title="Permalink to this headline">¶</a></h3>
<p>Execute the following command, start <code class="docutils literal notranslate"><span class="pre">main.py</span></code> training script for training:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>python main.py --i /path/NVT_290_10ns.in \
               --amber_parm /path/WATER_ALA.parm7 \
               --c /path/WATER_ALA_350_cool_290.rst7 \
               --o /path/ala_NVT_290_10ns.out
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">i</span></code> is property file of MD simulation, which control simulation process.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">amber_parm</span></code> is topology file of MD simulation system.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">c</span></code> is initial coordinate file we input.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">o</span></code> is log file output after simulation, which records energy and other data obtained in each simulation step.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">path</span></code> is the path to the file, this path is denoted as <code class="docutils literal notranslate"><span class="pre">data</span></code> in this tutorial.</p></li>
</ul>
<p>During training, property file (file suffix<code class="docutils literal notranslate"><span class="pre">.in</span></code>), topology file (file suffix<code class="docutils literal notranslate"><span class="pre">.param7</span></code>) and coordinate file (file suffix<code class="docutils literal notranslate"><span class="pre">.rst7</span></code>) can be used under specified temperatures to perform simulation, compute force and energy, perform molecular dynamics process evolves.</p>
</div>
<div class="section" id="running-result">
<h3>Running Result<a class="headerlink" href="#running-result" title="Permalink to this headline">¶</a></h3>
<p>After training, output file <code class="docutils literal notranslate"><span class="pre">ala_NVT_290_10ns.out</span></code> can be obtained, which records the change of system energy and can be viewed for thermodynamic information of the simulation system. When viewing <code class="docutils literal notranslate"><span class="pre">ala_NVT_290_10ns.out</span></code>, contents are as follows:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>_steps_ _TEMP_ _TOT_POT_ENE_ _BOND_ENE_ _ANGLE_ENE_ _DIHEDRAL_ENE_ _14LJ_ENE_ _14CF_ENE_ _LJ_ENE_ _CF_PME_ENE_
      1 0.788   -5836.521         48.745       0.891         14.904      9.041    194.479  763.169    -6867.750
   ...
</pre></div>
</div>
<p>Types of energy output in the simulation process are recorded, namely iterations(steps), temperature(TEMP), total energy(TOT_POT_E), bond length(BOND_ENE), bond angle(ANGLE_ENE), dihedral angle interactions(DIHEDRAL_ENE), and none-bonded interaction that includes electrostatic force and Leonard-Jones interaction.</p>
</div>
</div>
<div class="section" id="performance">
<h2>Performance<a class="headerlink" href="#performance" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<thead>
<tr>
<th>Parameter</th>
<th>GPU</th>
</tr>
</thead>
<tbody>
<tr>
<td>Resource</td>
<td>GPU (Tesla V100 SXM2); memory 16 GB</td>
</tr>
<tr>
<td>Upload date</td>
<td></td>
</tr>
<tr>
<td>MindSpore version</td>
<td>1.2</td>
</tr>
<tr>
<td>Training parameter</td>
<td>step=1</td>
</tr>
<tr>
<td>Output</td>
<td>numpy file</td>
</tr>
<tr>
<td>Speed</td>
<td>15.0 ms/step</td>
</tr>
<tr>
<td>Total time</td>
<td>5.7 s</td>
</tr>
<tr>
<td>Script</td>
<td><a href="https://gitee.com/mindspore/mindscience/tree/r0.1/MindSPONGE/examples/polypeptide/scripts">Link</a></td>
</tr>
</tbody>
</table></div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="../mindelec/intro_and_install.html" class="btn btn-neutral float-right" title="MindElec Introduction and Installation" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="intro_and_install.html" class="btn btn-neutral float-left" title="MindSPONGE Introduction and Installation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, MindSpore.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   
	<script async="async" src="https://cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</body>
</html>