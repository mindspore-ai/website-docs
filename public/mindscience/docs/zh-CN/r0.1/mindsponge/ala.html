

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>模拟丙氨酸三肽水溶液体系 &mdash; MindSpore master documentation</title>
  

  
   
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  
  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        
        
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="基于AI分子力场模拟分子动力学" href="claisen.html" />
    <link rel="prev" title="MindSPONGE介绍和安装" href="intro_and_install.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> MindSpore
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">MindSPONGE</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="intro_and_install.html">MindSPONGE介绍和安装</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">模拟丙氨酸三肽水溶液体系</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#id2">概述</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id3">整体执行</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id4">准备环节</a></li>
<li class="toctree-l2"><a class="reference internal" href="#id5">模拟多肽水溶液体系示例</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id6">准备输入文件</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id7">加载数据</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id8">构建模拟流程</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id9">运行脚本</a></li>
<li class="toctree-l3"><a class="reference internal" href="#id10">运行结果</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#id11">性能描述</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="claisen.html">基于AI分子力场模拟分子动力学</a></li>
<li class="toctree-l1"><a class="reference internal" href="covid.html">模拟新型冠状病毒Delta变异毒株</a></li>
</ul>
<p class="caption"><span class="caption-text">MindElec</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../mindelec/intro_and_install.html">MindElec介绍和安装</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mindelec/physics_driven.html">物理驱动的AI电磁仿真方法</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mindelec/data_driven.html">数据驱动的AI电磁仿真方法</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mindelec/visualization.html">电磁仿真结果可视化</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MindSpore</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>模拟丙氨酸三肽水溶液体系</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/mindsponge/ala.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="id1">
<h1>模拟丙氨酸三肽水溶液体系<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<!-- TOC -->
<ul class="simple">
<li><p><a class="reference external" href="#%E6%A8%A1%E6%8B%9F%E4%B8%99%E6%B0%A8%E9%85%B8%E4%B8%89%E8%82%BD%E6%B0%B4%E6%BA%B6%E6%B6%B2%E4%BD%93%E7%B3%BB">模拟丙氨酸三肽水溶液体系</a></p>
<ul>
<li><p><a class="reference external" href="#%E6%A6%82%E8%BF%B0">概述</a></p></li>
<li><p><a class="reference external" href="#%E6%95%B4%E4%BD%93%E6%89%A7%E8%A1%8C">整体执行</a></p></li>
<li><p><a class="reference external" href="#%E5%87%86%E5%A4%87%E7%8E%AF%E8%8A%82">准备环节</a></p></li>
<li><p><a class="reference external" href="#%E6%A8%A1%E6%8B%9F%E5%A4%9A%E8%82%BD%E6%B0%B4%E6%BA%B6%E6%B6%B2%E4%BD%93%E7%B3%BB%E7%A4%BA%E4%BE%8B">模拟多肽水溶液体系示例</a></p>
<ul>
<li><p><a class="reference external" href="#%E5%87%86%E5%A4%87%E8%BE%93%E5%85%A5%E6%96%87%E4%BB%B6">准备输入文件</a></p></li>
<li><p><a class="reference external" href="#%E5%8A%A0%E8%BD%BD%E6%95%B0%E6%8D%AE">加载数据</a></p></li>
<li><p><a class="reference external" href="#%E6%9E%84%E5%BB%BA%E6%A8%A1%E6%8B%9F%E6%B5%81%E7%A8%8B">构建模拟流程</a></p></li>
<li><p><a class="reference external" href="#%E8%BF%90%E8%A1%8C%E8%84%9A%E6%9C%AC">运行脚本</a></p></li>
<li><p><a class="reference external" href="#%E8%BF%90%E8%A1%8C%E7%BB%93%E6%9E%9C">运行结果</a></p></li>
</ul>
</li>
<li><p><a class="reference external" href="#%E6%80%A7%E8%83%BD%E6%8F%8F%E8%BF%B0">性能描述</a></p></li>
</ul>
</li>
</ul>
<!-- /TOC -->
<p><a href="https://gitee.com/mindspore/docs/blob/r1.5/docs/mindscience/docs/source_zh_cn/mindsponge/ala.md" target="_blank"><img src="https://gitee.com/mindspore/docs/raw/r1.5/resource/_static/logo_source.png"></a></p>
<div class="section" id="id2">
<h2>概述<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>本篇教程将主要介绍如何在GPU上，使用MindSPONGE进行丙氨酸三肽水溶液体系模拟。</p>
</div>
<div class="section" id="id3">
<h2>整体执行<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<ol class="simple">
<li><p>准备分子模拟输入文件，加载数据，确定计算的分子体系；</p></li>
<li><p>定义 SPONGE 模块并初始化，确定计算流程；</p></li>
<li><p>运行训练脚本，输出模拟的热力学信息文件，并查看结果；</p></li>
</ol>
</div>
<div class="section" id="id4">
<h2>准备环节<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h2>
<p>实践前，确保已经正确安装MindSpore。如果没有，可以通过<a class="reference external" href="https://www.mindspore.cn/install">MindSpore安装页面</a>安装MindSpore。</p>
<p>教程中的体系结构文件建模由AmberTools中自带的tleap工具（下载地址<a class="reference external" href="http://ambermd.org/GetAmber.php">http://ambermd.org/GetAmber.php</a>， 遵守GPL协议）完成。</p>
</div>
<div class="section" id="id5">
<h2>模拟多肽水溶液体系示例<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h2>
<p>SPONGE具有高性能及易用的优势，本教程使用SPONGE模拟多肽水溶液体系。模拟体系为丙氨酸三肽水溶液体系。</p>
<div class="section" id="id6">
<h3>准备输入文件<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h3>
<p>本教程模拟体系中需要加载三个输入文件，分别是：</p>
<ul class="simple">
<li><p>属性文件（后缀为<code class="docutils literal notranslate"><span class="pre">.in</span></code>的文件），声明模拟的基本条件，对整个模拟过程进行参数控制。</p></li>
<li><p>拓扑文件（后缀为<code class="docutils literal notranslate"><span class="pre">.param7</span></code>的文件），拓扑文件描述的是体系内部分子的拓扑关系及各种参数。</p></li>
<li><p>坐标文件（后缀为<code class="docutils literal notranslate"><span class="pre">.rst7</span></code>的文件），坐标文件描述的是每个原子在体系中的初始时刻的坐标及速度。</p></li>
</ul>
<p>拓扑文件和坐标文件可以通过建模过程由AmberTools中自带的tleap工具（下载地址<a class="reference external" href="http://ambermd.org/GetAmber.php">http://ambermd.org/GetAmber.php</a>， 遵守GPL协议）建模完成。建模过程如下：</p>
<ul>
<li><p>打开tleap</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>tleap
</pre></div>
</div>
</li>
<li><p>加载tleap自带的ff14SB力场</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>&gt; <span class="nb">source</span> leaprc.protein.ff14SB
</pre></div>
</div>
</li>
<li><p>搭建丙氨酸三肽模型</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>&gt; <span class="nv">ala</span> <span class="o">=</span> sequence <span class="o">{</span>ALA ALA ALA<span class="o">}</span>
</pre></div>
</div>
</li>
<li><p>利用tleap加载其自带的tip3p力场</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>&gt; <span class="nb">source</span> leaprc.water.tip3p
</pre></div>
</div>
</li>
<li><p>利用tleap中的<code class="docutils literal notranslate"><span class="pre">slovatebox</span></code>溶解丙氨酸三肽链， 完成体系构建。<code class="docutils literal notranslate"><span class="pre">10.0</span></code>代表加入的水距离我们溶解的分子及体系边界至少在<code class="docutils literal notranslate"><span class="pre">10.0</span></code>埃以上</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>&gt; solvatebox ala TIP3PBOX <span class="m">10</span>.0
</pre></div>
</div>
</li>
<li><p>将建好的体系保存成<code class="docutils literal notranslate"><span class="pre">parm7</span></code>及<code class="docutils literal notranslate"><span class="pre">rst7</span></code>文件</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>&gt; saveamberparm ala WATER_ALA.parm7 WATER_ALA_350_cool_290.rst7
</pre></div>
</div>
</li>
</ul>
<p>通过tleap构建了所需要的拓扑文件（<code class="docutils literal notranslate"><span class="pre">WATER_ALA.parm7</span></code>）和坐标文件（<code class="docutils literal notranslate"><span class="pre">WATER_ALA_350_cool_290.rst7</span></code>）后，需要通过属性文件声明模拟的基本条件，对整个模拟过程进行参数控制。以本教程中的属性文件<code class="docutils literal notranslate"><span class="pre">NVT_290_10ns.in</span></code>为例，其文件内容如下：</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>NVT 290k
   mode = 1,                              # Simulation mode ; mode=1 for NVT ensemble
   dt= 0.001,                             # Time step in picoseconds (ps). The time length of each MD step
   step_limit = 1,                        # Total step limit, number of MD steps run
   thermostat=1,                          # Thermostat for temperature ; thermostat=0 for Langevin thermostat
   langevin_gamma=1.0,                    # Gamma_ln for Langevin thermostat represents coupling strength between thermostat and system
   target_temperature=290,                # Target temperature
   write_information_interval=1000,       # Output frequency
   amber_irest=0,                         # Input style ;  amber_irest=1 for using amber style input &amp; rst7 file contains veclocity
   cut=10.0,                              # Nonbonded cutoff distance in Angstroms
</pre></div>
</div>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">mode</span></code>，分子动力学（MD）模式，<code class="docutils literal notranslate"><span class="pre">1</span></code>表示模拟采用<code class="docutils literal notranslate"><span class="pre">NVT</span></code>系综。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dt</span></code>，表示模拟步长。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">step_limit</span></code>，表示模拟总步数。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">thermostat</span></code>，表示控温方法，<code class="docutils literal notranslate"><span class="pre">1</span></code>表示采用的是<code class="docutils literal notranslate"><span class="pre">Liujian-Langevin</span></code>方法。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">langevin_gamma</span></code>，表示控温器中的<code class="docutils literal notranslate"><span class="pre">Gamma_ln</span></code>参数。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">target_temperature</span></code>，表示目标温度。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">amber_irest</span></code>，表示输入方式，<code class="docutils literal notranslate"><span class="pre">0</span></code>表示使用amber方式输入，<code class="docutils literal notranslate"><span class="pre">rst7</span></code>文件中不包含<code class="docutils literal notranslate"><span class="pre">veclocity</span></code>属性。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cut</span></code>，表示非键相互作用的距离。</p></li>
</ul>
</div>
<div class="section" id="id7">
<h3>加载数据<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h3>
<p>完成输入文件的构建后，将文件存放在本地工作区的<code class="docutils literal notranslate"><span class="pre">data</span></code>路径下，其目录结构如下：</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>└─data
    ├─polypeptide
    │      NVT_290_10ns.in                 # specific MD simulation setting
    │      WATER_ALA.parm7                 # topology file include atom &amp; residue &amp; bond &amp; nonbond information
    │      WATER_ALA_350_cool_290.rst7     # restart file record atom coordinate &amp; velocity and box information
</pre></div>
</div>
<p>从三个输入文件中，读取模拟体系需要的参数，用于MindSpore的计算。加载代码如下：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">argparse</span>
<span class="kn">import</span> <span class="nn">time</span>
<span class="kn">from</span> <span class="nn">mindspore</span> <span class="kn">import</span> <span class="n">context</span>

<span class="n">parser</span> <span class="o">=</span> <span class="n">argparse</span><span class="o">.</span><span class="n">ArgumentParser</span><span class="p">(</span><span class="n">description</span><span class="o">=</span><span class="s1">&#39;Sponge Controller&#39;</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--i&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;Input .in file&#39;</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--amber_parm&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;paramter file in AMBER type&#39;</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--c&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;initial coordinates file&#39;</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--r&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;restrt&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--x&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;mdcrd&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--o&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;mdout&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--box&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">str</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="s2">&quot;mdbox&quot;</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">parser</span><span class="o">.</span><span class="n">add_argument</span><span class="p">(</span><span class="s1">&#39;--device_id&#39;</span><span class="p">,</span> <span class="nb">type</span><span class="o">=</span><span class="nb">int</span><span class="p">,</span> <span class="n">default</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">help</span><span class="o">=</span><span class="s1">&#39;&#39;</span><span class="p">)</span>
<span class="n">args_opt</span> <span class="o">=</span> <span class="n">parser</span><span class="o">.</span><span class="n">parse_args</span><span class="p">()</span>

<span class="n">context</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="n">context</span><span class="o">.</span><span class="n">GRAPH_MODE</span><span class="p">,</span> <span class="n">device_target</span><span class="o">=</span><span class="s2">&quot;GPU&quot;</span><span class="p">,</span> <span class="n">device_id</span><span class="o">=</span><span class="n">args_opt</span><span class="o">.</span><span class="n">device_id</span><span class="p">,</span> <span class="n">save_graphs</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="id8">
<h3>构建模拟流程<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h3>
<p>使用SPONGE中定义的计算力模块和计算能量模块，通过多次迭代进行分子动力学过程演化，使得体系达到我们所需要的平衡态，并记录每一个模拟步骤中得到的能量等数据。为了方便起见，本教程的计算迭代次数设置为<code class="docutils literal notranslate"><span class="pre">1</span></code>，其模拟流程构建代码如下：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mindsponge.md.simulation</span> <span class="kn">import</span> <span class="n">Simulation</span>
<span class="kn">from</span> <span class="nn">mindspore</span> <span class="kn">import</span> <span class="n">Tensor</span>

<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="n">simulation</span> <span class="o">=</span> <span class="n">Simulation</span><span class="p">(</span><span class="n">args_opt</span><span class="p">)</span>

    <span class="n">start</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    <span class="n">compiler</span> <span class="o">=</span> <span class="n">args_opt</span><span class="o">.</span><span class="n">o</span>
    <span class="n">save_path</span> <span class="o">=</span> <span class="n">args_opt</span><span class="o">.</span><span class="n">o</span>
    <span class="n">simulation</span><span class="o">.</span><span class="n">main_initial</span><span class="p">()</span>
    <span class="k">for</span> <span class="n">steps</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">simulation</span><span class="o">.</span><span class="n">md_info</span><span class="o">.</span><span class="n">step_limit</span><span class="p">):</span>
        <span class="n">print_step</span> <span class="o">=</span> <span class="n">steps</span> <span class="o">%</span> <span class="n">simulation</span><span class="o">.</span><span class="n">ntwx</span>
        <span class="k">if</span> <span class="n">steps</span> <span class="o">==</span> <span class="n">simulation</span><span class="o">.</span><span class="n">md_info</span><span class="o">.</span><span class="n">step_limit</span> <span class="o">-</span> <span class="mi">1</span><span class="p">:</span>
            <span class="n">print_step</span> <span class="o">=</span> <span class="mi">0</span>
        <span class="n">temperature</span><span class="p">,</span> <span class="n">total_potential_energy</span><span class="p">,</span> <span class="n">sigma_of_bond_ene</span><span class="p">,</span> <span class="n">sigma_of_angle_ene</span><span class="p">,</span> <span class="n">sigma_of_dihedral_ene</span><span class="p">,</span> \
        <span class="n">nb14_lj_energy_sum</span><span class="p">,</span> <span class="n">nb14_cf_energy_sum</span><span class="p">,</span> <span class="n">LJ_energy_sum</span><span class="p">,</span> <span class="n">ee_ene</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">simulation</span><span class="p">(</span><span class="n">Tensor</span><span class="p">(</span><span class="n">steps</span><span class="p">),</span> <span class="n">Tensor</span><span class="p">(</span><span class="n">print_step</span><span class="p">))</span>
        <span class="c1"># compute energy and temperature</span>
</pre></div>
</div>
</div>
<div class="section" id="id9">
<h3>运行脚本<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h3>
<p>执行以下命令，启动训练脚本<code class="docutils literal notranslate"><span class="pre">main.py</span></code>进行训练：</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>python main.py --i /path/NVT_290_10ns.in \
               --amber_parm /path/WATER_ALA.parm7 \
               --c /path/WATER_ALA_350_cool_290.rst7 \
               --o /path/ala_NVT_290_10ns.out
</pre></div>
</div>
<ul class="simple">
<li><p>-<code class="docutils literal notranslate"><span class="pre">i</span></code> 为MD模拟的属性文件，控制模拟过程</p></li>
<li><p>-<code class="docutils literal notranslate"><span class="pre">amber_parm</span></code> 为MD模拟体系的拓扑文件</p></li>
<li><p>-<code class="docutils literal notranslate"><span class="pre">c</span></code> 为我们输入的初始坐标文件</p></li>
<li><p>-<code class="docutils literal notranslate"><span class="pre">o</span></code> 为我们模拟输出的记录文件，其记录了输出每步的能量等信息</p></li>
<li><p>-<code class="docutils literal notranslate"><span class="pre">path</span></code> 为文件所在的路径，在本教程中为<code class="docutils literal notranslate"><span class="pre">data/polypeptide</span></code></p></li>
</ul>
<p>训练过程中，使用属性文件（后缀为<code class="docutils literal notranslate"><span class="pre">.in</span></code>的文件）、拓扑文件（后缀为<code class="docutils literal notranslate"><span class="pre">.param7</span></code>的文件）以及坐标文件（后缀为<code class="docutils literal notranslate"><span class="pre">.rst7</span></code>的文件），通过在指定温度下进行模拟，计算力和能量，进行分子动力学过程演化。</p>
</div>
<div class="section" id="id10">
<h3>运行结果<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h3>
<p>训练结束后，可以得到输出文件<code class="docutils literal notranslate"><span class="pre">ala_NVT_290_10ns.out</span></code>，体系能量变化被记录在了该文件中，可以查看模拟体系的热力学信息。查看<code class="docutils literal notranslate"><span class="pre">ala_NVT_290_10ns.out</span></code>可以看到如下内容：</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>_steps_ _TEMP_ _TOT_POT_ENE_ _BOND_ENE_ _ANGLE_ENE_ _DIHEDRAL_ENE_ _14LJ_ENE_ _14CF_ENE_ _LJ_ENE_ _CF_PME_ENE_
      1 0.788   -5836.521         48.745       0.891         14.904      9.041    194.479  763.169    -6867.750
   ...
</pre></div>
</div>
<p>其中记录了模拟过程中输出的各类能量， 分别是迭代次数（<em>steps</em>），温度（<em>TEMP</em>），总能量（<em>TOT_POT_E</em>），键长（<em>BOND_ENE</em>），键角（<em>ANGLE_ENE</em>），二面角相互作用（<em>DIHEDRAL_ENE</em>），非键相互作用，其包含静电力及Leonard-Jones相互作用。</p>
</div>
</div>
<div class="section" id="id11">
<h2>性能描述<a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h2>
<table border="1" class="docutils">
<thead>
<tr>
<th>Parameter</th>
<th>GPU</th>
</tr>
</thead>
<tbody>
<tr>
<td>Resource</td>
<td>GPU (Tesla V100 SXM2); memory 16 GB</td>
</tr>
<tr>
<td>Upload date</td>
<td></td>
</tr>
<tr>
<td>MindSpore version</td>
<td>1.2</td>
</tr>
<tr>
<td>Training parameter</td>
<td>step=1</td>
</tr>
<tr>
<td>Output</td>
<td>numpy file</td>
</tr>
<tr>
<td>Speed</td>
<td>15.0 ms/step</td>
</tr>
<tr>
<td>Total time</td>
<td>5.7 s</td>
</tr>
<tr>
<td>Script</td>
<td><a href="https://gitee.com/mindspore/mindscience/tree/r0.1/MindSPONGE/examples/polypeptide/scripts">Link</a></td>
</tr>
</tbody>
</table></div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="claisen.html" class="btn btn-neutral float-right" title="基于AI分子力场模拟分子动力学" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="intro_and_install.html" class="btn btn-neutral float-left" title="MindSPONGE介绍和安装" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, MindSpore.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   
	<script async="async" src="https://cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</body>
</html>