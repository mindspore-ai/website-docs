<!DOCTYPE html>
<html class="writer-html5" lang="zh-CN" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>深度概率编程库 &mdash; MindSpore master 文档</title><link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/translations.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <script src="_static/js/theme.js"></script>
    <link rel="index" title="索引" href="genindex.html" />
    <link rel="search" title="搜索" href="search.html" />
    <link rel="next" title="mindspore.nn.probability" href="mindspore.nn.probability.html" />
    <link rel="prev" title="使用贝叶斯神经网络实现图片分类应用" href="using_bnn.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> MindSpore
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="在文档中搜索" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">使用指南</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="using_bnn.html">使用贝叶斯神经网络实现图片分类应用</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">深度概率编程库</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#概率分布">概率分布</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#概率分布类">概率分布类</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#distribution基类">Distribution基类</a></li>
<li class="toctree-l4"><a class="reference internal" href="#伯努利分布bernoulli">伯努利分布(Bernoulli)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#指数分布exponential">指数分布(Exponential)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#几何分布geometric">几何分布(Geometric)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#正态分布normal">正态分布(Normal)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#均匀分布uniform">均匀分布(Uniform)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#多类别分布categorical">多类别分布（Categorical）</a></li>
<li class="toctree-l4"><a class="reference internal" href="#对数正态分布lognormal">对数正态分布(LogNormal)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#柯西分布cauchy">柯西分布(Cauchy)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#耿贝尔极值分布gumbel">耿贝尔极值分布(Gumbel)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#逻辑斯谛分布logistic">逻辑斯谛分布(Logistic)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#泊松分布">泊松分布</a></li>
<li class="toctree-l4"><a class="reference internal" href="#伽马分布gamma">伽马分布(Gamma)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#贝塔分布beta">贝塔分布(Beta)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#概率分布类在pynative模式下的应用">概率分布类在PyNative模式下的应用</a></li>
<li class="toctree-l3"><a class="reference internal" href="#概率分布类在图模式下的应用">概率分布类在图模式下的应用</a></li>
<li class="toctree-l3"><a class="reference internal" href="#transformeddistribution类接口设计">TransformedDistribution类接口设计</a></li>
<li class="toctree-l3"><a class="reference internal" href="#pynative模式下调用transformeddistribution实例">PyNative模式下调用TransformedDistribution实例</a></li>
<li class="toctree-l3"><a class="reference internal" href="#图模式下调用transformeddistribution实例">图模式下调用TransformedDistribution实例</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#概率分布映射">概率分布映射</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#bijector类接口设计">Bijector类接口设计</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#bijector基类">Bijector基类</a></li>
<li class="toctree-l4"><a class="reference internal" href="#幂函数变换映射powertransform">幂函数变换映射(PowerTransform)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#指数变换映射exp">指数变换映射(Exp)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#标量仿射变换映射scalaraffine">标量仿射变换映射(ScalarAffine)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#softplus变换映射softplus">Softplus变换映射(Softplus)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#耿贝尔累计密度函数映射gumbelcdf">耿贝尔累计密度函数映射(GumbelCDF)</a></li>
<li class="toctree-l4"><a class="reference internal" href="#逆映射invert">逆映射(Invert)</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#pynative模式下调用bijector实例">PyNative模式下调用Bijector实例</a></li>
<li class="toctree-l3"><a class="reference internal" href="#图模式下调用bijector实例">图模式下调用Bijector实例</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API参考</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="mindspore.nn.probability.html">mindspore.nn.probability</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">MindSpore</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>深度概率编程库</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/probability.ipynb.txt" rel="nofollow"> 查看页面源码</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS for nbsphinx extension */

/* remove conflicting styling from Sphinx themes */
div.nbinput.container div.prompt *,
div.nboutput.container div.prompt *,
div.nbinput.container div.input_area pre,
div.nboutput.container div.output_area pre,
div.nbinput.container div.input_area .highlight,
div.nboutput.container div.output_area .highlight {
    border: none;
    padding: 0;
    margin: 0;
    box-shadow: none;
}

div.nbinput.container > div[class*=highlight],
div.nboutput.container > div[class*=highlight] {
    margin: 0;
}

div.nbinput.container div.prompt *,
div.nboutput.container div.prompt * {
    background: none;
}

div.nboutput.container div.output_area .highlight,
div.nboutput.container div.output_area pre {
    background: unset;
}

div.nboutput.container div.output_area div.highlight {
    color: unset;  /* override Pygments text color */
}

/* avoid gaps between output lines */
div.nboutput.container div[class*=highlight] pre {
    line-height: normal;
}

/* input/output containers */
div.nbinput.container,
div.nboutput.container {
    display: -webkit-flex;
    display: flex;
    align-items: flex-start;
    margin: 0;
    width: 100%;
}
@media (max-width: 540px) {
    div.nbinput.container,
    div.nboutput.container {
        flex-direction: column;
    }
}

/* input container */
div.nbinput.container {
    padding-top: 5px;
}

/* last container */
div.nblast.container {
    padding-bottom: 5px;
}

/* input prompt */
div.nbinput.container div.prompt pre {
    color: #307FC1;
}

/* output prompt */
div.nboutput.container div.prompt pre {
    color: #BF5B3D;
}

/* all prompts */
div.nbinput.container div.prompt,
div.nboutput.container div.prompt {
    width: 4.5ex;
    padding-top: 5px;
    position: relative;
    user-select: none;
}

div.nbinput.container div.prompt > div,
div.nboutput.container div.prompt > div {
    position: absolute;
    right: 0;
    margin-right: 0.3ex;
}

@media (max-width: 540px) {
    div.nbinput.container div.prompt,
    div.nboutput.container div.prompt {
        width: unset;
        text-align: left;
        padding: 0.4em;
    }
    div.nboutput.container div.prompt.empty {
        padding: 0;
    }

    div.nbinput.container div.prompt > div,
    div.nboutput.container div.prompt > div {
        position: unset;
    }
}

/* disable scrollbars and line breaks on prompts */
div.nbinput.container div.prompt pre,
div.nboutput.container div.prompt pre {
    overflow: hidden;
    white-space: pre;
}

/* input/output area */
div.nbinput.container div.input_area,
div.nboutput.container div.output_area {
    -webkit-flex: 1;
    flex: 1;
    overflow: auto;
}
@media (max-width: 540px) {
    div.nbinput.container div.input_area,
    div.nboutput.container div.output_area {
        width: 100%;
    }
}

/* input area */
div.nbinput.container div.input_area {
    border: 1px solid #e0e0e0;
    border-radius: 2px;
    /*background: #f5f5f5;*/
}

/* override MathJax center alignment in output cells */
div.nboutput.container div[class*=MathJax] {
    text-align: left !important;
}

/* override sphinx.ext.imgmath center alignment in output cells */
div.nboutput.container div.math p {
    text-align: left;
}

/* standard error */
div.nboutput.container div.output_area.stderr {
    background: #fdd;
}

/* ANSI colors */
.ansi-black-fg { color: #3E424D; }
.ansi-black-bg { background-color: #3E424D; }
.ansi-black-intense-fg { color: #282C36; }
.ansi-black-intense-bg { background-color: #282C36; }
.ansi-red-fg { color: #E75C58; }
.ansi-red-bg { background-color: #E75C58; }
.ansi-red-intense-fg { color: #B22B31; }
.ansi-red-intense-bg { background-color: #B22B31; }
.ansi-green-fg { color: #00A250; }
.ansi-green-bg { background-color: #00A250; }
.ansi-green-intense-fg { color: #007427; }
.ansi-green-intense-bg { background-color: #007427; }
.ansi-yellow-fg { color: #DDB62B; }
.ansi-yellow-bg { background-color: #DDB62B; }
.ansi-yellow-intense-fg { color: #B27D12; }
.ansi-yellow-intense-bg { background-color: #B27D12; }
.ansi-blue-fg { color: #208FFB; }
.ansi-blue-bg { background-color: #208FFB; }
.ansi-blue-intense-fg { color: #0065CA; }
.ansi-blue-intense-bg { background-color: #0065CA; }
.ansi-magenta-fg { color: #D160C4; }
.ansi-magenta-bg { background-color: #D160C4; }
.ansi-magenta-intense-fg { color: #A03196; }
.ansi-magenta-intense-bg { background-color: #A03196; }
.ansi-cyan-fg { color: #60C6C8; }
.ansi-cyan-bg { background-color: #60C6C8; }
.ansi-cyan-intense-fg { color: #258F8F; }
.ansi-cyan-intense-bg { background-color: #258F8F; }
.ansi-white-fg { color: #C5C1B4; }
.ansi-white-bg { background-color: #C5C1B4; }
.ansi-white-intense-fg { color: #A1A6B2; }
.ansi-white-intense-bg { background-color: #A1A6B2; }

.ansi-default-inverse-fg { color: #FFFFFF; }
.ansi-default-inverse-bg { background-color: #000000; }

.ansi-bold { font-weight: bold; }
.ansi-underline { text-decoration: underline; }


div.nbinput.container div.input_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight] > pre,
div.nboutput.container div.output_area div[class*=highlight].math,
div.nboutput.container div.output_area.rendered_html,
div.nboutput.container div.output_area > div.output_javascript,
div.nboutput.container div.output_area:not(.rendered_html) > img{
    padding: 5px;
    margin: 0;
}

/* fix copybtn overflow problem in chromium (needed for 'sphinx_copybutton') */
div.nbinput.container div.input_area > div[class^='highlight'],
div.nboutput.container div.output_area > div[class^='highlight']{
    overflow-y: hidden;
}

/* hide copybtn icon on prompts (needed for 'sphinx_copybutton') */
.prompt .copybtn {
    display: none;
}

/* Some additional styling taken form the Jupyter notebook CSS */
.jp-RenderedHTMLCommon table,
div.rendered_html table {
  border: none;
  border-collapse: collapse;
  border-spacing: 0;
  color: black;
  font-size: 12px;
  table-layout: fixed;
}
.jp-RenderedHTMLCommon thead,
div.rendered_html thead {
  border-bottom: 1px solid black;
  vertical-align: bottom;
}
.jp-RenderedHTMLCommon tr,
.jp-RenderedHTMLCommon th,
.jp-RenderedHTMLCommon td,
div.rendered_html tr,
div.rendered_html th,
div.rendered_html td {
  text-align: right;
  vertical-align: middle;
  padding: 0.5em 0.5em;
  line-height: normal;
  white-space: normal;
  max-width: none;
  border: none;
}
.jp-RenderedHTMLCommon th,
div.rendered_html th {
  font-weight: bold;
}
.jp-RenderedHTMLCommon tbody tr:nth-child(odd),
div.rendered_html tbody tr:nth-child(odd) {
  background: #f5f5f5;
}
.jp-RenderedHTMLCommon tbody tr:hover,
div.rendered_html tbody tr:hover {
  background: rgba(66, 165, 245, 0.2);
}

/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="深度概率编程库">
<h1>深度概率编程库<a class="headerlink" href="#深度概率编程库" title="永久链接至标题"></a></h1>
<p><a class="reference external" href="https://obs.dualstack.cn-north-4.myhuaweicloud.com/mindspore-website/notebook/master/probability/zh_cn/mindspore_probability.ipynb"><img alt="下载Notebook" src="https://mindspore-website.obs.cn-north-4.myhuaweicloud.com/website-images/master/resource/_static/logo_notebook.png" /></a> <a class="reference external" href="https://obs.dualstack.cn-north-4.myhuaweicloud.com/mindspore-website/notebook/master/probability/zh_cn/mindspore_probability.py"><img alt="下载样例代码" src="https://mindspore-website.obs.cn-north-4.myhuaweicloud.com/website-images/master/resource/_static/logo_download_code.png" /></a> <a class="reference external" href="https://gitee.com/mindspore/docs/blob/master/docs/probability/docs/source_zh_cn/probability.ipynb"><img alt="查看源文件" src="https://mindspore-website.obs.cn-north-4.myhuaweicloud.com/website-images/master/resource/_static/logo_source.png" /></a></p>
<p>MindSpore深度概率编程的目标是将深度学习和贝叶斯学习结合，包括概率分布、概率分布映射、深度概率网络、概率推断算法、贝叶斯层、贝叶斯转换和贝叶斯工具箱，面向不同的开发者。对于专业的贝叶斯学习用户，提供概率采样、推理算法和模型构建库；另一方面，为不熟悉贝叶斯深度学习的用户提供了高级的API，从而不用更改深度学习编程逻辑，即可利用贝叶斯模型。</p>
<section id="概率分布">
<h2>概率分布<a class="headerlink" href="#概率分布" title="永久链接至标题"></a></h2>
<p>概率分布（<code class="docutils literal notranslate"><span class="pre">mindspore.nn.probability.distribution</span></code>）是概率编程的基础。<code class="docutils literal notranslate"><span class="pre">Distribution</span></code>类提供多样的概率统计接口，例如概率密度函数<code class="docutils literal notranslate"><span class="pre">pdf</span></code>、累积密度函数<code class="docutils literal notranslate"><span class="pre">cdf</span></code>、散度计算<code class="docutils literal notranslate"><span class="pre">kl_loss</span></code>、抽样<code class="docutils literal notranslate"><span class="pre">sample</span></code>等。现有的概率分布实例包括高斯分布，伯努利分布，指数型分布，几何分布和均匀分布。</p>
<section id="概率分布类">
<h3>概率分布类<a class="headerlink" href="#概率分布类" title="永久链接至标题"></a></h3>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Distribution</span></code>：所有概率分布的基类。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Bernoulli</span></code>：伯努利分布。参数为试验成功的概率。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Exponential</span></code>：指数型分布。参数为率参数。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Geometric</span></code>：几何分布。参数为一次伯努利试验成功的概率。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Normal</span></code>：正态（高斯）分布。参数为均值和标准差。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Uniform</span></code>：均匀分布。参数为数轴上的最小值和最大值。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Categorical</span></code>：类别分布。每种类别出现的概率。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">LogNormal</span></code>：对数正态分布。参数为位置参数和规模参数。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Gumbel</span></code>: 耿贝尔极值分布。参数为位置参数和规模参数。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Logistic</span></code>：逻辑斯谛分布。参数为位置参数和规模参数。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Cauchy</span></code>：柯西分布。参数为位置参数和规模参数。</p></li>
</ul>
<section id="distribution基类">
<h4>Distribution基类<a class="headerlink" href="#distribution基类" title="永久链接至标题"></a></h4>
<p><code class="docutils literal notranslate"><span class="pre">Distribution</span></code>是所有概率分布的基类。</p>
<p>接口介绍：<code class="docutils literal notranslate"><span class="pre">Distribution</span></code>类支持的函数包括<code class="docutils literal notranslate"><span class="pre">prob</span></code>、<code class="docutils literal notranslate"><span class="pre">log_prob</span></code>、<code class="docutils literal notranslate"><span class="pre">cdf</span></code>、<code class="docutils literal notranslate"><span class="pre">log_cdf</span></code>、<code class="docutils literal notranslate"><span class="pre">survival_function</span></code>、<code class="docutils literal notranslate"><span class="pre">log_survival</span></code>、<code class="docutils literal notranslate"><span class="pre">mean</span></code>、<code class="docutils literal notranslate"><span class="pre">sd</span></code>、<code class="docutils literal notranslate"><span class="pre">var</span></code>、<code class="docutils literal notranslate"><span class="pre">entropy</span></code>、<code class="docutils literal notranslate"><span class="pre">kl_loss</span></code>、<code class="docutils literal notranslate"><span class="pre">cross_entropy</span></code>和<code class="docutils literal notranslate"><span class="pre">sample</span></code>。分布不同，所需传入的参数也不同。只有在派生类中才能使用，由派生类的函数实现决定参数。</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">prob</span></code>：概率密度函数（PDF）/ 概率质量函数（PMF）。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">log_prob</span></code>：对数似然函数。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cdf</span></code>：累积分布函数（CDF）。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">log_cdf</span></code>：对数累积分布函数。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">survival_function</span></code>：生存函数。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">log_survival</span></code>：对数生存函数。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mean</span></code>：均值。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sd</span></code>：标准差。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">var</span></code>：方差。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">entropy</span></code>：熵。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">kl_loss</span></code>：Kullback-Leibler 散度。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cross_entropy</span></code>：两个概率分布的交叉熵。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sample</span></code>：概率分布的随机抽样。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_dist_args</span></code>：概率分布在网络中使用的参数。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_dist_type</span></code>：概率分布的类型。</p></li>
</ul>
</section>
<section id="伯努利分布bernoulli">
<h4>伯努利分布(Bernoulli)<a class="headerlink" href="#伯努利分布bernoulli" title="永久链接至标题"></a></h4>
<p>伯努利分布，继承自<code class="docutils literal notranslate"><span class="pre">Distribution</span></code>类。</p>
<p>属性：</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Bernoulli.probs</span></code>：返回伯努利试验成功的概率，类型为<code class="docutils literal notranslate"><span class="pre">Tensor</span></code>。</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">Distribution</span></code>基类调用<code class="docutils literal notranslate"><span class="pre">Bernoulli</span></code>中私有接口以实现基类中的公有接口。<code class="docutils literal notranslate"><span class="pre">Bernoulli</span></code>支持的公有接口为：</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">mean</span></code>，<code class="docutils literal notranslate"><span class="pre">mode</span></code>，<code class="docutils literal notranslate"><span class="pre">var</span></code>，<code class="docutils literal notranslate"><span class="pre">sd</span></code>：可选择传入 试验成功的概率<code class="docutils literal notranslate"><span class="pre">probs1</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">entropy</span></code>：可选择传入 试验成功的概率<code class="docutils literal notranslate"><span class="pre">probs1</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cross_entropy</span></code>，<code class="docutils literal notranslate"><span class="pre">kl_loss</span></code>：必须传入<code class="docutils literal notranslate"><span class="pre">dist</span></code>和<code class="docutils literal notranslate"><span class="pre">probs1_b</span></code>。<code class="docutils literal notranslate"><span class="pre">dist</span></code>为另一分布的类型，目前只支持此处为“Bernoulli”。<code class="docutils literal notranslate"><span class="pre">probs1_b</span></code>为分布<code class="docutils literal notranslate"><span class="pre">b</span></code>的试验成功概率。可选择传入分布<code class="docutils literal notranslate"><span class="pre">a</span></code>的参数<code class="docutils literal notranslate"><span class="pre">probs1_a</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">prob</span></code>，<code class="docutils literal notranslate"><span class="pre">log_prob</span></code>，<code class="docutils literal notranslate"><span class="pre">cdf</span></code>，<code class="docutils literal notranslate"><span class="pre">log_cdf</span></code>，<code class="docutils literal notranslate"><span class="pre">survival_function</span></code>，<code class="docutils literal notranslate"><span class="pre">log_survival</span></code>：必须传入<code class="docutils literal notranslate"><span class="pre">value</span></code>。可选择传入试验成功的概率<code class="docutils literal notranslate"><span class="pre">probs</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sample</span></code>：可选择传入样本形状<code class="docutils literal notranslate"><span class="pre">shape</span></code>和试验成功的概率<code class="docutils literal notranslate"><span class="pre">probs1</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_dist_args</span></code>：可选择传入试验成功的概率<code class="docutils literal notranslate"><span class="pre">probs</span></code>。返回值为<code class="docutils literal notranslate"><span class="pre">(probs,)</span></code>，类型为tuple。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_dist_type</span></code>：返回“Bernoulli”。</p></li>
</ul>
</section>
<section id="指数分布exponential">
<h4>指数分布(Exponential)<a class="headerlink" href="#指数分布exponential" title="永久链接至标题"></a></h4>
<p>指数分布，继承自<code class="docutils literal notranslate"><span class="pre">Distribution</span></code>类。</p>
<p>属性：</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Exponential.rate</span></code>：返回分布的率参数，类型为<code class="docutils literal notranslate"><span class="pre">Tensor</span></code>。</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">Distribution</span></code>基类调用<code class="docutils literal notranslate"><span class="pre">Exponential</span></code>私有接口以实现基类中的公有接口。<code class="docutils literal notranslate"><span class="pre">Exponential</span></code>支持的公有接口为：</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">mean</span></code>，<code class="docutils literal notranslate"><span class="pre">mode</span></code>，<code class="docutils literal notranslate"><span class="pre">var</span></code>，<code class="docutils literal notranslate"><span class="pre">sd</span></code>：可选择传入率参数<code class="docutils literal notranslate"><span class="pre">rate</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">entropy</span></code>：可选择传入率参数<code class="docutils literal notranslate"><span class="pre">rate</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cross_entropy</span></code>，<code class="docutils literal notranslate"><span class="pre">kl_loss</span></code>：必须传入<code class="docutils literal notranslate"><span class="pre">dist</span></code>和<code class="docutils literal notranslate"><span class="pre">rate_b</span></code>。<code class="docutils literal notranslate"><span class="pre">dist</span></code>为另一分布的类型的名称， 目前只支持此处为“Exponential”。<code class="docutils literal notranslate"><span class="pre">rate_b</span></code>为分布<code class="docutils literal notranslate"><span class="pre">b</span></code>的率参数。可选择传入分布<code class="docutils literal notranslate"><span class="pre">a</span></code>的参数<code class="docutils literal notranslate"><span class="pre">rate_a</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">prob</span></code>，<code class="docutils literal notranslate"><span class="pre">log_prob</span></code>，<code class="docutils literal notranslate"><span class="pre">cdf</span></code>，<code class="docutils literal notranslate"><span class="pre">log_cdf</span></code>，<code class="docutils literal notranslate"><span class="pre">survival_function</span></code>，<code class="docutils literal notranslate"><span class="pre">log_survival</span></code>：必须传入<code class="docutils literal notranslate"><span class="pre">value</span></code>。可选择传入率参数<code class="docutils literal notranslate"><span class="pre">rate</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sample</span></code>：可选择传入样本形状<code class="docutils literal notranslate"><span class="pre">shape</span></code>和率参数<code class="docutils literal notranslate"><span class="pre">rate</span></code>。返回值为<code class="docutils literal notranslate"><span class="pre">(rate,)</span></code>，类型为tuple。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_dist_args</span></code>：可选择传入率参数<code class="docutils literal notranslate"><span class="pre">rate</span></code>。返回值为<code class="docutils literal notranslate"><span class="pre">(rate,)</span></code>，类型为tuple。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_dist_type</span></code>：返回“Exponential”。</p></li>
</ul>
</section>
<section id="几何分布geometric">
<h4>几何分布(Geometric)<a class="headerlink" href="#几何分布geometric" title="永久链接至标题"></a></h4>
<p>几何分布，继承自<code class="docutils literal notranslate"><span class="pre">Distribution</span></code>类。</p>
<p>属性：</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Geometric.probs</span></code>：返回伯努利试验成功的概率，类型为<code class="docutils literal notranslate"><span class="pre">Tensor</span></code>。</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">Distribution</span></code>基类调用<code class="docutils literal notranslate"><span class="pre">Geometric</span></code>中私有接口以实现基类中的公有接口。<code class="docutils literal notranslate"><span class="pre">Geometric</span></code>支持的公有接口为：</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">mean</span></code>，<code class="docutils literal notranslate"><span class="pre">mode</span></code>，<code class="docutils literal notranslate"><span class="pre">var</span></code>，<code class="docutils literal notranslate"><span class="pre">sd</span></code>：可选择传入试验成功的概率<code class="docutils literal notranslate"><span class="pre">probs1</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">entropy</span></code>：可选择传入 试验成功的概率<code class="docutils literal notranslate"><span class="pre">probs1</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cross_entropy</span></code>，<code class="docutils literal notranslate"><span class="pre">kl_loss</span></code>：必须传入<code class="docutils literal notranslate"><span class="pre">dist</span></code>和<code class="docutils literal notranslate"><span class="pre">probs1_b</span></code>。<code class="docutils literal notranslate"><span class="pre">dist</span></code>为另一分布的类型的名称，目前只支持此处为“Geometric”。<code class="docutils literal notranslate"><span class="pre">probs1_b</span></code>为分布<code class="docutils literal notranslate"><span class="pre">b</span></code>的试验成功概率。可选择传入分布<code class="docutils literal notranslate"><span class="pre">a</span></code>的参数<code class="docutils literal notranslate"><span class="pre">probs1_a</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">prob</span></code>，<code class="docutils literal notranslate"><span class="pre">log_prob</span></code>，<code class="docutils literal notranslate"><span class="pre">cdf</span></code>，<code class="docutils literal notranslate"><span class="pre">log_cdf</span></code>，<code class="docutils literal notranslate"><span class="pre">survival_function</span></code>，<code class="docutils literal notranslate"><span class="pre">log_survival</span></code>：必须传入<code class="docutils literal notranslate"><span class="pre">value</span></code>。可选择传入试验成功的概率<code class="docutils literal notranslate"><span class="pre">probs1</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sample</span></code>：可选择传入样本形状<code class="docutils literal notranslate"><span class="pre">shape</span></code>和试验成功的概率<code class="docutils literal notranslate"><span class="pre">probs1</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_dist_args</span></code>：可选择传入试验成功的概率<code class="docutils literal notranslate"><span class="pre">probs1</span></code>。返回值为<code class="docutils literal notranslate"><span class="pre">(probs1,)</span></code>，类型为tuple。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_dist_type</span></code>：返回“Geometric”。</p></li>
</ul>
</section>
<section id="正态分布normal">
<h4>正态分布(Normal)<a class="headerlink" href="#正态分布normal" title="永久链接至标题"></a></h4>
<p>正态（高斯）分布，继承自<code class="docutils literal notranslate"><span class="pre">Distribution</span></code>类。</p>
<p><code class="docutils literal notranslate"><span class="pre">Distribution</span></code>基类调用<code class="docutils literal notranslate"><span class="pre">Normal</span></code>中私有接口以实现基类中的公有接口。<code class="docutils literal notranslate"><span class="pre">Normal</span></code>支持的公有接口为：</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">mean</span></code>，<code class="docutils literal notranslate"><span class="pre">mode</span></code>，<code class="docutils literal notranslate"><span class="pre">var</span></code>，<code class="docutils literal notranslate"><span class="pre">sd</span></code>：可选择传入分布的参数均值<code class="docutils literal notranslate"><span class="pre">mean</span></code>和标准差<code class="docutils literal notranslate"><span class="pre">sd</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">entropy</span></code>：可选择传入分布的参数均值<code class="docutils literal notranslate"><span class="pre">mean</span></code>和标准差<code class="docutils literal notranslate"><span class="pre">sd</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cross_entropy</span></code>，<code class="docutils literal notranslate"><span class="pre">kl_loss</span></code>：必须传入<code class="docutils literal notranslate"><span class="pre">dist</span></code>，<code class="docutils literal notranslate"><span class="pre">mean_b</span></code>和<code class="docutils literal notranslate"><span class="pre">sd_b</span></code>。<code class="docutils literal notranslate"><span class="pre">dist</span></code>为另一分布的类型的名称，目前只支持此处为“Normal”。</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">mean_b</span></code>和<code class="docutils literal notranslate"><span class="pre">sd_b</span></code>为分布<code class="docutils literal notranslate"><span class="pre">b</span></code>的均值和标准差。可选择传入分布的参数<code class="docutils literal notranslate"><span class="pre">a</span></code>均值<code class="docutils literal notranslate"><span class="pre">mean_a</span></code>和标准差<code class="docutils literal notranslate"><span class="pre">sd_a</span></code>。</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">prob</span></code>，<code class="docutils literal notranslate"><span class="pre">log_prob</span></code>，<code class="docutils literal notranslate"><span class="pre">cdf</span></code>，<code class="docutils literal notranslate"><span class="pre">log_cdf</span></code>，<code class="docutils literal notranslate"><span class="pre">survival_function</span></code>，<code class="docutils literal notranslate"><span class="pre">log_survival</span></code>：必须传入<code class="docutils literal notranslate"><span class="pre">value</span></code>。可选择分布的参数包括均值<code class="docutils literal notranslate"><span class="pre">mean_a</span></code>和标准差<code class="docutils literal notranslate"><span class="pre">sd_a</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sample</span></code>：可选择传入样本形状<code class="docutils literal notranslate"><span class="pre">shape</span></code>和分布的参数包括均值<code class="docutils literal notranslate"><span class="pre">mean_a</span></code>和标准差<code class="docutils literal notranslate"><span class="pre">sd_a</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_dist_args</span></code>：可选择传入分布的参数均值<code class="docutils literal notranslate"><span class="pre">mean</span></code>和标准差<code class="docutils literal notranslate"><span class="pre">sd</span></code>。返回值为<code class="docutils literal notranslate"><span class="pre">(mean,</span> <span class="pre">sd)</span></code>，类型为tuple。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_dist_type</span></code>：返回“Normal”。</p></li>
</ul>
</section>
<section id="均匀分布uniform">
<h4>均匀分布(Uniform)<a class="headerlink" href="#均匀分布uniform" title="永久链接至标题"></a></h4>
<p>均匀分布，继承自<code class="docutils literal notranslate"><span class="pre">Distribution</span></code>类。</p>
<p>属性：</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Uniform.low</span></code>：返回分布的最小值，类型为<code class="docutils literal notranslate"><span class="pre">Tensor</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Uniform.high</span></code>：返回分布的最大值，类型为<code class="docutils literal notranslate"><span class="pre">Tensor</span></code>。</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">Distribution</span></code>基类调用<code class="docutils literal notranslate"><span class="pre">Uniform</span></code>以实现基类中的公有接口。<code class="docutils literal notranslate"><span class="pre">Uniform</span></code>支持的公有接口为：</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">mean</span></code>，<code class="docutils literal notranslate"><span class="pre">mode</span></code>，<code class="docutils literal notranslate"><span class="pre">var</span></code>，<code class="docutils literal notranslate"><span class="pre">sd</span></code>：可选择传入分布的参数最大值<code class="docutils literal notranslate"><span class="pre">high</span></code>和最小值<code class="docutils literal notranslate"><span class="pre">low</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">entropy</span></code>：可选择传入分布的参数最大值<code class="docutils literal notranslate"><span class="pre">high</span></code>和最小值<code class="docutils literal notranslate"><span class="pre">low</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cross_entropy</span></code>，<code class="docutils literal notranslate"><span class="pre">kl_loss</span></code>：必须传入<code class="docutils literal notranslate"><span class="pre">dist</span></code>，<code class="docutils literal notranslate"><span class="pre">high_b</span></code>和<code class="docutils literal notranslate"><span class="pre">low_b</span></code>。<code class="docutils literal notranslate"><span class="pre">dist</span></code>为另一分布的类型的名称，目前只支持此处为“Uniform”。<code class="docutils literal notranslate"><span class="pre">high_b</span></code>和<code class="docutils literal notranslate"><span class="pre">low_b</span></code>为分布<code class="docutils literal notranslate"><span class="pre">b</span></code>的参数。可选择传入分布<code class="docutils literal notranslate"><span class="pre">a</span></code>的参数即最大值<code class="docutils literal notranslate"><span class="pre">high_a</span></code>和最小值<code class="docutils literal notranslate"><span class="pre">low_a</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">prob</span></code>，<code class="docutils literal notranslate"><span class="pre">log_prob</span></code>，<code class="docutils literal notranslate"><span class="pre">cdf</span></code>，<code class="docutils literal notranslate"><span class="pre">log_cdf</span></code>，<code class="docutils literal notranslate"><span class="pre">survival_function</span></code>，<code class="docutils literal notranslate"><span class="pre">log_survival</span></code>：必须传入<code class="docutils literal notranslate"><span class="pre">value</span></code>。可选择传入分布的参数最大值<code class="docutils literal notranslate"><span class="pre">high</span></code>和最小值<code class="docutils literal notranslate"><span class="pre">low</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sample</span></code>：可选择传入<code class="docutils literal notranslate"><span class="pre">shape</span></code>和分布的参数即最大值<code class="docutils literal notranslate"><span class="pre">high</span></code>和最小值<code class="docutils literal notranslate"><span class="pre">low</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_dist_args</span></code>：可选择传入分布的参数最大值<code class="docutils literal notranslate"><span class="pre">high</span></code>和最小值<code class="docutils literal notranslate"><span class="pre">low</span></code>。返回值为<code class="docutils literal notranslate"><span class="pre">(low,</span> <span class="pre">high)</span></code>，类型为tuple。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_dist_type</span></code>：返回“Uniform”。</p></li>
</ul>
</section>
<section id="多类别分布categorical">
<h4>多类别分布（Categorical）<a class="headerlink" href="#多类别分布categorical" title="永久链接至标题"></a></h4>
<p>多类别分布，继承自<code class="docutils literal notranslate"><span class="pre">Distribution</span></code>类。</p>
<p>属性：</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Categorical.probs</span></code>：返回各种类别的概率，类型为<code class="docutils literal notranslate"><span class="pre">Tensor</span></code>。</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">Distribution</span></code>基类调用<code class="docutils literal notranslate"><span class="pre">Categorical</span></code>以实现基类中的公有接口。<code class="docutils literal notranslate"><span class="pre">Categorical</span></code>支持的公有接口为：</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">mean</span></code>，<code class="docutils literal notranslate"><span class="pre">mode</span></code>，<code class="docutils literal notranslate"><span class="pre">var</span></code>，<code class="docutils literal notranslate"><span class="pre">sd</span></code>：可选择传入分布的参数类别概率<code class="docutils literal notranslate"><span class="pre">probs</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">entropy</span></code>：可选择传入分布的参数类别概率<code class="docutils literal notranslate"><span class="pre">probs</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cross_entropy</span></code>，<code class="docutils literal notranslate"><span class="pre">kl_loss</span></code>：必须传入<code class="docutils literal notranslate"><span class="pre">dist</span></code>，<code class="docutils literal notranslate"><span class="pre">probs_b</span></code>。<code class="docutils literal notranslate"><span class="pre">dist</span></code>为另一分布的类型的名称，目前只支持此处为“Categorical”。<code class="docutils literal notranslate"><span class="pre">probs_b</span></code>为分布<code class="docutils literal notranslate"><span class="pre">b</span></code>的参数。可选择传入分布<code class="docutils literal notranslate"><span class="pre">a</span></code>的参数即<code class="docutils literal notranslate"><span class="pre">probs_a</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">prob</span></code>，<code class="docutils literal notranslate"><span class="pre">log_prob</span></code>，<code class="docutils literal notranslate"><span class="pre">cdf</span></code>，<code class="docutils literal notranslate"><span class="pre">log_cdf</span></code>，<code class="docutils literal notranslate"><span class="pre">survival_function</span></code>，<code class="docutils literal notranslate"><span class="pre">log_survival</span></code>：必须传入<code class="docutils literal notranslate"><span class="pre">value</span></code>。可选择传入分布的参数类别概率<code class="docutils literal notranslate"><span class="pre">probs</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sample</span></code>：可选择传入<code class="docutils literal notranslate"><span class="pre">shape</span></code>和类别概率<code class="docutils literal notranslate"><span class="pre">probs</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_dist_args</span></code>：可选择传入分布的参数类别概率<code class="docutils literal notranslate"><span class="pre">probs</span></code>。返回值为<code class="docutils literal notranslate"><span class="pre">(probs,)</span></code>，类型为tuple。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_dist_type</span></code>：返回“Categorical”。</p></li>
</ul>
</section>
<section id="对数正态分布lognormal">
<h4>对数正态分布(LogNormal)<a class="headerlink" href="#对数正态分布lognormal" title="永久链接至标题"></a></h4>
<p>对数正态分布，继承自<code class="docutils literal notranslate"><span class="pre">TransformedDistribution</span></code>类，由<code class="docutils literal notranslate"><span class="pre">Exp</span></code>Bijector 和<code class="docutils literal notranslate"><span class="pre">Normal</span></code>Distribution 构成。</p>
<p>属性：</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">LogNormal.loc</span></code>：返回分布的位置参数，类型为<code class="docutils literal notranslate"><span class="pre">Tensor</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">LogNormal.scale</span></code>：返回分布的规模参数，类型为<code class="docutils literal notranslate"><span class="pre">Tensor</span></code>。</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">Distribution</span></code>基类调用<code class="docutils literal notranslate"><span class="pre">LogNormal</span></code>及<code class="docutils literal notranslate"><span class="pre">TransformedDistribution</span></code>中私有接口以实现基类中的公有接口。<code class="docutils literal notranslate"><span class="pre">LogNormal</span></code>支持的公有接口为：</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">mean</span></code>，<code class="docutils literal notranslate"><span class="pre">mode</span></code>，<code class="docutils literal notranslate"><span class="pre">var</span></code>，<code class="docutils literal notranslate"><span class="pre">sd</span></code>：可选择传入分布的位置参数<code class="docutils literal notranslate"><span class="pre">loc</span></code>和规模参数<code class="docutils literal notranslate"><span class="pre">scale</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">entropy</span></code>：可选择传入分布的位置参数<code class="docutils literal notranslate"><span class="pre">loc</span></code>和规模参数<code class="docutils literal notranslate"><span class="pre">scale</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cross_entropy</span></code>，<code class="docutils literal notranslate"><span class="pre">kl_loss</span></code>：必须传入<code class="docutils literal notranslate"><span class="pre">dist</span></code>，<code class="docutils literal notranslate"><span class="pre">loc_b</span></code>和<code class="docutils literal notranslate"><span class="pre">scale_b</span></code>。<code class="docutils literal notranslate"><span class="pre">dist</span></code>为另一分布的类型的名称，目前只支持此处为“LogNormal”。<code class="docutils literal notranslate"><span class="pre">loc_b</span></code>和<code class="docutils literal notranslate"><span class="pre">scale_b</span></code>为分布<code class="docutils literal notranslate"><span class="pre">b</span></code>的均值和标准差。可选择传入分布的参数<code class="docutils literal notranslate"><span class="pre">a</span></code>均值<code class="docutils literal notranslate"><span class="pre">loc_a</span></code>和标准差<code class="docutils literal notranslate"><span class="pre">sclae_a</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">prob</span></code>，<code class="docutils literal notranslate"><span class="pre">log_prob</span></code>，<code class="docutils literal notranslate"><span class="pre">cdf</span></code>，<code class="docutils literal notranslate"><span class="pre">log_cdf</span></code>，<code class="docutils literal notranslate"><span class="pre">survival_function</span></code>，<code class="docutils literal notranslate"><span class="pre">log_survival</span></code>：必须传入<code class="docutils literal notranslate"><span class="pre">value</span></code>。可选择分布的参数包括均值<code class="docutils literal notranslate"><span class="pre">loc_a</span></code>和标准差<code class="docutils literal notranslate"><span class="pre">scale_a</span></code>。<code class="docutils literal notranslate"><span class="pre">Distribution</span></code>基类调用<code class="docutils literal notranslate"><span class="pre">TransformedDistribution</span></code>私有接口。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sample</span></code>：可选择传入样本形状<code class="docutils literal notranslate"><span class="pre">shape</span></code>和分布的参数包括均值<code class="docutils literal notranslate"><span class="pre">loc_a</span></code>和标准差<code class="docutils literal notranslate"><span class="pre">scale_a</span></code>。<code class="docutils literal notranslate"><span class="pre">Distribution</span></code>基类调用<code class="docutils literal notranslate"><span class="pre">TransformedDistribution</span></code>私有接口。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_dist_args</span></code>：可选择传入分布的位置参数<code class="docutils literal notranslate"><span class="pre">loc</span></code>和规模参数<code class="docutils literal notranslate"><span class="pre">scale</span></code>。返回值为<code class="docutils literal notranslate"><span class="pre">(loc,</span> <span class="pre">scale)</span></code>，类型为tuple。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_dist_type</span></code>：返回“LogNormal”。</p></li>
</ul>
</section>
<section id="柯西分布cauchy">
<h4>柯西分布(Cauchy)<a class="headerlink" href="#柯西分布cauchy" title="永久链接至标题"></a></h4>
<p>柯西分布，继承自<code class="docutils literal notranslate"><span class="pre">Distribution</span></code>类。</p>
<p>属性：</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Cauchy.loc</span></code>：返回分布的位置参数，类型为<code class="docutils literal notranslate"><span class="pre">Tensor</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Cauchy.scale</span></code>：返回分布的规模参数，类型为<code class="docutils literal notranslate"><span class="pre">Tensor</span></code>。</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">Distribution</span></code>基类调用<code class="docutils literal notranslate"><span class="pre">Cauchy</span></code>中私有接口以实现基类中的公有接口。<code class="docutils literal notranslate"><span class="pre">Cauchy</span></code>支持的公有接口为：</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">entropy</span></code>：可选择传入分布的位置参数<code class="docutils literal notranslate"><span class="pre">loc</span></code>和规模参数<code class="docutils literal notranslate"><span class="pre">scale</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cross_entropy</span></code>，<code class="docutils literal notranslate"><span class="pre">kl_loss</span></code>：必须传入<code class="docutils literal notranslate"><span class="pre">dist</span></code>，<code class="docutils literal notranslate"><span class="pre">loc_b</span></code>和<code class="docutils literal notranslate"><span class="pre">scale_b</span></code>。<code class="docutils literal notranslate"><span class="pre">dist</span></code>为另一分布的类型的名称，目前只支持此处为“Cauchy”。<code class="docutils literal notranslate"><span class="pre">loc_b</span></code>和<code class="docutils literal notranslate"><span class="pre">scale_b</span></code>为分布<code class="docutils literal notranslate"><span class="pre">b</span></code>的位置参数和规模参数。可选择传入分布的参数<code class="docutils literal notranslate"><span class="pre">a</span></code>位置<code class="docutils literal notranslate"><span class="pre">loc_a</span></code>和规模<code class="docutils literal notranslate"><span class="pre">scale_a</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">prob</span></code>，<code class="docutils literal notranslate"><span class="pre">log_prob</span></code>，<code class="docutils literal notranslate"><span class="pre">cdf</span></code>，<code class="docutils literal notranslate"><span class="pre">log_cdf</span></code>，<code class="docutils literal notranslate"><span class="pre">survival_function</span></code>，<code class="docutils literal notranslate"><span class="pre">log_survival</span></code>：必须传入<code class="docutils literal notranslate"><span class="pre">value</span></code>。可选择传入分布的位置参数<code class="docutils literal notranslate"><span class="pre">loc</span></code>和规模参数<code class="docutils literal notranslate"><span class="pre">scale</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sample</span></code>：可选择传入样本形状<code class="docutils literal notranslate"><span class="pre">shape</span></code>和分布的参数包括分布的位置参数<code class="docutils literal notranslate"><span class="pre">loc</span></code>和规模参数<code class="docutils literal notranslate"><span class="pre">scale</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_dist_args</span></code>：可选择传入分布的位置参数<code class="docutils literal notranslate"><span class="pre">loc</span></code>和规模参数<code class="docutils literal notranslate"><span class="pre">scale</span></code>。返回值为<code class="docutils literal notranslate"><span class="pre">(loc,</span> <span class="pre">scale)</span></code>，类型为tuple。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_dist_type</span></code>：返回“Cauchy”。</p></li>
</ul>
</section>
<section id="耿贝尔极值分布gumbel">
<h4>耿贝尔极值分布(Gumbel)<a class="headerlink" href="#耿贝尔极值分布gumbel" title="永久链接至标题"></a></h4>
<p>耿贝尔极值分布，继承自<code class="docutils literal notranslate"><span class="pre">TransformedDistribution</span></code>类，由<code class="docutils literal notranslate"><span class="pre">GumbelCDF</span></code>Bijector和<code class="docutils literal notranslate"><span class="pre">Uniform</span></code>Distribution 构成。</p>
<p>属性：</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Gumbel.loc</span></code>：返回分布的位置参数，类型为<code class="docutils literal notranslate"><span class="pre">Tensor</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Gumbel.scale</span></code>：返回分布的规模参数，类型为<code class="docutils literal notranslate"><span class="pre">Tensor</span></code>。</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">Distribution</span></code>基类调用<code class="docutils literal notranslate"><span class="pre">Gumbel</span></code>中私有接口以实现基类中的公有接口。<code class="docutils literal notranslate"><span class="pre">Gumbel</span></code>支持的公有接口为：</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">mean</span></code>，<code class="docutils literal notranslate"><span class="pre">mode</span></code>，<code class="docutils literal notranslate"><span class="pre">var</span></code>，<code class="docutils literal notranslate"><span class="pre">sd</span></code>：无参数 。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">entropy</span></code>：无参数 。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cross_entropy</span></code>，<code class="docutils literal notranslate"><span class="pre">kl_loss</span></code>：必须传入<code class="docutils literal notranslate"><span class="pre">dist</span></code>，<code class="docutils literal notranslate"><span class="pre">loc_b</span></code>和<code class="docutils literal notranslate"><span class="pre">scale_b</span></code>。<code class="docutils literal notranslate"><span class="pre">dist</span></code>为另一分布的类型的名称，目前只支持此处为“Gumbel”。<code class="docutils literal notranslate"><span class="pre">loc_b</span></code>和<code class="docutils literal notranslate"><span class="pre">scale_b</span></code>为分布<code class="docutils literal notranslate"><span class="pre">b</span></code>的位置参数和规模参数。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">prob</span></code>，<code class="docutils literal notranslate"><span class="pre">log_prob</span></code>，<code class="docutils literal notranslate"><span class="pre">cdf</span></code>，<code class="docutils literal notranslate"><span class="pre">log_cdf</span></code>，<code class="docutils literal notranslate"><span class="pre">survival_function</span></code>，<code class="docutils literal notranslate"><span class="pre">log_survival</span></code>：必须传入<code class="docutils literal notranslate"><span class="pre">value</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sample</span></code>：可选择传入样本形状<code class="docutils literal notranslate"><span class="pre">shape</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_dist_args</span></code>：可选择传入分布的位置参数<code class="docutils literal notranslate"><span class="pre">loc</span></code>和规模参数<code class="docutils literal notranslate"><span class="pre">scale</span></code>。返回值为<code class="docutils literal notranslate"><span class="pre">(loc,</span> <span class="pre">scale)</span></code>，类型为tuple。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_dist_type</span></code>：返回“Gumbel”。</p></li>
</ul>
</section>
<section id="逻辑斯谛分布logistic">
<h4>逻辑斯谛分布(Logistic)<a class="headerlink" href="#逻辑斯谛分布logistic" title="永久链接至标题"></a></h4>
<p>逻辑斯谛分布，继承自<code class="docutils literal notranslate"><span class="pre">Distribution</span></code>类。</p>
<p>属性：</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Logistic.loc</span></code>：返回分布的位置参数，类型为<code class="docutils literal notranslate"><span class="pre">Tensor</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Logistic.scale</span></code>：返回分布的规模参数，类型为<code class="docutils literal notranslate"><span class="pre">Tensor</span></code>。</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">Distribution</span></code>基类调用<code class="docutils literal notranslate"><span class="pre">logistic</span></code>中私有接口以实现基类中的公有接口。<code class="docutils literal notranslate"><span class="pre">Logistic</span></code>支持的公有接口为：</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">mean</span></code>，<code class="docutils literal notranslate"><span class="pre">mode</span></code>，<code class="docutils literal notranslate"><span class="pre">var</span></code>，<code class="docutils literal notranslate"><span class="pre">sd</span></code>：可选择传入分布的位置参数<code class="docutils literal notranslate"><span class="pre">loc</span></code>和规模参数<code class="docutils literal notranslate"><span class="pre">scale</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">entropy</span></code>：可选择传入分布的位置参数<code class="docutils literal notranslate"><span class="pre">loc</span></code>和规模参数<code class="docutils literal notranslate"><span class="pre">scale</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">prob</span></code>，<code class="docutils literal notranslate"><span class="pre">log_prob</span></code>，<code class="docutils literal notranslate"><span class="pre">cdf</span></code>，<code class="docutils literal notranslate"><span class="pre">log_cdf</span></code>，<code class="docutils literal notranslate"><span class="pre">survival_function</span></code>，<code class="docutils literal notranslate"><span class="pre">log_survival</span></code>：必须传入<code class="docutils literal notranslate"><span class="pre">value</span></code>。可选择传入分布的位置参数<code class="docutils literal notranslate"><span class="pre">loc</span></code>和规模参数<code class="docutils literal notranslate"><span class="pre">scale</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sample</span></code>：可选择传入样本形状<code class="docutils literal notranslate"><span class="pre">shape</span></code>和分布的参数包括分布的位置参数<code class="docutils literal notranslate"><span class="pre">loc</span></code>和规模参数<code class="docutils literal notranslate"><span class="pre">scale</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_dist_args</span></code>：可选择传入分布的位置参数<code class="docutils literal notranslate"><span class="pre">loc</span></code>和规模参数<code class="docutils literal notranslate"><span class="pre">scale</span></code>。返回值为<code class="docutils literal notranslate"><span class="pre">(loc,</span> <span class="pre">scale)</span></code>，类型为tuple。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_dist_type</span></code>：返回“Logistic”。</p></li>
</ul>
</section>
<section id="泊松分布">
<h4>泊松分布<a class="headerlink" href="#泊松分布" title="永久链接至标题"></a></h4>
<p>泊松分布，继承自<code class="docutils literal notranslate"><span class="pre">Distribution</span></code>类。</p>
<p>属性：</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Poisson.rate</span></code>：返回分布的率参数，类型为Tensor。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Distribution</span></code> 基类调用<code class="docutils literal notranslate"><span class="pre">Poisson</span></code>中私有接口以实现基类中的公有接口。<code class="docutils literal notranslate"><span class="pre">Poisson</span></code>支持的公有接口为：</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mean</span></code>，<code class="docutils literal notranslate"><span class="pre">mode</span></code>，<code class="docutils literal notranslate"><span class="pre">var</span></code>，<code class="docutils literal notranslate"><span class="pre">sd</span></code>：可选择传入分布的率参数 rate 。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">prob</span></code>，<code class="docutils literal notranslate"><span class="pre">log_prob</span></code>，<code class="docutils literal notranslate"><span class="pre">cdf</span></code>，<code class="docutils literal notranslate"><span class="pre">log_cdf</span></code>，<code class="docutils literal notranslate"><span class="pre">survival_function</span></code>，<code class="docutils literal notranslate"><span class="pre">log_survival</span></code>：必须传入<code class="docutils literal notranslate"><span class="pre">value</span></code>。可选择传入分布的率参数<code class="docutils literal notranslate"><span class="pre">rate</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sample</span></code>：可选择传入样本形状shape 和分布的率参数 rate 。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_dist_args</span></code>：可选择传入分布的率参数<code class="docutils literal notranslate"><span class="pre">rate</span></code>。返回值为<code class="docutils literal notranslate"><span class="pre">(rate,)</span></code>，类型为tuple。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_dist_type</span></code>：返回“Poisson”。</p></li>
</ul>
</section>
<section id="伽马分布gamma">
<h4>伽马分布(Gamma)<a class="headerlink" href="#伽马分布gamma" title="永久链接至标题"></a></h4>
<p>伽马分布，继承自 <code class="docutils literal notranslate"><span class="pre">Distribution</span></code> 类。</p>
<p>属性：</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Gamma.concentration</span></code>：返回分布的参数 <code class="docutils literal notranslate"><span class="pre">concentration</span></code> ，类型为<code class="docutils literal notranslate"><span class="pre">Tensor</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Gamma.rate</span></code>：返回分布的参数 <code class="docutils literal notranslate"><span class="pre">rate</span></code> ，类型为<code class="docutils literal notranslate"><span class="pre">Tensor</span></code>。</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">Distribution</span></code> 基类调用 <code class="docutils literal notranslate"><span class="pre">Gamma</span></code> 中私有接口以实现基类中的公有接口。<code class="docutils literal notranslate"><span class="pre">Gamma</span></code> 支持的公有接口为：</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">mean</span></code>，<code class="docutils literal notranslate"><span class="pre">mode</span></code>，<code class="docutils literal notranslate"><span class="pre">sd</span></code>，<code class="docutils literal notranslate"><span class="pre">var</span></code>：可选择传入分布的参数<code class="docutils literal notranslate"><span class="pre">concentration</span></code>和参数<code class="docutils literal notranslate"><span class="pre">rate</span></code> 。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">entropy</span></code>：可选择传入分布的参数<code class="docutils literal notranslate"><span class="pre">concentration</span></code>和参数<code class="docutils literal notranslate"><span class="pre">rate</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">prob</span></code>，<code class="docutils literal notranslate"><span class="pre">log_prob</span></code>，<code class="docutils literal notranslate"><span class="pre">cdf</span></code>，<code class="docutils literal notranslate"><span class="pre">log_cdf</span></code>，<code class="docutils literal notranslate"><span class="pre">survival_function</span></code>，<code class="docutils literal notranslate"><span class="pre">log_survival</span></code>：必须传入<code class="docutils literal notranslate"><span class="pre">value</span></code>。可选择传入分布的参数<code class="docutils literal notranslate"><span class="pre">concentration</span></code>和参数<code class="docutils literal notranslate"><span class="pre">rate</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cross_entropy</span></code>，<code class="docutils literal notranslate"><span class="pre">kl_loss</span></code>：必须传入<code class="docutils literal notranslate"><span class="pre">dist</span></code>，<code class="docutils literal notranslate"><span class="pre">concentration_b</span></code>和<code class="docutils literal notranslate"><span class="pre">rate_b</span></code>。<code class="docutils literal notranslate"><span class="pre">dist</span></code>为另一分布的类型的名称，目前只支持此处为“Gamma”。 <code class="docutils literal notranslate"><span class="pre">concentration_b</span></code>和<code class="docutils literal notranslate"><span class="pre">rate_b</span></code>为分布<code class="docutils literal notranslate"><span class="pre">b</span></code>的参数。可选择传入分布<code class="docutils literal notranslate"><span class="pre">a</span></code>的参数即<code class="docutils literal notranslate"><span class="pre">concentration_a</span></code>和<code class="docutils literal notranslate"><span class="pre">rate_a</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sample</span></code>：可选择传入样本形状<code class="docutils literal notranslate"><span class="pre">shape</span></code>和分布的参数包括分布的参数<code class="docutils literal notranslate"><span class="pre">concentration</span></code>和参数<code class="docutils literal notranslate"><span class="pre">rate</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_dist_args</span></code>：可选择传入分布的参数<code class="docutils literal notranslate"><span class="pre">concentration</span></code>和参数<code class="docutils literal notranslate"><span class="pre">rate</span></code>。返回值为<code class="docutils literal notranslate"><span class="pre">(concentration,</span> <span class="pre">rate)</span></code>，类型为tuple。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_dist_type</span></code>：返回“Gamma”。</p></li>
</ul>
</section>
<section id="贝塔分布beta">
<h4>贝塔分布(Beta)<a class="headerlink" href="#贝塔分布beta" title="永久链接至标题"></a></h4>
<p>贝塔分布，继承自 <code class="docutils literal notranslate"><span class="pre">Distribution</span></code> 类。</p>
<p>属性：</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Beta.concentration1</span></code>：返回分布的参数 <code class="docutils literal notranslate"><span class="pre">concentration1</span></code> ，类型为<code class="docutils literal notranslate"><span class="pre">Tensor</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Beta.concentration0</span></code>：返回分布的参数 <code class="docutils literal notranslate"><span class="pre">concentration0</span></code> ，类型为<code class="docutils literal notranslate"><span class="pre">Tensor</span></code>。</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">Distribution</span></code> 基类调用 <code class="docutils literal notranslate"><span class="pre">Beta</span></code> 中私有接口以实现基类中的公有接口。<code class="docutils literal notranslate"><span class="pre">Beta</span></code> 支持的公有接口为：</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">mean</span></code>，<code class="docutils literal notranslate"><span class="pre">mode</span></code>，<code class="docutils literal notranslate"><span class="pre">sd</span></code>，<code class="docutils literal notranslate"><span class="pre">var</span></code>：可选择传入分布的参数<code class="docutils literal notranslate"><span class="pre">concentration1</span></code>和参数<code class="docutils literal notranslate"><span class="pre">concentration0</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">entropy</span></code>：可选择传入分布的参数<code class="docutils literal notranslate"><span class="pre">concentration1</span></code>和参数<code class="docutils literal notranslate"><span class="pre">concentration0</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">prob</span></code>，<code class="docutils literal notranslate"><span class="pre">log_prob</span></code>：必须传入<code class="docutils literal notranslate"><span class="pre">value</span></code>。可选择传入分布的参数<code class="docutils literal notranslate"><span class="pre">concentration1</span></code>和参数<code class="docutils literal notranslate"><span class="pre">concentration0</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">cross_entropy</span></code>，<code class="docutils literal notranslate"><span class="pre">kl_loss</span></code>：必须传入<code class="docutils literal notranslate"><span class="pre">dist</span></code>，<code class="docutils literal notranslate"><span class="pre">concentration1_b</span></code>和<code class="docutils literal notranslate"><span class="pre">concentration1_b</span></code>。<code class="docutils literal notranslate"><span class="pre">dist</span></code>为另一分布的类型的名称，目前只支持此处为“Beta”。<code class="docutils literal notranslate"><span class="pre">concentration1_b</span></code>和<code class="docutils literal notranslate"><span class="pre">concentration1_b</span></code>为分布<code class="docutils literal notranslate"><span class="pre">b</span></code>的参数。可选择传入分布<code class="docutils literal notranslate"><span class="pre">a</span></code>的参数即<code class="docutils literal notranslate"><span class="pre">concentration1_a</span></code>和<code class="docutils literal notranslate"><span class="pre">concentration0_a</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sample</span></code>：可选择传入样本形状<code class="docutils literal notranslate"><span class="pre">shape</span></code>和分布的参数包括分布的位置参数<code class="docutils literal notranslate"><span class="pre">loc</span></code>和规模参数<code class="docutils literal notranslate"><span class="pre">scale</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_dist_args</span></code>：可选择传入分布的参数<code class="docutils literal notranslate"><span class="pre">concentration1</span></code>和参数<code class="docutils literal notranslate"><span class="pre">concentration0</span></code>。返回值为<code class="docutils literal notranslate"><span class="pre">(concentration1,</span> <span class="pre">concentration0)</span></code>，类型为tuple。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">get_dist_type</span></code>：返回“Beta”。</p></li>
</ul>
</section>
</section>
<section id="概率分布类在pynative模式下的应用">
<h3>概率分布类在PyNative模式下的应用<a class="headerlink" href="#概率分布类在pynative模式下的应用" title="永久链接至标题"></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">Distribution</span></code>子类可在PyNative模式下使用。</p>
<p>以<code class="docutils literal notranslate"><span class="pre">Normal</span></code>为例， 创建一个均值为0.0、标准差为1.0的正态分布，然后计算相关函数。</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[1]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mindspore</span> <span class="k">as</span> <span class="nn">ms</span>
<span class="kn">import</span> <span class="nn">mindspore.nn.probability.distribution</span> <span class="k">as</span> <span class="nn">msd</span>

<span class="n">ms</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">PYNATIVE_MODE</span><span class="p">,</span> <span class="n">device_target</span><span class="o">=</span><span class="s2">&quot;GPU&quot;</span><span class="p">)</span>

<span class="n">my_normal</span> <span class="o">=</span> <span class="n">msd</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

<span class="n">mean</span> <span class="o">=</span> <span class="n">my_normal</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="n">var</span> <span class="o">=</span> <span class="n">my_normal</span><span class="o">.</span><span class="n">var</span><span class="p">()</span>
<span class="n">entropy</span> <span class="o">=</span> <span class="n">my_normal</span><span class="o">.</span><span class="n">entropy</span><span class="p">()</span>

<span class="n">value</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">prob</span> <span class="o">=</span> <span class="n">my_normal</span><span class="o">.</span><span class="n">prob</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
<span class="n">cdf</span> <span class="o">=</span> <span class="n">my_normal</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>

<span class="n">mean_b</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">sd_b</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><span class="mf">2.0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">kl</span> <span class="o">=</span> <span class="n">my_normal</span><span class="o">.</span><span class="n">kl_loss</span><span class="p">(</span><span class="s1">&#39;Normal&#39;</span><span class="p">,</span> <span class="n">mean_b</span><span class="p">,</span> <span class="n">sd_b</span><span class="p">)</span>

<span class="c1"># get the distribution args as a tuple</span>
<span class="n">dist_arg</span> <span class="o">=</span> <span class="n">my_normal</span><span class="o">.</span><span class="n">get_dist_args</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;mean: &quot;</span><span class="p">,</span> <span class="n">mean</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;var: &quot;</span><span class="p">,</span> <span class="n">var</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;entropy: &quot;</span><span class="p">,</span> <span class="n">entropy</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;prob: &quot;</span><span class="p">,</span> <span class="n">prob</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;cdf: &quot;</span><span class="p">,</span> <span class="n">cdf</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;kl: &quot;</span><span class="p">,</span> <span class="n">kl</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;dist_arg: &quot;</span><span class="p">,</span> <span class="n">dist_arg</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
mean:  0.0
var:  1.0
entropy:  1.4189385
prob:  [0.35206532 0.3989423  0.35206532]
cdf:  [0.30853754 0.5        0.69146246]
kl:  0.44314718
dist_arg:  (Tensor(shape=[], dtype=Float32, value= 0), Tensor(shape=[], dtype=Float32, value= 1))
</pre></div></div>
</div>
</section>
<section id="概率分布类在图模式下的应用">
<h3>概率分布类在图模式下的应用<a class="headerlink" href="#概率分布类在图模式下的应用" title="永久链接至标题"></a></h3>
<p>在图模式下，<code class="docutils literal notranslate"><span class="pre">Distribution</span></code>子类可用在网络中。</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[2]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mindspore.nn</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="kn">import</span> <span class="nn">mindspore</span> <span class="k">as</span> <span class="nn">ms</span>
<span class="kn">import</span> <span class="nn">mindspore.nn.probability.distribution</span> <span class="k">as</span> <span class="nn">msd</span>
<span class="n">ms</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">GRAPH_MODE</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Net</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Cell</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Net</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">normal</span> <span class="o">=</span> <span class="n">msd</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">construct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sd</span><span class="p">):</span>
        <span class="n">pdf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">normal</span><span class="o">.</span><span class="n">prob</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="n">kl</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">normal</span><span class="o">.</span><span class="n">kl_loss</span><span class="p">(</span><span class="s2">&quot;Normal&quot;</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sd</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">pdf</span><span class="p">,</span> <span class="n">kl</span>

<span class="n">net</span> <span class="o">=</span> <span class="n">Net</span><span class="p">()</span>
<span class="n">value</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([</span><span class="o">-</span><span class="mf">0.5</span><span class="p">,</span> <span class="mf">0.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">mean</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">sd</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">pdf</span><span class="p">,</span> <span class="n">kl</span> <span class="o">=</span> <span class="n">net</span><span class="p">(</span><span class="n">value</span><span class="p">,</span> <span class="n">mean</span><span class="p">,</span> <span class="n">sd</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;pdf: &quot;</span><span class="p">,</span> <span class="n">pdf</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;kl: &quot;</span><span class="p">,</span> <span class="n">kl</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
pdf:  [0.35206532 0.3989423  0.35206532]
kl:  0.5
</pre></div></div>
</div>
</section>
<section id="transformeddistribution类接口设计">
<h3>TransformedDistribution类接口设计<a class="headerlink" href="#transformeddistribution类接口设计" title="永久链接至标题"></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">TransformedDistribution</span></code>继承自<code class="docutils literal notranslate"><span class="pre">Distribution</span></code>，是可通过映射f(x)变化得到的数学分布的基类。其接口包括：</p>
<ol class="arabic simple">
<li><p>属性</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">bijector</span></code>：返回分布的变换方法。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">distribution</span></code>：返回原始分布。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">is_linear_transformation</span></code>：返回线性变换标志。</p></li>
</ul>
</li>
<li><p>接口函数（以下接口函数的参数与构造函数中<code class="docutils literal notranslate"><span class="pre">distribution</span></code>的对应接口的参数相同）。</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">cdf</span></code>：累积分布函数（CDF）。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">log_cdf</span></code>：对数累积分布函数。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">survival_function</span></code>：生存函数。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">log_survival</span></code>：对数生存函数。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">prob</span></code>：概率密度函数（PDF）/ 概率质量函数（PMF）。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">log_prob</span></code>：对数似然函数。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">sample</span></code>：随机取样。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">mean</span></code>：无参数。只有当<code class="docutils literal notranslate"><span class="pre">Bijector.is_constant_jacobian=true</span></code>时可调用。</p></li>
</ul>
</li>
</ol>
</section>
<section id="pynative模式下调用transformeddistribution实例">
<h3>PyNative模式下调用TransformedDistribution实例<a class="headerlink" href="#pynative模式下调用transformeddistribution实例" title="永久链接至标题"></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">TransformedDistribution</span></code>子类可在PyNative模式下使用。</p>
<p>这里构造一个<code class="docutils literal notranslate"><span class="pre">TransformedDistribution</span></code>实例，使用<code class="docutils literal notranslate"><span class="pre">Normal</span></code>分布作为需要变换的分布类，使用<code class="docutils literal notranslate"><span class="pre">Exp</span></code>作为映射变换，可以生成<code class="docutils literal notranslate"><span class="pre">LogNormal</span></code>分布。</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[3]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">mindspore.nn</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="kn">import</span> <span class="nn">mindspore.nn.probability.bijector</span> <span class="k">as</span> <span class="nn">msb</span>
<span class="kn">import</span> <span class="nn">mindspore.nn.probability.distribution</span> <span class="k">as</span> <span class="nn">msd</span>
<span class="kn">import</span> <span class="nn">mindspore</span> <span class="k">as</span> <span class="nn">ms</span>

<span class="n">ms</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">PYNATIVE_MODE</span><span class="p">)</span>

<span class="n">normal</span> <span class="o">=</span> <span class="n">msd</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">exp</span> <span class="o">=</span> <span class="n">msb</span><span class="o">.</span><span class="n">Exp</span><span class="p">()</span>
<span class="n">LogNormal</span> <span class="o">=</span> <span class="n">msd</span><span class="o">.</span><span class="n">TransformedDistribution</span><span class="p">(</span><span class="n">exp</span><span class="p">,</span> <span class="n">normal</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;LogNormal&quot;</span><span class="p">)</span>

<span class="c1"># compute cumulative distribution function</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">,</span> <span class="mf">10.0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">tx</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">cdf</span> <span class="o">=</span> <span class="n">LogNormal</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">tx</span><span class="p">)</span>

<span class="c1"># generate samples from the distribution</span>
<span class="n">shape</span> <span class="o">=</span> <span class="p">((</span><span class="mi">3</span><span class="p">,</span> <span class="mi">2</span><span class="p">))</span>
<span class="n">sample</span> <span class="o">=</span> <span class="n">LogNormal</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">shape</span><span class="p">)</span>

<span class="c1"># get information of the distribution</span>
<span class="nb">print</span><span class="p">(</span><span class="n">LogNormal</span><span class="p">)</span>
<span class="c1"># get information of the underlying distribution and the bijector separately</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;underlying distribution:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">LogNormal</span><span class="o">.</span><span class="n">distribution</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;bijector:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">LogNormal</span><span class="o">.</span><span class="n">bijector</span><span class="p">)</span>
<span class="c1"># get the computation results</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;cdf:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">cdf</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;sample:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">sample</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
TransformedDistribution&lt;
  (_bijector): Exp&lt;exp&gt;
  (_distribution): Normal&lt;mean = 0.0, standard deviation = 1.0&gt;
  &gt;
underlying distribution:
 Normal&lt;mean = 0.0, standard deviation = 1.0&gt;
bijector:
 Exp&lt;exp&gt;
cdf:
 [0.7558914 0.9462397 0.9893489]
sample:
 (3, 2)
</pre></div></div>
</div>
<p>当构造<code class="docutils literal notranslate"><span class="pre">TransformedDistribution</span></code>映射变换的<code class="docutils literal notranslate"><span class="pre">is_constant_jacobian</span> <span class="pre">=</span> <span class="pre">true</span></code>时（如<code class="docutils literal notranslate"><span class="pre">ScalarAffine</span></code>)，构造的<code class="docutils literal notranslate"><span class="pre">TransformedDistribution</span></code>实例可以使用直接使用<code class="docutils literal notranslate"><span class="pre">mean</span></code>接口计算均值，例如：</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[4]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">normal</span> <span class="o">=</span> <span class="n">msd</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">scalaraffine</span> <span class="o">=</span> <span class="n">msb</span><span class="o">.</span><span class="n">ScalarAffine</span><span class="p">(</span><span class="mf">1.0</span><span class="p">,</span> <span class="mf">2.0</span><span class="p">)</span>
<span class="n">trans_dist</span> <span class="o">=</span> <span class="n">msd</span><span class="o">.</span><span class="n">TransformedDistribution</span><span class="p">(</span><span class="n">scalaraffine</span><span class="p">,</span> <span class="n">normal</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="n">mean</span> <span class="o">=</span> <span class="n">trans_dist</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="n">mean</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
2.0
</pre></div></div>
</div>
</section>
<section id="图模式下调用transformeddistribution实例">
<h3>图模式下调用TransformedDistribution实例<a class="headerlink" href="#图模式下调用transformeddistribution实例" title="永久链接至标题"></a></h3>
<p>在图模式下，<code class="docutils literal notranslate"><span class="pre">TransformedDistribution</span></code>类可用在网络中。</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[5]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">mindspore.nn</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="kn">import</span> <span class="nn">mindspore</span> <span class="k">as</span> <span class="nn">ms</span>
<span class="kn">import</span> <span class="nn">mindspore.nn.probability.bijector</span> <span class="k">as</span> <span class="nn">msb</span>
<span class="kn">import</span> <span class="nn">mindspore.nn.probability.distribution</span> <span class="k">as</span> <span class="nn">msd</span>
<span class="n">ms</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">GRAPH_MODE</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Net</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Cell</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shape</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s1">&#39;transformed_distribution&#39;</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Net</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="c1"># create TransformedDistribution distribution</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">exp</span> <span class="o">=</span> <span class="n">msb</span><span class="o">.</span><span class="n">Exp</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">normal</span> <span class="o">=</span> <span class="n">msd</span><span class="o">.</span><span class="n">Normal</span><span class="p">(</span><span class="mf">0.0</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">dtype</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">lognormal</span> <span class="o">=</span> <span class="n">msd</span><span class="o">.</span><span class="n">TransformedDistribution</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">exp</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">normal</span><span class="p">,</span> <span class="n">seed</span><span class="o">=</span><span class="n">seed</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="n">name</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">shape</span> <span class="o">=</span> <span class="n">shape</span>

    <span class="k">def</span> <span class="nf">construct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="n">cdf</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lognormal</span><span class="o">.</span><span class="n">cdf</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="n">sample</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">lognormal</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">cdf</span><span class="p">,</span> <span class="n">sample</span>

<span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="n">net</span> <span class="o">=</span> <span class="n">Net</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">shape</span><span class="p">,</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;LogNormal&quot;</span><span class="p">)</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">tx</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">cdf</span><span class="p">,</span> <span class="n">sample</span> <span class="o">=</span> <span class="n">net</span><span class="p">(</span><span class="n">tx</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;cdf: &quot;</span><span class="p">,</span> <span class="n">cdf</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;sample: &quot;</span><span class="p">,</span> <span class="n">sample</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
cdf:  [0.7558914  0.86403143 0.9171715  0.9462397 ]
sample:  (2, 3)
</pre></div></div>
</div>
</section>
</section>
<section id="概率分布映射">
<h2>概率分布映射<a class="headerlink" href="#概率分布映射" title="永久链接至标题"></a></h2>
<p>Bijector（<code class="docutils literal notranslate"><span class="pre">mindspore.nn.probability.bijector</span></code>）是概率编程的基本组成部分。Bijector描述了一种随机变量的变换方法，可以通过一个已有的随机变量X和一个映射函数f生成一个新的随机变量<span class="math notranslate nohighlight">\(Y = f(x)\)</span>。</p>
<p><code class="docutils literal notranslate"><span class="pre">Bijector</span></code>提供了映射相关的四种变换方法。它可以当做算子直接使用，也可以作用在某个随机变量<code class="docutils literal notranslate"><span class="pre">Distribution</span></code>类实例上生成新的随机变量的<code class="docutils literal notranslate"><span class="pre">Distribution</span></code>类实例。</p>
<section id="bijector类接口设计">
<h3>Bijector类接口设计<a class="headerlink" href="#bijector类接口设计" title="永久链接至标题"></a></h3>
<section id="bijector基类">
<h4>Bijector基类<a class="headerlink" href="#bijector基类" title="永久链接至标题"></a></h4>
<p><code class="docutils literal notranslate"><span class="pre">Bijector</span></code>类是所有概率分布映射的基类。其接口包括：</p>
<ol class="arabic simple">
<li><p>属性</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">name</span></code>：返回<code class="docutils literal notranslate"><span class="pre">name</span></code>的值。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">is_dtype</span></code>：返回<code class="docutils literal notranslate"><span class="pre">dtype</span></code>的值。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">parameter</span></code>：返回<code class="docutils literal notranslate"><span class="pre">parameter</span></code>的值。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">is_constant_jacobian</span></code>：返回<code class="docutils literal notranslate"><span class="pre">is_constant_jacobian</span></code>的值。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">is_injective</span></code>：返回<code class="docutils literal notranslate"><span class="pre">is_injective</span></code>的值。</p></li>
</ul>
</li>
<li><p>映射函数</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">forward</span></code>：正向映射，创建派生类后由派生类的<code class="docutils literal notranslate"><span class="pre">_forward</span></code>决定参数。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">inverse</span></code>：反向映射，创建派生类后由派生类的<code class="docutils literal notranslate"><span class="pre">_inverse</span></code>决定参数。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">forward_log_jacobian</span></code>：正向映射的导数的对数，创建派生类后由派生类的<code class="docutils literal notranslate"><span class="pre">_forward_log_jacobian</span></code>决定参数。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">inverse_log_jacobian</span></code>：反向映射的导数的对数，创建派生类后由派生类的<code class="docutils literal notranslate"><span class="pre">_inverse_log_jacobian</span></code>决定参数。</p></li>
</ul>
</li>
</ol>
<p><code class="docutils literal notranslate"><span class="pre">Bijector</span></code>作为函数调用：输入是一个<code class="docutils literal notranslate"><span class="pre">Distribution</span></code>类：生成一个<code class="docutils literal notranslate"><span class="pre">TransformedDistribution</span></code> <em>（不可在图内调用）</em>。</p>
</section>
<section id="幂函数变换映射powertransform">
<h4>幂函数变换映射(PowerTransform)<a class="headerlink" href="#幂函数变换映射powertransform" title="永久链接至标题"></a></h4>
<p><code class="docutils literal notranslate"><span class="pre">PowerTransform</span></code>做如下变量替换：<span class="math notranslate nohighlight">\(Y = g(X) = {(1 + X \times power)}^{1 / power}\)</span>。其接口包括：</p>
<ol class="arabic simple">
<li><p>属性</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">power</span></code>：返回<code class="docutils literal notranslate"><span class="pre">power</span></code>的值，类型为<code class="docutils literal notranslate"><span class="pre">Tensor</span></code>。</p></li>
</ul>
</li>
<li><p>映射函数</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">forward</span></code>：正向映射，输入为<code class="docutils literal notranslate"><span class="pre">Tensor</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">inverse</span></code>：反向映射，输入为<code class="docutils literal notranslate"><span class="pre">Tensor</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">forward_log_jacobian</span></code>：正向映射的导数的对数，输入为<code class="docutils literal notranslate"><span class="pre">Tensor</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">inverse_log_jacobian</span></code>：反向映射的导数的对数，输入为<code class="docutils literal notranslate"><span class="pre">Tensor</span></code>。</p></li>
</ul>
</li>
</ol>
</section>
<section id="指数变换映射exp">
<h4>指数变换映射(Exp)<a class="headerlink" href="#指数变换映射exp" title="永久链接至标题"></a></h4>
<p><code class="docutils literal notranslate"><span class="pre">Exp</span></code>做如下变量替换：<span class="math notranslate nohighlight">\(Y = g(X)= exp(X)\)</span>。其接口包括：</p>
<p>映射函数</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">forward</span></code>：正向映射，输入为<code class="docutils literal notranslate"><span class="pre">Tensor</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">inverse</span></code>：反向映射，输入为<code class="docutils literal notranslate"><span class="pre">Tensor</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">forward_log_jacobian</span></code>：正向映射的导数的对数，输入为<code class="docutils literal notranslate"><span class="pre">Tensor</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">inverse_log_jacobian</span></code>：反向映射的导数的对数，输入为<code class="docutils literal notranslate"><span class="pre">Tensor</span></code>。</p></li>
</ul>
</section>
<section id="标量仿射变换映射scalaraffine">
<h4>标量仿射变换映射(ScalarAffine)<a class="headerlink" href="#标量仿射变换映射scalaraffine" title="永久链接至标题"></a></h4>
<p><code class="docutils literal notranslate"><span class="pre">ScalarAffine</span></code>做如下变量替换：<span class="math notranslate nohighlight">\(Y = g(X) = scale\times X + shift\)</span>。其接口包括：</p>
<ol class="arabic simple">
<li><p>属性</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">scale</span></code>：返回<code class="docutils literal notranslate"><span class="pre">scale</span></code>的值，类型为<code class="docutils literal notranslate"><span class="pre">Tensor</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">shift</span></code>：返回<code class="docutils literal notranslate"><span class="pre">shift</span></code>的值，类型为<code class="docutils literal notranslate"><span class="pre">Tensor</span></code>。</p></li>
</ul>
</li>
<li><p>映射函数</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">forward</span></code>：正向映射，输入为<code class="docutils literal notranslate"><span class="pre">Tensor</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">inverse</span></code>：反向映射，输入为<code class="docutils literal notranslate"><span class="pre">Tensor</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">forward_log_jacobian</span></code>：正向映射的导数的对数，输入为<code class="docutils literal notranslate"><span class="pre">Tensor</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">inverse_log_jacobian</span></code>：反向映射的导数的对数，输入为<code class="docutils literal notranslate"><span class="pre">Tensor</span></code>。</p></li>
</ul>
</li>
</ol>
</section>
<section id="softplus变换映射softplus">
<h4>Softplus变换映射(Softplus)<a class="headerlink" href="#softplus变换映射softplus" title="永久链接至标题"></a></h4>
<p><code class="docutils literal notranslate"><span class="pre">Softplus</span></code>做如下变量替换：<span class="math notranslate nohighlight">\(Y = g(X) = \frac{log(1 + e ^ {sharpness \times X}\ \ \ \ \ \ )} {sharpness}\)</span>。其接口包括：</p>
<ol class="arabic simple">
<li><p>属性</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">sharpness</span></code>：返回<code class="docutils literal notranslate"><span class="pre">sharpness</span></code>的值，类型为<code class="docutils literal notranslate"><span class="pre">Tensor</span></code>。</p></li>
</ul>
</li>
<li><p>映射函数</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">forward</span></code>：正向映射，输入为<code class="docutils literal notranslate"><span class="pre">Tensor</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">inverse</span></code>：反向映射，输入为<code class="docutils literal notranslate"><span class="pre">Tensor</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">forward_log_jacobian</span></code>：正向映射的导数的对数，输入为<code class="docutils literal notranslate"><span class="pre">Tensor</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">inverse_log_jacobian</span></code>：反向映射的导数的对数，输入为<code class="docutils literal notranslate"><span class="pre">Tensor</span></code>。</p></li>
</ul>
</li>
</ol>
</section>
<section id="耿贝尔累计密度函数映射gumbelcdf">
<h4>耿贝尔累计密度函数映射(GumbelCDF)<a class="headerlink" href="#耿贝尔累计密度函数映射gumbelcdf" title="永久链接至标题"></a></h4>
<p><code class="docutils literal notranslate"><span class="pre">GumbelCDF</span></code>做如下变量替换：<span class="math notranslate nohighlight">\(Y = g(X) = \exp(-\exp(-\frac{X - loc}{scale}))\)</span>。其接口包括：</p>
<ol class="arabic simple">
<li><p>属性</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">loc</span></code>：返回<code class="docutils literal notranslate"><span class="pre">loc</span></code>的值，类型为<code class="docutils literal notranslate"><span class="pre">Tensor</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">scale</span></code>：返回<code class="docutils literal notranslate"><span class="pre">scale</span></code>的值，类型为<code class="docutils literal notranslate"><span class="pre">Tensor</span></code>。</p></li>
</ul>
</li>
<li><p>映射函数</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">forward</span></code>：正向映射，输入为<code class="docutils literal notranslate"><span class="pre">Tensor</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">inverse</span></code>：反向映射，输入为<code class="docutils literal notranslate"><span class="pre">Tensor</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">forward_log_jacobian</span></code>：正向映射的导数的对数，输入为<code class="docutils literal notranslate"><span class="pre">Tensor</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">inverse_log_jacobian</span></code>：反向映射的导数的对数，输入为<code class="docutils literal notranslate"><span class="pre">Tensor</span></code>。</p></li>
</ul>
</li>
</ol>
</section>
<section id="逆映射invert">
<h4>逆映射(Invert)<a class="headerlink" href="#逆映射invert" title="永久链接至标题"></a></h4>
<p><code class="docutils literal notranslate"><span class="pre">Invert</span></code>对一个映射做逆变换，其接口包括：</p>
<ol class="arabic simple">
<li><p>属性</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">bijector</span></code>：返回初始化时使用的<code class="docutils literal notranslate"><span class="pre">Bijector</span></code>，类型为<code class="docutils literal notranslate"><span class="pre">Bijector</span></code>。</p></li>
</ul>
</li>
<li><p>映射函数</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">forward</span></code>：正向映射，输入为<code class="docutils literal notranslate"><span class="pre">Tensor</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">inverse</span></code>：反向映射，输入为<code class="docutils literal notranslate"><span class="pre">Tensor</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">forward_log_jacobian</span></code>：正向映射的导数的对数，输入为<code class="docutils literal notranslate"><span class="pre">Tensor</span></code>。</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">inverse_log_jacobian</span></code>：反向映射的导数的对数，输入为<code class="docutils literal notranslate"><span class="pre">Tensor</span></code>。</p></li>
</ul>
</li>
</ol>
</section>
</section>
<section id="pynative模式下调用bijector实例">
<h3>PyNative模式下调用Bijector实例<a class="headerlink" href="#pynative模式下调用bijector实例" title="永久链接至标题"></a></h3>
<p>在执行之前，我们需要导入需要的库文件包。双射类最主要的库是<code class="docutils literal notranslate"><span class="pre">mindspore.nn.probability.bijector</span></code>，导入后我们使用<code class="docutils literal notranslate"><span class="pre">msb</span></code>作为库的缩写并进行调用。</p>
<p>下面我们以<code class="docutils literal notranslate"><span class="pre">PowerTransform</span></code>为例。创建一个指数为2的<code class="docutils literal notranslate"><span class="pre">PowerTransform</span></code>对象。</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[6]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">mindspore.nn</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="kn">import</span> <span class="nn">mindspore.nn.probability.bijector</span> <span class="k">as</span> <span class="nn">msb</span>
<span class="kn">import</span> <span class="nn">mindspore</span> <span class="k">as</span> <span class="nn">ms</span>

<span class="n">ms</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">PYNATIVE_MODE</span><span class="p">)</span>

<span class="n">powertransform</span> <span class="o">=</span> <span class="n">msb</span><span class="o">.</span><span class="n">PowerTransform</span><span class="p">(</span><span class="n">power</span><span class="o">=</span><span class="mf">2.</span><span class="p">)</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">tx</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">forward</span> <span class="o">=</span> <span class="n">powertransform</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">tx</span><span class="p">)</span>
<span class="n">inverse</span> <span class="o">=</span> <span class="n">powertransform</span><span class="o">.</span><span class="n">inverse</span><span class="p">(</span><span class="n">tx</span><span class="p">)</span>
<span class="n">forward_log_jaco</span> <span class="o">=</span> <span class="n">powertransform</span><span class="o">.</span><span class="n">forward_log_jacobian</span><span class="p">(</span><span class="n">tx</span><span class="p">)</span>
<span class="n">inverse_log_jaco</span> <span class="o">=</span> <span class="n">powertransform</span><span class="o">.</span><span class="n">inverse_log_jacobian</span><span class="p">(</span><span class="n">tx</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">powertransform</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;forward: &quot;</span><span class="p">,</span> <span class="n">forward</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;inverse: &quot;</span><span class="p">,</span> <span class="n">inverse</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;forward_log_jacobian: &quot;</span><span class="p">,</span> <span class="n">forward_log_jaco</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;inverse_log_jacobian: &quot;</span><span class="p">,</span> <span class="n">inverse_log_jaco</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
PowerTransform&lt;power = 2.0&gt;
forward:  [2.236068  2.6457515 3.        3.3166249]
inverse:  [ 1.5       4.        7.5      12.000001]
forward_log_jacobian:  [-0.804719  -0.9729551 -1.0986123 -1.1989477]
inverse_log_jacobian:  [0.6931472 1.0986123 1.3862944 1.609438 ]
</pre></div></div>
</div>
</section>
<section id="图模式下调用bijector实例">
<h3>图模式下调用Bijector实例<a class="headerlink" href="#图模式下调用bijector实例" title="永久链接至标题"></a></h3>
<p>在图模式下，<code class="docutils literal notranslate"><span class="pre">Bijector</span></code>子类可用在网络中。</p>
<div class="nbinput docutils container">
<div class="prompt highlight-none notranslate"><div class="highlight"><pre><span></span>[7]:
</pre></div>
</div>
<div class="input_area highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">mindspore.nn</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="kn">import</span> <span class="nn">mindspore</span> <span class="k">as</span> <span class="nn">ms</span>
<span class="kn">import</span> <span class="nn">mindspore.nn.probability.bijector</span> <span class="k">as</span> <span class="nn">msb</span>
<span class="n">ms</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">GRAPH_MODE</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">Net</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Cell</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">Net</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="c1"># create a PowerTransform bijector</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">powertransform</span> <span class="o">=</span> <span class="n">msb</span><span class="o">.</span><span class="n">PowerTransform</span><span class="p">(</span><span class="n">power</span><span class="o">=</span><span class="mf">2.</span><span class="p">)</span>

    <span class="k">def</span> <span class="nf">construct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">value</span><span class="p">):</span>
        <span class="n">forward</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">powertransform</span><span class="o">.</span><span class="n">forward</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="n">inverse</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">powertransform</span><span class="o">.</span><span class="n">inverse</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="n">forward_log_jaco</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">powertransform</span><span class="o">.</span><span class="n">forward_log_jacobian</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="n">inverse_log_jaco</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">powertransform</span><span class="o">.</span><span class="n">inverse_log_jacobian</span><span class="p">(</span><span class="n">value</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">forward</span><span class="p">,</span> <span class="n">inverse</span><span class="p">,</span> <span class="n">forward_log_jaco</span><span class="p">,</span> <span class="n">inverse_log_jaco</span>

<span class="n">net</span> <span class="o">=</span> <span class="n">Net</span><span class="p">()</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">4.0</span><span class="p">,</span> <span class="mf">5.0</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">tx</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">dtype</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">forward</span><span class="p">,</span> <span class="n">inverse</span><span class="p">,</span> <span class="n">forward_log_jaco</span><span class="p">,</span> <span class="n">inverse_log_jaco</span> <span class="o">=</span> <span class="n">net</span><span class="p">(</span><span class="n">tx</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;forward: &quot;</span><span class="p">,</span> <span class="n">forward</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;inverse: &quot;</span><span class="p">,</span> <span class="n">inverse</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;forward_log_jacobian: &quot;</span><span class="p">,</span> <span class="n">forward_log_jaco</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;inverse_log_jacobian: &quot;</span><span class="p">,</span> <span class="n">inverse_log_jaco</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="nboutput nblast docutils container">
<div class="prompt empty docutils container">
</div>
<div class="output_area docutils container">
<div class="highlight"><pre>
forward:  [2.236068  2.6457515 3.        3.3166249]
inverse:  [ 1.5       4.        7.5      12.000001]
forward_log_jacobian:  [-0.804719  -0.9729551 -1.0986123 -1.1989477]
inverse_log_jacobian:  [0.6931472 1.0986123 1.3862944 1.609438 ]
</pre></div></div>
</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="using_bnn.html" class="btn btn-neutral float-left" title="使用贝叶斯神经网络实现图片分类应用" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> 上一页</a>
        <a href="mindspore.nn.probability.html" class="btn btn-neutral float-right" title="mindspore.nn.probability" accesskey="n" rel="next">下一页 <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; 版权所有 2022, MindSpore.</p>
  </div>

  利用 <a href="https://www.sphinx-doc.org/">Sphinx</a> 构建，使用了 
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">主题</a>
    由 <a href="https://readthedocs.org">Read the Docs</a>开发.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 
</body>
</html>