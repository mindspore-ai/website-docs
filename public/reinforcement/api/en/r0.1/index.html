

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>MindSpore Reinforcement API &mdash; MindSpore Reinforcement Learning master documentation</title>
  

  
   
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  
  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="#" class="icon icon-home" alt="Documentation Home"> MindSpore Reinforcement Learning
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <!-- Local TOC -->
              <div class="local-toc"><ul>
<li><a class="reference internal" href="#">MindSpore Reinforcement API</a><ul>
<li><a class="reference internal" href="#module-mindspore_rl.agent">mindspore_rl.agent</a></li>
<li><a class="reference internal" href="#module-mindspore_rl.core">mindspore_rl.core</a></li>
<li><a class="reference internal" href="#module-mindspore_rl.environment">mindspore_rl.environment</a></li>
<li><a class="reference internal" href="#module-mindspore_rl.network">mindspore_rl.network</a></li>
<li><a class="reference internal" href="#module-mindspore_rl.policy">mindspore_rl.policy</a></li>
</ul>
</li>
</ul>
</div>
            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="#">MindSpore Reinforcement Learning</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="#" class="icon icon-home"></a> &raquo;</li>
        
      <li>MindSpore Reinforcement API</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/index.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-mindspore_rl">
<span id="mindspore-reinforcement-api"></span><h1>MindSpore Reinforcement API<a class="headerlink" href="#module-mindspore_rl" title="Permalink to this headline">¶</a></h1>
<p>Components for MindSpore Reinforcement Learning Framework.</p>
<div class="section" id="module-mindspore_rl.agent">
<span id="mindspore-rl-agent"></span><h2>mindspore_rl.agent<a class="headerlink" href="#module-mindspore_rl.agent" title="Permalink to this headline">¶</a></h2>
<p>Components for agent, actor, learner, trainer.</p>
<dl class="class">
<dt id="mindspore_rl.agent.Actor">
<em class="property">class </em><code class="sig-prename descclassname">mindspore_rl.agent.</code><code class="sig-name descname">Actor</code><a class="reference internal" href="_modules/mindspore_rl/agent/actor.html#Actor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.agent.Actor" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class for all actors.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.agent.actor</span> <span class="kn">import</span> <span class="n">Actor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.network</span> <span class="kn">import</span> <span class="n">FullyConnectedNet</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.environment</span> <span class="kn">import</span> <span class="n">GymEnvironment</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">MyActor</span><span class="p">(</span><span class="n">Actor</span><span class="p">):</span>
<span class="gp">... </span>  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">super</span><span class="p">(</span><span class="n">MyActor</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">argmax</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">Argmax</span><span class="p">()</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">actor_net</span> <span class="o">=</span> <span class="n">FullyConnectedNet</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">env</span> <span class="o">=</span> <span class="n">GymEnvironment</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;CartPole-v0&#39;</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_actor</span> <span class="o">=</span> <span class="n">MyActor</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">my_actor</span><span class="p">)</span>
<span class="go">MyActor&lt;</span>
<span class="go">(actor_net): FullyConnectedNet&lt;</span>
<span class="go">(linear1): Dense&lt;input_channels=4, output_channels=10, has_bias=True&gt;</span>
<span class="go">(linear2): Dense&lt;input_channels=10, output_channels=2, has_bias=True&gt;</span>
<span class="go">(relu): ReLU&lt;&gt;</span>
<span class="go">&gt;</span>
<span class="go">(environment): GymEnvironment&lt;&gt;</span>
</pre></div>
</div>
<dl class="method">
<dt id="mindspore_rl.agent.Actor.act">
<code class="sig-name descname">act</code><span class="sig-paren">(</span><em class="sig-param">state</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/agent/actor.html#Actor.act"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.agent.Actor.act" title="Permalink to this definition">¶</a></dt>
<dd><p>The interface of the act function.
User will need to overload this function according to
the algorithm. But argument of this function should be
the state output from the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>state</strong> (<em>Tensor</em>) – the output state from the environment.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>done (Tensor), whether the simulation is finish or not.</p></li>
<li><p>reward (Tensor), simulation reward.</p></li>
<li><p>state (Tensor), simulation state.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.agent.Actor.act_init">
<code class="sig-name descname">act_init</code><span class="sig-paren">(</span><em class="sig-param">state</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/agent/actor.html#Actor.act_init"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.agent.Actor.act_init" title="Permalink to this definition">¶</a></dt>
<dd><p>The interface of the act initialization function.
User will need to overload this function according to
the algorithm. But argument of this function should be
the state output from the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>state</strong> (<em>Tensor</em>) – the output state from the environment.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>done (Tensor), whether the simulation is finish or not.</p></li>
<li><p>reward (Tensor), simulation reward.</p></li>
<li><p>state (Tensor), simulation state.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.agent.Actor.env_setter">
<code class="sig-name descname">env_setter</code><span class="sig-paren">(</span><em class="sig-param">env</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/agent/actor.html#Actor.env_setter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.agent.Actor.env_setter" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the environment by the input <cite>env</cite> for the actor. The <cite>env</cite> is created by
class <cite>GymEnvironment</cite> or other environment class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>env</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#object" title="(in Python v3.8)"><em>object</em></a>) – the input environment.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.agent.Actor.evaluate">
<code class="sig-name descname">evaluate</code><span class="sig-paren">(</span><em class="sig-param">state</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/agent/actor.html#Actor.evaluate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.agent.Actor.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>The interface of the act evaluation function.
User will need to overload this function according to
the algorithm. But argument of this function should be
the state output from the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>state</strong> (<em>Tensor</em>) – the output state from the environment.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>done (Tensor), whether the simulation is finish or not.</p></li>
<li><p>reward (Tensor), simulation reward.</p></li>
<li><p>state (Tensor), simulation state.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.agent.Actor.reset_collect_actor">
<code class="sig-name descname">reset_collect_actor</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/agent/actor.html#Actor.reset_collect_actor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.agent.Actor.reset_collect_actor" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the collect actor, reset the collect actor’s environment and
return the reset state and a false flag of <cite>done</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>state (Tensor), the state of the actor after reset.</p></li>
<li><p>Tensor, always false of <cite>done</cite>.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.agent.Actor.reset_eval_actor">
<code class="sig-name descname">reset_eval_actor</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/agent/actor.html#Actor.reset_eval_actor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.agent.Actor.reset_eval_actor" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the eval actor, reset the eval actor’s environment and
return the reset state and a false flag of <cite>done</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>state (Tensor), the state of the actor after reset.</p></li>
<li><p>Tensor, always false of <cite>done</cite>.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.agent.Actor.update">
<code class="sig-name descname">update</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/agent/actor.html#Actor.update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.agent.Actor.update" title="Permalink to this definition">¶</a></dt>
<dd><p>The interface of the update function.
User will need to overload this function according to the algorithm.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mindspore_rl.agent.Learner">
<em class="property">class </em><code class="sig-prename descclassname">mindspore_rl.agent.</code><code class="sig-name descname">Learner</code><a class="reference internal" href="_modules/mindspore_rl/agent/learner.html#Learner"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.agent.Learner" title="Permalink to this definition">¶</a></dt>
<dd><p>The base class of the learner.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.agent.learner</span> <span class="kn">import</span> <span class="n">Learner</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.network</span> <span class="kn">import</span> <span class="n">FullyConnectedNet</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">MyLearner</span><span class="p">(</span><span class="n">Learner</span><span class="p">):</span>
<span class="gp">... </span>  <span class="k">def</span> <span class="nf">init</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">super</span><span class="p">(</span><span class="n">MyLearner</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">target_network</span> <span class="o">=</span> <span class="n">FullyConnectedNet</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_learner</span> <span class="o">=</span> <span class="n">MyLearner</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">my_learner</span><span class="p">)</span>
<span class="go">MyLearner&lt;</span>
<span class="go">(target_network): FullyConnectedNet&lt;</span>
<span class="go">(linear1): Dense&lt;input_channels=4, output_channels=10, has_bias=True&gt;</span>
<span class="go">(linear2): Dense&lt;input_channels=10, output_channels=2, has_bias=True&gt;</span>
<span class="go">(relu): ReLU&lt;&gt;</span>
<span class="go">&gt;</span>
</pre></div>
</div>
<dl class="method">
<dt id="mindspore_rl.agent.Learner.learn">
<code class="sig-name descname">learn</code><span class="sig-paren">(</span><em class="sig-param">samples</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/agent/learner.html#Learner.learn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.agent.Learner.learn" title="Permalink to this definition">¶</a></dt>
<dd><p>The interface for the learn function. The behavior of the <cite>learn</cite> function
depend on the user’s implementation. Usually, it takes the <cite>samples</cite> form
replay buffer or other Tensors, and calculates the loss for updating the networks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>samples</strong> (<em>Tensor</em>) – Sampling from the buffer.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>success, If the training success or not.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mindspore_rl.agent.Trainer">
<em class="property">class </em><code class="sig-prename descclassname">mindspore_rl.agent.</code><code class="sig-name descname">Trainer</code><span class="sig-paren">(</span><em class="sig-param">msrl</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/agent/trainer.html#Trainer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.agent.Trainer" title="Permalink to this definition">¶</a></dt>
<dd><p>The trainer base class.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Reference to <a class="reference external" href="https://gitee.com/mindspore/docs/blob/master/docs/reinforcement/docs/source_en/dqn.md#defining-the-dqntrainer-class">dqn_trainer.py</a>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>msrl</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#object" title="(in Python v3.8)"><em>object</em></a>) – the function handler class.</p>
</dd>
</dl>
<dl class="method">
<dt id="mindspore_rl.agent.Trainer.train">
<code class="sig-name descname">train</code><span class="sig-paren">(</span><em class="sig-param">episode</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/agent/trainer.html#Trainer.train"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.agent.Trainer.train" title="Permalink to this definition">¶</a></dt>
<dd><p>The interface of the train function. User will implement
this function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>episode</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – the number of training episode.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mindspore_rl.agent.Agent">
<em class="property">class </em><code class="sig-prename descclassname">mindspore_rl.agent.</code><code class="sig-name descname">Agent</code><span class="sig-paren">(</span><em class="sig-param">num_actor</em>, <em class="sig-param">actors</em>, <em class="sig-param">learner</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/agent/agent.html#Agent"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.agent.Agent" title="Permalink to this definition">¶</a></dt>
<dd><p>The base class for the Agent.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>num_actor</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The actor numbers in this agent.</p></li>
<li><p><strong>actors</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#object" title="(in Python v3.8)"><em>object</em></a>) – The actor instance.</p></li>
<li><p><strong>learner</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#object" title="(in Python v3.8)"><em>object</em></a>) – The learner instance.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.agent.learner</span> <span class="kn">import</span> <span class="n">Learner</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.agent.actor</span> <span class="kn">import</span> <span class="n">Actor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.agent.agent</span> <span class="kn">import</span> <span class="n">Agent</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">actor_num</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">actors</span> <span class="o">=</span> <span class="n">Actor</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">learner</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">agent</span> <span class="o">=</span> <span class="n">Agent</span><span class="p">(</span><span class="n">actor_num</span><span class="p">,</span> <span class="n">actors</span><span class="p">,</span> <span class="n">learner</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">agent</span><span class="p">)</span>
<span class="go">Agent&lt;</span>
<span class="go">(_actors): Actor&lt;&gt;</span>
<span class="go">(_learner): Learner&lt;&gt;</span>
<span class="go">&gt;</span>
</pre></div>
</div>
<dl class="method">
<dt id="mindspore_rl.agent.Agent.act">
<code class="sig-name descname">act</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/agent/agent.html#Agent.act"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.agent.Agent.act" title="Permalink to this definition">¶</a></dt>
<dd><p>The act function interface.</p>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.agent.Agent.actors">
<em class="property">property </em><code class="sig-name descname">actors</code><a class="headerlink" href="#mindspore_rl.agent.Agent.actors" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the instance of actors in the agent.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>actors (object), actors object created by class <cite>Actor</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.agent.Agent.env_setter">
<code class="sig-name descname">env_setter</code><span class="sig-paren">(</span><em class="sig-param">env</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/agent/agent.html#Agent.env_setter"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.agent.Agent.env_setter" title="Permalink to this definition">¶</a></dt>
<dd><p>Set the agent environment for actors in agent.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>env</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#object" title="(in Python v3.8)"><em>object</em></a>) – the input environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.agent.Agent.init">
<code class="sig-name descname">init</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/agent/agent.html#Agent.init"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.agent.Agent.init" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialize the agent, reset all the actors in agent.</p>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.agent.Agent.learn">
<code class="sig-name descname">learn</code><span class="sig-paren">(</span><em class="sig-param">samples</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/agent/agent.html#Agent.learn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.agent.Agent.learn" title="Permalink to this definition">¶</a></dt>
<dd><p>The learn function interface.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>samples</strong> (<em>Tensor</em>) – the sample from replay buffer.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.agent.Agent.learner">
<em class="property">property </em><code class="sig-name descname">learner</code><a class="headerlink" href="#mindspore_rl.agent.Agent.learner" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the instance of learner in the agent.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>learner (object), learner object created by class <cite>Learner</cite>.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.agent.Agent.num_actor">
<em class="property">property </em><code class="sig-name descname">num_actor</code><a class="headerlink" href="#mindspore_rl.agent.Agent.num_actor" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the number of the actors of the agent.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>num_actor (int), actor numbers.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.agent.Agent.reset_all">
<code class="sig-name descname">reset_all</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/agent/agent.html#Agent.reset_all"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.agent.Agent.reset_all" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the all the actors in agent, and return the reset <cite>state</cite>
and the flag <cite>done</cite>.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>state (Tensor), the state of the reset environment in actor.</p></li>
<li><p>done (Tensor), a false flag of <cite>done</cite>.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.agent.Agent.update">
<code class="sig-name descname">update</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/agent/agent.html#Agent.update"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.agent.Agent.update" title="Permalink to this definition">¶</a></dt>
<dd><p>The update function interface.</p>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-mindspore_rl.core">
<span id="mindspore-rl-core"></span><h2>mindspore_rl.core<a class="headerlink" href="#module-mindspore_rl.core" title="Permalink to this headline">¶</a></h2>
<p>Helper components used to implement RL algorithms.</p>
<dl class="class">
<dt id="mindspore_rl.core.MSRL">
<em class="property">class </em><code class="sig-prename descclassname">mindspore_rl.core.</code><code class="sig-name descname">MSRL</code><span class="sig-paren">(</span><em class="sig-param">config</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/msrl.html#MSRL"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.core.MSRL" title="Permalink to this definition">¶</a></dt>
<dd><p>The MSRL class provides the function handlers and APIs for reinforcement
learning algorithm development.</p>
<p>It exposes the following function handler to the user. The input and output of
these function handlers are identical to the user defined functions.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">agent_act_init</span>
<span class="n">agent_act_collect</span>
<span class="n">agent_act_eval</span>
<span class="n">agent_act</span>
<span class="n">agent_reset</span>
<span class="n">sample_buffer</span>
<span class="n">agent_learn</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>config</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – <p>provides the algorithm configuration.</p>
<ul class="simple">
<li><p>Top level: defines the algorithm components.</p>
<ul>
<li><p>key: ‘actor’,              value: the actor configuration (dict).</p></li>
<li><p>key: ‘learner’,            value: the learner configuration (dict).</p></li>
<li><p>key: ‘policy_and_network’, value: the policy and networks used by
actors and learners (dict).</p></li>
<li><p>key: ‘env’,                value: the environment configuration (dict).</p></li>
</ul>
</li>
<li><p>Second level: the configuration of each algorithm component.</p>
<ul>
<li><p>key: ‘number’,      value: the number of actors/learner (int).</p></li>
<li><p>key: ‘type’,        value: the type of the
actor/learner/policy_and_network/environment (class name).</p></li>
<li><p>key: ‘params’,      value: the parameters of
actor/learner/policy_and_network/environment (dict).</p></li>
<li><p>key: ‘policies’,    value: the list of policies used by the
actor/learner (list).</p></li>
<li><p>key: ‘networks’,    value: the list of networks used by the
actor/learner (list).</p></li>
<li><p>key: ‘environment’, value: True if the component needs to interact
with the environment, False otherwise (Bool).</p></li>
<li><p>key: ‘buffer’,      value: the buffer configuration (dict).</p></li>
</ul>
</li>
</ul>
</p>
</dd>
</dl>
<dl class="method">
<dt id="mindspore_rl.core.MSRL.get_replay_buffer">
<code class="sig-name descname">get_replay_buffer</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/msrl.html#MSRL.get_replay_buffer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.core.MSRL.get_replay_buffer" title="Permalink to this definition">¶</a></dt>
<dd><p>It will return the instance of replay buffer.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Buffers (object), The instance of relay buffer. If the buffer is None, the return
value will be None.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.core.MSRL.get_replay_buffer_elements">
<code class="sig-name descname">get_replay_buffer_elements</code><span class="sig-paren">(</span><em class="sig-param">transpose=False</em>, <em class="sig-param">shape=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/msrl.html#MSRL.get_replay_buffer_elements"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.core.MSRL.get_replay_buffer_elements" title="Permalink to this definition">¶</a></dt>
<dd><p>It will return all the elements in the replay buffer.
:param transpose: whether the output element needs to be transpose,
:type transpose: boolean
:param if transpose is true, shape will also need to be filled. Default: False
:param shape: the shape used in transpose. Default: None
:type shape: Tuple[int]</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>elements (List[Tensor]), A set of tensor contains all the elements in the replay buffer</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.core.MSRL.init">
<code class="sig-name descname">init</code><span class="sig-paren">(</span><em class="sig-param">config</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/msrl.html#MSRL.init"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.core.MSRL.init" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialization of MSRL object.
The function creates all the data/objects that the algorithm requires.
It also initializes all the function handler.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>config</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – algorithm configuration file.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mindspore_rl.core.Session">
<em class="property">class </em><code class="sig-prename descclassname">mindspore_rl.core.</code><code class="sig-name descname">Session</code><span class="sig-paren">(</span><em class="sig-param">config</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/session.html#Session"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.core.Session" title="Permalink to this definition">¶</a></dt>
<dd><p>The Session is a class for running MindSpore RL algorithms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>config</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – the algorithm configuration or the deployment configuration of the algorithm.
For more details of configuration of algorithm, please have a look at
<a class="reference external" href="https://www.mindspore.cn/reinforcement/docs/zh-CN/r1.5/index.html">https://www.mindspore.cn/reinforcement/docs/zh-CN/r1.5/index.html</a></p>
</dd>
</dl>
<dl class="method">
<dt id="mindspore_rl.core.Session.run">
<code class="sig-name descname">run</code><span class="sig-paren">(</span><em class="sig-param">class_type=None</em>, <em class="sig-param">episode=0</em>, <em class="sig-param">params=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/session.html#Session.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.core.Session.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute the reinforcement learning algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>class_type</strong> (<em>class type</em>) – The class type of the algorithm’s trainer class. Default: None.</p></li>
<li><p><strong>episode</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The number of episode of the training. Default: 0.</p></li>
<li><p><strong>params</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – The algorithm specific training parameters. Default: None.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-mindspore_rl.environment">
<span id="mindspore-rl-environment"></span><h2>mindspore_rl.environment<a class="headerlink" href="#module-mindspore_rl.environment" title="Permalink to this headline">¶</a></h2>
<p>Component used to implement custom environments.</p>
<dl class="class">
<dt id="mindspore_rl.environment.GymEnvironment">
<em class="property">class </em><code class="sig-prename descclassname">mindspore_rl.environment.</code><code class="sig-name descname">GymEnvironment</code><span class="sig-paren">(</span><em class="sig-param">params</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/gym_environment.html#GymEnvironment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.GymEnvironment" title="Permalink to this definition">¶</a></dt>
<dd><p>The GymEnvironment class provides the functions to interact with
different environments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>params</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – A dictionary contains all the parameters which are used to create the
instance of GymEnvironment, such as the name of environment. Since this environment
is based on Gym, the name of environment should match with the name in Gym.</p>
</dd>
</dl>
<dl class="simple">
<dt>Supported Platforms:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">Ascend</span></code> <code class="docutils literal notranslate"><span class="pre">GPU</span></code> <code class="docutils literal notranslate"><span class="pre">CPU</span></code></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">env_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;CartPole-v0&#39;</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">environment</span> <span class="o">=</span> <span class="n">GymEnvironment</span><span class="p">(</span><span class="n">env_params</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">environment</span><span class="p">)</span>
<span class="go">GymEnvironment&lt;&gt;</span>
</pre></div>
</div>
<dl class="method">
<dt id="mindspore_rl.environment.GymEnvironment.action_space_dim">
<em class="property">property </em><code class="sig-name descname">action_space_dim</code><a class="headerlink" href="#mindspore_rl.environment.GymEnvironment.action_space_dim" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the action space dim of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tuple which states for the space dimension of action</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.GymEnvironment.clone">
<code class="sig-name descname">clone</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/gym_environment.html#GymEnvironment.clone"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.GymEnvironment.clone" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a copy of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>env (object), a copy of the original environment object.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.GymEnvironment.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/gym_environment.html#GymEnvironment.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.GymEnvironment.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the environment to the initial state. It is always used at the beginning of each
episode. It will return the value of initial state.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tensor which states for the initial state of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.GymEnvironment.state_space_dim">
<em class="property">property </em><code class="sig-name descname">state_space_dim</code><a class="headerlink" href="#mindspore_rl.environment.GymEnvironment.state_space_dim" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the state space dim of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tuple which states for the space dimension of state</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.GymEnvironment.step">
<code class="sig-name descname">step</code><span class="sig-paren">(</span><em class="sig-param">action</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/gym_environment.html#GymEnvironment.step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.GymEnvironment.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute the environment step, which means that interact with environment once.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>action</strong> (<em>Tensor</em>) – A tensor that contains the action information.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>state (Tensor), the environment state after performing the action.</p></li>
<li><p>reward (Tensor), the reward after performing the action.</p></li>
<li><p>done (mindspore.bool_), whether the simulation finishes or not.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mindspore_rl.environment.GymMultiEnvironment">
<em class="property">class </em><code class="sig-prename descclassname">mindspore_rl.environment.</code><code class="sig-name descname">GymMultiEnvironment</code><span class="sig-paren">(</span><em class="sig-param">params</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/gym_multi_environment.html#GymMultiEnvironment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.GymMultiEnvironment" title="Permalink to this definition">¶</a></dt>
<dd><p>The GymMultiEnvironment class provides the functions to interact with
different environments. It is the multi-environment version of GymEnvironment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>params</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – A dictionary contains all the parameters which are used to create the
instance of GymEnvironment, such as name of environment, number of environment.
Since this environment is based on Gym, the name of environment should match
with the name in Gym.</p>
</dd>
</dl>
<dl class="simple">
<dt>Supported Platforms:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">Ascend</span></code> <code class="docutils literal notranslate"><span class="pre">GPU</span></code> <code class="docutils literal notranslate"><span class="pre">CPU</span></code></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">env_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;CartPole-v0&#39;</span><span class="p">,</span> <span class="s1">&#39;env_nums&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">environment</span> <span class="o">=</span> <span class="n">GymMultiEnvironment</span><span class="p">(</span><span class="n">env_params</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">environment</span><span class="p">)</span>
<span class="go">GymMultiEnvironment&lt;&gt;</span>
</pre></div>
</div>
<dl class="method">
<dt id="mindspore_rl.environment.GymMultiEnvironment.action_space_dim">
<em class="property">property </em><code class="sig-name descname">action_space_dim</code><a class="headerlink" href="#mindspore_rl.environment.GymMultiEnvironment.action_space_dim" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the action space dim of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tuple which states for the space dimension of action</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.GymMultiEnvironment.clone">
<code class="sig-name descname">clone</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/gym_multi_environment.html#GymMultiEnvironment.clone"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.GymMultiEnvironment.clone" title="Permalink to this definition">¶</a></dt>
<dd><p>Make a copy of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>env (object). A copy of the original environment object.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.GymMultiEnvironment.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/gym_multi_environment.html#GymMultiEnvironment.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.GymMultiEnvironment.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the environment to the initial state. It is always used at the beginning of each
episode. It will return the value of initial state of each environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A list of tensor which states for all the initial states of each environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.GymMultiEnvironment.state_space_dim">
<em class="property">property </em><code class="sig-name descname">state_space_dim</code><a class="headerlink" href="#mindspore_rl.environment.GymMultiEnvironment.state_space_dim" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the state space dim of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tuple which states for the space dimension of state</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.GymMultiEnvironment.step">
<code class="sig-name descname">step</code><span class="sig-paren">(</span><em class="sig-param">action</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/gym_multi_environment.html#GymMultiEnvironment.step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.GymMultiEnvironment.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute the environment step, which means that interact with environment once.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>action</strong> (<em>Tensor</em>) – A tensor that contains the action information.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>state (Tensor), a list of environment state after performing the action.</p></li>
<li><p>reward (Tensor), a list of reward after performing the action.</p></li>
<li><p>done (Tensor), whether the simulations of each environment finishes or not</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-mindspore_rl.network">
<span id="mindspore-rl-network"></span><h2>mindspore_rl.network<a class="headerlink" href="#module-mindspore_rl.network" title="Permalink to this headline">¶</a></h2>
<p>Network component used to implement polies.</p>
<dl class="class">
<dt id="mindspore_rl.network.FullyConnectedNet">
<em class="property">class </em><code class="sig-prename descclassname">mindspore_rl.network.</code><code class="sig-name descname">FullyConnectedNet</code><span class="sig-paren">(</span><em class="sig-param">input_size</em>, <em class="sig-param">hidden_size</em>, <em class="sig-param">output_size</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/network/fully_connected_net.html#FullyConnectedNet"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.network.FullyConnectedNet" title="Permalink to this definition">¶</a></dt>
<dd><p>A basic fully connected neural network.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_size</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – numbers of input size.</p></li>
<li><p><strong>hidden_size</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – numbers of hidden layers.</p></li>
<li><p><strong>output_size</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – numbers of output size.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">input</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">net</span> <span class="o">=</span> <span class="n">FullyConnectedNet</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">net</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(2, 2)</span>
</pre></div>
</div>
<dl class="method">
<dt id="mindspore_rl.network.FullyConnectedNet.construct">
<code class="sig-name descname">construct</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/network/fully_connected_net.html#FullyConnectedNet.construct"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.network.FullyConnectedNet.construct" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns output of Dense layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> (<em>Tensor</em>) – Tensor as the input of network.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The output of the Dense layer.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-mindspore_rl.policy">
<span id="mindspore-rl-policy"></span><h2>mindspore_rl.policy<a class="headerlink" href="#module-mindspore_rl.policy" title="Permalink to this headline">¶</a></h2>
<p>Policies used in RL algorithms.</p>
<dl class="class">
<dt id="mindspore_rl.policy.Policy">
<em class="property">class </em><code class="sig-prename descclassname">mindspore_rl.policy.</code><code class="sig-name descname">Policy</code><a class="reference internal" href="_modules/mindspore_rl/policy/policy.html#Policy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.policy.Policy" title="Permalink to this definition">¶</a></dt>
<dd><p>The virtual base class for the policy. This class should be overridden before calling in the model.</p>
<dl class="method">
<dt id="mindspore_rl.policy.Policy.construct">
<code class="sig-name descname">construct</code><span class="sig-paren">(</span><em class="sig-param">*inputs</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/policy/policy.html#Policy.construct"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.policy.Policy.construct" title="Permalink to this definition">¶</a></dt>
<dd><p>The interface of the construct function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong> – it’s depended on the user definition.</p></li>
<li><p><strong>kwargs</strong> – it’s depended on the user definition.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>User defined.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mindspore_rl.policy.RandomPolicy">
<em class="property">class </em><code class="sig-prename descclassname">mindspore_rl.policy.</code><code class="sig-name descname">RandomPolicy</code><span class="sig-paren">(</span><em class="sig-param">action_space_dim</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/policy/random_policy.html#RandomPolicy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.policy.RandomPolicy" title="Permalink to this definition">¶</a></dt>
<dd><p>Produces a random action betweens [0, <cite>acton_space_dim</cite>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>acton_space_dim</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – dimension of the action space.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">action_space_dim</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">policy</span> <span class="o">=</span> <span class="n">RandomPolicy</span><span class="p">(</span><span class="n">action_space_dim</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">policy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(1,)</span>
</pre></div>
</div>
<dl class="method">
<dt id="mindspore_rl.policy.RandomPolicy.construct">
<code class="sig-name descname">construct</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/policy/random_policy.html#RandomPolicy.construct"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.policy.RandomPolicy.construct" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a random number betweens [0, <cite>acton_space_dim</cite>).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A random integer betweens [0, <cite>acton_space_dim</cite>).</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mindspore_rl.policy.GreedyPolicy">
<em class="property">class </em><code class="sig-prename descclassname">mindspore_rl.policy.</code><code class="sig-name descname">GreedyPolicy</code><span class="sig-paren">(</span><em class="sig-param">input_network</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/policy/greedy_policy.html#GreedyPolicy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.policy.GreedyPolicy" title="Permalink to this definition">¶</a></dt>
<dd><p>Produces a greedy action base on the given policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input_network</strong> (<em>Cell</em>) – network used to generate action probs by input state.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">state_dim</span><span class="p">,</span> <span class="n">hidden_dim</span><span class="p">,</span> <span class="n">action_dim</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_net</span> <span class="o">=</span> <span class="n">FullyConnectedNet</span><span class="p">(</span><span class="n">state_dim</span><span class="p">,</span> <span class="n">hidden_dim</span><span class="p">,</span> <span class="n">action_dim</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">policy</span> <span class="o">=</span> <span class="n">GreedyPolicy</span><span class="p">(</span><span class="n">input_net</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">state</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">policy</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(2,)</span>
</pre></div>
</div>
<dl class="method">
<dt id="mindspore_rl.policy.GreedyPolicy.construct">
<code class="sig-name descname">construct</code><span class="sig-paren">(</span><em class="sig-param">state</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/policy/greedy_policy.html#GreedyPolicy.construct"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.policy.GreedyPolicy.construct" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the best action.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>state</strong> (<em>Tensor</em>) – State tensor as the input of network.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>action_max, the best action.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mindspore_rl.policy.EpsilonGreedyPolicy">
<em class="property">class </em><code class="sig-prename descclassname">mindspore_rl.policy.</code><code class="sig-name descname">EpsilonGreedyPolicy</code><span class="sig-paren">(</span><em class="sig-param">input_network</em>, <em class="sig-param">size</em>, <em class="sig-param">epsi_high</em>, <em class="sig-param">epsi_low</em>, <em class="sig-param">decay</em>, <em class="sig-param">action_space_dim</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/policy/epsilon_greedy_policy.html#EpsilonGreedyPolicy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.policy.EpsilonGreedyPolicy" title="Permalink to this definition">¶</a></dt>
<dd><p>Produces an epsilon-greedy sample action base on the given policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_network</strong> (<em>Cell</em>) – A network returns policy action.</p></li>
<li><p><strong>size</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Shape of epsilon.</p></li>
<li><p><strong>epsi_high</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – A high epsilon for exploration betweens [0, 1].</p></li>
<li><p><strong>epsi_low</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – A low epsilon for exploration betweens [0, epsi_high].</p></li>
<li><p><strong>decay</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – A decay factor applied to epsilon.</p></li>
<li><p><strong>action_space_dim</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Dimensions of the action space.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">state_dim</span><span class="p">,</span> <span class="n">hidden_dim</span><span class="p">,</span> <span class="n">action_dim</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_net</span> <span class="o">=</span> <span class="n">FullyConnectedNet</span><span class="p">(</span><span class="n">state_dim</span><span class="p">,</span> <span class="n">hidden_dim</span><span class="p">,</span> <span class="n">action_dim</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">policy</span> <span class="o">=</span> <span class="n">EpsilonGreedyPolicy</span><span class="p">(</span><span class="n">input_net</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">action_dim</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">state</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="n">state_dim</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">step</span> <span class="o">=</span>  <span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">10</span><span class="p">,])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">policy</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(1,)</span>
</pre></div>
</div>
<dl class="method">
<dt id="mindspore_rl.policy.EpsilonGreedyPolicy.construct">
<code class="sig-name descname">construct</code><span class="sig-paren">(</span><em class="sig-param">state</em>, <em class="sig-param">step</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/policy/epsilon_greedy_policy.html#EpsilonGreedyPolicy.construct"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.policy.EpsilonGreedyPolicy.construct" title="Permalink to this definition">¶</a></dt>
<dd><p>The interface of the construct function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<em>Tensor</em>) – The input tensor for network.</p></li>
<li><p><strong>step</strong> (<em>Tensor</em>) – The current step, effects the epsilon decay.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The output action.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, MindSpore.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   
</body>
</html>