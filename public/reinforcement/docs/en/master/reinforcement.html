

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>mindspore_rl &mdash; MindSpore master documentation</title>
  

  
   
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  
  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Release Notes" href="RELEASE.html" />
    <link rel="prev" title="Reinforcement Learning Environment Access" href="environment.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> MindSpore
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Installation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="reinforcement_install.html">MindSpore Reinforcement Installation</a></li>
</ul>
<p class="caption"><span class="caption-text">Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="custom_config_info.html">MindSpore RL Configuration Instruction</a></li>
<li class="toctree-l1"><a class="reference internal" href="dqn.html">Deep Q Learning (DQN) with MindSpore Reinforcement</a></li>
<li class="toctree-l1"><a class="reference internal" href="replaybuffer.html">ReplayBuffer Usage Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="environment.html">Reinforcement Learning Environment Access</a></li>
</ul>
<p class="caption"><span class="caption-text">API References</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">mindspore_rl</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#mindspore-rl-agent">mindspore_rl.agent</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-mindspore_rl.core">mindspore_rl.core</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-mindspore_rl.environment">mindspore_rl.environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="#mindspore-rl-network">mindspore_rl.network</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-mindspore_rl.policy">mindspore_rl.policy</a></li>
<li class="toctree-l2"><a class="reference internal" href="#mindspore-rl-utils">mindspore_rl.utils</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="RELEASE.html">Release Notes</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">MindSpore</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>mindspore_rl</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/reinforcement.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="module-mindspore_rl">
<span id="module-mindspore_rl"></span><span id="mindspore-rl"></span><h1>mindspore_rl<a class="headerlink" href="#module-mindspore_rl" title="Permalink to this headline">¶</a></h1>
<p>Components for MindSpore Reinforcement Learning Framework.</p>
<div class="section" id="mindspore-rl-agent">
<h2>mindspore_rl.agent<a class="headerlink" href="#mindspore-rl-agent" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-mindspore_rl.core">
<span id="module-mindspore_rl.core"></span><span id="mindspore-rl-core"></span><h2>mindspore_rl.core<a class="headerlink" href="#module-mindspore_rl.core" title="Permalink to this headline">¶</a></h2>
<p>Helper components used to implement RL algorithms.</p>
<dl class="class">
<dt id="mindspore_rl.core.MSRL">
<em class="property">class </em><code class="sig-prename descclassname">mindspore_rl.core.</code><code class="sig-name descname">MSRL</code><span class="sig-paren">(</span><em class="sig-param">alg_config</em>, <em class="sig-param">deploy_config=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/msrl.html#MSRL"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.core.MSRL" title="Permalink to this definition">¶</a></dt>
<dd><p>The MSRL class provides the function handlers and APIs for reinforcement
learning algorithm development.</p>
<p>It exposes the following function handler to the user. The input and output of
these function handlers are identical to the user defined functions.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">agent_act</span>
<span class="n">agent_get_action</span>
<span class="n">sample_buffer</span>
<span class="n">agent_learn</span>
<span class="n">replay_buffer_sample</span>
<span class="n">replay_buffer_insert</span>
<span class="n">replay_buffer_reset</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>alg_config</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – provides the algorithm configuration.</p></li>
<li><p><strong>deploy_config</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – <p>provides the distribute configuration.</p>
<ul>
<li><p>Top level: defines the algorithm components.</p>
<ul>
<li><p>key: ‘actor’,              value: the actor configuration (dict).</p></li>
<li><p>key: ‘learner’,            value: the learner configuration (dict).</p></li>
<li><p>key: ‘policy_and_network’, value: the policy and networks used by
actor and learner (dict).</p></li>
<li><p>key: ‘collect_environment’,     value: the collect environment configuration (dict).</p></li>
<li><p>key: ‘eval_environment’,        value: the eval environment configuration (dict).</p></li>
<li><p>key: ‘replay_buffer’,           value: the replay buffer configuration (dict).</p></li>
</ul>
</li>
<li><p>Second level: the configuration of each algorithm component.</p>
<ul>
<li><p>key: ‘number’,      value: the number of actor/learner (int).</p></li>
<li><p>key: ‘type’,        value: the type of the
actor/learner/policy_and_network/environment (class name).</p></li>
<li><p>key: ‘params’,      value: the parameters of
actor/learner/policy_and_network/environment (dict).</p></li>
<li><p>key: ‘policies’,    value: the list of policies used by the
actor/learner (list).</p></li>
<li><p>key: ‘networks’,    value: the list of networks used by the
actor/learner (list).</p></li>
<li><p>key: ‘pass_environment’, value: True user needs to pass the environment
instance into actor, False otherwise (Bool).</p></li>
</ul>
</li>
</ul>
</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="mindspore_rl.core.MSRL.get_replay_buffer">
<code class="sig-name descname">get_replay_buffer</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/msrl.html#MSRL.get_replay_buffer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.core.MSRL.get_replay_buffer" title="Permalink to this definition">¶</a></dt>
<dd><p>It will return the instance of replay buffer.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Buffers (object), The instance of relay buffer. If the buffer is None, the return
value will be None.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.core.MSRL.get_replay_buffer_elements">
<code class="sig-name descname">get_replay_buffer_elements</code><span class="sig-paren">(</span><em class="sig-param">transpose=False</em>, <em class="sig-param">shape=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/msrl.html#MSRL.get_replay_buffer_elements"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.core.MSRL.get_replay_buffer_elements" title="Permalink to this definition">¶</a></dt>
<dd><p>It will return all the elements in the replay buffer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>transpose</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – whether the output element needs to be transpose,
if transpose is true, shape will also need to be filled. Default: False.</p></li>
<li><p><strong>shape</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>]</em>) – the shape used in transpose. Default: None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>elements (List[Tensor]), A set of tensor contains all the elements in the replay buffer.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.core.MSRL.init">
<code class="sig-name descname">init</code><span class="sig-paren">(</span><em class="sig-param">config</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/msrl.html#MSRL.init"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.core.MSRL.init" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialization of MSRL object.
The function creates all the data/objects that the algorithm requires.
It also initializes all the function handler.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>config</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – algorithm configuration file.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mindspore_rl.core.Session">
<em class="property">class </em><code class="sig-prename descclassname">mindspore_rl.core.</code><code class="sig-name descname">Session</code><span class="sig-paren">(</span><em class="sig-param">alg_config</em>, <em class="sig-param">deploy_config=None</em>, <em class="sig-param">params=None</em>, <em class="sig-param">callbacks=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/session.html#Session"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.core.Session" title="Permalink to this definition">¶</a></dt>
<dd><p>The Session is a class for running MindSpore RL algorithms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>alg_config</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – the algorithm configuration or the deployment configuration of the algorithm.</p></li>
<li><p><strong>deploy_config</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – the deployment configuration for distribution. Default: None.
For more details of configuration of algorithm, please have a look at
<a class="reference external" href="https://www.mindspore.cn/reinforcement/docs/zh-CN/master/custom_config_info.html">detail</a>.</p></li>
<li><p><strong>params</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – The algorithm specific training parameters. Default: None.</p></li>
<li><p><strong>callbacks</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em>[</em><em>Callback</em><em>]</em>) – The callback list. Default: None.</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="mindspore_rl.core.Session.run">
<code class="sig-name descname">run</code><span class="sig-paren">(</span><em class="sig-param">class_type=None</em>, <em class="sig-param">is_train=True</em>, <em class="sig-param">episode=0</em>, <em class="sig-param">duration=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/session.html#Session.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.core.Session.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute the reinforcement learning algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>class_type</strong> (<em>Trainer</em>) – The class type of the algorithm’s trainer class. Default: None.</p></li>
<li><p><strong>is_train</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Run the algorithm in train mode or eval mode. Default: True</p></li>
<li><p><strong>episode</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The number of episode of the training. Default: 0.</p></li>
<li><p><strong>duration</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The number of duration of the training. Default: 0.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mindspore_rl.core.UniformReplayBuffer">
<em class="property">class </em><code class="sig-prename descclassname">mindspore_rl.core.</code><code class="sig-name descname">UniformReplayBuffer</code><span class="sig-paren">(</span><em class="sig-param">batch_size</em>, <em class="sig-param">capacity</em>, <em class="sig-param">shapes</em>, <em class="sig-param">types</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/uniform_replay_buffer.html#UniformReplayBuffer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.core.UniformReplayBuffer" title="Permalink to this definition">¶</a></dt>
<dd><p>The replay buffer class.
The replay buffer will store the experience from environment. In replay
buffer, each element is a list of tensors. Therefore, the constructor of the
UniformReplayBuffer class takes the shape and type of each tensor as an argument.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch_size</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – size for sampling from the buffer.</p></li>
<li><p><strong>capacity</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – the capacity of the buffer.</p></li>
<li><p><strong>shapes</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>]</em>) – the shape of each tensor in a buffer element.</p></li>
<li><p><strong>types</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em>[</em><em>mindspore.dtype</em><em>]</em>) – the data type of each tensor in a buffer element.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mindspore</span> <span class="k">as</span> <span class="nn">ms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.core.uniform_replay_buffer</span> <span class="kn">import</span> <span class="n">UniformReplayBuffer</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">batch_size</span> <span class="o">=</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">capacity</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shapes</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">4</span><span class="p">,),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">types</span> <span class="o">=</span> <span class="p">[</span><span class="n">ms</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">ms</span><span class="o">.</span><span class="n">int32</span><span class="p">,</span> <span class="n">ms</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">ms</span><span class="o">.</span><span class="n">float32</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">replaybuffer</span> <span class="o">=</span> <span class="n">UniformReplayBuffer</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">capacity</span><span class="p">,</span> <span class="n">shapes</span><span class="p">,</span> <span class="n">types</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">replaybuffer</span><span class="p">)</span>
<span class="go">UniformReplayBuffer&lt;&gt;</span>
</pre></div>
</div>
<dl class="method">
<dt id="mindspore_rl.core.UniformReplayBuffer.full">
<code class="sig-name descname">full</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/uniform_replay_buffer.html#UniformReplayBuffer.full"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.core.UniformReplayBuffer.full" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if the replaybuffer is full or not.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Full(bool), True if the replaybuffer is full, False otherwise.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.core.UniformReplayBuffer.get_item">
<code class="sig-name descname">get_item</code><span class="sig-paren">(</span><em class="sig-param">index</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/uniform_replay_buffer.html#UniformReplayBuffer.get_item"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.core.UniformReplayBuffer.get_item" title="Permalink to this definition">¶</a></dt>
<dd><p>Get an element from the replaybuffer in specific position(index).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>index</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – the location of the item.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>element (List[Tensor]), the element from the buffer.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.core.UniformReplayBuffer.insert">
<code class="sig-name descname">insert</code><span class="sig-paren">(</span><em class="sig-param">exp</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/uniform_replay_buffer.html#UniformReplayBuffer.insert"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.core.UniformReplayBuffer.insert" title="Permalink to this definition">¶</a></dt>
<dd><p>Insert an element to the buffer. If the buffer is full, FIFO strategy will be used to
replace the element in the buffer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>exp</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em>[</em><em>Tensor</em><em>]</em>) – insert a list of tensor which matches with the initialized shape
and type into the buffer.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>element (list[Tensor]), return the whole buffer after insertion</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.core.UniformReplayBuffer.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/uniform_replay_buffer.html#UniformReplayBuffer.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.core.UniformReplayBuffer.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the replaybuffer. It changes the value of self.count to zero.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>success (boolean), whether the reset successful or not.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.core.UniformReplayBuffer.sample">
<code class="sig-name descname">sample</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/uniform_replay_buffer.html#UniformReplayBuffer.sample"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.core.UniformReplayBuffer.sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Sampling the replaybuffer, which means that it will randomly choose a set of element
and output them.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>data (Tuple(Tensor)), A set of sampled elements from the buffer.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.core.UniformReplayBuffer.size">
<code class="sig-name descname">size</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/uniform_replay_buffer.html#UniformReplayBuffer.size"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.core.UniformReplayBuffer.size" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the size of the replybuffer.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>size (int), the number of element in the replaybuffer.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mindspore_rl.core.PriorityReplayBuffer">
<em class="property">class </em><code class="sig-prename descclassname">mindspore_rl.core.</code><code class="sig-name descname">PriorityReplayBuffer</code><span class="sig-paren">(</span><em class="sig-param">alpha</em>, <em class="sig-param">capacity</em>, <em class="sig-param">sample_size</em>, <em class="sig-param">shapes</em>, <em class="sig-param">dtypes</em>, <em class="sig-param">seed0=0</em>, <em class="sig-param">seed1=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/priority_replay_buffer.html#PriorityReplayBuffer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.core.PriorityReplayBuffer" title="Permalink to this definition">¶</a></dt>
<dd><p>PriorityReplayBuffer is experience container used in Deep Q-Networks.
The algorithm is proposed in <cite>Prioritized Experience Replay &lt;https://arxiv.org/abs/1511.05952&gt;</cite>.
Same as the normal replay buffer, it lets the reinforcement learning agents remember and reuse experiences from the
past. Besides, it replays important transitions more frequently and improve sample effciency.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>alpha</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – parameter to control degree of prioritization.
0 means the uniform sampling, 1 means priority sampling.</p></li>
<li><p><strong>capacity</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – the capacity of the buffer.</p></li>
<li><p><strong>sample_size</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – size for sampling from the buffer.</p></li>
<li><p><strong>shapes</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>]</em>) – the shape of each tensor in a buffer element.</p></li>
<li><p><strong>types</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em>[</em><em>mindspore.dtype</em><em>]</em>) – the data type of each tensor in a buffer element.</p></li>
<li><p><strong>seed0</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Seed0 value for random generating. Default: 0.</p></li>
<li><p><strong>seed1</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Seed1 value for random generating. Default: 0.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mindspore</span> <span class="k">as</span> <span class="nn">ms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore</span> <span class="kn">import</span> <span class="n">Tensor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.core.priority_replay_buffer</span> <span class="kn">import</span> <span class="n">PriorityReplayBuffer</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">capacity</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">batch_size</span> <span class="o">=</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shapes</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">4</span><span class="p">,),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dtypes</span> <span class="o">=</span> <span class="p">[</span><span class="n">ms</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">ms</span><span class="o">.</span><span class="n">int32</span><span class="p">,</span> <span class="n">ms</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">ms</span><span class="o">.</span><span class="n">float32</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">replaybuffer</span> <span class="o">=</span> <span class="n">PriorityReplayBuffer</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">capacity</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">,</span> <span class="n">shapes</span><span class="p">,</span> <span class="n">dtypes</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">replaybuffer</span><span class="p">)</span>
<span class="go">PriorityReplayBuffer&lt;&gt;</span>
</pre></div>
</div>
<dl class="method">
<dt id="mindspore_rl.core.PriorityReplayBuffer.destroy">
<code class="sig-name descname">destroy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/priority_replay_buffer.html#PriorityReplayBuffer.destroy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.core.PriorityReplayBuffer.destroy" title="Permalink to this definition">¶</a></dt>
<dd><p>Destroy the replay buffer.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Priority replay buffer instance handle with dtype int64 and shape (1,).</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.core.PriorityReplayBuffer.push">
<code class="sig-name descname">push</code><span class="sig-paren">(</span><em class="sig-param">*transition</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/priority_replay_buffer.html#PriorityReplayBuffer.push"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.core.PriorityReplayBuffer.push" title="Permalink to this definition">¶</a></dt>
<dd><p>Push a transition to the buffer. If the buffer is full, the oldest one will be removed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>transition</strong> (<em>List</em><em>[</em><em>Tensor</em><em>]</em>) – insert a list of tensor which matches with the initialized shapes
and dtypes into the buffer.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>handle(Tensor), Priority replay buffer instance handle with dtype int64 and shape (1,).</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.core.PriorityReplayBuffer.sample">
<code class="sig-name descname">sample</code><span class="sig-paren">(</span><em class="sig-param">beta</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/priority_replay_buffer.html#PriorityReplayBuffer.sample"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.core.PriorityReplayBuffer.sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Samples a batch of transitions from the replay buffer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>beta</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – parameter to control degree of sampling correction.
0 means the no correction, 1 means full correction.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>indices (Tensor), the transition indices in the replay buffer.
weights (Tensor), the weight used to correct for sampling bias.
transitions (tuple(Tensor)), transitions with variable-length tensors.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.core.PriorityReplayBuffer.update_priorities">
<code class="sig-name descname">update_priorities</code><span class="sig-paren">(</span><em class="sig-param">indices</em>, <em class="sig-param">priorities</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/priority_replay_buffer.html#PriorityReplayBuffer.update_priorities"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.core.PriorityReplayBuffer.update_priorities" title="Permalink to this definition">¶</a></dt>
<dd><p>Update transition prorities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>indices</strong> (<em>Tensor</em>) – transition indices. The caller needs to ensure the validity of the indices.</p></li>
<li><p><strong>priorities</strong> (<em>Tensor</em>) – transition priorities.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>tuple(Tensor), Transition with its indices and correction weights.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-mindspore_rl.environment">
<span id="module-mindspore_rl.environment"></span><span id="mindspore-rl-environment"></span><h2>mindspore_rl.environment<a class="headerlink" href="#module-mindspore_rl.environment" title="Permalink to this headline">¶</a></h2>
<p>Component used to implement custom environments.</p>
<dl class="class">
<dt id="mindspore_rl.environment.GymEnvironment">
<em class="property">class </em><code class="sig-prename descclassname">mindspore_rl.environment.</code><code class="sig-name descname">GymEnvironment</code><span class="sig-paren">(</span><em class="sig-param">params</em>, <em class="sig-param">env_id=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/gym_environment.html#GymEnvironment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.GymEnvironment" title="Permalink to this definition">¶</a></dt>
<dd><p>The GymEnvironment class is a wrapper that encapsulates <a class="reference external" href="https://gym.openai.com/">Gym</a> to
provide the ability to interact with Gym environments in MindSpore Graph Mode.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – <p>A dictionary contains all the parameters which are used in this class.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 52%" />
<col style="width: 48%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Configuration Parameters</p></th>
<th class="head"><p>Notices</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>name</p></td>
<td><p>the name of game in Gym</p></td>
</tr>
<tr class="row-odd"><td><p>seed</p></td>
<td><p>seed used in Gym</p></td>
</tr>
</tbody>
</table>
</p></li>
<li><p><strong>env_id</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – A integer which is used to set the seed of this environment. Default: 0.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Supported Platforms:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">Ascend</span></code> <code class="docutils literal notranslate"><span class="pre">GPU</span></code> <code class="docutils literal notranslate"><span class="pre">CPU</span></code></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">env_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;CartPole-v0&#39;</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">environment</span> <span class="o">=</span> <span class="n">GymEnvironment</span><span class="p">(</span><span class="n">env_params</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">environment</span><span class="p">)</span>
<span class="go">GymEnvironment&lt;&gt;</span>
</pre></div>
</div>
<dl class="method">
<dt id="mindspore_rl.environment.GymEnvironment.action_space">
<em class="property">property </em><code class="sig-name descname">action_space</code><a class="headerlink" href="#mindspore_rl.environment.GymEnvironment.action_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the action space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The action space of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.GymEnvironment.close">
<code class="sig-name descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/gym_environment.html#GymEnvironment.close"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.GymEnvironment.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Close the environment to release the resource.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Success(np.bool_), Whether shutdown the process or threading successfully.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.GymEnvironment.config">
<em class="property">property </em><code class="sig-name descname">config</code><a class="headerlink" href="#mindspore_rl.environment.GymEnvironment.config" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the config of environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A dictionary which contains environment’s info.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.GymEnvironment.done_space">
<em class="property">property </em><code class="sig-name descname">done_space</code><a class="headerlink" href="#mindspore_rl.environment.GymEnvironment.done_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the done space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The done space of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.GymEnvironment.observation_space">
<em class="property">property </em><code class="sig-name descname">observation_space</code><a class="headerlink" href="#mindspore_rl.environment.GymEnvironment.observation_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the state space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The state space of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.GymEnvironment.render">
<code class="sig-name descname">render</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/gym_environment.html#GymEnvironment.render"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.GymEnvironment.render" title="Permalink to this definition">¶</a></dt>
<dd><p>Render the game. Only support on PyNative mode.</p>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.GymEnvironment.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/gym_environment.html#GymEnvironment.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.GymEnvironment.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the environment to the initial state. It is always used at the beginning of each
episode. It will return the value of initial state.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tensor which states for the initial state of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.GymEnvironment.reward_space">
<em class="property">property </em><code class="sig-name descname">reward_space</code><a class="headerlink" href="#mindspore_rl.environment.GymEnvironment.reward_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the reward space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The reward space of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.GymEnvironment.step">
<code class="sig-name descname">step</code><span class="sig-paren">(</span><em class="sig-param">action</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/gym_environment.html#GymEnvironment.step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.GymEnvironment.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute the environment step, which means that interact with environment once.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>action</strong> (<em>Tensor</em>) – A tensor that contains the action information.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>state (Tensor), the environment state after performing the action.</p></li>
<li><p>reward (Tensor), the reward after performing the action.</p></li>
<li><p>done (Tensor), whether the simulation finishes or not.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mindspore_rl.environment.MultiEnvironmentWrapper">
<em class="property">class </em><code class="sig-prename descclassname">mindspore_rl.environment.</code><code class="sig-name descname">MultiEnvironmentWrapper</code><span class="sig-paren">(</span><em class="sig-param">env_instance</em>, <em class="sig-param">num_proc=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/multi_environment_wrapper.html#MultiEnvironmentWrapper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.MultiEnvironmentWrapper" title="Permalink to this definition">¶</a></dt>
<dd><p>The MultiEnvironmentWrapper is a wrapper for multi environment scenario. User implements
their single environment class and set the environment number larger than 1 in configuration
file, framework will automatically invoke this class to create a multi environment class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env_instance</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em>[</em><a class="reference internal" href="#mindspore_rl.environment.Environment" title="mindspore_rl.environment.Environment"><em>Environment</em></a><em>]</em>) – A list that contains instance of environment (subclass of Environment).</p></li>
<li><p><strong>num_proc</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Number of processing uses during interacting with environment. Default: None.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Supported Platforms:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">Ascend</span></code> <code class="docutils literal notranslate"><span class="pre">GPU</span></code> <code class="docutils literal notranslate"><span class="pre">CPU</span></code></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">env_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;CartPole-v0&#39;</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">multi_env</span> <span class="o">=</span> <span class="p">[</span><span class="n">GymEnvironment</span><span class="p">(</span><span class="n">env_params</span><span class="p">),</span> <span class="n">GymEnvironment</span><span class="p">(</span><span class="n">env_params</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wrapper</span> <span class="o">=</span> <span class="n">MultiEnvironmentWrapper</span><span class="p">(</span><span class="n">multi_env</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">wrapper</span><span class="p">)</span>
<span class="go">MultiEnvironmentWrapper&lt;&gt;</span>
</pre></div>
</div>
<dl class="method">
<dt id="mindspore_rl.environment.MultiEnvironmentWrapper.action_space">
<em class="property">property </em><code class="sig-name descname">action_space</code><a class="headerlink" href="#mindspore_rl.environment.MultiEnvironmentWrapper.action_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the action space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tuple which states for the space of action.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.MultiEnvironmentWrapper.close">
<code class="sig-name descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/multi_environment_wrapper.html#MultiEnvironmentWrapper.close"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.MultiEnvironmentWrapper.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Close the environment to release the resource.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Success(np.bool_), Whether shutdown the process or threading successfully.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.MultiEnvironmentWrapper.config">
<em class="property">property </em><code class="sig-name descname">config</code><a class="headerlink" href="#mindspore_rl.environment.MultiEnvironmentWrapper.config" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the config of environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A dictionary which contains environment’s info.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.MultiEnvironmentWrapper.done_space">
<em class="property">property </em><code class="sig-name descname">done_space</code><a class="headerlink" href="#mindspore_rl.environment.MultiEnvironmentWrapper.done_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the done space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tuple which states for the space of done.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.MultiEnvironmentWrapper.observation_space">
<em class="property">property </em><code class="sig-name descname">observation_space</code><a class="headerlink" href="#mindspore_rl.environment.MultiEnvironmentWrapper.observation_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the state space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tuple which states for the space of state.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.MultiEnvironmentWrapper.render">
<code class="sig-name descname">render</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/multi_environment_wrapper.html#MultiEnvironmentWrapper.render"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.MultiEnvironmentWrapper.render" title="Permalink to this definition">¶</a></dt>
<dd><p>Render the game. Only support on PyNative mode.</p>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.MultiEnvironmentWrapper.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/multi_environment_wrapper.html#MultiEnvironmentWrapper.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.MultiEnvironmentWrapper.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the environment to the initial state. It is always used at the beginning of each
episode. It will return the value of initial state of each environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A list of tensor which states for all the initial states of each environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.MultiEnvironmentWrapper.reward_space">
<em class="property">property </em><code class="sig-name descname">reward_space</code><a class="headerlink" href="#mindspore_rl.environment.MultiEnvironmentWrapper.reward_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the reward space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tuple which states for the space of reward.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.MultiEnvironmentWrapper.step">
<code class="sig-name descname">step</code><span class="sig-paren">(</span><em class="sig-param">action</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/multi_environment_wrapper.html#MultiEnvironmentWrapper.step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.MultiEnvironmentWrapper.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute the environment step, which means that interact with environment once.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>action</strong> (<em>Tensor</em>) – A tensor that contains the action information.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>state (list(Tensor)), a list of environment state after performing the action.</p></li>
<li><p>reward (list(Tensor)), a list of reward after performing the action.</p></li>
<li><p>done (list(Tensor)), whether the simulations of each environment finishes or not.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mindspore_rl.environment.Environment">
<em class="property">class </em><code class="sig-prename descclassname">mindspore_rl.environment.</code><code class="sig-name descname">Environment</code><a class="reference internal" href="_modules/mindspore_rl/environment/environment.html#Environment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.Environment" title="Permalink to this definition">¶</a></dt>
<dd><p>The virtual base class for the environment. This class should be overridden before calling in the model.</p>
<dl class="method">
<dt id="mindspore_rl.environment.Environment.action_space">
<em class="property">property </em><code class="sig-name descname">action_space</code><a class="headerlink" href="#mindspore_rl.environment.Environment.action_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the action space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The action space of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.Environment.close">
<code class="sig-name descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/environment.html#Environment.close"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.Environment.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Close the environment to release the resource.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Success(np.bool_), Whether shutdown the process or threading successfully.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.Environment.config">
<em class="property">property </em><code class="sig-name descname">config</code><a class="headerlink" href="#mindspore_rl.environment.Environment.config" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the config of environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A dictionary which contains environment’s info.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.Environment.done_space">
<em class="property">property </em><code class="sig-name descname">done_space</code><a class="headerlink" href="#mindspore_rl.environment.Environment.done_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the done space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The done space of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.Environment.observation_space">
<em class="property">property </em><code class="sig-name descname">observation_space</code><a class="headerlink" href="#mindspore_rl.environment.Environment.observation_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the state space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The state space of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.Environment.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/environment.html#Environment.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.Environment.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the environment to the initial state. It is always used at the beginning of each
episode. It will return the value of initial state or other initial information.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tensor which states for the initial state of environment or a tuple contains
initial information, such as new state, action, reward, etc.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.Environment.reward_space">
<em class="property">property </em><code class="sig-name descname">reward_space</code><a class="headerlink" href="#mindspore_rl.environment.Environment.reward_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the reward space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The reward space of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.Environment.step">
<code class="sig-name descname">step</code><span class="sig-paren">(</span><em class="sig-param">action</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/environment.html#Environment.step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.Environment.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute the environment step, which means that interact with environment once.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>action</strong> (<em>Tensor</em>) – A tensor that contains the action information.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tuple of Tensor which contains information after interacting with environment.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mindspore_rl.environment.Space">
<em class="property">class </em><code class="sig-prename descclassname">mindspore_rl.environment.</code><code class="sig-name descname">Space</code><span class="sig-paren">(</span><em class="sig-param">feature_shape</em>, <em class="sig-param">dtype</em>, <em class="sig-param">low=None</em>, <em class="sig-param">high=None</em>, <em class="sig-param">batch_shape=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/space.html#Space"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.Space" title="Permalink to this definition">¶</a></dt>
<dd><p>The class for environment action/observation space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>feature_shape</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em>(</em><a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>)</em><em>, </em><a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em>(</em><a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>)</em><em>, </em><a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>]</em>) – The action/observation shape before batching.</p></li>
<li><p><strong>dtype</strong> (<em>np.dtype</em>) – The action/observation space dtype.</p></li>
<li><p><strong>low</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a><em>]</em><em>, </em><em>optional</em>) – The action/observation space lower boundary.</p></li>
<li><p><strong>high</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a><em>]</em><em>, </em><em>optional</em>) – The action/observation space upper boundary.</p></li>
<li><p><strong>batch_shape</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em>(</em><a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>)</em><em>, </em><a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em>(</em><a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>)</em><em>, </em><a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>]</em><em>, </em><em>optional</em>) – The batch shape for vectorization.
It usually be used in multi-environment and multi-agent cases.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">action_space</span> <span class="o">=</span> <span class="n">Space</span><span class="p">(</span><span class="n">feature_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">action_space</span><span class="o">.</span><span class="n">ms_dtype</span><span class="p">)</span>
<span class="go">Int32</span>
</pre></div>
</div>
<dl class="method">
<dt id="mindspore_rl.environment.Space.boundary">
<em class="property">property </em><code class="sig-name descname">boundary</code><a class="headerlink" href="#mindspore_rl.environment.Space.boundary" title="Permalink to this definition">¶</a></dt>
<dd><p>The space boundary of current Space.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Uppoer and lower boundary of current space.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.Space.is_discrete">
<em class="property">property </em><code class="sig-name descname">is_discrete</code><a class="headerlink" href="#mindspore_rl.environment.Space.is_discrete" title="Permalink to this definition">¶</a></dt>
<dd><p>Is discrete space.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Whether the current space is discrete or continuous.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.Space.ms_dtype">
<em class="property">property </em><code class="sig-name descname">ms_dtype</code><a class="headerlink" href="#mindspore_rl.environment.Space.ms_dtype" title="Permalink to this definition">¶</a></dt>
<dd><p>MindSpore data type of current Space.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The mindspore data type of current space.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.Space.np_dtype">
<em class="property">property </em><code class="sig-name descname">np_dtype</code><a class="headerlink" href="#mindspore_rl.environment.Space.np_dtype" title="Permalink to this definition">¶</a></dt>
<dd><p>Numpy data type of current Space.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The numpy dtype of current space.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.Space.num_values">
<em class="property">property </em><code class="sig-name descname">num_values</code><a class="headerlink" href="#mindspore_rl.environment.Space.num_values" title="Permalink to this definition">¶</a></dt>
<dd><p>available action number of current Space.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The available action of current space.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.Space.sample">
<code class="sig-name descname">sample</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/space.html#Space.sample"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.Space.sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Sample a valid action from the space</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Tensor, a valid action.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.Space.shape">
<em class="property">property </em><code class="sig-name descname">shape</code><a class="headerlink" href="#mindspore_rl.environment.Space.shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Space shape after batching.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The shape of current space.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mindspore_rl.environment.MsEnvironment">
<em class="property">class </em><code class="sig-prename descclassname">mindspore_rl.environment.</code><code class="sig-name descname">MsEnvironment</code><span class="sig-paren">(</span><em class="sig-param">kwargs=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/ms_environment.html#MsEnvironment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.MsEnvironment" title="Permalink to this definition">¶</a></dt>
<dd><p>Class encapsulates built-in environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kwargs</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – <p>The dictionary of environment specific configurations. See below table for details:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 21%" />
<col style="width: 31%" />
<col style="width: 19%" />
<col style="width: 29%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Environment name</p></th>
<th class="head"><p>Configuration Parameters</p></th>
<th class="head"><p>Default value</p></th>
<th class="head"><p>Notices</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td rowspan="10"><p>Tag</p></td>
<td><p>seed</p></td>
<td><p>42</p></td>
<td><p>random seed</p></td>
</tr>
<tr class="row-odd"><td><p>environment_num</p></td>
<td><p>2</p></td>
<td><p>number of environments</p></td>
</tr>
<tr class="row-even"><td><p>predator_num</p></td>
<td><p>10</p></td>
<td><p>number of predators</p></td>
</tr>
<tr class="row-odd"><td><p>max_timestep</p></td>
<td><p>100</p></td>
<td><p>max timestep per episode</p></td>
</tr>
<tr class="row-even"><td><p>map_length</p></td>
<td><p>100</p></td>
<td><p>length of map</p></td>
</tr>
<tr class="row-odd"><td><p>map_width</p></td>
<td><p>100</p></td>
<td><p>width of map</p></td>
</tr>
<tr class="row-even"><td><p>wall_hit_penalty</p></td>
<td><p>0.1</p></td>
<td><p>agent wall hit penalty</p></td>
</tr>
<tr class="row-odd"><td><p>catch_reward</p></td>
<td><p>10</p></td>
<td><p>predator catch reward</p></td>
</tr>
<tr class="row-even"><td><p>caught_penalty</p></td>
<td><p>5</p></td>
<td><p>prey caught penalty</p></td>
</tr>
<tr class="row-odd"><td><p>step_cost</p></td>
<td><p>0.01</p></td>
<td><p>step cost</p></td>
</tr>
</tbody>
</table>
</p>
</dd>
</dl>
<dl class="simple">
<dt>Supported Platforms:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">GPU</span></code></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">config</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Tag&#39;</span><span class="p">,</span> <span class="s1">&#39;predator_num&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">env</span> <span class="o">=</span> <span class="n">MsEnvironment</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">observation</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">action</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">action_space</span><span class="o">.</span><span class="n">sample</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">observation</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">done</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">observation</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(2, 5, 21)</span>
</pre></div>
</div>
<dl class="method">
<dt id="mindspore_rl.environment.MsEnvironment.action_space">
<em class="property">property </em><code class="sig-name descname">action_space</code><a class="headerlink" href="#mindspore_rl.environment.MsEnvironment.action_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the valid action space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The action space of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.MsEnvironment.config">
<em class="property">property </em><code class="sig-name descname">config</code><a class="headerlink" href="#mindspore_rl.environment.MsEnvironment.config" title="Permalink to this definition">¶</a></dt>
<dd><p>Get environment configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The configuration of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.MsEnvironment.done_space">
<em class="property">property </em><code class="sig-name descname">done_space</code><a class="headerlink" href="#mindspore_rl.environment.MsEnvironment.done_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the valid done space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The done space of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.MsEnvironment.observation_space">
<em class="property">property </em><code class="sig-name descname">observation_space</code><a class="headerlink" href="#mindspore_rl.environment.MsEnvironment.observation_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the valid observation space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The state space of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.MsEnvironment.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/ms_environment.html#MsEnvironment.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.MsEnvironment.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the environment to initial observation and return the initial observation.</p>
<dl class="simple">
<dt>Inputs:</dt><dd><p>No inputs.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Tensor, the initial observation.</p>
</dd>
</dl>
<dl class="simple">
<dt>Supported Platforms:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">GPU</span></code></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">config</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Tag&#39;</span><span class="p">,</span> <span class="s1">&#39;predator_num&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">env</span> <span class="o">=</span> <span class="n">MsEnvironment</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">observation</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">observation</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(2, 5, 21)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.MsEnvironment.reward_space">
<em class="property">property </em><code class="sig-name descname">reward_space</code><a class="headerlink" href="#mindspore_rl.environment.MsEnvironment.reward_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the valid reward space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The reward space of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.MsEnvironment.step">
<code class="sig-name descname">step</code><span class="sig-paren">(</span><em class="sig-param">action</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/ms_environment.html#MsEnvironment.step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.MsEnvironment.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Run one timestep of environment to interact with environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>action</strong> (<em>Tensor</em>) – Action provided by the all of agents.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>Tuple of 3 tensors, the observation, the reward and the done.</p>
<ul class="simple">
<li><p><strong>observation</strong> (Tensor) - Observations of all agents after action.</p></li>
<li><p><strong>reward</strong> (Tensor) - Amount of reward returned by the environment.</p></li>
<li><p><strong>done</strong> (Tensor) - Whether the episode has ended.</p></li>
</ul>
</p>
</dd>
</dl>
<dl class="simple">
<dt>Supported Platforms:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">GPU</span></code></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">config</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Tag&#39;</span><span class="p">,</span> <span class="s1">&#39;predator_num&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">env</span> <span class="o">=</span> <span class="n">MsEnvironment</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">observation</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">action</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">action_space</span><span class="o">.</span><span class="n">sample</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">observation</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">done</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">observation</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(2, 5, 21)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mindspore_rl.environment.EnvironmentProcess">
<em class="property">class </em><code class="sig-prename descclassname">mindspore_rl.environment.</code><code class="sig-name descname">EnvironmentProcess</code><span class="sig-paren">(</span><em class="sig-param">proc_no</em>, <em class="sig-param">env_num</em>, <em class="sig-param">envs</em>, <em class="sig-param">actions</em>, <em class="sig-param">observations</em>, <em class="sig-param">initial_states</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/env_process.html#EnvironmentProcess"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.EnvironmentProcess" title="Permalink to this definition">¶</a></dt>
<dd><p>An independent process responsible for creating and interacting with one or more environments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>proc_no</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The process number assigned by the caller.</p></li>
<li><p><strong>env_num</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The number of input environments.</p></li>
<li><p><strong>envs</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em>(</em><a class="reference internal" href="#mindspore_rl.environment.Environment" title="mindspore_rl.environment.Environment"><em>Environment</em></a><em>)</em>) – A list that contains instance of environment (subclass of Environment).</p></li>
<li><p><strong>actions</strong> (<em>Queue</em>) – The queue used to pass actions to the environment process.</p></li>
<li><p><strong>observations</strong> (<em>Queue</em>) – The queue used to pass observations to the caller process.</p></li>
<li><p><strong>initial_states</strong> (<em>Queue</em>) – The queue used to pass initial states to the caller process.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">multiprocessing</span> <span class="kn">import</span> <span class="n">Queue</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">actions</span> <span class="o">=</span> <span class="n">Queue</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">observations</span> <span class="o">=</span> <span class="n">Queue</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">initial_states</span> <span class="o">=</span> <span class="n">Queue</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">proc_no</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">env_num</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">env_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;CartPole-v0&#39;</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">multi_env</span> <span class="o">=</span> <span class="p">[</span><span class="n">GymEnvironment</span><span class="p">(</span><span class="n">env_params</span><span class="p">),</span> <span class="n">GymEnvironment</span><span class="p">(</span><span class="n">env_params</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">env_proc</span> <span class="o">=</span> <span class="n">EnvironmentProcess</span><span class="p">(</span><span class="n">proc_no</span><span class="p">,</span> <span class="n">env_num</span><span class="p">,</span> <span class="n">multi_env</span><span class="p">,</span> <span class="n">actions</span><span class="p">,</span> <span class="n">observations</span><span class="p">,</span> <span class="n">initial_states</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">env_proc</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</pre></div>
</div>
<dl class="method">
<dt id="mindspore_rl.environment.EnvironmentProcess.run">
<code class="sig-name descname">run</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/env_process.html#EnvironmentProcess.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.EnvironmentProcess.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to be run in sub-process; can be overridden in sub-class</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mindspore_rl.environment.StarCraft2Environment">
<em class="property">class </em><code class="sig-prename descclassname">mindspore_rl.environment.</code><code class="sig-name descname">StarCraft2Environment</code><span class="sig-paren">(</span><em class="sig-param">params</em>, <em class="sig-param">env_id=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/sc2_environment.html#StarCraft2Environment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.StarCraft2Environment" title="Permalink to this definition">¶</a></dt>
<dd><p>StarCraft2Environment is a wrapper of SMAC. SMAC is WhiRL’s environment for research in the
field of collaborative multi-agent reinforcement learning (MARL) based on Blizzard’s
StarCraft II RTS game. SMAC makes use of Blizzard’s StarCraft II Machine Learning API and
DeepMind’s PySC2 to provide a convenient interface for autonomous agents to interact with
StarCraft II, getting observations and performing actions. Unlike the PySC2, SMAC concentrates
on decentralised micromanagement scenarios, where each unit of the game is controlled by an
individual RL agent. More detail please have a look at the official github of SMAC:
<a class="reference external" href="https://github.com/oxwhirl/smac">https://github.com/oxwhirl/smac</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – <p>A dictionary contains all the parameters which are used in this class.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 35%" />
<col style="width: 65%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Configuration Parameters</p></th>
<th class="head"><p>Notices</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>sc2_args</p></td>
<td><p>a dict which contains key value that is used to create
instance of SMAC, such as map_name. For more detail
please have a look at its official github.</p></td>
</tr>
</tbody>
</table>
</p></li>
<li><p><strong>env_id</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – A integer which is used to set the seed of this environment.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Supported Platforms:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">Ascend</span></code> <code class="docutils literal notranslate"><span class="pre">GPU</span></code> <code class="docutils literal notranslate"><span class="pre">CPU</span></code></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">env_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;sc2_args&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;map_name&#39;</span><span class="p">:</span> <span class="s1">&#39;2s3z&#39;</span><span class="p">}}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">environment</span> <span class="o">=</span> <span class="n">StarCraft2Environment</span><span class="p">(</span><span class="n">env_params</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">environment</span><span class="p">)</span>
</pre></div>
</div>
<dl class="method">
<dt id="mindspore_rl.environment.StarCraft2Environment.action_space">
<em class="property">property </em><code class="sig-name descname">action_space</code><a class="headerlink" href="#mindspore_rl.environment.StarCraft2Environment.action_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the action space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tuple which states for the space of observation.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.StarCraft2Environment.close">
<code class="sig-name descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/sc2_environment.html#StarCraft2Environment.close"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.StarCraft2Environment.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Close the environment to release the resource.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Success(np.bool_), Whether shutdown the process or threading successfully.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.StarCraft2Environment.config">
<em class="property">property </em><code class="sig-name descname">config</code><a class="headerlink" href="#mindspore_rl.environment.StarCraft2Environment.config" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the config of environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A dictionary which contains environment’s info.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.StarCraft2Environment.done_space">
<em class="property">property </em><code class="sig-name descname">done_space</code><a class="headerlink" href="#mindspore_rl.environment.StarCraft2Environment.done_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the done space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The done space of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.StarCraft2Environment.get_step_info">
<code class="sig-name descname">get_step_info</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/sc2_environment.html#StarCraft2Environment.get_step_info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.StarCraft2Environment.get_step_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the information after interacting with environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>battle_won, whether this game is won or not.</p></li>
<li><p>dead_allies, how many allies are dead.</p></li>
<li><p>dead_enemies, how many enemies are dead.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.StarCraft2Environment.observation_space">
<em class="property">property </em><code class="sig-name descname">observation_space</code><a class="headerlink" href="#mindspore_rl.environment.StarCraft2Environment.observation_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the state space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tuple which states for the space of state.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.StarCraft2Environment.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/sc2_environment.html#StarCraft2Environment.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.StarCraft2Environment.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the environment to the initial state. It is always used at the beginning of each
episode. It will return the value of initial state, the global observation and
an new available action.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tuple of Tensor contains initial state, global observation and available actions.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.StarCraft2Environment.reward_space">
<em class="property">property </em><code class="sig-name descname">reward_space</code><a class="headerlink" href="#mindspore_rl.environment.StarCraft2Environment.reward_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the reward space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The reward space of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.StarCraft2Environment.step">
<code class="sig-name descname">step</code><span class="sig-paren">(</span><em class="sig-param">action</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/sc2_environment.html#StarCraft2Environment.step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.StarCraft2Environment.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute the environment step, which means that interact with environment once.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>action</strong> (<em>Tensor</em>) – A tensor that contains the action information.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>state (Tensor), the environment state after performing the action.</p></li>
<li><p>reward (Tensor), the reward after performing the action.</p></li>
<li><p>done (mindspore.bool_), whether the simulation finishes or not.</p></li>
<li><p>global_obs, the global observation of this environment.</p></li>
<li><p>avail_actions, the available actions in this state.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mindspore_rl.environment.TicTacToeEnvironment">
<em class="property">class </em><code class="sig-prename descclassname">mindspore_rl.environment.</code><code class="sig-name descname">TicTacToeEnvironment</code><span class="sig-paren">(</span><em class="sig-param">params</em>, <em class="sig-param">env_id=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/tic_tac_toe_environment.html#TicTacToeEnvironment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.TicTacToeEnvironment" title="Permalink to this definition">¶</a></dt>
<dd><p>Tic-Tac-Toe is a famous paper-and-pencil game (<a class="reference external" href="https://en.wikipedia.org/wiki/Tic-tac-toe">https://en.wikipedia.org/wiki/Tic-tac-toe</a>). The rule is that two
players draw Os or Xs in a three-by-tree grid. When three of their marks are in a Horizontal, vertical or diagonal
row, that player will be the winner. The following figure is an example of Tic-Tac-Toe.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>o</p></td>
<td></td>
<td><p>x</p></td>
</tr>
<tr class="row-even"><td><p>x</p></td>
<td><p>o</p></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>x</p></td>
<td><p>o</p></td>
</tr>
</tbody>
</table>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – A dictionary contains all the parameters which are used in this class.</p></li>
<li><p><strong>env_id</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – A integer which is used to set the seed of this environment. Default: 0.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Supported Platforms:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">Ascend</span></code> <code class="docutils literal notranslate"><span class="pre">GPU</span></code> <code class="docutils literal notranslate"><span class="pre">CPU</span></code></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.environment</span> <span class="kn">import</span> <span class="n">TicTacToeEnvironment</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">env_params</span> <span class="o">=</span> <span class="p">{}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">environment</span> <span class="o">=</span> <span class="n">TicTacToeEnvironment</span><span class="p">(</span><span class="n">env_params</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">environment</span><span class="p">)</span>
<span class="go">TicTacToeEnvironment&lt;&gt;</span>
</pre></div>
</div>
<dl class="method">
<dt id="mindspore_rl.environment.TicTacToeEnvironment.action_space">
<em class="property">property </em><code class="sig-name descname">action_space</code><a class="headerlink" href="#mindspore_rl.environment.TicTacToeEnvironment.action_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the action space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The action space of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.TicTacToeEnvironment.calculate_rewards">
<code class="sig-name descname">calculate_rewards</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/tic_tac_toe_environment.html#TicTacToeEnvironment.calculate_rewards"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.TicTacToeEnvironment.calculate_rewards" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the rewards of current state.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tensor which states for the rewards of current state.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.TicTacToeEnvironment.config">
<em class="property">property </em><code class="sig-name descname">config</code><a class="headerlink" href="#mindspore_rl.environment.TicTacToeEnvironment.config" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the config of environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A dictionary which contains environment’s info.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.TicTacToeEnvironment.current_player">
<code class="sig-name descname">current_player</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/tic_tac_toe_environment.html#TicTacToeEnvironment.current_player"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.TicTacToeEnvironment.current_player" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the current player of current state.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tensor which states for current player.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.TicTacToeEnvironment.done_space">
<em class="property">property </em><code class="sig-name descname">done_space</code><a class="headerlink" href="#mindspore_rl.environment.TicTacToeEnvironment.done_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the done space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The done space of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.TicTacToeEnvironment.is_terminal">
<code class="sig-name descname">is_terminal</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/tic_tac_toe_environment.html#TicTacToeEnvironment.is_terminal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.TicTacToeEnvironment.is_terminal" title="Permalink to this definition">¶</a></dt>
<dd><p>Return whether the current state is terminal.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>whether the current state is terminal or not.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.TicTacToeEnvironment.legal_action">
<code class="sig-name descname">legal_action</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/tic_tac_toe_environment.html#TicTacToeEnvironment.legal_action"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.TicTacToeEnvironment.legal_action" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the legal action of current state.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tensor which states for the legal action.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.TicTacToeEnvironment.load">
<code class="sig-name descname">load</code><span class="sig-paren">(</span><em class="sig-param">state</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/tic_tac_toe_environment.html#TicTacToeEnvironment.load"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.TicTacToeEnvironment.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Load the input state. It will update the legal action, current state and done info of the game to the
input checkpoint.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>state</strong> (<em>Tensor</em>) – The input checkpoint state.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>state (Tensor), the state of checkpoint.</p></li>
<li><p>reward (Tensor), the reward of checkpoint.</p></li>
<li><p>done (Tensor), whether the checkpoint is terminal.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.TicTacToeEnvironment.max_utility">
<code class="sig-name descname">max_utility</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/tic_tac_toe_environment.html#TicTacToeEnvironment.max_utility"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.TicTacToeEnvironment.max_utility" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the max utility of Tic-Tac-Toe.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tensor which states for max utility.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.TicTacToeEnvironment.observation_space">
<em class="property">property </em><code class="sig-name descname">observation_space</code><a class="headerlink" href="#mindspore_rl.environment.TicTacToeEnvironment.observation_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the state space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The state space of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.TicTacToeEnvironment.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/tic_tac_toe_environment.html#TicTacToeEnvironment.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.TicTacToeEnvironment.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the environment to the initial state. It is always used at the beginning of each
episode. It will return the value of initial state.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A Tensor which states for initial state.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.TicTacToeEnvironment.reward_space">
<em class="property">property </em><code class="sig-name descname">reward_space</code><a class="headerlink" href="#mindspore_rl.environment.TicTacToeEnvironment.reward_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the reward space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The reward space of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.TicTacToeEnvironment.save">
<code class="sig-name descname">save</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/tic_tac_toe_environment.html#TicTacToeEnvironment.save"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.TicTacToeEnvironment.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a repilca of environment. Tic-Tac-Toe do not need a replica, thus it will return the current
state</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tensor which states for the current state.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.TicTacToeEnvironment.step">
<code class="sig-name descname">step</code><span class="sig-paren">(</span><em class="sig-param">action</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/tic_tac_toe_environment.html#TicTacToeEnvironment.step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.TicTacToeEnvironment.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute the environment step, which means that interact with environment once.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>action</strong> (<em>Tensor</em>) – A tensor that contains the action information.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>state (Tensor), the environment state after performing the action.</p></li>
<li><p>reward (Tensor), the reward after performing the action.</p></li>
<li><p>done (Tensor), whether the simulation finishes or not.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.TicTacToeEnvironment.total_num_player">
<code class="sig-name descname">total_num_player</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/tic_tac_toe_environment.html#TicTacToeEnvironment.total_num_player"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.TicTacToeEnvironment.total_num_player" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the total number of player</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>int, the total number of player.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mindspore_rl.environment.DeepMindControlEnvironment">
<em class="property">class </em><code class="sig-prename descclassname">mindspore_rl.environment.</code><code class="sig-name descname">DeepMindControlEnvironment</code><span class="sig-paren">(</span><em class="sig-param">params</em>, <em class="sig-param">env_id=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/dmc_environment.html#DeepMindControlEnvironment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.DeepMindControlEnvironment" title="Permalink to this definition">¶</a></dt>
<dd><p>DeepMindControlEnvironment is a wrapper which encapsulates the DeepMind Control Suite(DMC)
It stack for physics-based simulation and Reinforcement Learning environments, using MUJOCO
physics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – <p>A dictionary contains all the parameters which are used in this class.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 52%" />
<col style="width: 48%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Configuration Parameters</p></th>
<th class="head"><p>Notices</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>env_name</p></td>
<td><p>the name of game in DMC</p></td>
</tr>
<tr class="row-odd"><td><p>seed</p></td>
<td><p>seed used in Gym</p></td>
</tr>
<tr class="row-even"><td><p>camera</p></td>
<td><p>The camera pos used in
render</p></td>
</tr>
<tr class="row-odd"><td><p>action_repeat</p></td>
<td><p>How many times an action
interacts with env</p></td>
</tr>
<tr class="row-even"><td><p>normalize_action</p></td>
<td><p>Whether needs to normalize
the input action</p></td>
</tr>
<tr class="row-odd"><td><p>img_size</p></td>
<td><p>The rendered img size</p></td>
</tr>
</tbody>
</table>
</p></li>
<li><p><strong>env_id</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – A integer which is used to set the seed of this environment. Default: 0.</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="mindspore_rl.environment.DeepMindControlEnvironment.action_space">
<em class="property">property </em><code class="sig-name descname">action_space</code><a class="headerlink" href="#mindspore_rl.environment.DeepMindControlEnvironment.action_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the action space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The action space of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.DeepMindControlEnvironment.close">
<code class="sig-name descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/dmc_environment.html#DeepMindControlEnvironment.close"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.DeepMindControlEnvironment.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Close the environment to release the resource.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Success(np.bool_), Whether shutdown the process or threading successfully.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.DeepMindControlEnvironment.config">
<em class="property">property </em><code class="sig-name descname">config</code><a class="headerlink" href="#mindspore_rl.environment.DeepMindControlEnvironment.config" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the config of environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A dictionary which contains environment’s info.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.DeepMindControlEnvironment.done_space">
<em class="property">property </em><code class="sig-name descname">done_space</code><a class="headerlink" href="#mindspore_rl.environment.DeepMindControlEnvironment.done_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the done space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The done space of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.DeepMindControlEnvironment.observation_space">
<em class="property">property </em><code class="sig-name descname">observation_space</code><a class="headerlink" href="#mindspore_rl.environment.DeepMindControlEnvironment.observation_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the state space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The state space of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.DeepMindControlEnvironment.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/dmc_environment.html#DeepMindControlEnvironment.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.DeepMindControlEnvironment.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the environment to the initial state. It is always used at the beginning of each
episode. It will return the value of initial state.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tensor which states for the initial state of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.DeepMindControlEnvironment.reward_space">
<em class="property">property </em><code class="sig-name descname">reward_space</code><a class="headerlink" href="#mindspore_rl.environment.DeepMindControlEnvironment.reward_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the reward space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The reward space of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.DeepMindControlEnvironment.step">
<code class="sig-name descname">step</code><span class="sig-paren">(</span><em class="sig-param">action</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/dmc_environment.html#DeepMindControlEnvironment.step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.DeepMindControlEnvironment.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute the environment step, which means that interact with environment once.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>action</strong> (<em>Tensor</em>) – A tensor that contains the action information.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>state (Tensor), the environment state after performing the action.</p></li>
<li><p>reward (Tensor), the reward after performing the action.</p></li>
<li><p>done (Tensor), whether the simulation finishes or not.</p></li>
<li><p>discount (Tensor), the discount value of env.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="mindspore-rl-network">
<h2>mindspore_rl.network<a class="headerlink" href="#mindspore-rl-network" title="Permalink to this headline">¶</a></h2>
</div>
<div class="section" id="module-mindspore_rl.policy">
<span id="module-mindspore_rl.policy"></span><span id="mindspore-rl-policy"></span><h2>mindspore_rl.policy<a class="headerlink" href="#module-mindspore_rl.policy" title="Permalink to this headline">¶</a></h2>
<p>Policies used in RL algorithms.</p>
<dl class="class">
<dt id="mindspore_rl.policy.Policy">
<em class="property">class </em><code class="sig-prename descclassname">mindspore_rl.policy.</code><code class="sig-name descname">Policy</code><a class="reference internal" href="_modules/mindspore_rl/policy/policy.html#Policy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.policy.Policy" title="Permalink to this definition">¶</a></dt>
<dd><p>The virtual base class for the policy. This class should be overridden before calling in the model.</p>
<dl class="method">
<dt id="mindspore_rl.policy.Policy.construct">
<code class="sig-name descname">construct</code><span class="sig-paren">(</span><em class="sig-param">*inputs</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/policy/policy.html#Policy.construct"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.policy.Policy.construct" title="Permalink to this definition">¶</a></dt>
<dd><p>The interface of the construct function. Inherited and used by users.
Args can refer to ‘epsilongreedypolicy’, ‘randompolicy’, etc.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong> – it’s depended on the user definition.</p></li>
<li><p><strong>kwargs</strong> – it’s depended on the user definition.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>User defined. Usually, it returns an action value or the probability distribution of an action.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mindspore_rl.policy.RandomPolicy">
<em class="property">class </em><code class="sig-prename descclassname">mindspore_rl.policy.</code><code class="sig-name descname">RandomPolicy</code><span class="sig-paren">(</span><em class="sig-param">action_space_dim</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/policy/random_policy.html#RandomPolicy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.policy.RandomPolicy" title="Permalink to this definition">¶</a></dt>
<dd><p>Produces a random action betweens [0, <cite>acton_space_dim</cite>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>action_space_dim</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – dimension of the action space.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">action_space_dim</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">policy</span> <span class="o">=</span> <span class="n">RandomPolicy</span><span class="p">(</span><span class="n">action_space_dim</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">policy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(1,)</span>
</pre></div>
</div>
<dl class="method">
<dt id="mindspore_rl.policy.RandomPolicy.construct">
<code class="sig-name descname">construct</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/policy/random_policy.html#RandomPolicy.construct"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.policy.RandomPolicy.construct" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a random number betweens [0, <cite>acton_space_dim</cite>).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A random integer betweens [0, <cite>acton_space_dim</cite>).</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mindspore_rl.policy.GreedyPolicy">
<em class="property">class </em><code class="sig-prename descclassname">mindspore_rl.policy.</code><code class="sig-name descname">GreedyPolicy</code><span class="sig-paren">(</span><em class="sig-param">input_network</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/policy/greedy_policy.html#GreedyPolicy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.policy.GreedyPolicy" title="Permalink to this definition">¶</a></dt>
<dd><p>Produces a sample action base on the given greedy policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input_network</strong> (<em>Cell</em>) – network used to generate action probs by input state.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">state_dim</span><span class="p">,</span> <span class="n">hidden_dim</span><span class="p">,</span> <span class="n">action_dim</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_net</span> <span class="o">=</span> <span class="n">FullyConnectedNet</span><span class="p">(</span><span class="n">state_dim</span><span class="p">,</span> <span class="n">hidden_dim</span><span class="p">,</span> <span class="n">action_dim</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">policy</span> <span class="o">=</span> <span class="n">GreedyPolicy</span><span class="p">(</span><span class="n">input_net</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">state</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">policy</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(2,)</span>
</pre></div>
</div>
<dl class="method">
<dt id="mindspore_rl.policy.GreedyPolicy.construct">
<code class="sig-name descname">construct</code><span class="sig-paren">(</span><em class="sig-param">state</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/policy/greedy_policy.html#GreedyPolicy.construct"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.policy.GreedyPolicy.construct" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the best action.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>state</strong> (<em>Tensor</em>) – State tensor as the input of network.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>action_max, the best action.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mindspore_rl.policy.EpsilonGreedyPolicy">
<em class="property">class </em><code class="sig-prename descclassname">mindspore_rl.policy.</code><code class="sig-name descname">EpsilonGreedyPolicy</code><span class="sig-paren">(</span><em class="sig-param">input_network</em>, <em class="sig-param">size</em>, <em class="sig-param">epsi_high</em>, <em class="sig-param">epsi_low</em>, <em class="sig-param">decay</em>, <em class="sig-param">action_space_dim</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/policy/epsilon_greedy_policy.html#EpsilonGreedyPolicy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.policy.EpsilonGreedyPolicy" title="Permalink to this definition">¶</a></dt>
<dd><p>Produces a sample action base on the given epsilon-greedy policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_network</strong> (<em>Cell</em>) – A network returns policy action.</p></li>
<li><p><strong>size</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Shape of epsilon.</p></li>
<li><p><strong>epsi_high</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – A high epsilon for exploration betweens [0, 1].</p></li>
<li><p><strong>epsi_low</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – A low epsilon for exploration betweens [0, epsi_high].</p></li>
<li><p><strong>decay</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – A decay factor applied to epsilon.</p></li>
<li><p><strong>action_space_dim</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Dimensions of the action space.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">state_dim</span><span class="p">,</span> <span class="n">hidden_dim</span><span class="p">,</span> <span class="n">action_dim</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_net</span> <span class="o">=</span> <span class="n">FullyConnectedNet</span><span class="p">(</span><span class="n">state_dim</span><span class="p">,</span> <span class="n">hidden_dim</span><span class="p">,</span> <span class="n">action_dim</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">policy</span> <span class="o">=</span> <span class="n">EpsilonGreedyPolicy</span><span class="p">(</span><span class="n">input_net</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">action_dim</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">state</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="n">state_dim</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">step</span> <span class="o">=</span>  <span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">10</span><span class="p">,])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">policy</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(1,)</span>
</pre></div>
</div>
<dl class="method">
<dt id="mindspore_rl.policy.EpsilonGreedyPolicy.construct">
<code class="sig-name descname">construct</code><span class="sig-paren">(</span><em class="sig-param">state</em>, <em class="sig-param">step</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/policy/epsilon_greedy_policy.html#EpsilonGreedyPolicy.construct"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.policy.EpsilonGreedyPolicy.construct" title="Permalink to this definition">¶</a></dt>
<dd><p>The interface of the construct function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<em>Tensor</em>) – The input tensor for network.</p></li>
<li><p><strong>step</strong> (<em>Tensor</em>) – The current step, effects the epsilon decay.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The output action.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="mindspore-rl-utils">
<h2>mindspore_rl.utils<a class="headerlink" href="#mindspore-rl-utils" title="Permalink to this headline">¶</a></h2>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="RELEASE.html" class="btn btn-neutral float-right" title="Release Notes" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="environment.html" class="btn btn-neutral float-left" title="Reinforcement Learning Environment Access" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2022, MindSpore.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   
</body>
</html>