

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>mindspore_rl &mdash; MindSpore master documentation</title>
  

  
   
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  
  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
        
        
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Release Notes" href="RELEASE.html" />
    <link rel="prev" title="Reinforcement Learning Environment Access" href="environment.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> MindSpore
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Installation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="reinforcement_install.html">MindSpore Reinforcement Installation</a></li>
</ul>
<p class="caption"><span class="caption-text">Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="custom_config_info.html">MindSpore RL Configuration Instruction</a></li>
<li class="toctree-l1"><a class="reference internal" href="dqn.html">Deep Q Learning (DQN) with MindSpore Reinforcement</a></li>
<li class="toctree-l1"><a class="reference internal" href="replaybuffer.html">ReplayBuffer Usage Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="environment.html">Reinforcement Learning Environment Access</a></li>
</ul>
<p class="caption"><span class="caption-text">API References</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">mindspore_rl</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-mindspore_rl.agent">mindspore_rl.agent</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-mindspore_rl.core">mindspore_rl.core</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-mindspore_rl.environment">mindspore_rl.environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-mindspore_rl.network">mindspore_rl.network</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-mindspore_rl.policy">mindspore_rl.policy</a></li>
<li class="toctree-l2"><a class="reference internal" href="#mindspore-rl-utils">mindspore_rl.utils</a></li>
</ul>
</li>
</ul>
<p class="caption"><span class="caption-text">RELEASE NOTES</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="RELEASE.html">Release Notes</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">MindSpore</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>mindspore_rl</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="_sources/reinforcement.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="module-mindspore_rl">
<span id="module-mindspore_rl"></span><span id="mindspore-rl"></span><h1>mindspore_rl<a class="headerlink" href="#module-mindspore_rl" title="Permalink to this headline">¶</a></h1>
<p>Components for MindSpore Reinforcement Learning Framework.</p>
<div class="section" id="module-mindspore_rl.agent">
<span id="module-mindspore_rl.agent"></span><span id="mindspore-rl-agent"></span><h2>mindspore_rl.agent<a class="headerlink" href="#module-mindspore_rl.agent" title="Permalink to this headline">¶</a></h2>
<p>Components for agent, actor, learner, trainer.</p>
<dl class="class">
<dt id="mindspore_rl.agent.Actor">
<em class="property">class </em><code class="sig-prename descclassname">mindspore_rl.agent.</code><code class="sig-name descname">Actor</code><a class="reference internal" href="_modules/mindspore_rl/agent/actor.html#Actor"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.agent.Actor" title="Permalink to this definition">¶</a></dt>
<dd><p>Base class for all actors. Actor is a class used to interact with the environment and generate data.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.agent.actor</span> <span class="kn">import</span> <span class="n">Actor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.network</span> <span class="kn">import</span> <span class="n">FullyConnectedNet</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.environment</span> <span class="kn">import</span> <span class="n">GymEnvironment</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">MyActor</span><span class="p">(</span><span class="n">Actor</span><span class="p">):</span>
<span class="gp">... </span>  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">super</span><span class="p">(</span><span class="n">MyActor</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">argmax</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">Argmax</span><span class="p">()</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">actor_net</span> <span class="o">=</span> <span class="n">FullyConnectedNet</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">env</span> <span class="o">=</span> <span class="n">GymEnvironment</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;CartPole-v0&#39;</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_actor</span> <span class="o">=</span> <span class="n">MyActor</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">my_actor</span><span class="p">)</span>
<span class="go">MyActor&lt;</span>
<span class="go">(actor_net): FullyConnectedNet&lt;</span>
<span class="go">(linear1): Dense&lt;input_channels=4, output_channels=10, has_bias=True&gt;</span>
<span class="go">(linear2): Dense&lt;input_channels=10, output_channels=2, has_bias=True&gt;</span>
<span class="go">(relu): ReLU&lt;&gt;</span>
<span class="go">&gt;</span>
<span class="go">(environment): GymEnvironment&lt;&gt;</span>
</pre></div>
</div>
<dl class="method">
<dt id="mindspore_rl.agent.Actor.act">
<code class="sig-name descname">act</code><span class="sig-paren">(</span><em class="sig-param">phase</em>, <em class="sig-param">params</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/agent/actor.html#Actor.act"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.agent.Actor.act" title="Permalink to this definition">¶</a></dt>
<dd><p>The act function will take an enumerate value and observation or other data which is needed during
calculating the action. It will return a set of output which contains new observation, or other
experience. In this function, agent will interact with environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phase</strong> (<em>enum</em>) – A enumerate value states for init, collect, eval or other user-defined stage.</p></li>
<li><p><strong>params</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em>(</em><em>Tensor</em><em>)</em>) – A tuple of tensor as input, which is used to calculate action</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>tuple(Tensor), a tuple of tensor as output, which states for experience data.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.agent.Actor.get_action">
<code class="sig-name descname">get_action</code><span class="sig-paren">(</span><em class="sig-param">phase</em>, <em class="sig-param">params</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/agent/actor.html#Actor.get_action"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.agent.Actor.get_action" title="Permalink to this definition">¶</a></dt>
<dd><p>get_action is the method used to obtain the action.
User will need to overload this function according to
the algorithm. But argument of this function should be
phase and params. This interface will not interact with
environment</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phase</strong> (<em>enum</em>) – A enumerate value states for init, collect, eval or other user-defined stage.</p></li>
<li><p><strong>params</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em>(</em><em>Tensor</em><em>)</em>) – A tuple of tensor as input, which is used to calculate action</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>tuple(Tensor), a tuple of tensor as output, containing actions and other data.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mindspore_rl.agent.Learner">
<em class="property">class </em><code class="sig-prename descclassname">mindspore_rl.agent.</code><code class="sig-name descname">Learner</code><a class="reference internal" href="_modules/mindspore_rl/agent/learner.html#Learner"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.agent.Learner" title="Permalink to this definition">¶</a></dt>
<dd><p>The base class of the learner. Calculate and update the self generated network through the input experience.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.agent.learner</span> <span class="kn">import</span> <span class="n">Learner</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.network</span> <span class="kn">import</span> <span class="n">FullyConnectedNet</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">MyLearner</span><span class="p">(</span><span class="n">Learner</span><span class="p">):</span>
<span class="gp">... </span>  <span class="k">def</span> <span class="nf">init</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">super</span><span class="p">(</span><span class="n">MyLearner</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">target_network</span> <span class="o">=</span> <span class="n">FullyConnectedNet</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_learner</span> <span class="o">=</span> <span class="n">MyLearner</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">my_learner</span><span class="p">)</span>
<span class="go">MyLearner&lt;</span>
<span class="go">(target_network): FullyConnectedNet&lt;</span>
<span class="go">(linear1): Dense&lt;input_channels=4, output_channels=10, has_bias=True&gt;</span>
<span class="go">(linear2): Dense&lt;input_channels=10, output_channels=2, has_bias=True&gt;</span>
<span class="go">(relu): ReLU&lt;&gt;</span>
<span class="go">&gt;</span>
</pre></div>
</div>
<dl class="method">
<dt id="mindspore_rl.agent.Learner.learn">
<code class="sig-name descname">learn</code><span class="sig-paren">(</span><em class="sig-param">experience</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/agent/learner.html#Learner.learn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.agent.Learner.learn" title="Permalink to this definition">¶</a></dt>
<dd><p>The interface for the learn function. The behavior of the <cite>learn</cite> function
depend on the user’s implementation. Usually, it takes the <cite>samples</cite> form
replay buffer or other Tensors, and calculates the loss for updating the networks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>experience</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em>(</em><em>Tensor</em><em>)</em>) – Sampling from the buffer.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>tuple(Tensor), result which outputs after updating weights</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mindspore_rl.agent.Trainer">
<em class="property">class </em><code class="sig-prename descclassname">mindspore_rl.agent.</code><code class="sig-name descname">Trainer</code><span class="sig-paren">(</span><em class="sig-param">msrl</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/agent/trainer.html#Trainer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.agent.Trainer" title="Permalink to this definition">¶</a></dt>
<dd><p>The trainer base class. It is a process class that provides the basic mode of training.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Reference to <a class="reference external" href="https://gitee.com/mindspore/docs/blob/master/docs/reinforcement/docs/source_en/dqn.md#defining-the-dqntrainer-class">dqn_trainer.py</a>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>msrl</strong> (<a class="reference internal" href="#mindspore_rl.core.MSRL" title="mindspore_rl.core.MSRL"><em>MSRL</em></a>) – the function handler class.</p>
</dd>
</dl>
<dl class="method">
<dt id="mindspore_rl.agent.Trainer.evaluate">
<code class="sig-name descname">evaluate</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/agent/trainer.html#Trainer.evaluate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.agent.Trainer.evaluate" title="Permalink to this definition">¶</a></dt>
<dd><p>The interface of the evaluate function for evaluate in train.</p>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.agent.Trainer.load_and_eval">
<code class="sig-name descname">load_and_eval</code><span class="sig-paren">(</span><em class="sig-param">ckpt_path=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/agent/trainer.html#Trainer.load_and_eval"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.agent.Trainer.load_and_eval" title="Permalink to this definition">¶</a></dt>
<dd><p>The interface of the eval function for offline. A checkpoint must be provided.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ckpt_path</strong> (<em>string</em>) – The checkpoint file to restore net.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.agent.Trainer.train">
<code class="sig-name descname">train</code><span class="sig-paren">(</span><em class="sig-param">episodes</em>, <em class="sig-param">callbacks=None</em>, <em class="sig-param">ckpt_path=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/agent/trainer.html#Trainer.train"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.agent.Trainer.train" title="Permalink to this definition">¶</a></dt>
<dd><p>The train method provides a standard training process, including the whole loop and callbacks.
Users can inherit or overwrite as needed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>episodes</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – the number of training episodes.</p></li>
<li><p><strong>callbacks</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em>[</em><em>Callback</em><em>]</em><em>]</em>) – List of callback objects. Default: None</p></li>
<li><p><strong>ckpt_path</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a><em>]</em>) – The checkpoint file path to init or restore net. Default: None.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.agent.Trainer.train_one_episode">
<code class="sig-name descname">train_one_episode</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/agent/trainer.html#Trainer.train_one_episode"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.agent.Trainer.train_one_episode" title="Permalink to this definition">¶</a></dt>
<dd><p>The interface of train one episode function in train.
And the output of this function must be constricted as <cite>loss, rewards, steps, [optional]others</cite> in order.</p>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.agent.Trainer.trainable_variables">
<code class="sig-name descname">trainable_variables</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/agent/trainer.html#Trainer.trainable_variables"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.agent.Trainer.trainable_variables" title="Permalink to this definition">¶</a></dt>
<dd><p>The variables for saving to checkpoint.</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mindspore_rl.agent.Agent">
<em class="property">class </em><code class="sig-prename descclassname">mindspore_rl.agent.</code><code class="sig-name descname">Agent</code><span class="sig-paren">(</span><em class="sig-param">actors</em>, <em class="sig-param">learner</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/agent/agent.html#Agent"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.agent.Agent" title="Permalink to this definition">¶</a></dt>
<dd><p>The base class for the Agent. As the definition of agent, it is composed of actor and leanrner.
It has basic act and learn functions for interaction with environment and update itself.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>actors</strong> (<a class="reference internal" href="#mindspore_rl.agent.Actor" title="mindspore_rl.agent.Actor"><em>Actor</em></a>) – The actor instance.</p></li>
<li><p><strong>learner</strong> (<a class="reference internal" href="#mindspore_rl.agent.Learner" title="mindspore_rl.agent.Learner"><em>Learner</em></a>) – The learner instance.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.agent.learner</span> <span class="kn">import</span> <span class="n">Learner</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.agent.actor</span> <span class="kn">import</span> <span class="n">Actor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.agent.agent</span> <span class="kn">import</span> <span class="n">Agent</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">actors</span> <span class="o">=</span> <span class="n">Actor</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">learner</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">agent</span> <span class="o">=</span> <span class="n">Agent</span><span class="p">(</span><span class="n">actors</span><span class="p">,</span> <span class="n">learner</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">agent</span><span class="p">)</span>
<span class="go">Agent&lt;</span>
<span class="go">(_actors): Actor&lt;&gt;</span>
<span class="go">(_learner): Learner&lt;&gt;</span>
<span class="go">&gt;</span>
</pre></div>
</div>
<dl class="method">
<dt id="mindspore_rl.agent.Agent.act">
<code class="sig-name descname">act</code><span class="sig-paren">(</span><em class="sig-param">phase</em>, <em class="sig-param">params</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/agent/agent.html#Agent.act"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.agent.Agent.act" title="Permalink to this definition">¶</a></dt>
<dd><p>The act function will take an enumerate value and observation or other data which is needed during
calculating the action. It will return a set of output which contains new observation, or other
experience. In this function, agent will interact with environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phase</strong> (<em>enum</em>) – A enumerate value states for init, collect or eval stage.</p></li>
<li><p><strong>params</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em>(</em><em>Tensor</em><em>)</em>) – A tuple of tensor as input, which is used to calculate action</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>tuple(Tensor), a tuple of tensor as output, which states for experience</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.agent.Agent.get_action">
<code class="sig-name descname">get_action</code><span class="sig-paren">(</span><em class="sig-param">phase</em>, <em class="sig-param">params</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/agent/agent.html#Agent.get_action"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.agent.Agent.get_action" title="Permalink to this definition">¶</a></dt>
<dd><p>The get_action function will take an enumerate value and observation or other data which is needed during
calculating the action. It will return a set of outputs containing actions and other data. In this
function, agent will not interact with environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phase</strong> (<em>enum</em>) – A enumerate value states for init, collect or eval stage.</p></li>
<li><p><strong>params</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em>(</em><em>Tensor</em><em>)</em>) – A tuple of tensor as input, which is used to calculate action</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>tuple(Tensor), a tuple of tensor as output, containing actions and other data.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.agent.Agent.learn">
<code class="sig-name descname">learn</code><span class="sig-paren">(</span><em class="sig-param">experience</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/agent/agent.html#Agent.learn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.agent.Agent.learn" title="Permalink to this definition">¶</a></dt>
<dd><p>The learn function will take a set of experience as input to calculate the loss and update
the weights.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>experience</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em>(</em><em>Tensor</em><em>)</em>) – A tuple of tensor states for experience</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>tuple(Tensor), result which outputs after updating weights</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-mindspore_rl.core">
<span id="module-mindspore_rl.core"></span><span id="mindspore-rl-core"></span><h2>mindspore_rl.core<a class="headerlink" href="#module-mindspore_rl.core" title="Permalink to this headline">¶</a></h2>
<p>Helper components used to implement RL algorithms.</p>
<dl class="class">
<dt id="mindspore_rl.core.MSRL">
<em class="property">class </em><code class="sig-prename descclassname">mindspore_rl.core.</code><code class="sig-name descname">MSRL</code><span class="sig-paren">(</span><em class="sig-param">alg_config</em>, <em class="sig-param">deploy_config=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/msrl.html#MSRL"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.core.MSRL" title="Permalink to this definition">¶</a></dt>
<dd><p>The MSRL class provides the function handlers and APIs for reinforcement
learning algorithm development.</p>
<p>It exposes the following function handler to the user. The input and output of
these function handlers are identical to the user defined functions.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">agent_act</span>
<span class="n">agent_get_action</span>
<span class="n">sample_buffer</span>
<span class="n">agent_learn</span>
<span class="n">replay_buffer_sample</span>
<span class="n">replay_buffer_insert</span>
<span class="n">replay_buffer_reset</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>alg_config</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – provides the algorithm configuration.</p></li>
<li><p><strong>deploy_config</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – <p>provides the distribute configuration.</p>
<ul>
<li><p>Top level: defines the algorithm components.</p>
<ul>
<li><p>key: ‘actor’,              value: the actor configuration (dict).</p></li>
<li><p>key: ‘learner’,            value: the learner configuration (dict).</p></li>
<li><p>key: ‘policy_and_network’, value: the policy and networks used by
actor and learner (dict).</p></li>
<li><p>key: ‘collect_environment’,     value: the collect environment configuration (dict).</p></li>
<li><p>key: ‘eval_environment’,        value: the eval environment configuration (dict).</p></li>
<li><p>key: ‘replay_buffer’,           value: the replay buffer configuration (dict).</p></li>
</ul>
</li>
<li><p>Second level: the configuration of each algorithm component.</p>
<ul>
<li><p>key: ‘number’,      value: the number of actor/learner (int).</p></li>
<li><p>key: ‘type’,        value: the type of the
actor/learner/policy_and_network/environment (class name).</p></li>
<li><p>key: ‘params’,      value: the parameters of
actor/learner/policy_and_network/environment (dict).</p></li>
<li><p>key: ‘policies’,    value: the list of policies used by the
actor/learner (list).</p></li>
<li><p>key: ‘networks’,    value: the list of networks used by the
actor/learner (list).</p></li>
<li><p>key: ‘pass_environment’, value: True user needs to pass the environment
instance into actor, False otherwise (Bool).</p></li>
</ul>
</li>
</ul>
</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="mindspore_rl.core.MSRL.get_replay_buffer">
<code class="sig-name descname">get_replay_buffer</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/msrl.html#MSRL.get_replay_buffer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.core.MSRL.get_replay_buffer" title="Permalink to this definition">¶</a></dt>
<dd><p>It will return the instance of replay buffer.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Buffers (object), The instance of relay buffer. If the buffer is None, the return
value will be None.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.core.MSRL.get_replay_buffer_elements">
<code class="sig-name descname">get_replay_buffer_elements</code><span class="sig-paren">(</span><em class="sig-param">transpose=False</em>, <em class="sig-param">shape=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/msrl.html#MSRL.get_replay_buffer_elements"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.core.MSRL.get_replay_buffer_elements" title="Permalink to this definition">¶</a></dt>
<dd><p>It will return all the elements in the replay buffer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>transpose</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – whether the output element needs to be transpose,
if transpose is true, shape will also need to be filled. Default: False.</p></li>
<li><p><strong>shape</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>]</em>) – the shape used in transpose. Default: None.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>elements (List[Tensor]), A set of tensor contains all the elements in the replay buffer.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.core.MSRL.init">
<code class="sig-name descname">init</code><span class="sig-paren">(</span><em class="sig-param">config</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/msrl.html#MSRL.init"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.core.MSRL.init" title="Permalink to this definition">¶</a></dt>
<dd><p>Initialization of MSRL object.
The function creates all the data/objects that the algorithm requires.
It also initializes all the function handler.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>config</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – algorithm configuration file.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mindspore_rl.core.Session">
<em class="property">class </em><code class="sig-prename descclassname">mindspore_rl.core.</code><code class="sig-name descname">Session</code><span class="sig-paren">(</span><em class="sig-param">alg_config</em>, <em class="sig-param">deploy_config=None</em>, <em class="sig-param">params=None</em>, <em class="sig-param">callbacks=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/session.html#Session"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.core.Session" title="Permalink to this definition">¶</a></dt>
<dd><p>The Session is a class for running MindSpore RL algorithms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>alg_config</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – the algorithm configuration or the deployment configuration of the algorithm.</p></li>
<li><p><strong>deploy_config</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – the deployment configuration for distribution. Default: None.
For more details of configuration of algorithm, please have a look at
<a class="reference external" href="https://www.mindspore.cn/reinforcement/docs/zh-CN/master/custom_config_info.html">detail</a>.</p></li>
<li><p><strong>params</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – The algorithm specific training parameters. Default: None.</p></li>
<li><p><strong>callbacks</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em>[</em><em>Callback</em><em>]</em>) – The callback list. Default: None.</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="mindspore_rl.core.Session.run">
<code class="sig-name descname">run</code><span class="sig-paren">(</span><em class="sig-param">class_type=None</em>, <em class="sig-param">is_train=True</em>, <em class="sig-param">episode=0</em>, <em class="sig-param">duration=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/session.html#Session.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.core.Session.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute the reinforcement learning algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>class_type</strong> (<a class="reference internal" href="#mindspore_rl.agent.Trainer" title="mindspore_rl.agent.Trainer"><em>Trainer</em></a>) – The class type of the algorithm’s trainer class. Default: None.</p></li>
<li><p><strong>is_train</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Run the algorithm in train mode or eval mode. Default: True</p></li>
<li><p><strong>episode</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The number of episode of the training. Default: 0.</p></li>
<li><p><strong>duration</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The number of duration of the training. Default: 0.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mindspore_rl.core.UniformReplayBuffer">
<em class="property">class </em><code class="sig-prename descclassname">mindspore_rl.core.</code><code class="sig-name descname">UniformReplayBuffer</code><span class="sig-paren">(</span><em class="sig-param">batch_size</em>, <em class="sig-param">capacity</em>, <em class="sig-param">shapes</em>, <em class="sig-param">types</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/uniform_replay_buffer.html#UniformReplayBuffer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.core.UniformReplayBuffer" title="Permalink to this definition">¶</a></dt>
<dd><p>The replay buffer class.
The replay buffer will store the experience from environment. In replay
buffer, each element is a list of tensors. Therefore, the constructor of the
UniformReplayBuffer class takes the shape and type of each tensor as an argument.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch_size</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – size for sampling from the buffer.</p></li>
<li><p><strong>capacity</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – the capacity of the buffer.</p></li>
<li><p><strong>shapes</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>]</em>) – the shape of each tensor in a buffer element.</p></li>
<li><p><strong>types</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em>[</em><em>mindspore.dtype</em><em>]</em>) – the data type of each tensor in a buffer element.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mindspore</span> <span class="k">as</span> <span class="nn">ms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.core.uniform_replay_buffer</span> <span class="kn">import</span> <span class="n">UniformReplayBuffer</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">batch_size</span> <span class="o">=</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">capacity</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shapes</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">4</span><span class="p">,),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">types</span> <span class="o">=</span> <span class="p">[</span><span class="n">ms</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">ms</span><span class="o">.</span><span class="n">int32</span><span class="p">,</span> <span class="n">ms</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">ms</span><span class="o">.</span><span class="n">float32</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">replaybuffer</span> <span class="o">=</span> <span class="n">UniformReplayBuffer</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">capacity</span><span class="p">,</span> <span class="n">shapes</span><span class="p">,</span> <span class="n">types</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">replaybuffer</span><span class="p">)</span>
<span class="go">UniformReplayBuffer&lt;&gt;</span>
</pre></div>
</div>
<dl class="method">
<dt id="mindspore_rl.core.UniformReplayBuffer.full">
<code class="sig-name descname">full</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/uniform_replay_buffer.html#UniformReplayBuffer.full"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.core.UniformReplayBuffer.full" title="Permalink to this definition">¶</a></dt>
<dd><p>Check if the replaybuffer is full or not.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Full(bool), True if the replaybuffer is full, False otherwise.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.core.UniformReplayBuffer.get_item">
<code class="sig-name descname">get_item</code><span class="sig-paren">(</span><em class="sig-param">index</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/uniform_replay_buffer.html#UniformReplayBuffer.get_item"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.core.UniformReplayBuffer.get_item" title="Permalink to this definition">¶</a></dt>
<dd><p>Get an element from the replaybuffer in specific position(index).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>index</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – the location of the item.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>element (List[Tensor]), the element from the buffer.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.core.UniformReplayBuffer.insert">
<code class="sig-name descname">insert</code><span class="sig-paren">(</span><em class="sig-param">exp</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/uniform_replay_buffer.html#UniformReplayBuffer.insert"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.core.UniformReplayBuffer.insert" title="Permalink to this definition">¶</a></dt>
<dd><p>Insert an element to the buffer. If the buffer is full, FIFO strategy will be used to
replace the element in the buffer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>exp</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em>[</em><em>Tensor</em><em>]</em>) – insert a list of tensor which matches with the initialized shape
and type into the buffer.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>element (list[Tensor]), return the whole buffer after insertion</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.core.UniformReplayBuffer.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/uniform_replay_buffer.html#UniformReplayBuffer.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.core.UniformReplayBuffer.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the replaybuffer. It changes the value of self.count to zero.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>success (boolean), whether the reset successful or not.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.core.UniformReplayBuffer.sample">
<code class="sig-name descname">sample</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/uniform_replay_buffer.html#UniformReplayBuffer.sample"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.core.UniformReplayBuffer.sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Sampling the replaybuffer, which means that it will randomly choose a set of element
and output them.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>data (Tuple(Tensor)), A set of sampled elements from the buffer.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.core.UniformReplayBuffer.size">
<code class="sig-name descname">size</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/uniform_replay_buffer.html#UniformReplayBuffer.size"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.core.UniformReplayBuffer.size" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the size of the replybuffer.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>size (int), the number of element in the replaybuffer.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mindspore_rl.core.PriorityReplayBuffer">
<em class="property">class </em><code class="sig-prename descclassname">mindspore_rl.core.</code><code class="sig-name descname">PriorityReplayBuffer</code><span class="sig-paren">(</span><em class="sig-param">alpha</em>, <em class="sig-param">capacity</em>, <em class="sig-param">sample_size</em>, <em class="sig-param">shapes</em>, <em class="sig-param">dtypes</em>, <em class="sig-param">seed0=0</em>, <em class="sig-param">seed1=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/priority_replay_buffer.html#PriorityReplayBuffer"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.core.PriorityReplayBuffer" title="Permalink to this definition">¶</a></dt>
<dd><p>PriorityReplayBuffer is experience container used in Deep Q-Networks.
The algorithm is proposed in <cite>Prioritized Experience Replay &lt;https://arxiv.org/abs/1511.05952&gt;</cite>.
Same as the normal replay buffer, it lets the reinforcement learning agents remember and reuse experiences from the
past. Besides, it replays important transitions more frequently and improve sample effciency.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>alpha</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – parameter to control degree of prioritization.
0 means the uniform sampling, 1 means priority sampling.</p></li>
<li><p><strong>capacity</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – the capacity of the buffer.</p></li>
<li><p><strong>sample_size</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – size for sampling from the buffer.</p></li>
<li><p><strong>shapes</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>]</em>) – the shape of each tensor in a buffer element.</p></li>
<li><p><strong>types</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em>[</em><em>mindspore.dtype</em><em>]</em>) – the data type of each tensor in a buffer element.</p></li>
<li><p><strong>seed0</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Seed0 value for random generating. Default: 0.</p></li>
<li><p><strong>seed1</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Seed1 value for random generating. Default: 0.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mindspore</span> <span class="k">as</span> <span class="nn">ms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore</span> <span class="kn">import</span> <span class="n">Tensor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.core.priority_replay_buffer</span> <span class="kn">import</span> <span class="n">PriorityReplayBuffer</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">capacity</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">batch_size</span> <span class="o">=</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shapes</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">4</span><span class="p">,),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dtypes</span> <span class="o">=</span> <span class="p">[</span><span class="n">ms</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">ms</span><span class="o">.</span><span class="n">int32</span><span class="p">,</span> <span class="n">ms</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">ms</span><span class="o">.</span><span class="n">float32</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">replaybuffer</span> <span class="o">=</span> <span class="n">PriorityReplayBuffer</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">capacity</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">,</span> <span class="n">shapes</span><span class="p">,</span> <span class="n">dtypes</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">replaybuffer</span><span class="p">)</span>
<span class="go">PriorityReplayBuffer&lt;&gt;</span>
</pre></div>
</div>
<dl class="method">
<dt id="mindspore_rl.core.PriorityReplayBuffer.destroy">
<code class="sig-name descname">destroy</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/priority_replay_buffer.html#PriorityReplayBuffer.destroy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.core.PriorityReplayBuffer.destroy" title="Permalink to this definition">¶</a></dt>
<dd><p>Destroy the replay buffer.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Priority replay buffer instance handle with dtype int64 and shape (1,).</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.core.PriorityReplayBuffer.push">
<code class="sig-name descname">push</code><span class="sig-paren">(</span><em class="sig-param">*transition</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/priority_replay_buffer.html#PriorityReplayBuffer.push"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.core.PriorityReplayBuffer.push" title="Permalink to this definition">¶</a></dt>
<dd><p>Push a transition to the buffer. If the buffer is full, the oldest one will be removed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>transition</strong> (<em>List</em><em>[</em><em>Tensor</em><em>]</em>) – insert a list of tensor which matches with the initialized shapes
and dtypes into the buffer.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>handle(Tensor), Priority replay buffer instance handle with dtype int64 and shape (1,).</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.core.PriorityReplayBuffer.sample">
<code class="sig-name descname">sample</code><span class="sig-paren">(</span><em class="sig-param">beta</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/priority_replay_buffer.html#PriorityReplayBuffer.sample"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.core.PriorityReplayBuffer.sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Samples a batch of transitions from the replay buffer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>beta</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – parameter to control degree of sampling correction.
0 means the no correction, 1 means full correction.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>indices (Tensor), the transition indices in the replay buffer.
weights (Tensor), the weight used to correct for sampling bias.
transitions (tuple(Tensor)), transitions with variable-length tensors.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.core.PriorityReplayBuffer.update_priorities">
<code class="sig-name descname">update_priorities</code><span class="sig-paren">(</span><em class="sig-param">indices</em>, <em class="sig-param">priorities</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/priority_replay_buffer.html#PriorityReplayBuffer.update_priorities"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.core.PriorityReplayBuffer.update_priorities" title="Permalink to this definition">¶</a></dt>
<dd><p>Update transition prorities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>indices</strong> (<em>Tensor</em>) – transition indices. The caller needs to ensure the validity of the indices.</p></li>
<li><p><strong>priorities</strong> (<em>Tensor</em>) – transition priorities.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>tuple(Tensor), Transition with its indices and correction weights.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-mindspore_rl.environment">
<span id="module-mindspore_rl.environment"></span><span id="mindspore-rl-environment"></span><h2>mindspore_rl.environment<a class="headerlink" href="#module-mindspore_rl.environment" title="Permalink to this headline">¶</a></h2>
<p>Component used to implement custom environments.</p>
<dl class="class">
<dt id="mindspore_rl.environment.GymEnvironment">
<em class="property">class </em><code class="sig-prename descclassname">mindspore_rl.environment.</code><code class="sig-name descname">GymEnvironment</code><span class="sig-paren">(</span><em class="sig-param">params</em>, <em class="sig-param">env_id=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/gym_environment.html#GymEnvironment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.GymEnvironment" title="Permalink to this definition">¶</a></dt>
<dd><p>The GymEnvironment class is a wrapper that encapsulates <a class="reference external" href="https://gym.openai.com/">Gym</a> to
provide the ability to interact with Gym environments in MindSpore Graph Mode.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – <p>A dictionary contains all the parameters which are used in this class.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 52%" />
<col style="width: 48%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Configuration Parameters</p></th>
<th class="head"><p>Notices</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>name</p></td>
<td><p>the name of game in Gym</p></td>
</tr>
<tr class="row-odd"><td><p>seed</p></td>
<td><p>seed used in Gym</p></td>
</tr>
</tbody>
</table>
</p></li>
<li><p><strong>env_id</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – A integer which is used to set the seed of this environment. Default: 0.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Supported Platforms:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">Ascend</span></code> <code class="docutils literal notranslate"><span class="pre">GPU</span></code> <code class="docutils literal notranslate"><span class="pre">CPU</span></code></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">env_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;CartPole-v0&#39;</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">environment</span> <span class="o">=</span> <span class="n">GymEnvironment</span><span class="p">(</span><span class="n">env_params</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">environment</span><span class="p">)</span>
<span class="go">GymEnvironment&lt;&gt;</span>
</pre></div>
</div>
<dl class="method">
<dt id="mindspore_rl.environment.GymEnvironment.action_space">
<em class="property">property </em><code class="sig-name descname">action_space</code><a class="headerlink" href="#mindspore_rl.environment.GymEnvironment.action_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the action space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The action space of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.GymEnvironment.close">
<code class="sig-name descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/gym_environment.html#GymEnvironment.close"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.GymEnvironment.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Close the environment to release the resource.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Success(np.bool_), Whether shutdown the process or threading successfully.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.GymEnvironment.config">
<em class="property">property </em><code class="sig-name descname">config</code><a class="headerlink" href="#mindspore_rl.environment.GymEnvironment.config" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the config of environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A dictionary which contains environment’s info.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.GymEnvironment.done_space">
<em class="property">property </em><code class="sig-name descname">done_space</code><a class="headerlink" href="#mindspore_rl.environment.GymEnvironment.done_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the done space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The done space of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.GymEnvironment.observation_space">
<em class="property">property </em><code class="sig-name descname">observation_space</code><a class="headerlink" href="#mindspore_rl.environment.GymEnvironment.observation_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the state space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The state space of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.GymEnvironment.render">
<code class="sig-name descname">render</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/gym_environment.html#GymEnvironment.render"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.GymEnvironment.render" title="Permalink to this definition">¶</a></dt>
<dd><p>Render the game. Only support on PyNative mode.</p>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.GymEnvironment.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/gym_environment.html#GymEnvironment.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.GymEnvironment.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the environment to the initial state. It is always used at the beginning of each
episode. It will return the value of initial state.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tensor which states for the initial state of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.GymEnvironment.reward_space">
<em class="property">property </em><code class="sig-name descname">reward_space</code><a class="headerlink" href="#mindspore_rl.environment.GymEnvironment.reward_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the reward space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The reward space of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.GymEnvironment.step">
<code class="sig-name descname">step</code><span class="sig-paren">(</span><em class="sig-param">action</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/gym_environment.html#GymEnvironment.step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.GymEnvironment.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute the environment step, which means that interact with environment once.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>action</strong> (<em>Tensor</em>) – A tensor that contains the action information.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>state (Tensor), the environment state after performing the action.</p></li>
<li><p>reward (Tensor), the reward after performing the action.</p></li>
<li><p>done (Tensor), whether the simulation finishes or not.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mindspore_rl.environment.MultiEnvironmentWrapper">
<em class="property">class </em><code class="sig-prename descclassname">mindspore_rl.environment.</code><code class="sig-name descname">MultiEnvironmentWrapper</code><span class="sig-paren">(</span><em class="sig-param">env_instance</em>, <em class="sig-param">num_proc=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/multi_environment_wrapper.html#MultiEnvironmentWrapper"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.MultiEnvironmentWrapper" title="Permalink to this definition">¶</a></dt>
<dd><p>The MultiEnvironmentWrapper is a wrapper for multi environment scenario. User implements
their single environment class and set the environment number larger than 1 in configuration
file, framework will automatically invoke this class to create a multi environment class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env_instance</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em>[</em><a class="reference internal" href="#mindspore_rl.environment.Environment" title="mindspore_rl.environment.Environment"><em>Environment</em></a><em>]</em>) – A list that contains instance of environment (subclass of Environment).</p></li>
<li><p><strong>num_proc</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Number of processing uses during interacting with environment. Default: None.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Supported Platforms:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">Ascend</span></code> <code class="docutils literal notranslate"><span class="pre">GPU</span></code> <code class="docutils literal notranslate"><span class="pre">CPU</span></code></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">env_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;CartPole-v0&#39;</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">multi_env</span> <span class="o">=</span> <span class="p">[</span><span class="n">GymEnvironment</span><span class="p">(</span><span class="n">env_params</span><span class="p">),</span> <span class="n">GymEnvironment</span><span class="p">(</span><span class="n">env_params</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wrapper</span> <span class="o">=</span> <span class="n">MultiEnvironmentWrapper</span><span class="p">(</span><span class="n">multi_env</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">wrapper</span><span class="p">)</span>
<span class="go">MultiEnvironmentWrapper&lt;&gt;</span>
</pre></div>
</div>
<dl class="method">
<dt id="mindspore_rl.environment.MultiEnvironmentWrapper.action_space">
<em class="property">property </em><code class="sig-name descname">action_space</code><a class="headerlink" href="#mindspore_rl.environment.MultiEnvironmentWrapper.action_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the action space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tuple which states for the space of action.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.MultiEnvironmentWrapper.close">
<code class="sig-name descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/multi_environment_wrapper.html#MultiEnvironmentWrapper.close"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.MultiEnvironmentWrapper.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Close the environment to release the resource.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Success(np.bool_), Whether shutdown the process or threading successfully.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.MultiEnvironmentWrapper.config">
<em class="property">property </em><code class="sig-name descname">config</code><a class="headerlink" href="#mindspore_rl.environment.MultiEnvironmentWrapper.config" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the config of environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A dictionary which contains environment’s info.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.MultiEnvironmentWrapper.done_space">
<em class="property">property </em><code class="sig-name descname">done_space</code><a class="headerlink" href="#mindspore_rl.environment.MultiEnvironmentWrapper.done_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the done space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tuple which states for the space of done.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.MultiEnvironmentWrapper.observation_space">
<em class="property">property </em><code class="sig-name descname">observation_space</code><a class="headerlink" href="#mindspore_rl.environment.MultiEnvironmentWrapper.observation_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the state space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tuple which states for the space of state.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.MultiEnvironmentWrapper.render">
<code class="sig-name descname">render</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/multi_environment_wrapper.html#MultiEnvironmentWrapper.render"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.MultiEnvironmentWrapper.render" title="Permalink to this definition">¶</a></dt>
<dd><p>Render the game. Only support on PyNative mode.</p>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.MultiEnvironmentWrapper.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/multi_environment_wrapper.html#MultiEnvironmentWrapper.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.MultiEnvironmentWrapper.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the environment to the initial state. It is always used at the beginning of each
episode. It will return the value of initial state of each environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A list of tensor which states for all the initial states of each environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.MultiEnvironmentWrapper.reward_space">
<em class="property">property </em><code class="sig-name descname">reward_space</code><a class="headerlink" href="#mindspore_rl.environment.MultiEnvironmentWrapper.reward_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the reward space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tuple which states for the space of reward.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.MultiEnvironmentWrapper.step">
<code class="sig-name descname">step</code><span class="sig-paren">(</span><em class="sig-param">action</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/multi_environment_wrapper.html#MultiEnvironmentWrapper.step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.MultiEnvironmentWrapper.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute the environment step, which means that interact with environment once.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>action</strong> (<em>Tensor</em>) – A tensor that contains the action information.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>state (list(Tensor)), a list of environment state after performing the action.</p></li>
<li><p>reward (list(Tensor)), a list of reward after performing the action.</p></li>
<li><p>done (list(Tensor)), whether the simulations of each environment finishes or not.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mindspore_rl.environment.Environment">
<em class="property">class </em><code class="sig-prename descclassname">mindspore_rl.environment.</code><code class="sig-name descname">Environment</code><a class="reference internal" href="_modules/mindspore_rl/environment/environment.html#Environment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.Environment" title="Permalink to this definition">¶</a></dt>
<dd><p>The virtual base class for the environment. This class should be overridden before calling in the model.</p>
<dl class="method">
<dt id="mindspore_rl.environment.Environment.action_space">
<em class="property">property </em><code class="sig-name descname">action_space</code><a class="headerlink" href="#mindspore_rl.environment.Environment.action_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the action space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The action space of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.Environment.close">
<code class="sig-name descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/environment.html#Environment.close"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.Environment.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Close the environment to release the resource.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Success(np.bool_), Whether shutdown the process or threading successfully.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.Environment.config">
<em class="property">property </em><code class="sig-name descname">config</code><a class="headerlink" href="#mindspore_rl.environment.Environment.config" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the config of environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A dictionary which contains environment’s info.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.Environment.done_space">
<em class="property">property </em><code class="sig-name descname">done_space</code><a class="headerlink" href="#mindspore_rl.environment.Environment.done_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the done space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The done space of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.Environment.observation_space">
<em class="property">property </em><code class="sig-name descname">observation_space</code><a class="headerlink" href="#mindspore_rl.environment.Environment.observation_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the state space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The state space of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.Environment.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/environment.html#Environment.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.Environment.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the environment to the initial state. It is always used at the beginning of each
episode. It will return the value of initial state or other initial information.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tensor which states for the initial state of environment or a tuple contains
initial information, such as new state, action, reward, etc.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.Environment.reward_space">
<em class="property">property </em><code class="sig-name descname">reward_space</code><a class="headerlink" href="#mindspore_rl.environment.Environment.reward_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the reward space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The reward space of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.Environment.step">
<code class="sig-name descname">step</code><span class="sig-paren">(</span><em class="sig-param">action</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/environment.html#Environment.step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.Environment.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute the environment step, which means that interact with environment once.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>action</strong> (<em>Tensor</em>) – A tensor that contains the action information.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tuple of Tensor which contains information after interacting with environment.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mindspore_rl.environment.Space">
<em class="property">class </em><code class="sig-prename descclassname">mindspore_rl.environment.</code><code class="sig-name descname">Space</code><span class="sig-paren">(</span><em class="sig-param">feature_shape</em>, <em class="sig-param">dtype</em>, <em class="sig-param">low=None</em>, <em class="sig-param">high=None</em>, <em class="sig-param">batch_shape=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/space.html#Space"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.Space" title="Permalink to this definition">¶</a></dt>
<dd><p>The class for environment action/observation space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>feature_shape</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em>(</em><a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>)</em><em>, </em><a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em>(</em><a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>)</em><em>, </em><a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>]</em>) – The action/observation shape before batching.</p></li>
<li><p><strong>dtype</strong> (<em>np.dtype</em>) – The action/observation space dtype.</p></li>
<li><p><strong>low</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a><em>]</em><em>, </em><em>optional</em>) – The action/observation space lower boundary.</p></li>
<li><p><strong>high</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a><em>]</em><em>, </em><em>optional</em>) – The action/observation space upper boundary.</p></li>
<li><p><strong>batch_shape</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em>(</em><a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>)</em><em>, </em><a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em>(</em><a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>)</em><em>, </em><a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>]</em><em>, </em><em>optional</em>) – The batch shape for vectorization.
It usually be used in multi-environment and multi-agent cases.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">action_space</span> <span class="o">=</span> <span class="n">Space</span><span class="p">(</span><span class="n">feature_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">action_space</span><span class="o">.</span><span class="n">ms_dtype</span><span class="p">)</span>
<span class="go">Int32</span>
</pre></div>
</div>
<dl class="method">
<dt id="mindspore_rl.environment.Space.boundary">
<em class="property">property </em><code class="sig-name descname">boundary</code><a class="headerlink" href="#mindspore_rl.environment.Space.boundary" title="Permalink to this definition">¶</a></dt>
<dd><p>The space boundary of current Space.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Uppoer and lower boundary of current space.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.Space.is_discrete">
<em class="property">property </em><code class="sig-name descname">is_discrete</code><a class="headerlink" href="#mindspore_rl.environment.Space.is_discrete" title="Permalink to this definition">¶</a></dt>
<dd><p>Is discrete space.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Whether the current space is discrete or continuous.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.Space.ms_dtype">
<em class="property">property </em><code class="sig-name descname">ms_dtype</code><a class="headerlink" href="#mindspore_rl.environment.Space.ms_dtype" title="Permalink to this definition">¶</a></dt>
<dd><p>MindSpore data type of current Space.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The mindspore data type of current space.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.Space.np_dtype">
<em class="property">property </em><code class="sig-name descname">np_dtype</code><a class="headerlink" href="#mindspore_rl.environment.Space.np_dtype" title="Permalink to this definition">¶</a></dt>
<dd><p>Numpy data type of current Space.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The numpy dtype of current space.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.Space.num_values">
<em class="property">property </em><code class="sig-name descname">num_values</code><a class="headerlink" href="#mindspore_rl.environment.Space.num_values" title="Permalink to this definition">¶</a></dt>
<dd><p>available action number of current Space.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The available action of current space.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.Space.sample">
<code class="sig-name descname">sample</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/space.html#Space.sample"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.Space.sample" title="Permalink to this definition">¶</a></dt>
<dd><p>Sample a valid action from the space</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Tensor, a valid action.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.Space.shape">
<em class="property">property </em><code class="sig-name descname">shape</code><a class="headerlink" href="#mindspore_rl.environment.Space.shape" title="Permalink to this definition">¶</a></dt>
<dd><p>Space shape after batching.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The shape of current space.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mindspore_rl.environment.MsEnvironment">
<em class="property">class </em><code class="sig-prename descclassname">mindspore_rl.environment.</code><code class="sig-name descname">MsEnvironment</code><span class="sig-paren">(</span><em class="sig-param">kwargs=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/ms_environment.html#MsEnvironment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.MsEnvironment" title="Permalink to this definition">¶</a></dt>
<dd><p>Class encapsulates built-in environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kwargs</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – <p>The dictionary of environment specific configurations. See below table for details:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 21%" />
<col style="width: 31%" />
<col style="width: 19%" />
<col style="width: 29%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Environment name</p></th>
<th class="head"><p>Configuration Parameters</p></th>
<th class="head"><p>Default value</p></th>
<th class="head"><p>Notices</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td rowspan="10"><p>Tag</p></td>
<td><p>seed</p></td>
<td><p>42</p></td>
<td><p>random seed</p></td>
</tr>
<tr class="row-odd"><td><p>environment_num</p></td>
<td><p>2</p></td>
<td><p>number of environments</p></td>
</tr>
<tr class="row-even"><td><p>predator_num</p></td>
<td><p>10</p></td>
<td><p>number of predators</p></td>
</tr>
<tr class="row-odd"><td><p>max_timestep</p></td>
<td><p>100</p></td>
<td><p>max timestep per episode</p></td>
</tr>
<tr class="row-even"><td><p>map_length</p></td>
<td><p>100</p></td>
<td><p>length of map</p></td>
</tr>
<tr class="row-odd"><td><p>map_width</p></td>
<td><p>100</p></td>
<td><p>width of map</p></td>
</tr>
<tr class="row-even"><td><p>wall_hit_penalty</p></td>
<td><p>0.1</p></td>
<td><p>agent wall hit penalty</p></td>
</tr>
<tr class="row-odd"><td><p>catch_reward</p></td>
<td><p>10</p></td>
<td><p>predator catch reward</p></td>
</tr>
<tr class="row-even"><td><p>caught_penalty</p></td>
<td><p>5</p></td>
<td><p>prey caught penalty</p></td>
</tr>
<tr class="row-odd"><td><p>step_cost</p></td>
<td><p>0.01</p></td>
<td><p>step cost</p></td>
</tr>
</tbody>
</table>
</p>
</dd>
</dl>
<dl class="simple">
<dt>Supported Platforms:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">GPU</span></code></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">config</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Tag&#39;</span><span class="p">,</span> <span class="s1">&#39;predator_num&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">env</span> <span class="o">=</span> <span class="n">MsEnvironment</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">observation</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">action</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">action_space</span><span class="o">.</span><span class="n">sample</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">observation</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">done</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">observation</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(2, 5, 21)</span>
</pre></div>
</div>
<dl class="method">
<dt id="mindspore_rl.environment.MsEnvironment.action_space">
<em class="property">property </em><code class="sig-name descname">action_space</code><a class="headerlink" href="#mindspore_rl.environment.MsEnvironment.action_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the valid action space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The action space of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.MsEnvironment.config">
<em class="property">property </em><code class="sig-name descname">config</code><a class="headerlink" href="#mindspore_rl.environment.MsEnvironment.config" title="Permalink to this definition">¶</a></dt>
<dd><p>Get environment configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The configuration of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.MsEnvironment.done_space">
<em class="property">property </em><code class="sig-name descname">done_space</code><a class="headerlink" href="#mindspore_rl.environment.MsEnvironment.done_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the valid done space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The done space of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.MsEnvironment.observation_space">
<em class="property">property </em><code class="sig-name descname">observation_space</code><a class="headerlink" href="#mindspore_rl.environment.MsEnvironment.observation_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the valid observation space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The state space of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.MsEnvironment.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/ms_environment.html#MsEnvironment.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.MsEnvironment.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the environment to initial observation and return the initial observation.</p>
<dl class="simple">
<dt>Inputs:</dt><dd><p>No inputs.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Tensor, the initial observation.</p>
</dd>
</dl>
<dl class="simple">
<dt>Supported Platforms:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">GPU</span></code></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">config</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Tag&#39;</span><span class="p">,</span> <span class="s1">&#39;predator_num&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">env</span> <span class="o">=</span> <span class="n">MsEnvironment</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">observation</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">observation</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(2, 5, 21)</span>
</pre></div>
</div>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.MsEnvironment.reward_space">
<em class="property">property </em><code class="sig-name descname">reward_space</code><a class="headerlink" href="#mindspore_rl.environment.MsEnvironment.reward_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the valid reward space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The reward space of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.MsEnvironment.step">
<code class="sig-name descname">step</code><span class="sig-paren">(</span><em class="sig-param">action</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/ms_environment.html#MsEnvironment.step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.MsEnvironment.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Run one timestep of environment to interact with environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>action</strong> (<em>Tensor</em>) – Action provided by the all of agents.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>Tuple of 3 tensors, the observation, the reward and the done.</p>
<ul class="simple">
<li><p><strong>observation</strong> (Tensor) - Observations of all agents after action.</p></li>
<li><p><strong>reward</strong> (Tensor) - Amount of reward returned by the environment.</p></li>
<li><p><strong>done</strong> (Tensor) - Whether the episode has ended.</p></li>
</ul>
</p>
</dd>
</dl>
<dl class="simple">
<dt>Supported Platforms:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">GPU</span></code></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">config</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Tag&#39;</span><span class="p">,</span> <span class="s1">&#39;predator_num&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">env</span> <span class="o">=</span> <span class="n">MsEnvironment</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">observation</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">action</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">action_space</span><span class="o">.</span><span class="n">sample</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">observation</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">done</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">observation</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(2, 5, 21)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mindspore_rl.environment.EnvironmentProcess">
<em class="property">class </em><code class="sig-prename descclassname">mindspore_rl.environment.</code><code class="sig-name descname">EnvironmentProcess</code><span class="sig-paren">(</span><em class="sig-param">proc_no</em>, <em class="sig-param">env_num</em>, <em class="sig-param">envs</em>, <em class="sig-param">actions</em>, <em class="sig-param">observations</em>, <em class="sig-param">initial_states</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/env_process.html#EnvironmentProcess"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.EnvironmentProcess" title="Permalink to this definition">¶</a></dt>
<dd><p>An independent process responsible for creating and interacting with one or more environments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>proc_no</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The process number assigned by the caller.</p></li>
<li><p><strong>env_num</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The number of input environments.</p></li>
<li><p><strong>envs</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em>(</em><a class="reference internal" href="#mindspore_rl.environment.Environment" title="mindspore_rl.environment.Environment"><em>Environment</em></a><em>)</em>) – A list that contains instance of environment (subclass of Environment).</p></li>
<li><p><strong>actions</strong> (<em>Queue</em>) – The queue used to pass actions to the environment process.</p></li>
<li><p><strong>observations</strong> (<em>Queue</em>) – The queue used to pass observations to the caller process.</p></li>
<li><p><strong>initial_states</strong> (<em>Queue</em>) – The queue used to pass initial states to the caller process.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">multiprocessing</span> <span class="kn">import</span> <span class="n">Queue</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">actions</span> <span class="o">=</span> <span class="n">Queue</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">observations</span> <span class="o">=</span> <span class="n">Queue</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">initial_states</span> <span class="o">=</span> <span class="n">Queue</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">proc_no</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">env_num</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">env_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;CartPole-v0&#39;</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">multi_env</span> <span class="o">=</span> <span class="p">[</span><span class="n">GymEnvironment</span><span class="p">(</span><span class="n">env_params</span><span class="p">),</span> <span class="n">GymEnvironment</span><span class="p">(</span><span class="n">env_params</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">env_proc</span> <span class="o">=</span> <span class="n">EnvironmentProcess</span><span class="p">(</span><span class="n">proc_no</span><span class="p">,</span> <span class="n">env_num</span><span class="p">,</span> <span class="n">multi_env</span><span class="p">,</span> <span class="n">actions</span><span class="p">,</span> <span class="n">observations</span><span class="p">,</span> <span class="n">initial_states</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">env_proc</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</pre></div>
</div>
<dl class="method">
<dt id="mindspore_rl.environment.EnvironmentProcess.run">
<code class="sig-name descname">run</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/env_process.html#EnvironmentProcess.run"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.EnvironmentProcess.run" title="Permalink to this definition">¶</a></dt>
<dd><p>Method to be run in sub-process; can be overridden in sub-class</p>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mindspore_rl.environment.StarCraft2Environment">
<em class="property">class </em><code class="sig-prename descclassname">mindspore_rl.environment.</code><code class="sig-name descname">StarCraft2Environment</code><span class="sig-paren">(</span><em class="sig-param">params</em>, <em class="sig-param">env_id=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/sc2_environment.html#StarCraft2Environment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.StarCraft2Environment" title="Permalink to this definition">¶</a></dt>
<dd><p>StarCraft2Environment is a wrapper of SMAC. SMAC is WhiRL’s environment for research in the
field of collaborative multi-agent reinforcement learning (MARL) based on Blizzard’s
StarCraft II RTS game. SMAC makes use of Blizzard’s StarCraft II Machine Learning API and
DeepMind’s PySC2 to provide a convenient interface for autonomous agents to interact with
StarCraft II, getting observations and performing actions. Unlike the PySC2, SMAC concentrates
on decentralised micromanagement scenarios, where each unit of the game is controlled by an
individual RL agent. More detail please have a look at the official github of SMAC:
<a class="reference external" href="https://github.com/oxwhirl/smac">https://github.com/oxwhirl/smac</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – <p>A dictionary contains all the parameters which are used in this class.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 35%" />
<col style="width: 65%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Configuration Parameters</p></th>
<th class="head"><p>Notices</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>sc2_args</p></td>
<td><p>a dict which contains key value that is used to create
instance of SMAC, such as map_name. For more detail
please have a look at its official github.</p></td>
</tr>
</tbody>
</table>
</p></li>
<li><p><strong>env_id</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – A integer which is used to set the seed of this environment.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Supported Platforms:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">Ascend</span></code> <code class="docutils literal notranslate"><span class="pre">GPU</span></code> <code class="docutils literal notranslate"><span class="pre">CPU</span></code></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">env_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;sc2_args&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;map_name&#39;</span><span class="p">:</span> <span class="s1">&#39;2s3z&#39;</span><span class="p">}}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">environment</span> <span class="o">=</span> <span class="n">StarCraft2Environment</span><span class="p">(</span><span class="n">env_params</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">environment</span><span class="p">)</span>
</pre></div>
</div>
<dl class="method">
<dt id="mindspore_rl.environment.StarCraft2Environment.action_space">
<em class="property">property </em><code class="sig-name descname">action_space</code><a class="headerlink" href="#mindspore_rl.environment.StarCraft2Environment.action_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the action space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tuple which states for the space of observation.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.StarCraft2Environment.close">
<code class="sig-name descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/sc2_environment.html#StarCraft2Environment.close"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.StarCraft2Environment.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Close the environment to release the resource.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Success(np.bool_), Whether shutdown the process or threading successfully.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.StarCraft2Environment.config">
<em class="property">property </em><code class="sig-name descname">config</code><a class="headerlink" href="#mindspore_rl.environment.StarCraft2Environment.config" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the config of environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A dictionary which contains environment’s info.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.StarCraft2Environment.done_space">
<em class="property">property </em><code class="sig-name descname">done_space</code><a class="headerlink" href="#mindspore_rl.environment.StarCraft2Environment.done_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the done space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The done space of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.StarCraft2Environment.get_step_info">
<code class="sig-name descname">get_step_info</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/sc2_environment.html#StarCraft2Environment.get_step_info"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.StarCraft2Environment.get_step_info" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the information after interacting with environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>battle_won, whether this game is won or not.</p></li>
<li><p>dead_allies, how many allies are dead.</p></li>
<li><p>dead_enemies, how many enemies are dead.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.StarCraft2Environment.observation_space">
<em class="property">property </em><code class="sig-name descname">observation_space</code><a class="headerlink" href="#mindspore_rl.environment.StarCraft2Environment.observation_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the state space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tuple which states for the space of state.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.StarCraft2Environment.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/sc2_environment.html#StarCraft2Environment.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.StarCraft2Environment.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the environment to the initial state. It is always used at the beginning of each
episode. It will return the value of initial state, the global observation and
an new available action.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tuple of Tensor contains initial state, global observation and available actions.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.StarCraft2Environment.reward_space">
<em class="property">property </em><code class="sig-name descname">reward_space</code><a class="headerlink" href="#mindspore_rl.environment.StarCraft2Environment.reward_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the reward space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The reward space of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.StarCraft2Environment.step">
<code class="sig-name descname">step</code><span class="sig-paren">(</span><em class="sig-param">action</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/sc2_environment.html#StarCraft2Environment.step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.StarCraft2Environment.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute the environment step, which means that interact with environment once.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>action</strong> (<em>Tensor</em>) – A tensor that contains the action information.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>state (Tensor), the environment state after performing the action.</p></li>
<li><p>reward (Tensor), the reward after performing the action.</p></li>
<li><p>done (mindspore.bool_), whether the simulation finishes or not.</p></li>
<li><p>global_obs, the global observation of this environment.</p></li>
<li><p>avail_actions, the available actions in this state.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mindspore_rl.environment.TicTacToeEnvironment">
<em class="property">class </em><code class="sig-prename descclassname">mindspore_rl.environment.</code><code class="sig-name descname">TicTacToeEnvironment</code><span class="sig-paren">(</span><em class="sig-param">params</em>, <em class="sig-param">env_id=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/tic_tac_toe_environment.html#TicTacToeEnvironment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.TicTacToeEnvironment" title="Permalink to this definition">¶</a></dt>
<dd><p>Tic-Tac-Toe is a famous paper-and-pencil game (<a class="reference external" href="https://en.wikipedia.org/wiki/Tic-tac-toe">https://en.wikipedia.org/wiki/Tic-tac-toe</a>). The rule is that two
players draw Os or Xs in a three-by-tree grid. When three of their marks are in a Horizontal, vertical or diagonal
row, that player will be the winner. The following figure is an example of Tic-Tac-Toe.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>o</p></td>
<td></td>
<td><p>x</p></td>
</tr>
<tr class="row-even"><td><p>x</p></td>
<td><p>o</p></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>x</p></td>
<td><p>o</p></td>
</tr>
</tbody>
</table>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – A dictionary contains all the parameters which are used in this class.</p></li>
<li><p><strong>env_id</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – A integer which is used to set the seed of this environment. Default: 0.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Supported Platforms:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">Ascend</span></code> <code class="docutils literal notranslate"><span class="pre">GPU</span></code> <code class="docutils literal notranslate"><span class="pre">CPU</span></code></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.environment</span> <span class="kn">import</span> <span class="n">TicTacToeEnvironment</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">env_params</span> <span class="o">=</span> <span class="p">{}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">environment</span> <span class="o">=</span> <span class="n">TicTacToeEnvironment</span><span class="p">(</span><span class="n">env_params</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">environment</span><span class="p">)</span>
<span class="go">TicTacToeEnvironment&lt;&gt;</span>
</pre></div>
</div>
<dl class="method">
<dt id="mindspore_rl.environment.TicTacToeEnvironment.action_space">
<em class="property">property </em><code class="sig-name descname">action_space</code><a class="headerlink" href="#mindspore_rl.environment.TicTacToeEnvironment.action_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the action space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The action space of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.TicTacToeEnvironment.calculate_rewards">
<code class="sig-name descname">calculate_rewards</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/tic_tac_toe_environment.html#TicTacToeEnvironment.calculate_rewards"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.TicTacToeEnvironment.calculate_rewards" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the rewards of current state.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tensor which states for the rewards of current state.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.TicTacToeEnvironment.config">
<em class="property">property </em><code class="sig-name descname">config</code><a class="headerlink" href="#mindspore_rl.environment.TicTacToeEnvironment.config" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the config of environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A dictionary which contains environment’s info.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.TicTacToeEnvironment.current_player">
<code class="sig-name descname">current_player</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/tic_tac_toe_environment.html#TicTacToeEnvironment.current_player"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.TicTacToeEnvironment.current_player" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the current player of current state.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tensor which states for current player.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.TicTacToeEnvironment.done_space">
<em class="property">property </em><code class="sig-name descname">done_space</code><a class="headerlink" href="#mindspore_rl.environment.TicTacToeEnvironment.done_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the done space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The done space of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.TicTacToeEnvironment.is_terminal">
<code class="sig-name descname">is_terminal</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/tic_tac_toe_environment.html#TicTacToeEnvironment.is_terminal"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.TicTacToeEnvironment.is_terminal" title="Permalink to this definition">¶</a></dt>
<dd><p>Return whether the current state is terminal.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>whether the current state is terminal or not.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.TicTacToeEnvironment.legal_action">
<code class="sig-name descname">legal_action</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/tic_tac_toe_environment.html#TicTacToeEnvironment.legal_action"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.TicTacToeEnvironment.legal_action" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the legal action of current state.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tensor which states for the legal action.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.TicTacToeEnvironment.load">
<code class="sig-name descname">load</code><span class="sig-paren">(</span><em class="sig-param">state</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/tic_tac_toe_environment.html#TicTacToeEnvironment.load"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.TicTacToeEnvironment.load" title="Permalink to this definition">¶</a></dt>
<dd><p>Load the input state. It will update the legal action, current state and done info of the game to the
input checkpoint.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>state</strong> (<em>Tensor</em>) – The input checkpoint state.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>state (Tensor), the state of checkpoint.</p></li>
<li><p>reward (Tensor), the reward of checkpoint.</p></li>
<li><p>done (Tensor), whether the checkpoint is terminal.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.TicTacToeEnvironment.max_utility">
<code class="sig-name descname">max_utility</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/tic_tac_toe_environment.html#TicTacToeEnvironment.max_utility"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.TicTacToeEnvironment.max_utility" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the max utility of Tic-Tac-Toe.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tensor which states for max utility.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.TicTacToeEnvironment.observation_space">
<em class="property">property </em><code class="sig-name descname">observation_space</code><a class="headerlink" href="#mindspore_rl.environment.TicTacToeEnvironment.observation_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the state space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The state space of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.TicTacToeEnvironment.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/tic_tac_toe_environment.html#TicTacToeEnvironment.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.TicTacToeEnvironment.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the environment to the initial state. It is always used at the beginning of each
episode. It will return the value of initial state.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A Tensor which states for initial state.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.TicTacToeEnvironment.reward_space">
<em class="property">property </em><code class="sig-name descname">reward_space</code><a class="headerlink" href="#mindspore_rl.environment.TicTacToeEnvironment.reward_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the reward space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The reward space of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.TicTacToeEnvironment.save">
<code class="sig-name descname">save</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/tic_tac_toe_environment.html#TicTacToeEnvironment.save"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.TicTacToeEnvironment.save" title="Permalink to this definition">¶</a></dt>
<dd><p>Return a repilca of environment. Tic-Tac-Toe do not need a replica, thus it will return the current
state</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tensor which states for the current state.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.TicTacToeEnvironment.step">
<code class="sig-name descname">step</code><span class="sig-paren">(</span><em class="sig-param">action</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/tic_tac_toe_environment.html#TicTacToeEnvironment.step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.TicTacToeEnvironment.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute the environment step, which means that interact with environment once.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>action</strong> (<em>Tensor</em>) – A tensor that contains the action information.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>state (Tensor), the environment state after performing the action.</p></li>
<li><p>reward (Tensor), the reward after performing the action.</p></li>
<li><p>done (Tensor), whether the simulation finishes or not.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.TicTacToeEnvironment.total_num_player">
<code class="sig-name descname">total_num_player</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/tic_tac_toe_environment.html#TicTacToeEnvironment.total_num_player"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.TicTacToeEnvironment.total_num_player" title="Permalink to this definition">¶</a></dt>
<dd><p>Return the total number of player</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>int, the total number of player.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mindspore_rl.environment.DeepMindControlEnvironment">
<em class="property">class </em><code class="sig-prename descclassname">mindspore_rl.environment.</code><code class="sig-name descname">DeepMindControlEnvironment</code><span class="sig-paren">(</span><em class="sig-param">params</em>, <em class="sig-param">env_id=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/dmc_environment.html#DeepMindControlEnvironment"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.DeepMindControlEnvironment" title="Permalink to this definition">¶</a></dt>
<dd><p>DeepMindControlEnvironment is a wrapper which encapsulates the DeepMind Control Suite(DMC)
It stack for physics-based simulation and Reinforcement Learning environments, using MUJOCO
physics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – <p>A dictionary contains all the parameters which are used in this class.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 52%" />
<col style="width: 48%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Configuration Parameters</p></th>
<th class="head"><p>Notices</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>env_name</p></td>
<td><p>the name of game in DMC</p></td>
</tr>
<tr class="row-odd"><td><p>seed</p></td>
<td><p>seed used in Gym</p></td>
</tr>
<tr class="row-even"><td><p>camera</p></td>
<td><p>The camera pos used in
render</p></td>
</tr>
<tr class="row-odd"><td><p>action_repeat</p></td>
<td><p>How many times an action
interacts with env</p></td>
</tr>
<tr class="row-even"><td><p>normalize_action</p></td>
<td><p>Whether needs to normalize
the input action</p></td>
</tr>
<tr class="row-odd"><td><p>img_size</p></td>
<td><p>The rendered img size</p></td>
</tr>
</tbody>
</table>
</p></li>
<li><p><strong>env_id</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – A integer which is used to set the seed of this environment. Default: 0.</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="mindspore_rl.environment.DeepMindControlEnvironment.action_space">
<em class="property">property </em><code class="sig-name descname">action_space</code><a class="headerlink" href="#mindspore_rl.environment.DeepMindControlEnvironment.action_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the action space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The action space of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.DeepMindControlEnvironment.close">
<code class="sig-name descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/dmc_environment.html#DeepMindControlEnvironment.close"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.DeepMindControlEnvironment.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Close the environment to release the resource.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Success(np.bool_), Whether shutdown the process or threading successfully.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.DeepMindControlEnvironment.config">
<em class="property">property </em><code class="sig-name descname">config</code><a class="headerlink" href="#mindspore_rl.environment.DeepMindControlEnvironment.config" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the config of environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A dictionary which contains environment’s info.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.DeepMindControlEnvironment.done_space">
<em class="property">property </em><code class="sig-name descname">done_space</code><a class="headerlink" href="#mindspore_rl.environment.DeepMindControlEnvironment.done_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the done space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The done space of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.DeepMindControlEnvironment.observation_space">
<em class="property">property </em><code class="sig-name descname">observation_space</code><a class="headerlink" href="#mindspore_rl.environment.DeepMindControlEnvironment.observation_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the state space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The state space of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.DeepMindControlEnvironment.reset">
<code class="sig-name descname">reset</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/dmc_environment.html#DeepMindControlEnvironment.reset"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.DeepMindControlEnvironment.reset" title="Permalink to this definition">¶</a></dt>
<dd><p>Reset the environment to the initial state. It is always used at the beginning of each
episode. It will return the value of initial state.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tensor which states for the initial state of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.DeepMindControlEnvironment.reward_space">
<em class="property">property </em><code class="sig-name descname">reward_space</code><a class="headerlink" href="#mindspore_rl.environment.DeepMindControlEnvironment.reward_space" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the reward space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The reward space of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.environment.DeepMindControlEnvironment.step">
<code class="sig-name descname">step</code><span class="sig-paren">(</span><em class="sig-param">action</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/dmc_environment.html#DeepMindControlEnvironment.step"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.environment.DeepMindControlEnvironment.step" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute the environment step, which means that interact with environment once.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>action</strong> (<em>Tensor</em>) – A tensor that contains the action information.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>state (Tensor), the environment state after performing the action.</p></li>
<li><p>reward (Tensor), the reward after performing the action.</p></li>
<li><p>done (Tensor), whether the simulation finishes or not.</p></li>
<li><p>discount (Tensor), the discount value of env.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-mindspore_rl.network">
<span id="module-mindspore_rl.network"></span><span id="mindspore-rl-network"></span><h2>mindspore_rl.network<a class="headerlink" href="#module-mindspore_rl.network" title="Permalink to this headline">¶</a></h2>
<p>Network component used to implement polices.</p>
<dl class="class">
<dt id="mindspore_rl.network.FullyConnectedNet">
<em class="property">class </em><code class="sig-prename descclassname">mindspore_rl.network.</code><code class="sig-name descname">FullyConnectedNet</code><span class="sig-paren">(</span><em class="sig-param">input_size</em>, <em class="sig-param">hidden_size</em>, <em class="sig-param">output_size</em>, <em class="sig-param">compute_type=mstype.float32</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/network/fully_connected_net.html#FullyConnectedNet"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.network.FullyConnectedNet" title="Permalink to this definition">¶</a></dt>
<dd><p>A basic fully connected neural network.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_size</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – numbers of input size.</p></li>
<li><p><strong>hidden_size</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – numbers of hidden layers.</p></li>
<li><p><strong>output_size</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – numbers of output size.</p></li>
<li><p><strong>compute_type</strong> (<em>mindspore.dtype</em>) – data type used for fully connected layer. Default: mindspore.dtype.float32</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore</span> <span class="kn">import</span> <span class="n">Tensor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.network.fully_connected_net</span> <span class="kn">import</span> <span class="n">FullyConnectedNet</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">input</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">net</span> <span class="o">=</span> <span class="n">FullyConnectedNet</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">net</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(2, 2)</span>
</pre></div>
</div>
<dl class="method">
<dt id="mindspore_rl.network.FullyConnectedNet.construct">
<code class="sig-name descname">construct</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/network/fully_connected_net.html#FullyConnectedNet.construct"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.network.FullyConnectedNet.construct" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns output of Dense layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> (<em>Tensor</em>) – Tensor as the input of network.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The output of the Dense layer.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mindspore_rl.network.FullyConnectedLayers">
<em class="property">class </em><code class="sig-prename descclassname">mindspore_rl.network.</code><code class="sig-name descname">FullyConnectedLayers</code><span class="sig-paren">(</span><em class="sig-param">fc_layer_params</em>, <em class="sig-param">dropout_layer_params=None</em>, <em class="sig-param">activation_fn=nn.ReLU()</em>, <em class="sig-param">weight_init=&quot;normal&quot;</em>, <em class="sig-param">bias_init=&quot;zeros&quot;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/network/fully_connected_net.html#FullyConnectedLayers"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.network.FullyConnectedLayers" title="Permalink to this definition">¶</a></dt>
<dd><p>This is a fully connected layers module. User can input abitrary number of fc_layer_params, then
this module can create corresponding number of fully connect layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fc_layer_params</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>]</em>) – A list of int states for the input and output size of fully
connected layer. For example, if the input list is [10, 20, 3], then the module will
create two fully connected layers whose input and output size are (10, 20) and (20, 3)
respectively. The length of fc_layer_params should be greater than or equal to 3.</p></li>
<li><p><strong>dropout_layer_params</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a><em>]</em>) – A list of float states for the dropout rate. If the input
list if [0.5, 0.3], then two dropout layers will be created after each fully connected
layer. The length of dropout_layer_params should be one less than fc_layer_params.
dropout_layer_params is a optional value. Default: None.</p></li>
<li><p><strong>activation_fn</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a><em>, </em><em>Cell</em><em>, </em><em>Primitive</em><em>]</em>) – An instance of activation function. Default: nn.ReLu().</p></li>
<li><p><strong>weight_init</strong> (<em>Union</em><em>[</em><em>Tensor</em><em>, </em><a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a><em>, </em><em>Initializer</em><em>, </em><a class="reference external" href="https://docs.python.org/library/numbers.html#numbers.Number" title="(in Python v3.8)"><em>numbers.Number</em></a><em>]</em>) – The trainable weight_init parameter.
The dtype is same as <cite>x</cite>. The values of str refer to the function <cite>initializer</cite>. Default: ‘normal’.</p></li>
<li><p><strong>bias_init</strong> (<em>Union</em><em>[</em><em>Tensor</em><em>, </em><a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a><em>, </em><em>Initializer</em><em>, </em><a class="reference external" href="https://docs.python.org/library/numbers.html#numbers.Number" title="(in Python v3.8)"><em>numbers.Number</em></a><em>]</em>) – The trainable bias_init parameter. The
dtype is same as <cite>x</cite>. The values of str refer to the function <cite>initializer</cite>. Default: ‘zeros’.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Inputs:</dt><dd><ul class="simple">
<li><p><strong>x</strong> (Tensor) - Tensor of shape <span class="math notranslate nohighlight">\((*, fc\_layers\_params[0])\)</span>.</p></li>
</ul>
</dd>
<dt>Outputs:</dt><dd><p>Tensor of shape <span class="math notranslate nohighlight">\((*, fc\_layers\_params[-1])\)</span>.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore</span> <span class="kn">import</span> <span class="n">Tensor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.network.fully_connected_net</span> <span class="kn">import</span> <span class="n">FullyConnectedLayers</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">input</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">net</span> <span class="o">=</span> <span class="n">FullyConnectedLayers</span><span class="p">(</span><span class="n">fc_layer_params</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">net</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(2, 2)</span>
</pre></div>
</div>
<dl class="method">
<dt id="mindspore_rl.network.FullyConnectedLayers.construct">
<code class="sig-name descname">construct</code><span class="sig-paren">(</span><em class="sig-param">x</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/network/fully_connected_net.html#FullyConnectedLayers.construct"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.network.FullyConnectedLayers.construct" title="Permalink to this definition">¶</a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> (<em>Tensor</em>) – Tensor of shape <span class="math notranslate nohighlight">\((*, fc\_layers\_params[0])\)</span>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Tensor of shape <span class="math notranslate nohighlight">\((*, fc\_layers\_params[-1])\)</span>.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mindspore_rl.network.GruNet">
<em class="property">class </em><code class="sig-prename descclassname">mindspore_rl.network.</code><code class="sig-name descname">GruNet</code><span class="sig-paren">(</span><em class="sig-param">input_size</em>, <em class="sig-param">hidden_size</em>, <em class="sig-param">weight_init=&quot;normal&quot;</em>, <em class="sig-param">num_layers=1</em>, <em class="sig-param">has_bias=True</em>, <em class="sig-param">batch_first=False</em>, <em class="sig-param">dropout=0.0</em>, <em class="sig-param">bidirectional=False</em>, <em class="sig-param">enable_fusion=True</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/network/gru_net.html#GruNet"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.network.GruNet" title="Permalink to this definition">¶</a></dt>
<dd><p>Stacked GRU (Gated Recurrent Unit) layers.</p>
<p>Apply GRU layer to the input.</p>
<p>For detailed information, please refer to
<a class="reference external" href="https://www.mindspore.cn/docs/en/master/api_python/nn/mindspore.nn.GRU.html">mindspore.nn.GRU</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_size</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Number of features of input.</p></li>
<li><p><strong>hidden_size</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Number of features of hidden layer.</p></li>
<li><p><strong>weight_init</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a><em> or </em><em>Initializer</em>) – Initialize method. Default: ‘normal’.</p></li>
<li><p><strong>num_layers</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Number of layers of stacked GRU. Default: 1.</p></li>
<li><p><strong>has_bias</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Whether the cell has bias. Default: True.</p></li>
<li><p><strong>batch_first</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Specifies whether the first dimension of input <cite>x</cite> is batch_size. Default: False.</p></li>
<li><p><strong>dropout</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – If not 0.0, append <cite>Dropout</cite> layer on the outputs of each
GRU layer except the last layer. Default 0.0. The range of dropout is [0.0, 1.0).</p></li>
<li><p><strong>bidirectional</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Specifies whether it is a bidirectional GRU,
num_directions=2 if bidirectional=True otherwise 1. Default: False.</p></li>
<li><p><strong>enable_fusion</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Whether need to use GRU fusion ops. Default: True.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Inputs:</dt><dd><ul class="simple">
<li><p><strong>x_in</strong> (Tensor) - Tensor of data type mindspore.float32 and
shape (seq_len, batch_size, <cite>input_size</cite>) or (batch_size, seq_len, <cite>input_size</cite>).</p></li>
<li><p><strong>h_in</strong> (Tensor) - Tensor of data type mindspore.float32 and
shape (num_directions * <cite>num_layers</cite>, batch_size, <cite>hidden_size</cite>). The data type of <cite>h_in</cite> must be the same as
<cite>x_in</cite>.</p></li>
</ul>
</dd>
<dt>Outputs:</dt><dd><p>Tuple, a tuple contains (<cite>x_out</cite>, <cite>h_out</cite>).</p>
<ul class="simple">
<li><p><strong>x_out</strong> (Tensor) - Tensor of shape (seq_len, batch_size, num_directions * <cite>hidden_size</cite>) or
(batch_size, seq_len, num_directions * <cite>hidden_size</cite>).</p></li>
<li><p><strong>h_out</strong> (Tensor) - Tensor of shape (num_directions * <cite>num_layers</cite>, batch_size, <cite>hidden_size</cite>).</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">net</span> <span class="o">=</span> <span class="n">GruNet</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">has_bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bidirectional</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x_in</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h_in</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">16</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x_out</span><span class="p">,</span> <span class="n">h_out</span> <span class="o">=</span> <span class="n">net</span><span class="p">(</span><span class="n">x_in</span><span class="p">,</span> <span class="n">h_in</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">x_out</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(3, 5, 16)</span>
</pre></div>
</div>
<dl class="method">
<dt id="mindspore_rl.network.GruNet.construct">
<code class="sig-name descname">construct</code><span class="sig-paren">(</span><em class="sig-param">x_in</em>, <em class="sig-param">h_in</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/network/gru_net.html#GruNet.construct"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.network.GruNet.construct" title="Permalink to this definition">¶</a></dt>
<dd><p>The forward calculation of gru net</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_in</strong> (<em>Tensor</em>) – Tensor of data type mindspore.float32 and shape (seq_len, batch_size, <cite>input_size</cite>)
or (batch_size, seq_len, <cite>input_size</cite>).</p></li>
<li><p><strong>h_in</strong> (<em>Tensor</em>) – Tensor of data type mindspore.float32 and shape (num_directions * <cite>num_layers</cite>,
batch_size, <cite>hidden_size</cite>). The data type of <cite>h_in</cite> must be the same as <cite>x_in</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>x_out</strong> (Tensor) - Tensor of shape (seq_len, batch_size, num_directions * <cite>hidden_size</cite>) or
(batch_size, seq_len, num_directions * <cite>hidden_size</cite>).</p></li>
<li><p><strong>h_out</strong> (Tensor) - Tensor of shape (num_directions * <cite>num_layers</cite>, batch_size, <cite>hidden_size</cite>).</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="module-mindspore_rl.policy">
<span id="module-mindspore_rl.policy"></span><span id="mindspore-rl-policy"></span><h2>mindspore_rl.policy<a class="headerlink" href="#module-mindspore_rl.policy" title="Permalink to this headline">¶</a></h2>
<p>Policies used in RL algorithms.</p>
<dl class="class">
<dt id="mindspore_rl.policy.Policy">
<em class="property">class </em><code class="sig-prename descclassname">mindspore_rl.policy.</code><code class="sig-name descname">Policy</code><a class="reference internal" href="_modules/mindspore_rl/policy/policy.html#Policy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.policy.Policy" title="Permalink to this definition">¶</a></dt>
<dd><p>The virtual base class for the policy. This class should be overridden before calling in the model.</p>
<dl class="method">
<dt id="mindspore_rl.policy.Policy.construct">
<code class="sig-name descname">construct</code><span class="sig-paren">(</span><em class="sig-param">*inputs</em>, <em class="sig-param">**kwargs</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/policy/policy.html#Policy.construct"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.policy.Policy.construct" title="Permalink to this definition">¶</a></dt>
<dd><p>The interface of the construct function. Inherited and used by users.
Args can refer to ‘epsilongreedypolicy’, ‘randompolicy’, etc.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong> – it’s depended on the user definition.</p></li>
<li><p><strong>kwargs</strong> – it’s depended on the user definition.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>User defined. Usually, it returns an action value or the probability distribution of an action.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mindspore_rl.policy.RandomPolicy">
<em class="property">class </em><code class="sig-prename descclassname">mindspore_rl.policy.</code><code class="sig-name descname">RandomPolicy</code><span class="sig-paren">(</span><em class="sig-param">action_space_dim</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/policy/random_policy.html#RandomPolicy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.policy.RandomPolicy" title="Permalink to this definition">¶</a></dt>
<dd><p>Produces a random action betweens [0, <cite>acton_space_dim</cite>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>action_space_dim</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – dimension of the action space.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">action_space_dim</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">policy</span> <span class="o">=</span> <span class="n">RandomPolicy</span><span class="p">(</span><span class="n">action_space_dim</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">policy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(1,)</span>
</pre></div>
</div>
<dl class="method">
<dt id="mindspore_rl.policy.RandomPolicy.construct">
<code class="sig-name descname">construct</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/policy/random_policy.html#RandomPolicy.construct"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.policy.RandomPolicy.construct" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns a random number betweens [0, <cite>acton_space_dim</cite>).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A random integer betweens [0, <cite>acton_space_dim</cite>).</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mindspore_rl.policy.GreedyPolicy">
<em class="property">class </em><code class="sig-prename descclassname">mindspore_rl.policy.</code><code class="sig-name descname">GreedyPolicy</code><span class="sig-paren">(</span><em class="sig-param">input_network</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/policy/greedy_policy.html#GreedyPolicy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.policy.GreedyPolicy" title="Permalink to this definition">¶</a></dt>
<dd><p>Produces a sample action base on the given greedy policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input_network</strong> (<em>Cell</em>) – network used to generate action probs by input state.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">state_dim</span><span class="p">,</span> <span class="n">hidden_dim</span><span class="p">,</span> <span class="n">action_dim</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_net</span> <span class="o">=</span> <span class="n">FullyConnectedNet</span><span class="p">(</span><span class="n">state_dim</span><span class="p">,</span> <span class="n">hidden_dim</span><span class="p">,</span> <span class="n">action_dim</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">policy</span> <span class="o">=</span> <span class="n">GreedyPolicy</span><span class="p">(</span><span class="n">input_net</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">state</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">policy</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(2,)</span>
</pre></div>
</div>
<dl class="method">
<dt id="mindspore_rl.policy.GreedyPolicy.construct">
<code class="sig-name descname">construct</code><span class="sig-paren">(</span><em class="sig-param">state</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/policy/greedy_policy.html#GreedyPolicy.construct"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.policy.GreedyPolicy.construct" title="Permalink to this definition">¶</a></dt>
<dd><p>Returns the best action.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>state</strong> (<em>Tensor</em>) – State tensor as the input of network.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>action_max, the best action.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mindspore_rl.policy.EpsilonGreedyPolicy">
<em class="property">class </em><code class="sig-prename descclassname">mindspore_rl.policy.</code><code class="sig-name descname">EpsilonGreedyPolicy</code><span class="sig-paren">(</span><em class="sig-param">input_network</em>, <em class="sig-param">size</em>, <em class="sig-param">epsi_high</em>, <em class="sig-param">epsi_low</em>, <em class="sig-param">decay</em>, <em class="sig-param">action_space_dim</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/policy/epsilon_greedy_policy.html#EpsilonGreedyPolicy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.policy.EpsilonGreedyPolicy" title="Permalink to this definition">¶</a></dt>
<dd><p>Produces a sample action base on the given epsilon-greedy policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_network</strong> (<em>Cell</em>) – A network returns policy action.</p></li>
<li><p><strong>size</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Shape of epsilon.</p></li>
<li><p><strong>epsi_high</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – A high epsilon for exploration betweens [0, 1].</p></li>
<li><p><strong>epsi_low</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – A low epsilon for exploration betweens [0, epsi_high].</p></li>
<li><p><strong>decay</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – A decay factor applied to epsilon.</p></li>
<li><p><strong>action_space_dim</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Dimensions of the action space.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">state_dim</span><span class="p">,</span> <span class="n">hidden_dim</span><span class="p">,</span> <span class="n">action_dim</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_net</span> <span class="o">=</span> <span class="n">FullyConnectedNet</span><span class="p">(</span><span class="n">state_dim</span><span class="p">,</span> <span class="n">hidden_dim</span><span class="p">,</span> <span class="n">action_dim</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">policy</span> <span class="o">=</span> <span class="n">EpsilonGreedyPolicy</span><span class="p">(</span><span class="n">input_net</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">action_dim</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">state</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="n">state_dim</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">step</span> <span class="o">=</span>  <span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">10</span><span class="p">,])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">policy</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(1,)</span>
</pre></div>
</div>
<dl class="method">
<dt id="mindspore_rl.policy.EpsilonGreedyPolicy.construct">
<code class="sig-name descname">construct</code><span class="sig-paren">(</span><em class="sig-param">state</em>, <em class="sig-param">step</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/policy/epsilon_greedy_policy.html#EpsilonGreedyPolicy.construct"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.policy.EpsilonGreedyPolicy.construct" title="Permalink to this definition">¶</a></dt>
<dd><p>The interface of the construct function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<em>Tensor</em>) – The input tensor for network.</p></li>
<li><p><strong>step</strong> (<em>Tensor</em>) – The current step, effects the epsilon decay.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The output action.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
<div class="section" id="mindspore-rl-utils">
<h2>mindspore_rl.utils<a class="headerlink" href="#mindspore-rl-utils" title="Permalink to this headline">¶</a></h2>
<dl class="class">
<dt id="mindspore_rl.utils.DiscountedReturn">
<em class="property">class </em><code class="sig-prename descclassname">mindspore_rl.utils.</code><code class="sig-name descname">DiscountedReturn</code><span class="sig-paren">(</span><em class="sig-param">gamma</em>, <em class="sig-param">need_bprop=False</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/discounted_return.html#DiscountedReturn"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.utils.DiscountedReturn" title="Permalink to this definition">¶</a></dt>
<dd><p>Calculate discounted return.</p>
<p>Set discounted return as <span class="math notranslate nohighlight">\(G\)</span>, discounted factor as <span class="math notranslate nohighlight">\(\gamma\)</span>, reward as <span class="math notranslate nohighlight">\(R\)</span>,
timestep as <span class="math notranslate nohighlight">\(t\)</span>, max timestep as <span class="math notranslate nohighlight">\(N\)</span>. Then <span class="math notranslate nohighlight">\(G_{t} = \Sigma_{t=0}^N{\gamma^tR_{t+1}}\)</span></p>
<p>For the reward sequence contain multi-episode, <span class="math notranslate nohighlight">\(done\)</span> is introduced for indicating episode boundary,
<span class="math notranslate nohighlight">\(last\_state\_value\)</span> represents value after final step of last episode.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gamma</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – Discounted factor between [0, 1].</p></li>
<li><p><strong>need_bprop</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Whether need to calculate the backpropagation of discounted returns. Default: False.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Inputs:</dt><dd><ul class="simple">
<li><p><strong>reward</strong> (Tensor) - The reward sequence contains multi-episode.
Tensor of shape <span class="math notranslate nohighlight">\((Timestep, Batch, ...)\)</span></p></li>
<li><p><strong>done</strong> (Tensor) - The episode done flag. Tensor of shape <span class="math notranslate nohighlight">\((Timestep, Batch)\)</span>.
The data type must be bool.</p></li>
<li><p><strong>last_state_value</strong> (Tensor) - The value after final step of last episode.
Tensor of shape <span class="math notranslate nohighlight">\((Batch, ...)\)</span></p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Discounted return.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">net</span> <span class="o">=</span> <span class="n">DiscountedReturn</span><span class="p">(</span><span class="n">gamma</span><span class="o">=</span><span class="mf">0.99</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reward</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">mindspore</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">done</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">([[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">last_state_value</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">([</span><span class="mf">2.</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">mindspore</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ret</span> <span class="o">=</span> <span class="n">net</span><span class="p">(</span><span class="n">reward</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">last_state_value</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(2, 2)</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="mindspore_rl.utils.OUNoise">
<em class="property">class </em><code class="sig-prename descclassname">mindspore_rl.utils.</code><code class="sig-name descname">OUNoise</code><span class="sig-paren">(</span><em class="sig-param">stddev</em>, <em class="sig-param">damping</em>, <em class="sig-param">action_shape</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/noise.html#OUNoise"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.utils.OUNoise" title="Permalink to this definition">¶</a></dt>
<dd><p>Perform Ornstein-Uhlenbeck (OU) noise base on actions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stddev</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – stddev of Ornstein-Uhlenbeck (OU) noise.</p></li>
<li><p><strong>damping</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – damping of Ornstein-Uhlenbeck (OU) noise.</p></li>
<li><p><strong>action_shape</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a>) – action shape.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Inputs:</dt><dd><ul class="simple">
<li><p><strong>actions</strong> (Tensor) - Actions before perferming noise.</p></li>
</ul>
</dd>
<dt>Outputs:</dt><dd><ul class="simple">
<li><p><strong>actions</strong> (Tensor) - Actions after perferming noise.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore</span> <span class="kn">import</span> <span class="n">Tensor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.utils</span> <span class="kn">import</span> <span class="n">OUNoise</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">action_shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">6</span><span class="p">,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">actions</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">action_shape</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">net</span> <span class="o">=</span> <span class="n">OUNoise</span><span class="p">(</span><span class="n">stddev</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">damping</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span> <span class="n">action_shape</span><span class="o">=</span><span class="n">action_shape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">actions</span> <span class="o">=</span> <span class="n">net</span><span class="p">(</span><span class="n">actions</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">actions</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(6,)</span>
</pre></div>
</div>
</dd></dl>

<dl class="class">
<dt id="mindspore_rl.utils.SoftUpdate">
<em class="property">class </em><code class="sig-prename descclassname">mindspore_rl.utils.</code><code class="sig-name descname">SoftUpdate</code><span class="sig-paren">(</span><em class="sig-param">factor</em>, <em class="sig-param">update_interval</em>, <em class="sig-param">behavior_params</em>, <em class="sig-param">target_params</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/soft_update.html#SoftUpdate"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.utils.SoftUpdate" title="Permalink to this definition">¶</a></dt>
<dd><p>Update target network parameters with moving average algorithm.</p>
<p>Set target network parameter as <span class="math notranslate nohighlight">\(target\_param\)</span>, behavior network parameter as <span class="math notranslate nohighlight">\(behavior\_param\)</span>,
moving averaget factor as <span class="math notranslate nohighlight">\(factor\)</span>.
Then <span class="math notranslate nohighlight">\(target\_param = (1. - factor) * behavior\_param + factor * target\_param\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>factor</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – moving average factor between [0, 1].</p></li>
<li><p><strong>update_interval</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The target network parameters will be updated every <cite>update_interval</cite> steps.</p></li>
<li><p><strong>behavior_params</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a>) – list of behavior network parameters.</p></li>
<li><p><strong>target_params</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a>) – list of target network parameters.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mindspore.nn</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore.common.parameter</span> <span class="kn">import</span> <span class="n">ParameterTuple</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.utils</span> <span class="kn">import</span> <span class="n">SoftUpdate</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Net</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Cell</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="nb">super</span><span class="p">(</span><span class="n">Net</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="bp">self</span><span class="o">.</span><span class="n">behavior_params</span> <span class="o">=</span> <span class="n">ParameterTuple</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">trainable_params</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="bp">self</span><span class="o">.</span><span class="n">target_params</span> <span class="o">=</span> <span class="n">ParameterTuple</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">trainable_params</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="bp">self</span><span class="o">.</span><span class="n">updater</span> <span class="o">=</span> <span class="n">SoftUpdate</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">behavior_params</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_params</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">def</span> <span class="nf">construct</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">updater</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">net</span> <span class="o">=</span> <span class="n">Net</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">net</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">net</span><span class="o">.</span><span class="n">behavior_params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">asnumpy</span><span class="p">(),</span> <span class="n">net</span><span class="o">.</span><span class="n">target_params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">asnumpy</span><span class="p">(),</span> <span class="n">atol</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<span class="target" id="module-mindspore_rl.utils"><span id="module-mindspore_rl.utils"></span></span><p>Network component used to implement polices.</p>
<dl class="class">
<dt id="mindspore_rl.utils.CallbackParam">
<em class="property">class </em><code class="sig-prename descclassname">mindspore_rl.utils.</code><code class="sig-name descname">CallbackParam</code><a class="reference internal" href="_modules/mindspore_rl/utils/callback.html#CallbackParam"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.utils.CallbackParam" title="Permalink to this definition">¶</a></dt>
<dd><p>Callback object’s parameters</p>
</dd></dl>

<dl class="class">
<dt id="mindspore_rl.utils.CallbackManager">
<em class="property">class </em><code class="sig-prename descclassname">mindspore_rl.utils.</code><code class="sig-name descname">CallbackManager</code><span class="sig-paren">(</span><em class="sig-param">callbacks</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/callback.html#CallbackManager"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.utils.CallbackManager" title="Permalink to this definition">¶</a></dt>
<dd><p>Execute callbacks sequentially</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>callbacks</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em>[</em><em>Callback</em><em>]</em>) – Callbacks list.</p>
</dd>
</dl>
<dl class="method">
<dt id="mindspore_rl.utils.CallbackManager.begin">
<code class="sig-name descname">begin</code><span class="sig-paren">(</span><em class="sig-param">params</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/callback.html#CallbackManager.begin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.utils.CallbackManager.begin" title="Permalink to this definition">¶</a></dt>
<dd><p>Call only once before training</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>params</strong> (<a class="reference internal" href="#mindspore_rl.utils.CallbackParam" title="mindspore_rl.utils.CallbackParam"><em>CallbackParam</em></a>) – Parameters for begin.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.utils.CallbackManager.end">
<code class="sig-name descname">end</code><span class="sig-paren">(</span><em class="sig-param">params</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/callback.html#CallbackManager.end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.utils.CallbackManager.end" title="Permalink to this definition">¶</a></dt>
<dd><p>Call only once after training</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>params</strong> (<a class="reference internal" href="#mindspore_rl.utils.CallbackParam" title="mindspore_rl.utils.CallbackParam"><em>CallbackParam</em></a>) – Parameters for end.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.utils.CallbackManager.episode_begin">
<code class="sig-name descname">episode_begin</code><span class="sig-paren">(</span><em class="sig-param">params</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/callback.html#CallbackManager.episode_begin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.utils.CallbackManager.episode_begin" title="Permalink to this definition">¶</a></dt>
<dd><p>Call before each episode start</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>params</strong> (<a class="reference internal" href="#mindspore_rl.utils.CallbackParam" title="mindspore_rl.utils.CallbackParam"><em>CallbackParam</em></a>) – Parameters for episode begin.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.utils.CallbackManager.episode_end">
<code class="sig-name descname">episode_end</code><span class="sig-paren">(</span><em class="sig-param">params</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/callback.html#CallbackManager.episode_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.utils.CallbackManager.episode_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Call before each episode end</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>params</strong> (<a class="reference internal" href="#mindspore_rl.utils.CallbackParam" title="mindspore_rl.utils.CallbackParam"><em>CallbackParam</em></a>) – Parameters for episode end.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mindspore_rl.utils.TimeCallback">
<em class="property">class </em><code class="sig-prename descclassname">mindspore_rl.utils.</code><code class="sig-name descname">TimeCallback</code><span class="sig-paren">(</span><em class="sig-param">print_rate=1</em>, <em class="sig-param">fixed_steps_in_episode=None</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/callback.html#TimeCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.utils.TimeCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Time Callback to monitor time costs for each episode.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>print_rate</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The frequency to print time. Default: 1.</p></li>
<li><p><strong>fixed_steps_in_episode</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>]</em>) – If the number of steps in each episode is fixed, this number
is used to calculate the step time. Otherwise, the real steps number should be provided in params.
Default: None.</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="mindspore_rl.utils.TimeCallback.episode_begin">
<code class="sig-name descname">episode_begin</code><span class="sig-paren">(</span><em class="sig-param">params</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/callback.html#TimeCallback.episode_begin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.utils.TimeCallback.episode_begin" title="Permalink to this definition">¶</a></dt>
<dd><p>Get time in the begin of episode.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>params</strong> (<a class="reference internal" href="#mindspore_rl.utils.CallbackParam" title="mindspore_rl.utils.CallbackParam"><em>CallbackParam</em></a>) – Parameters of the tarining.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.utils.TimeCallback.episode_end">
<code class="sig-name descname">episode_end</code><span class="sig-paren">(</span><em class="sig-param">params</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/callback.html#TimeCallback.episode_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.utils.TimeCallback.episode_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Print time in the end of episode.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>params</strong> (<a class="reference internal" href="#mindspore_rl.utils.CallbackParam" title="mindspore_rl.utils.CallbackParam"><em>CallbackParam</em></a>) – Parameters of the tarining.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mindspore_rl.utils.LossCallback">
<em class="property">class </em><code class="sig-prename descclassname">mindspore_rl.utils.</code><code class="sig-name descname">LossCallback</code><span class="sig-paren">(</span><em class="sig-param">print_rate=1</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/callback.html#LossCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.utils.LossCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Loss Callback to monitor loss in each episode.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>print_rate</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The frequency to print loss. Default: 1.</p>
</dd>
</dl>
<dl class="method">
<dt id="mindspore_rl.utils.LossCallback.episode_end">
<code class="sig-name descname">episode_end</code><span class="sig-paren">(</span><em class="sig-param">params</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/callback.html#LossCallback.episode_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.utils.LossCallback.episode_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Print loss in the end of episode.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>params</strong> (<a class="reference internal" href="#mindspore_rl.utils.CallbackParam" title="mindspore_rl.utils.CallbackParam"><em>CallbackParam</em></a>) – Parameters of the tarining.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mindspore_rl.utils.EvaluateCallback">
<em class="property">class </em><code class="sig-prename descclassname">mindspore_rl.utils.</code><code class="sig-name descname">EvaluateCallback</code><span class="sig-paren">(</span><em class="sig-param">eval_rate=0</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/callback.html#EvaluateCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.utils.EvaluateCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Evaluate callback.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>eval_rate</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The frequency to eval. Default: 0.</p>
</dd>
</dl>
<dl class="method">
<dt id="mindspore_rl.utils.EvaluateCallback.begin">
<code class="sig-name descname">begin</code><span class="sig-paren">(</span><em class="sig-param">params</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/callback.html#EvaluateCallback.begin"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.utils.EvaluateCallback.begin" title="Permalink to this definition">¶</a></dt>
<dd><p>Store the eval rate in the begin of training, run once.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>params</strong> (<a class="reference internal" href="#mindspore_rl.utils.CallbackParam" title="mindspore_rl.utils.CallbackParam"><em>CallbackParam</em></a>) – Parameters for episode begin.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.utils.EvaluateCallback.episode_end">
<code class="sig-name descname">episode_end</code><span class="sig-paren">(</span><em class="sig-param">params</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/callback.html#EvaluateCallback.episode_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.utils.EvaluateCallback.episode_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Run evaluate in the end of episode, and print the rewards.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>params</strong> (<a class="reference internal" href="#mindspore_rl.utils.CallbackParam" title="mindspore_rl.utils.CallbackParam"><em>CallbackParam</em></a>) – Parameters for episode end.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mindspore_rl.utils.CheckpointCallback">
<em class="property">class </em><code class="sig-prename descclassname">mindspore_rl.utils.</code><code class="sig-name descname">CheckpointCallback</code><span class="sig-paren">(</span><em class="sig-param">save_per_episode=0</em>, <em class="sig-param">directory=None</em>, <em class="sig-param">max_ckpt_nums=5</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/callback.html#CheckpointCallback"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.utils.CheckpointCallback" title="Permalink to this definition">¶</a></dt>
<dd><p>Save the checkpoint file for all the model weights. And keep the latest <cite>max_ckpt_nums</cite> checkpoint files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_per_episode</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The frequency to save checkpoint. Default: 0.</p></li>
<li><p><strong>directory</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a><em>, </em><em>optional</em>) – The directory for saving checkpoints. Default is current path.</p></li>
<li><p><strong>max_ckpt_nums</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>optional</em>) – Numbers of how many checkpoint files to be kept. Default:5.</p></li>
</ul>
</dd>
</dl>
<dl class="method">
<dt id="mindspore_rl.utils.CheckpointCallback.episode_end">
<code class="sig-name descname">episode_end</code><span class="sig-paren">(</span><em class="sig-param">params</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/callback.html#CheckpointCallback.episode_end"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.utils.CheckpointCallback.episode_end" title="Permalink to this definition">¶</a></dt>
<dd><p>Save checkpoint in the end of episode.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>params</strong> (<a class="reference internal" href="#mindspore_rl.utils.CallbackParam" title="mindspore_rl.utils.CallbackParam"><em>CallbackParam</em></a>) – Parameters of the tarining.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mindspore_rl.utils.VanillaFunc">
<em class="property">class </em><code class="sig-prename descclassname">mindspore_rl.utils.</code><code class="sig-name descname">VanillaFunc</code><span class="sig-paren">(</span><em class="sig-param">env</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/mcts/mcts.html#VanillaFunc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.utils.VanillaFunc" title="Permalink to this definition">¶</a></dt>
<dd><p>This is the customized algorithm for VanillaMCTS. The prior of each legal action is uniform
distribution and it plays randomly to obtain the result of simulation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>env</strong> (<a class="reference internal" href="#mindspore_rl.environment.Environment" title="mindspore_rl.environment.Environment"><em>Environment</em></a>) – The input environment.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">env</span> <span class="o">=</span> <span class="n">TicTacToeEnvironment</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vanilla_func</span> <span class="o">=</span> <span class="n">VanillaFunc</span><span class="p">(</span><span class="n">env</span><span class="p">)</span>
</pre></div>
</div>
<dl class="method">
<dt id="mindspore_rl.utils.VanillaFunc.calculate_prior">
<code class="sig-name descname">calculate_prior</code><span class="sig-paren">(</span><em class="sig-param">new_state</em>, <em class="sig-param">legal_action</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/mcts/mcts.html#VanillaFunc.calculate_prior"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.utils.VanillaFunc.calculate_prior" title="Permalink to this definition">¶</a></dt>
<dd><p>The functionality of calculate_prior is to calculate prior of the input legal actions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>new_state</strong> (<em>mindspore.float32</em>) – The state of environment.</p></li>
<li><p><strong>legal_action</strong> (<em>mindspore.int32</em>) – The legal action of environment</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>prior (mindspore.float32), The probability (or prior) of all the input legal actions.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.utils.VanillaFunc.simulation">
<code class="sig-name descname">simulation</code><span class="sig-paren">(</span><em class="sig-param">new_state</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/mcts/mcts.html#VanillaFunc.simulation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.utils.VanillaFunc.simulation" title="Permalink to this definition">¶</a></dt>
<dd><p>The functionality of simulation is to calculate reward of the input state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>new_state</strong> (<em>mindspore.float32</em>) – The state of environment.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>rewards (mindspore.float32), The results of simulation.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mindspore_rl.utils.AlgorithmFunc">
<em class="property">class </em><code class="sig-prename descclassname">mindspore_rl.utils.</code><code class="sig-name descname">AlgorithmFunc</code><a class="reference internal" href="_modules/mindspore_rl/utils/mcts/mcts.html#AlgorithmFunc"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.utils.AlgorithmFunc" title="Permalink to this definition">¶</a></dt>
<dd><p>This is the base class for user to customize algorithm in MCTS. User need to
inherit this base class and implement all the functions with SAME input and output.</p>
<dl class="method">
<dt id="mindspore_rl.utils.AlgorithmFunc.calculate_prior">
<code class="sig-name descname">calculate_prior</code><span class="sig-paren">(</span><em class="sig-param">new_state</em>, <em class="sig-param">legal_action</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/mcts/mcts.html#AlgorithmFunc.calculate_prior"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.utils.AlgorithmFunc.calculate_prior" title="Permalink to this definition">¶</a></dt>
<dd><p>The functionality of calculate_prior is to calculate prior of the input legal actions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>new_state</strong> (<em>mindspore.float32</em>) – The state of environment.</p></li>
<li><p><strong>legal_action</strong> (<em>mindspore.int32</em>) – The legal action of environment</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>prior (mindspore.float32), The probability (or prior) of all the input legal actions.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.utils.AlgorithmFunc.simulation">
<code class="sig-name descname">simulation</code><span class="sig-paren">(</span><em class="sig-param">new_state</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/mcts/mcts.html#AlgorithmFunc.simulation"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.utils.AlgorithmFunc.simulation" title="Permalink to this definition">¶</a></dt>
<dd><p>The functionality of simulation is to implement the simulation phase in MCTS. It takes the
state as input and return the rewards.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>new_state</strong> (<em>mindspore.float32</em>) – The state of environment.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>rewards (mindspore.float32), The results of simulation.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mindspore_rl.utils.MCTS">
<em class="property">class </em><code class="sig-prename descclassname">mindspore_rl.utils.</code><code class="sig-name descname">MCTS</code><span class="sig-paren">(</span><em class="sig-param">env</em>, <em class="sig-param">tree_type</em>, <em class="sig-param">node_type</em>, <em class="sig-param">root_player</em>, <em class="sig-param">customized_func</em>, <em class="sig-param">device</em>, <em class="sig-param">args</em>, <em class="sig-param">has_init_reward=False</em>, <em class="sig-param">max_action=-1.0</em>, <em class="sig-param">max_iteration=1000</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/mcts/mcts.html#MCTS"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.utils.MCTS" title="Permalink to this definition">¶</a></dt>
<dd><p>Monte Carlo Tree Search(MCTS) is a general search algorithm for some kinds of decision processes,
most notably those employed in software that plays board games, such as Go, chess. It was originally
proposed in 2006. A general MCTS has four phases:</p>
<ol class="arabic simple">
<li><p>Selection - selects the next node according to the selection policy (like UCT, RAVE, AMAF and etc.).</p></li>
<li><p>Expansion - unless the selection reached a terminal state, expansion adds a new child node to
the last node (leaf node) that is selected in Selection phase.</p></li>
<li><p>Simulation - performs an algorithm (random, neural net or other algorithms) to obtain the payoff.</p></li>
<li><p>Backpropagation - propagates the payoff for all visited node.</p></li>
</ol>
<p>As the time goes by, these four phases of MCTS is evolved. AlphaGo introduced neural network to
MCTS, which makes the MCTS more powerful.</p>
<p>This class is a mindspore ops implementation MCTS. User can use provided MCTS algorithm, or develop
their own MCTS by derived base class (MonteCarloTreeNode) in c++.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env</strong> (<a class="reference internal" href="#mindspore_rl.environment.Environment" title="mindspore_rl.environment.Environment"><em>Environment</em></a>) – It must be the subclass of Environment.</p></li>
<li><p><strong>tree_type</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – The name of tree type.</p></li>
<li><p><strong>node_type</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – The name of node type.</p></li>
<li><p><strong>root_player</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – The root player, which should be less than the total number of player.</p></li>
<li><p><strong>customized_func</strong> (<a class="reference internal" href="#mindspore_rl.utils.AlgorithmFunc" title="mindspore_rl.utils.AlgorithmFunc"><em>AlgorithmFunc</em></a>) – Some algorithm specific class. For more detail, please have a look at
documentation of AlgorithmFunc.</p></li>
<li><p><strong>device</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – The device type in [“CPU”, “GPU”], Ascend is not support yet.</p></li>
<li><p><strong>args</strong> (<em>Tensor</em>) – any values which will be the input of MctsCreation. Please following the table below
to provide the input value. These value will not be reset after invoke ‘restore_tree_data’.</p></li>
<li><p><strong>has_init_reward</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Whether pass the reward to each node during the node initialization. Default: False.</p></li>
<li><p><strong>max_action</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – The max number of action in environment. If the max_action is -1.0, the step in Environment
will accept the last action. Otherwise, it will accept max_action number of action. Default: -1.0.</p></li>
<li><p><strong>max_iteration</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – <p>The max training iteration of MCTS. Default: 1000.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 29%" />
<col style="width: 17%" />
<col style="width: 28%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>MCTS Tree Type</p></th>
<th class="head"><p>MCTS Node Type</p></th>
<th class="head"><p>Configuration Parameter</p></th>
<th class="head"><p>Notices</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>CPUCommon</p></td>
<td><p>CPUVanilla</p></td>
<td><p>UCT const</p></td>
<td rowspan="2"><p>UCT const is used to
calculate UCT value in
Selection phase</p></td>
</tr>
<tr class="row-odd"><td><p>GPUCommon</p></td>
<td><p>GPUVanilla</p></td>
<td><p>UCT const</p></td>
</tr>
</tbody>
</table>
</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore</span> <span class="kn">import</span> <span class="n">Tensor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mindspore</span> <span class="k">as</span> <span class="nn">ms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.environment</span> <span class="kn">import</span> <span class="n">TicTacToeEnvironment</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.utils</span> <span class="kn">import</span> <span class="n">VanillaFunc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.utils</span> <span class="kn">import</span> <span class="n">MCTS</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">env</span> <span class="o">=</span> <span class="n">TicTacToeEnvironment</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vanilla_func</span> <span class="o">=</span> <span class="n">VanillaFunc</span><span class="p">(</span><span class="n">env</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">uct</span> <span class="o">=</span> <span class="p">(</span><span class="n">Tensor</span><span class="p">(</span><span class="n">uct</span><span class="p">,</span> <span class="n">ms</span><span class="o">.</span><span class="n">float32</span><span class="p">),)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">root_player</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mcts</span> <span class="o">=</span> <span class="n">MCTS</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="s2">&quot;CPUCommon&quot;</span><span class="p">,</span> <span class="s2">&quot;CPUVanilla&quot;</span><span class="p">,</span> <span class="n">root_player</span><span class="p">,</span> <span class="n">vanilla_func</span><span class="p">,</span> <span class="n">device</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="n">uct</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">action</span><span class="p">,</span> <span class="n">handle</span> <span class="o">=</span> <span class="n">mcts</span><span class="o">.</span><span class="n">mcts_search</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
</pre></div>
</div>
<dl class="method">
<dt id="mindspore_rl.utils.MCTS.destroy">
<code class="sig-name descname">destroy</code><span class="sig-paren">(</span><em class="sig-param">handle</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/mcts/mcts.html#MCTS.destroy"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.utils.MCTS.destroy" title="Permalink to this definition">¶</a></dt>
<dd><p>destroy will destroy current tree. Please call this function ONLY when
do not use this tree any more.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>handle</strong> (<em>mindspore.int64</em>) – The unique handle of mcts tree.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>success (mindspore.bool_), Whether destroy is successful.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.utils.MCTS.mcts_search">
<code class="sig-name descname">mcts_search</code><span class="sig-paren">(</span><em class="sig-param">*args</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/mcts/mcts.html#MCTS.mcts_search"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.utils.MCTS.mcts_search" title="Permalink to this definition">¶</a></dt>
<dd><p>mcts_search is the main function of MCTS. Invoke this function will return the best
action of current state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>*args</strong> (<em>Tensor</em>) – The variable which updates during each iteration. They will be restored
after invoking ‘restore_tree_data’. The input value needs to match provied
algorithm.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>action (mindspore.int32), The action which is returned by monte carlo tree search.</p></li>
<li><p>handle (mindspore.int64), The unique handle of mcts tree.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.utils.MCTS.restore_tree_data">
<code class="sig-name descname">restore_tree_data</code><span class="sig-paren">(</span><em class="sig-param">handle</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/mcts/mcts.html#MCTS.restore_tree_data"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.utils.MCTS.restore_tree_data" title="Permalink to this definition">¶</a></dt>
<dd><p>restore_tree_data will restore all the data in the tree, back to the initial state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>handle</strong> (<em>mindspore.int64</em>) – The unique handle of mcts tree.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>success (mindspore.bool_), Whether restore is successful.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="function">
<dt id="mindspore_rl.utils.update_config">
<code class="sig-prename descclassname">mindspore_rl.utils.</code><code class="sig-name descname">update_config</code><span class="sig-paren">(</span><em class="sig-param">config</em>, <em class="sig-param">env_yaml</em>, <em class="sig-param">algo_yaml</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/utils.html#update_config"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.utils.update_config" title="Permalink to this definition">¶</a></dt>
<dd><p>Update the config by the provided yamls.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – the config to be update.</p></li>
<li><p><strong>env_yaml</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – the environment yaml file.</p></li>
<li><p><strong>algo_yaml</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – the algorithm yaml file.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="class">
<dt id="mindspore_rl.utils.BatchRead">
<em class="property">class </em><code class="sig-prename descclassname">mindspore_rl.utils.</code><code class="sig-name descname">BatchRead</code><a class="reference internal" href="_modules/mindspore_rl/utils/batch_read_write.html#BatchRead"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.utils.BatchRead" title="Permalink to this definition">¶</a></dt>
<dd><p>BatchRead: read a list of parameters to assign the target.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is an experiential prototype that is subject to change and/or deletion.</p>
</div>
<dl class="simple">
<dt>Supported Platforms:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">GPU</span></code> <code class="docutils literal notranslate"><span class="pre">CPU</span></code></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mindspore</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore</span> <span class="kn">import</span> <span class="n">nn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore.common.parameter</span> <span class="kn">import</span> <span class="n">Parameter</span><span class="p">,</span> <span class="n">ParameterTuple</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.utils</span> <span class="kn">import</span> <span class="n">BatchRead</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">SNet</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Cell</span><span class="p">):</span>
<span class="gp">... </span>  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">super</span><span class="p">(</span><span class="n">SNet</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="n">Tensor</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">mstype</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;a&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">dense</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">in_channels</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">out_channels</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">weight_init</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">DNet</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Cell</span><span class="p">):</span>
<span class="gp">... </span>  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">super</span><span class="p">(</span><span class="n">DNet</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="n">Tensor</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">mstype</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;a&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">dense</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">in_channels</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">out_channels</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Read</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Cell</span><span class="p">):</span>
<span class="gp">... </span>  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dst</span><span class="p">,</span> <span class="n">src</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">super</span><span class="p">(</span><span class="n">Read</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">read</span> <span class="o">=</span> <span class="n">BatchRead</span><span class="p">()</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">dst</span> <span class="o">=</span> <span class="n">ParameterTuple</span><span class="p">(</span><span class="n">dst</span><span class="o">.</span><span class="n">trainable_params</span><span class="p">())</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">src</span> <span class="o">=</span> <span class="n">ParameterTuple</span><span class="p">(</span><span class="n">src</span><span class="o">.</span><span class="n">trainable_params</span><span class="p">())</span>
<span class="gp">... </span>  <span class="k">def</span> <span class="nf">construct</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">success</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dst</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">src</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">success</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dst_net</span> <span class="o">=</span> <span class="n">DNet</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">source_net</span> <span class="o">=</span> <span class="n">SNet</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nets</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">CellList</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dst_net</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">source_net</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">success</span> <span class="o">=</span> <span class="n">Read</span><span class="p">(</span><span class="n">nets</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nets</span><span class="p">[</span><span class="mi">1</span><span class="p">])()</span>
</pre></div>
</div>
<dl class="method">
<dt id="mindspore_rl.utils.BatchRead.construct">
<code class="sig-name descname">construct</code><span class="sig-paren">(</span><em class="sig-param">dst</em>, <em class="sig-param">src</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/batch_read_write.html#BatchRead.construct"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.utils.BatchRead.construct" title="Permalink to this definition">¶</a></dt>
<dd><p>Read the source parameter list to assign the dst.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dst</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em>(</em><em>Parameters</em><em>)</em>) – A paramameter tuple of the dst model.</p></li>
<li><p><strong>src</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em>(</em><em>Parameters</em><em>)</em>) – A paramameter tuple of the source model.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Bool, true.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mindspore_rl.utils.BatchWrite">
<em class="property">class </em><code class="sig-prename descclassname">mindspore_rl.utils.</code><code class="sig-name descname">BatchWrite</code><a class="reference internal" href="_modules/mindspore_rl/utils/batch_read_write.html#BatchWrite"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.utils.BatchWrite" title="Permalink to this definition">¶</a></dt>
<dd><p>BatchWrite: write a list of parameters to assign the target.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is an experiential prototype that is subject to change and/or deletion.</p>
</div>
<dl class="simple">
<dt>Supported Platforms:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">GPU</span></code> <code class="docutils literal notranslate"><span class="pre">CPU</span></code></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mindspore</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore</span> <span class="kn">import</span> <span class="n">nn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore.common.parameter</span> <span class="kn">import</span> <span class="n">Parameter</span><span class="p">,</span> <span class="n">ParameterTuple</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.utils</span> <span class="kn">import</span> <span class="n">BatchWrite</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">SourceNet</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Cell</span><span class="p">):</span>
<span class="gp">... </span>  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">super</span><span class="p">(</span><span class="n">SourceNet</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="n">Tensor</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">mstype</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;a&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">dense</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">in_channels</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">out_channels</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">weight_init</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">DstNet</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Cell</span><span class="p">):</span>
<span class="gp">... </span>  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">super</span><span class="p">(</span><span class="n">DstNet</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="n">Tensor</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">mstype</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;a&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">dense</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">in_channels</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">out_channels</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Write</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Cell</span><span class="p">):</span>
<span class="gp">... </span>  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dst</span><span class="p">,</span> <span class="n">src</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">super</span><span class="p">(</span><span class="n">Write</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">w</span> <span class="o">=</span> <span class="n">BatchWrite</span><span class="p">()</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">dst</span> <span class="o">=</span> <span class="n">ParameterTuple</span><span class="p">(</span><span class="n">dst</span><span class="o">.</span><span class="n">trainable_params</span><span class="p">())</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">src</span> <span class="o">=</span> <span class="n">ParameterTuple</span><span class="p">(</span><span class="n">src</span><span class="o">.</span><span class="n">trainable_params</span><span class="p">())</span>
<span class="gp">... </span>  <span class="k">def</span> <span class="nf">construct</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">success</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">w</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dst</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">src</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">success</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dst_net</span> <span class="o">=</span> <span class="n">DstNet</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">source_net</span> <span class="o">=</span> <span class="n">SourceNet</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nets</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">CellList</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dst_net</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">source_net</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">success</span> <span class="o">=</span> <span class="n">Write</span><span class="p">(</span><span class="n">nets</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nets</span><span class="p">[</span><span class="mi">1</span><span class="p">])()</span>
</pre></div>
</div>
<dl class="method">
<dt id="mindspore_rl.utils.BatchWrite.construct">
<code class="sig-name descname">construct</code><span class="sig-paren">(</span><em class="sig-param">dst</em>, <em class="sig-param">src</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/batch_read_write.html#BatchWrite.construct"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.utils.BatchWrite.construct" title="Permalink to this definition">¶</a></dt>
<dd><p>Write the source parameter list to assign the dst.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dst</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em>(</em><em>Parameters</em><em>)</em>) – A paramameter tuple of the dst model.</p></li>
<li><p><strong>src</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em>(</em><em>Parameters</em><em>)</em>) – A paramameter tuple of the source model.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Bool, true.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mindspore_rl.utils.TensorArray">
<em class="property">class </em><code class="sig-prename descclassname">mindspore_rl.utils.</code><code class="sig-name descname">TensorArray</code><span class="sig-paren">(</span><em class="sig-param">dtype</em>, <em class="sig-param">element_shape</em>, <em class="sig-param">dynamic_size=True</em>, <em class="sig-param">size=0</em>, <em class="sig-param">name=&quot;TA&quot;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/tensor_array.html#TensorArray"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.utils.TensorArray" title="Permalink to this definition">¶</a></dt>
<dd><p>TensorArray: a dynamic array to store tensors.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is an experiential prototype that is subject to change and/or deletion.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dtype</strong> (<em>mindspore.dtype</em>) – the data type in the TensorArray.</p></li>
<li><p><strong>element_shape</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em>(</em><a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>)</em>) – the shape of each tensor in a TensorArray.</p></li>
<li><p><strong>dynamic_size</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – if true, the size of TensorArray can be increased, otherwise it is a fixed size.
Default: True.</p></li>
<li><p><strong>size</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – if dynamic_size=False, <cite>size</cite> means the max_size of the TensorArray.</p></li>
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – the name of this TensorArray. Default: “TA”.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Supported Platforms:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">GPU</span></code> <code class="docutils literal notranslate"><span class="pre">CPU</span></code></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mindspore</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.utils</span> <span class="kn">import</span> <span class="n">TensorArray</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span> <span class="o">=</span> <span class="n">TensorArray</span><span class="p">(</span><span class="n">mindspore</span><span class="o">.</span><span class="n">int64</span><span class="p">,</span> <span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ans</span> <span class="o">=</span> <span class="n">ta</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ans</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">ta</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="go">[1 2]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ans</span> <span class="o">=</span> <span class="n">ta</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ans</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<dl class="method">
<dt id="mindspore_rl.utils.TensorArray.clear">
<code class="sig-name descname">clear</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/tensor_array.html#TensorArray.clear"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.utils.TensorArray.clear" title="Permalink to this definition">¶</a></dt>
<dd><p>Clear the created TensorArray. Only reset the TensorArray, clear the data and reset the size
in TensorArray and keep the instance of this TensorArray.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Bool, true.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.utils.TensorArray.close">
<code class="sig-name descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/tensor_array.html#TensorArray.close"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.utils.TensorArray.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Close the created TensorArray.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Once close the TensorArray, every functions belong to this TensorArray will be disaviliable.
Every resources created in TensorArray will be removed. If this TensorArray will be used in next step
or somewhere, eg: next loop, please use <cite>clear</cite> instead.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Bool, true.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.utils.TensorArray.read">
<code class="sig-name descname">read</code><span class="sig-paren">(</span><em class="sig-param">index</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/tensor_array.html#TensorArray.read"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.utils.TensorArray.read" title="Permalink to this definition">¶</a></dt>
<dd><p>Read tensor form the TensorArray by the given position index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>index</strong> (<em>[</em><a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>mindspore.int64</em><em>]</em>) – The given index to get the tensor.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Tensor, the value in position index.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.utils.TensorArray.size">
<code class="sig-name descname">size</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/tensor_array.html#TensorArray.size"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.utils.TensorArray.size" title="Permalink to this definition">¶</a></dt>
<dd><p>The logical size of TensorArray.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Tensor, the size of TensorArray.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.utils.TensorArray.stack">
<code class="sig-name descname">stack</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/tensor_array.html#TensorArray.stack"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.utils.TensorArray.stack" title="Permalink to this definition">¶</a></dt>
<dd><p>Stack the values in TensorArray into a stacked Tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Tensor, all the values will be stacked into one tensor.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.utils.TensorArray.write">
<code class="sig-name descname">write</code><span class="sig-paren">(</span><em class="sig-param">index</em>, <em class="sig-param">value</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/tensor_array.html#TensorArray.write"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.utils.TensorArray.write" title="Permalink to this definition">¶</a></dt>
<dd><p>Write value(Tensor) to TensorArray in position index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index</strong> (<em>[</em><a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>mindspore.int64</em><em>]</em>) – The position to write.</p></li>
<li><p><strong>value</strong> (<em>Tensor</em>) – The value to add into the TensorArray.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Bool, true.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="class">
<dt id="mindspore_rl.utils.TensorsQueue">
<em class="property">class </em><code class="sig-prename descclassname">mindspore_rl.utils.</code><code class="sig-name descname">TensorsQueue</code><span class="sig-paren">(</span><em class="sig-param">dtype</em>, <em class="sig-param">shapes</em>, <em class="sig-param">size=0</em>, <em class="sig-param">name=&quot;TQ&quot;</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/tensors_queue.html#TensorsQueue"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.utils.TensorsQueue" title="Permalink to this definition">¶</a></dt>
<dd><p>TensorsQueue: a queue which stores tensors lists.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is an experiential prototype that is subject to change and/or deletion.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dtype</strong> (<em>mindspore.dtype</em>) – the data type in the TensorsQueue. Each tensor should have the same dtype.</p></li>
<li><p><strong>shapes</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em>[</em><em>int64</em><em>]</em>) – the shape of each element in TensorsQueue.</p></li>
<li><p><strong>size</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – the size of the TensorsQueue. Default: 0.</p></li>
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – the name of this TensorsQueue. Default: “TQ”.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/library/exceptions.html#TypeError" title="(in Python v3.8)"><strong>TypeError</strong></a> – If <cite>dtype</cite> is not MindSpore number type.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/library/exceptions.html#ValueError" title="(in Python v3.8)"><strong>ValueError</strong></a> – If <cite>size</cite> is less than 0.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/library/exceptions.html#ValueError" title="(in Python v3.8)"><strong>ValueError</strong></a> – If <cite>shapes</cite> size is less than 1.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Supported Platforms:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">GPU</span></code> <code class="docutils literal notranslate"><span class="pre">CPU</span></code></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mindspore</span> <span class="k">as</span> <span class="nn">ms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore</span> <span class="kn">import</span> <span class="n">Tensor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.utils</span> <span class="kn">import</span> <span class="n">TensorsQueue</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data1</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data2</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tq</span> <span class="o">=</span> <span class="n">TensorsQueue</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">shapes</span><span class="o">=</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,)),</span> <span class="n">size</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tq</span><span class="o">.</span><span class="n">put</span><span class="p">((</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ans</span> <span class="o">=</span> <span class="n">tq</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
</pre></div>
</div>
<dl class="method">
<dt id="mindspore_rl.utils.TensorsQueue.clear">
<code class="sig-name descname">clear</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/tensors_queue.html#TensorsQueue.clear"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.utils.TensorsQueue.clear" title="Permalink to this definition">¶</a></dt>
<dd><p>Clear the created TensorsQueue. Only reset the TensorsQueue, clear the data and reset the size
in TensorsQueue and keep the instance of this TensorsQueue.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Bool, true.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.utils.TensorsQueue.close">
<code class="sig-name descname">close</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/tensors_queue.html#TensorsQueue.close"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.utils.TensorsQueue.close" title="Permalink to this definition">¶</a></dt>
<dd><p>Close the created TensorsQueue.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Once close the TensorsQueue, every functions belong to this TensorsQueue will be disaviliable.
Every resources created in TensorsQueue will be removed. If this TensorsQueue will be used in next step
or somewhere, eg: next loop, please use <cite>clear</cite> instead.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Bool, true.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.utils.TensorsQueue.get">
<code class="sig-name descname">get</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/tensors_queue.html#TensorsQueue.get"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.utils.TensorsQueue.get" title="Permalink to this definition">¶</a></dt>
<dd><p>Get one element int the front of the TensorsQueue.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>tuple(Tensors), the element in TensorsQueue.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.utils.TensorsQueue.pop">
<code class="sig-name descname">pop</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/tensors_queue.html#TensorsQueue.pop"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.utils.TensorsQueue.pop" title="Permalink to this definition">¶</a></dt>
<dd><p>Get one element int the front of the TensorsQueue, and remove it.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>tuple(Tensors), the element in TensorsQueue.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.utils.TensorsQueue.put">
<code class="sig-name descname">put</code><span class="sig-paren">(</span><em class="sig-param">element</em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/tensors_queue.html#TensorsQueue.put"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.utils.TensorsQueue.put" title="Permalink to this definition">¶</a></dt>
<dd><p>Put element(tuple(Tensors)) to TensorsQueue in the end of queue.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>element</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em>(</em><em>Tensor</em><em>) or </em><a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em>[</em><em>tensor</em><em>]</em>) – The input element.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Bool, true.</p>
</dd>
</dl>
</dd></dl>

<dl class="method">
<dt id="mindspore_rl.utils.TensorsQueue.size">
<code class="sig-name descname">size</code><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/tensors_queue.html#TensorsQueue.size"><span class="viewcode-link">[source]</span></a><a class="headerlink" href="#mindspore_rl.utils.TensorsQueue.size" title="Permalink to this definition">¶</a></dt>
<dd><p>Get the used size of the TensorsQueue.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Tensor(mindspore.int64), the used size of TensorsQueue.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="RELEASE.html" class="btn btn-neutral float-right" title="Release Notes" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="environment.html" class="btn btn-neutral float-left" title="Reinforcement Learning Environment Access" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2022, MindSpore.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   
	<script async="async" src="https://cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</body>
</html>