

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>mindspore_rl &mdash; MindSpore master documentation</title>
  

  
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
   
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  
  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="MindSpore Reinforcement Release Notes" href="RELEASE.html" />
    <link rel="prev" title="Deep Q Learning (DQN) with MindSpore Reinforcement" href="dqn.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> MindSpore
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Installation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="reinforcement_install.html">MindSpore Reinforcement Installation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="custom_config_info.html">MindSpore RL Configuration Instruction</a></li>
<li class="toctree-l1"><a class="reference internal" href="dqn.html">Deep Q Learning (DQN) with MindSpore Reinforcement</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API References</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">mindspore_rl</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-mindspore_rl.agent">mindspore_rl.agent</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-mindspore_rl.core">mindspore_rl.core</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-mindspore_rl.environment">mindspore_rl.environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-mindspore_rl.network">mindspore_rl.network</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-mindspore_rl.policy">mindspore_rl.policy</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">RELEASE NOTES</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="RELEASE.html">MindSpore Reinforcement Release Notes</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">MindSpore</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>mindspore_rl</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/reinforcement.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="module-mindspore_rl">
<span id="mindspore-rl"></span><h1>mindspore_rl<a class="headerlink" href="#module-mindspore_rl" title="Permalink to this headline"></a></h1>
<p>Components for MindSpore Reinforcement Learning Framework.</p>
<section id="module-mindspore_rl.agent">
<span id="mindspore-rl-agent"></span><h2>mindspore_rl.agent<a class="headerlink" href="#module-mindspore_rl.agent" title="Permalink to this headline"></a></h2>
<p>Components for agent, actor, learner, trainer.</p>
<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.agent.Actor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.agent.</span></span><span class="sig-name descname"><span class="pre">Actor</span></span><a class="reference internal" href="_modules/mindspore_rl/agent/actor.html#Actor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.agent.Actor" title="Permalink to this definition"></a></dt>
<dd><p>Base class for all actors. Actor is a class used to interact with the environment and generate data.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.agent.actor</span> <span class="kn">import</span> <span class="n">Actor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.network</span> <span class="kn">import</span> <span class="n">FullyConnectedNet</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.environment</span> <span class="kn">import</span> <span class="n">GymEnvironment</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">MyActor</span><span class="p">(</span><span class="n">Actor</span><span class="p">):</span>
<span class="gp">... </span>  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">super</span><span class="p">(</span><span class="n">MyActor</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">argmax</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">Argmax</span><span class="p">()</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">actor_net</span> <span class="o">=</span> <span class="n">FullyConnectedNet</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">env</span> <span class="o">=</span> <span class="n">GymEnvironment</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;CartPole-v0&#39;</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_actor</span> <span class="o">=</span> <span class="n">MyActor</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">my_actor</span><span class="p">)</span>
<span class="go">MyActor&lt;</span>
<span class="go">(actor_net): FullyConnectedNet&lt;</span>
<span class="go">(linear1): Dense&lt;input_channels=4, output_channels=10, has_bias=True&gt;</span>
<span class="go">(linear2): Dense&lt;input_channels=10, output_channels=2, has_bias=True&gt;</span>
<span class="go">(relu): ReLU&lt;&gt;</span>
<span class="go">&gt;</span>
<span class="go">(environment): GymEnvironment&lt;&gt;</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.agent.Actor.act">
<span class="sig-name descname"><span class="pre">act</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/agent/actor.html#Actor.act"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.agent.Actor.act" title="Permalink to this definition"></a></dt>
<dd><p>The act function will take an enumerate value and observation or other data which is needed during
calculating the action. It will return a set of output which contains new observation, or other
experience. In this function, agent will interact with environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phase</strong> (<em>enum</em>) – A enumerate value states for init, collect, eval or other user-defined stage.</p></li>
<li><p><strong>params</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em>(</em><em>Tensor</em><em>)</em>) – A tuple of tensor as input, which is used to calculate action</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tuple of tensor as output, which states for experience data.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>observation (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)">tuple</a>(Tensor))</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.agent.Actor.act_init">
<span class="sig-name descname"><span class="pre">act_init</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/agent/actor.html#Actor.act_init"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.agent.Actor.act_init" title="Permalink to this definition"></a></dt>
<dd><p>The interface of the act initialisation function by get the state as input.
User will needd to overload this function according to the algothrim.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>state</strong> (<em>Tensor</em>) – the output state from the environment.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>whether the simulation is finished or not.
- reward (Tensor): simulation reward.
- state (Tensor): simulation state.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>done (Tensor)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.agent.Actor.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/agent/actor.html#Actor.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.agent.Actor.evaluate" title="Permalink to this definition"></a></dt>
<dd><p>The interface of the evaluate function by get the state as input.
User will needd to overload this function according to the algothrim.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>state</strong> (<em>Tensor</em>) – the output state from the environment.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>whether the simulation is finished or not.
- reward (Tensor): simulation reward.
- state (Tensor): simulation state.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>done (Tensor)</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.agent.Actor.get_action">
<span class="sig-name descname"><span class="pre">get_action</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/agent/actor.html#Actor.get_action"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.agent.Actor.get_action" title="Permalink to this definition"></a></dt>
<dd><p>get_action is the method used to obtain the action.
User will need to overload this function according to
the algorithm. But argument of this function should be
phase and params. This interface will not interact with
environment</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phase</strong> (<em>enum</em>) – A enumerate value states for init, collect, eval or other user-defined stage.</p></li>
<li><p><strong>params</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em>(</em><em>Tensor</em><em>)</em>) – A tuple of tensor as input, which is used to calculate action</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tuple of tensor as output, containing actions and other data.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>action (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)">tuple</a>(Tensor))</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.agent.Agent">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.agent.</span></span><span class="sig-name descname"><span class="pre">Agent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">actors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learner</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/agent/agent.html#Agent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.agent.Agent" title="Permalink to this definition"></a></dt>
<dd><p>The base class for the Agent. As the definition of agent, it is composed of actor and leanrner.
It has basic act and learn functions for interaction with environment and update itself.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>actors</strong> (<a class="reference internal" href="#mindspore_rl.agent.Actor" title="mindspore_rl.agent.Actor"><em>Actor</em></a>) – The actor instance.</p></li>
<li><p><strong>learner</strong> (<a class="reference internal" href="#mindspore_rl.agent.Learner" title="mindspore_rl.agent.Learner"><em>Learner</em></a>) – The learner instance.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.agent.learner</span> <span class="kn">import</span> <span class="n">Learner</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.agent.actor</span> <span class="kn">import</span> <span class="n">Actor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.agent.agent</span> <span class="kn">import</span> <span class="n">Agent</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">actors</span> <span class="o">=</span> <span class="n">Actor</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">learner</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">agent</span> <span class="o">=</span> <span class="n">Agent</span><span class="p">(</span><span class="n">actors</span><span class="p">,</span> <span class="n">learner</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">agent</span><span class="p">)</span>
<span class="go">Agent&lt;</span>
<span class="go">(_actors): Actor&lt;&gt;</span>
<span class="go">(_learner): Learner&lt;&gt;</span>
<span class="go">&gt;</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.agent.Agent.act">
<span class="sig-name descname"><span class="pre">act</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/agent/agent.html#Agent.act"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.agent.Agent.act" title="Permalink to this definition"></a></dt>
<dd><p>The act function will take an enumerate value and observation or other data which is needed during
calculating the action. It will return a set of output which contains new observation, or other
experience. In this function, agent will interact with environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phase</strong> (<em>enum</em>) – A enumerate value states for init, collect or eval stage.</p></li>
<li><p><strong>params</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em>(</em><em>Tensor</em><em>)</em>) – A tuple of tensor as input, which is used to calculate action</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tuple of tensor as output, which states for experience</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>observation (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)">tuple</a>(Tensor))</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.agent.Agent.get_action">
<span class="sig-name descname"><span class="pre">get_action</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/agent/agent.html#Agent.get_action"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.agent.Agent.get_action" title="Permalink to this definition"></a></dt>
<dd><p>The get_action function will take an enumerate value and observation or other data which is needed during
calculating the action. It will return a set of outputs containing actions and other data. In this
function, agent will not interact with environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phase</strong> (<em>enum</em>) – A enumerate value states for init, collect or eval stage.</p></li>
<li><p><strong>params</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em>(</em><em>Tensor</em><em>)</em>) – A tuple of tensor as input, which is used to calculate action</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tuple of tensor as output, containing actions and other data.</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>atcion (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)">tuple</a>(Tensor))</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.agent.Agent.learn">
<span class="sig-name descname"><span class="pre">learn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">experience</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/agent/agent.html#Agent.learn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.agent.Agent.learn" title="Permalink to this definition"></a></dt>
<dd><p>The learn function will take a set of experience as input to calculate the loss and update
the weights.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>experience</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em>(</em><em>Tensor</em><em>)</em>) – A tuple of tensor states for experience</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Result which outputs after updating weights</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>results (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)">tuple</a>(Tensor))</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.agent.Learner">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.agent.</span></span><span class="sig-name descname"><span class="pre">Learner</span></span><a class="reference internal" href="_modules/mindspore_rl/agent/learner.html#Learner"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.agent.Learner" title="Permalink to this definition"></a></dt>
<dd><p>The base class of the learner. Calculate and update the self generated network through the input experience.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.agent.learner</span> <span class="kn">import</span> <span class="n">Learner</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.network</span> <span class="kn">import</span> <span class="n">FullyConnectedNet</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">MyLearner</span><span class="p">(</span><span class="n">Learner</span><span class="p">):</span>
<span class="gp">... </span>  <span class="k">def</span> <span class="nf">init</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">super</span><span class="p">(</span><span class="n">MyLearner</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">target_network</span> <span class="o">=</span> <span class="n">FullyConnectedNet</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_learner</span> <span class="o">=</span> <span class="n">MyLearner</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">my_learner</span><span class="p">)</span>
<span class="go">MyLearner&lt;</span>
<span class="go">(target_network): FullyConnectedNet&lt;</span>
<span class="go">(linear1): Dense&lt;input_channels=4, output_channels=10, has_bias=True&gt;</span>
<span class="go">(linear2): Dense&lt;input_channels=10, output_channels=2, has_bias=True&gt;</span>
<span class="go">(relu): ReLU&lt;&gt;</span>
<span class="go">&gt;</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.agent.Learner.learn">
<span class="sig-name descname"><span class="pre">learn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">experience</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/agent/learner.html#Learner.learn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.agent.Learner.learn" title="Permalink to this definition"></a></dt>
<dd><p>The interface for the learn function. The behavior of the <cite>learn</cite> function
depend on the user’s implementation. Usually, it takes the <cite>samples</cite> form
replay buffer or other Tensors, and calculates the loss for updating the networks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>experience</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em>(</em><em>Tensor</em><em>)</em>) – Sampling from the buffer.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Result which outputs after updating weights</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>results (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)">tuple</a>(Tensor))</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.agent.Trainer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.agent.</span></span><span class="sig-name descname"><span class="pre">Trainer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msrl</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/agent/trainer.html#Trainer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.agent.Trainer" title="Permalink to this definition"></a></dt>
<dd><p>The trainer base class. It is a process class that provides the basic mode of training.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Reference to <a class="reference external" href="https://gitee.com/mindspore/docs/blob/master/docs/reinforcement/docs/source_en/dqn.md#defining-the-dqntrainer-class">dqn_trainer.py</a>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>msrl</strong> (<a class="reference internal" href="#mindspore_rl.core.MSRL" title="mindspore_rl.core.MSRL"><em>MSRL</em></a>) – the function handler class.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.agent.Trainer.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/agent/trainer.html#Trainer.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.agent.Trainer.evaluate" title="Permalink to this definition"></a></dt>
<dd><p>The interface of the evaluate function for evaluate in train.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.agent.Trainer.load_and_eval">
<span class="sig-name descname"><span class="pre">load_and_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ckpt_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/agent/trainer.html#Trainer.load_and_eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.agent.Trainer.load_and_eval" title="Permalink to this definition"></a></dt>
<dd><p>The interface of the eval function for offline. A checkpoint must be provided.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ckpt_path</strong> (<em>string</em>) – The checkpoint file to restore net.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.agent.Trainer.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">episodes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callbacks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ckpt_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/agent/trainer.html#Trainer.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.agent.Trainer.train" title="Permalink to this definition"></a></dt>
<dd><p>The train method provides a standard training process, including the whole loop and callbacks.
Users can inherit or overwrite as needed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>episodes</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – the number of training episodes.</p></li>
<li><p><strong>callbacks</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em>[</em><em>Callback</em><em>]</em><em>]</em>) – List of callback objects. Default: None</p></li>
<li><p><strong>ckpt_path</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a><em>]</em>) – The checkpoint file path to init or restore net. Default: None.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.agent.Trainer.train_one_episode">
<span class="sig-name descname"><span class="pre">train_one_episode</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/agent/trainer.html#Trainer.train_one_episode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.agent.Trainer.train_one_episode" title="Permalink to this definition"></a></dt>
<dd><p>The interface of train one episode function in train.
And the output of this function must be constricted as <cite>loss, rewards, steps, [optional]others</cite> in order.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.agent.Trainer.trainable_variables">
<span class="sig-name descname"><span class="pre">trainable_variables</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/agent/trainer.html#Trainer.trainable_variables"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.agent.Trainer.trainable_variables" title="Permalink to this definition"></a></dt>
<dd><p>The variables for saving to checkpoint.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-mindspore_rl.core">
<span id="mindspore-rl-core"></span><h2>mindspore_rl.core<a class="headerlink" href="#module-mindspore_rl.core" title="Permalink to this headline"></a></h2>
<p>Helper components used to implement RL algorithms.</p>
<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.core.MSRL">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.core.</span></span><span class="sig-name descname"><span class="pre">MSRL</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alg_config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deploy_config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/msrl.html#MSRL"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.core.MSRL" title="Permalink to this definition"></a></dt>
<dd><p>The MSRL class provides the function handlers and APIs for reinforcement
learning algorithm development.</p>
<p>It exposes the following function handler to the user. The input and output of
these function handlers are identical to the user defined functions.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">agent_act</span>
<span class="n">agent_get_action</span>
<span class="n">sample_buffer</span>
<span class="n">agent_learn</span>
<span class="n">replay_buffer_sample</span>
<span class="n">replay_buffer_insert</span>
<span class="n">replay_buffer_reset</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>config</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – <p>provides the algorithm configuration.</p>
<ul class="simple">
<li><p>Top level: defines the algorithm components.</p>
<ul>
<li><p>key: ‘actor’,              value: the actor configuration (dict).</p></li>
<li><p>key: ‘learner’,            value: the learner configuration (dict).</p></li>
<li><p>key: ‘policy_and_network’, value: the policy and networks used by
actor and learner (dict).</p></li>
<li><p>key: ‘collect_environment’,     value: the collect environment configuration (dict).</p></li>
<li><p>key: ‘eval_environment’,        value: the eval environment configuration (dict).</p></li>
<li><p>key: ‘replay_buffer’,           value: the replay buffer configuration (dict).</p></li>
</ul>
</li>
<li><p>Second level: the configuration of each algorithm component.</p>
<ul>
<li><p>key: ‘number’,      value: the number of actor/learner (int).</p></li>
<li><p>key: ‘type’,        value: the type of the
actor/learner/policy_and_network/environment (class name).</p></li>
<li><p>key: ‘params’,      value: the parameters of
actor/learner/policy_and_network/environment (dict).</p></li>
<li><p>key: ‘policies’,    value: the list of policies used by the
actor/learner (list).</p></li>
<li><p>key: ‘networks’,    value: the list of networks used by the
actor/learner (list).</p></li>
<li><p>key: ‘pass_environment’, value: True user needs to pass the environment
instance into actor, False otherwise (Bool).</p></li>
</ul>
</li>
</ul>
</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.core.MSRL.get_replay_buffer">
<span class="sig-name descname"><span class="pre">get_replay_buffer</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/msrl.html#MSRL.get_replay_buffer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.core.MSRL.get_replay_buffer" title="Permalink to this definition"></a></dt>
<dd><p>It will return the instance of replay buffer.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Buffers (object), The instance of relay buffer. If the buffer is None, the return
value will be None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.core.MSRL.get_replay_buffer_elements">
<span class="sig-name descname"><span class="pre">get_replay_buffer_elements</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">transpose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/msrl.html#MSRL.get_replay_buffer_elements"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.core.MSRL.get_replay_buffer_elements" title="Permalink to this definition"></a></dt>
<dd><p>It will return all the elements in the replay buffer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>transpose</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – whether the output element needs to be transpose,
if transpose is true, shape will also need to be filled. Default: False</p></li>
<li><p><strong>shape</strong> (<em>Tuple</em><em>[</em><a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>]</em>) – the shape used in transpose. Default: None</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>elements (List[Tensor]), A set of tensor contains all the elements in the replay buffer</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.core.MSRL.init">
<span class="sig-name descname"><span class="pre">init</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/msrl.html#MSRL.init"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.core.MSRL.init" title="Permalink to this definition"></a></dt>
<dd><p>Initialization of MSRL object.
The function creates all the data/objects that the algorithm requires.
It also initializes all the function handler.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>config</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – algorithm configuration file.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.core.PriorityReplayBuffer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.core.</span></span><span class="sig-name descname"><span class="pre">PriorityReplayBuffer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">beta</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">capacity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shapes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtypes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/priority_replay_buffer.html#PriorityReplayBuffer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.core.PriorityReplayBuffer" title="Permalink to this definition"></a></dt>
<dd><p>PriorityReplayBuffer is experience container used in Deep Q-Networks.
The algorithm is proposed in <cite>Prioritized Experience Replay &lt;https://arxiv.org/abs/1511.05952&gt;</cite>.
Same as the normal replay buffer, it lets the reinforcement learning agents remember and reuse experiences from the
past. Besides, it replays important transitions more frequently and improve sample effciency.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>alpha</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – parameter to control degree of prioritization.
0 means the uniform sampling, 1 means priority sampling.</p></li>
<li><p><strong>beta</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – parameter to control degree of sampling correction.
0 means the no correction, 1 means full correction.</p></li>
<li><p><strong>capacity</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – the capacity of the buffer.</p></li>
<li><p><strong>sample_size</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – size for sampling from the buffer.</p></li>
<li><p><strong>shapes</strong> (<em>List</em><em>[</em><a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>]</em>) – the shape of each tensor in a buffer element.</p></li>
<li><p><strong>types</strong> (<em>List</em><em>[</em><em>mindspore.dtype</em><em>]</em>) – the data type of each tensor in a buffer element.</p></li>
<li><p><strong>seed0</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Seed0 value for random generating. Default: 0.</p></li>
<li><p><strong>seed1</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Seed1 value for random generating. Default: 0.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mindspore</span> <span class="k">as</span> <span class="nn">ms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore</span> <span class="kn">import</span> <span class="n">Tensor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.core.priority_replay_buffer</span> <span class="kn">import</span> <span class="n">PriorityReplayBuffer</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">capacity</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">batch_size</span> <span class="o">=</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span> <span class="o">=</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">1.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shapes</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">4</span><span class="p">,),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dtypes</span> <span class="o">=</span> <span class="p">[</span><span class="n">ms</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">ms</span><span class="o">.</span><span class="n">int32</span><span class="p">,</span> <span class="n">ms</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">ms</span><span class="o">.</span><span class="n">float32</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">replaybuffer</span> <span class="o">=</span> <span class="n">PriorityReplayBuffer</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">beta</span><span class="p">,</span> <span class="n">capacity</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">,</span> <span class="n">shapes</span><span class="p">,</span> <span class="n">dtypes</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">replaybuffer</span><span class="p">)</span>
<span class="go">PriorityReplayBuffer&lt;&gt;</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.core.PriorityReplayBuffer.destroy">
<span class="sig-name descname"><span class="pre">destroy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/priority_replay_buffer.html#PriorityReplayBuffer.destroy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.core.PriorityReplayBuffer.destroy" title="Permalink to this definition"></a></dt>
<dd><p>Destroy the replay buffer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>handle</strong> (<em>Tensor</em>) – Priority replay buffer instance handle with dtype int64 and shape (1,).</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Priority replay buffer instance handle with dtype int64 and shape (1,).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.core.PriorityReplayBuffer.push">
<span class="sig-name descname"><span class="pre">push</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">transition</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/priority_replay_buffer.html#PriorityReplayBuffer.push"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.core.PriorityReplayBuffer.push" title="Permalink to this definition"></a></dt>
<dd><p>Push a transition to the buffer. If the buffer is full, the oldest one will be removed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>transition</strong> (<em>List</em><em>[</em><em>Tensor</em><em>]</em>) – insert a list of tensor which matches with the initialized shapes
and dtypes into the buffer.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>handle(Tensor), Priority replay buffer instance handle with dtype int64 and shape (1,).</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.core.PriorityReplayBuffer.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/priority_replay_buffer.html#PriorityReplayBuffer.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.core.PriorityReplayBuffer.sample" title="Permalink to this definition"></a></dt>
<dd><p>Samples a batch of transitions from the replay buffer.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>indices (Tensor), the transition indices in the replay buffer.
weights (Tensor), the weight used to correct for sampling bias.
transitions (tuple(Tensor)), transitions with variable-length tensors.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.core.PriorityReplayBuffer.update_priorities">
<span class="sig-name descname"><span class="pre">update_priorities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">priorities</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/priority_replay_buffer.html#PriorityReplayBuffer.update_priorities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.core.PriorityReplayBuffer.update_priorities" title="Permalink to this definition"></a></dt>
<dd><p>Update transition prorities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>indices</strong> (<em>Tensor</em>) – </p></li>
<li><p><strong>priorities</strong> (<em>Tensor</em>) – </p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>tuple(Tensor), Transition with its indices and correction weights.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.core.ReplayBuffer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.core.</span></span><span class="sig-name descname"><span class="pre">ReplayBuffer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">batch_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">capacity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shapes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">types</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/replay_buffer.html#ReplayBuffer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.core.ReplayBuffer" title="Permalink to this definition"></a></dt>
<dd><p>The replay buffer class.
The replay buffer will store the experience from environment. In replay
buffer, each element is a list of tensors. Therefore, the constructor of the
ReplayBuffer class takes the shape and type of each tensor as an argument.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>batch_size</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – size for sampling from the buffer.</p></li>
<li><p><strong>capacity</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – the capacity of the buffer.</p></li>
<li><p><strong>shapes</strong> (<em>List</em><em>[</em><a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>]</em>) – the shape of each tensor in a buffer element.</p></li>
<li><p><strong>types</strong> (<em>List</em><em>[</em><em>mindspore.dtype</em><em>]</em>) – the data type of each tensor in a buffer element.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">batch_size</span> <span class="o">=</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">capacity</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shapes</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">4</span><span class="p">,),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">types</span> <span class="o">=</span> <span class="p">[</span><span class="n">ms</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">ms</span><span class="o">.</span><span class="n">int32</span><span class="p">,</span> <span class="n">ms</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">ms</span><span class="o">.</span><span class="n">float32</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">replaybuffer</span> <span class="o">=</span> <span class="n">ReplayBuffer</span><span class="p">(</span><span class="n">batch_size</span><span class="p">,</span> <span class="n">capacity</span><span class="p">,</span> <span class="n">shapes</span><span class="p">,</span> <span class="n">types</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">replaybuffer</span><span class="p">)</span>
<span class="go">ReplayBuffer&lt;&gt;</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.core.ReplayBuffer.full">
<span class="sig-name descname"><span class="pre">full</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/replay_buffer.html#ReplayBuffer.full"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.core.ReplayBuffer.full" title="Permalink to this definition"></a></dt>
<dd><p>Check if the replaybuffer is full or not.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>True if the replaybuffer is full, False otherwise.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.core.ReplayBuffer.get_item">
<span class="sig-name descname"><span class="pre">get_item</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/replay_buffer.html#ReplayBuffer.get_item"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.core.ReplayBuffer.get_item" title="Permalink to this definition"></a></dt>
<dd><p>Get an element from the replaybuffer in specific position(index).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>index</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – the location of the item.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>element (List[Tensor]), the element from the buffer.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.core.ReplayBuffer.insert">
<span class="sig-name descname"><span class="pre">insert</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exp</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/replay_buffer.html#ReplayBuffer.insert"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.core.ReplayBuffer.insert" title="Permalink to this definition"></a></dt>
<dd><p>Insert an element to the buffer. If the buffer is full, FIFO strategy will be used to
replace the element in the buffer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>exp</strong> (<em>List</em><em>[</em><em>Tensor</em><em>]</em>) – insert a list of tensor which matches with the initialized shape
and type into the buffer.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>element (List[Tensor]), return the whole buffer after insertion</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.core.ReplayBuffer.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/replay_buffer.html#ReplayBuffer.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.core.ReplayBuffer.reset" title="Permalink to this definition"></a></dt>
<dd><p>Reset the replaybuffer. It changes the value of self.count to zero.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>success (boolean), whether the reset successful or not.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.core.ReplayBuffer.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/replay_buffer.html#ReplayBuffer.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.core.ReplayBuffer.sample" title="Permalink to this definition"></a></dt>
<dd><p>Sampling the replaybuffer, which means that it will randomly choose a set of element
and output them.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A set of sampled elements from the buffer.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.core.ReplayBuffer.size">
<span class="sig-name descname"><span class="pre">size</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/replay_buffer.html#ReplayBuffer.size"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.core.ReplayBuffer.size" title="Permalink to this definition"></a></dt>
<dd><p>Return the size of the replybuffer.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>size (int), the number of element in the replaybuffer.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.core.Session">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.core.</span></span><span class="sig-name descname"><span class="pre">Session</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alg_config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deploy_config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/session.html#Session"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.core.Session" title="Permalink to this definition"></a></dt>
<dd><p>The Session is a class for running MindSpore RL algorithms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>alg_config</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – the algorithm configuration or the deployment configuration of the algorithm.</p></li>
<li><p><strong>deploy_config</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – the deployment configuration for distribution. Default: None.
For more details of configuration of algorithm, please have a look at
<a class="reference external" href="https://www.mindspore.cn/reinforcement/docs/zh-CN/master/custom_config_info.html">https://www.mindspore.cn/reinforcement/docs/zh-CN/master/custom_config_info.html</a></p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.core.Session.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">class_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_train</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">episode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callbacks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/session.html#Session.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.core.Session.run" title="Permalink to this definition"></a></dt>
<dd><p>Execute the reinforcement learning algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>class_type</strong> (<a class="reference internal" href="#mindspore_rl.agent.Trainer" title="mindspore_rl.agent.Trainer"><em>Trainer</em></a>) – The class type of the algorithm’s trainer class. Default: None.</p></li>
<li><p><strong>is_train</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Run the algorithm in train mode or eval mode. Default: True</p></li>
<li><p><strong>episode</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The number of episode of the training. Default: 0.</p></li>
<li><p><strong>duration</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The number of duration of the training. Default: 0.</p></li>
<li><p><strong>params</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – The algorithm specific training parameters. Default: None.</p></li>
<li><p><strong>callbacks</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em>[</em><em>Callback</em><em>]</em>) – The callback list. Default: None.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-mindspore_rl.environment">
<span id="mindspore-rl-environment"></span><h2>mindspore_rl.environment<a class="headerlink" href="#module-mindspore_rl.environment" title="Permalink to this headline"></a></h2>
<p>Component used to implement custom environments.</p>
<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.environment.Environment">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.environment.</span></span><span class="sig-name descname"><span class="pre">Environment</span></span><a class="reference internal" href="_modules/mindspore_rl/environment/environment.html#Environment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.Environment" title="Permalink to this definition"></a></dt>
<dd><p>The virtual base class for the environment. This class should be overridden before calling in the model.</p>
<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.Environment.action_space">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">action_space</span></span><a class="headerlink" href="#mindspore_rl.environment.Environment.action_space" title="Permalink to this definition"></a></dt>
<dd><p>Get the action space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The action space of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.Environment.config">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">config</span></span><a class="headerlink" href="#mindspore_rl.environment.Environment.config" title="Permalink to this definition"></a></dt>
<dd><p>Get the config of environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A dictionary which contains environment’s info.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.Environment.done_space">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">done_space</span></span><a class="headerlink" href="#mindspore_rl.environment.Environment.done_space" title="Permalink to this definition"></a></dt>
<dd><p>Get the done space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The done space of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.Environment.observation_space">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">observation_space</span></span><a class="headerlink" href="#mindspore_rl.environment.Environment.observation_space" title="Permalink to this definition"></a></dt>
<dd><p>Get the state space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The state space of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.environment.Environment.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/environment.html#Environment.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.Environment.reset" title="Permalink to this definition"></a></dt>
<dd><p>Reset the environment to the initial state. It is always used at the beginning of each
episode. It will return the value of initial state or other initial information.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tensor which states for the initial state of environment or a tuple contains
initial information, such as new state, action, reward, etc.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.Environment.reward_space">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">reward_space</span></span><a class="headerlink" href="#mindspore_rl.environment.Environment.reward_space" title="Permalink to this definition"></a></dt>
<dd><p>Get the reward space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The reward space of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.environment.Environment.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/environment.html#Environment.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.Environment.step" title="Permalink to this definition"></a></dt>
<dd><p>Execute the environment step, which means that interact with environment once.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>action</strong> (<em>Tensor</em>) – A tensor that contains the action information.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tuple of Tensor which contains information after interacting with environment.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.environment.EnvironmentProcess">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.environment.</span></span><span class="sig-name descname"><span class="pre">EnvironmentProcess</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">proc_no</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_num</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">envs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">actions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_states</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/env_process.html#EnvironmentProcess"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.EnvironmentProcess" title="Permalink to this definition"></a></dt>
<dd><p>An independent process responsible for creating and interacting with one or more environments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>proc_no</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The process number assigned by the caller.</p></li>
<li><p><strong>env_num</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The number of input environments.</p></li>
<li><p><strong>envs</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em>(</em><a class="reference internal" href="#mindspore_rl.environment.Environment" title="mindspore_rl.environment.Environment"><em>Environment</em></a><em>)</em>) – A list that contains instance of environment (subclass of Environment).</p></li>
<li><p><strong>actions</strong> (<em>Queue</em>) – The queue used to pass actions to the environment process.</p></li>
<li><p><strong>observations</strong> (<em>Queue</em>) – The queue used to pass observations to the caller process.</p></li>
<li><p><strong>initial_states</strong> (<em>Queue</em>) – The queue used to pass initial states to the caller process.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">multiprocessing</span> <span class="kn">import</span> <span class="n">Queue</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">actions</span> <span class="o">=</span> <span class="n">Queue</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">observations</span> <span class="o">=</span> <span class="n">Queue</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">initial_states</span> <span class="o">=</span> <span class="n">Queue</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">proc_no</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">env_num</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">env_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;CartPole-v0&#39;</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">multi_env</span> <span class="o">=</span> <span class="p">[</span><span class="n">GymEnvironment</span><span class="p">(</span><span class="n">env_params</span><span class="p">),</span> <span class="n">GymEnvironment</span><span class="p">(</span><span class="n">env_params</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">env_proc</span> <span class="o">=</span> <span class="n">EnvironmentProcess</span><span class="p">(</span><span class="n">proc_no</span><span class="p">,</span> <span class="n">env_num</span><span class="p">,</span> <span class="n">multi_env</span><span class="p">,</span> <span class="n">actions</span><span class="p">,</span> <span class="n">observations</span><span class="p">,</span> <span class="n">initial_states</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">env_proc</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.environment.EnvironmentProcess.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/env_process.html#EnvironmentProcess.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.EnvironmentProcess.run" title="Permalink to this definition"></a></dt>
<dd><p>Method to be run in sub-process; can be overridden in sub-class</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.environment.GymEnvironment">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.environment.</span></span><span class="sig-name descname"><span class="pre">GymEnvironment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/gym_environment.html#GymEnvironment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.GymEnvironment" title="Permalink to this definition"></a></dt>
<dd><p>The GymEnvironment class is a wrapper that encapsulates the Gym(<a class="reference external" href="https://gym.openai.com/">https://gym.openai.com/</a>) to
provide the ability to interact with Gym environments in MindSpore Graph Mode.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – <p>A dictionary contains all the parameters which are used in this class.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 52%" />
<col style="width: 48%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Configuration Parameters</p></th>
<th class="head"><p>Notices</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>name</p></td>
<td><p>the name of game in Gym</p></td>
</tr>
<tr class="row-odd"><td><p>seed</p></td>
<td><p>seed used in Gym</p></td>
</tr>
</tbody>
</table>
</p></li>
<li><p><strong>env_id</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – A integer which is used to set the seed of this environment.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Supported Platforms:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">Ascend</span></code> <code class="docutils literal notranslate"><span class="pre">GPU</span></code> <code class="docutils literal notranslate"><span class="pre">CPU</span></code></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">env_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;CartPole-v0&#39;</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">environment</span> <span class="o">=</span> <span class="n">GymEnvironment</span><span class="p">(</span><span class="n">env_params</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">environment</span><span class="p">)</span>
<span class="go">GymEnvironment&lt;&gt;</span>
</pre></div>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.GymEnvironment.action_space">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">action_space</span></span><a class="headerlink" href="#mindspore_rl.environment.GymEnvironment.action_space" title="Permalink to this definition"></a></dt>
<dd><p>Get the action space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The action space of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.GymEnvironment.config">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">config</span></span><a class="headerlink" href="#mindspore_rl.environment.GymEnvironment.config" title="Permalink to this definition"></a></dt>
<dd><p>Get the config of environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A dictionary which contains environment’s info.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.GymEnvironment.done_space">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">done_space</span></span><a class="headerlink" href="#mindspore_rl.environment.GymEnvironment.done_space" title="Permalink to this definition"></a></dt>
<dd><p>Get the done space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The done space of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.GymEnvironment.observation_space">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">observation_space</span></span><a class="headerlink" href="#mindspore_rl.environment.GymEnvironment.observation_space" title="Permalink to this definition"></a></dt>
<dd><p>Get the state space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The state space of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.environment.GymEnvironment.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/gym_environment.html#GymEnvironment.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.GymEnvironment.reset" title="Permalink to this definition"></a></dt>
<dd><p>Reset the environment to the initial state. It is always used at the beginning of each
episode. It will return the value of initial state.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tensor which states for the initial state of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.GymEnvironment.reward_space">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">reward_space</span></span><a class="headerlink" href="#mindspore_rl.environment.GymEnvironment.reward_space" title="Permalink to this definition"></a></dt>
<dd><p>Get the reward space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The reward space of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.environment.GymEnvironment.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/gym_environment.html#GymEnvironment.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.GymEnvironment.step" title="Permalink to this definition"></a></dt>
<dd><p>Execute the environment step, which means that interact with environment once.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>action</strong> (<em>Tensor</em>) – A tensor that contains the action information.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>state (Tensor), the environment state after performing the action.</p></li>
<li><p>reward (Tensor), the reward after performing the action.</p></li>
<li><p>done (Tensor), whether the simulation finishes or not.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.environment.MsEnvironment">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.environment.</span></span><span class="sig-name descname"><span class="pre">MsEnvironment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/ms_environment.html#MsEnvironment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.MsEnvironment" title="Permalink to this definition"></a></dt>
<dd><p>Class encapsulates built-in environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kwargs</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – <p>The dictionary of environment specific configurations. See below table for details:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 21%" />
<col style="width: 31%" />
<col style="width: 19%" />
<col style="width: 29%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Environment name</p></th>
<th class="head"><p>Configuration Parameters</p></th>
<th class="head"><p>Default value</p></th>
<th class="head"><p>Notices</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td rowspan="10"><p>Tag</p></td>
<td><p>seed</p></td>
<td><p>42</p></td>
<td><p>random seed</p></td>
</tr>
<tr class="row-odd"><td><p>environment_num</p></td>
<td><p>2</p></td>
<td><p>number of environments</p></td>
</tr>
<tr class="row-even"><td><p>predator_num</p></td>
<td><p>10</p></td>
<td><p>number of predators</p></td>
</tr>
<tr class="row-odd"><td><p>max_timestep</p></td>
<td><p>100</p></td>
<td><p>max timestep per episode</p></td>
</tr>
<tr class="row-even"><td><p>map_length</p></td>
<td><p>100</p></td>
<td><p>length of map</p></td>
</tr>
<tr class="row-odd"><td><p>map_width</p></td>
<td><p>100</p></td>
<td><p>width of map</p></td>
</tr>
<tr class="row-even"><td><p>wall_hit_penalty</p></td>
<td><p>0.1</p></td>
<td><p>agent wall hit penalty</p></td>
</tr>
<tr class="row-odd"><td><p>catch_reward</p></td>
<td><p>10</p></td>
<td><p>predator catch reward</p></td>
</tr>
<tr class="row-even"><td><p>caught_penalty</p></td>
<td><p>5</p></td>
<td><p>prey caught penalty</p></td>
</tr>
<tr class="row-odd"><td><p>step_cost</p></td>
<td><p>0.01</p></td>
<td><p>step cost</p></td>
</tr>
</tbody>
</table>
</p>
</dd>
</dl>
<dl class="simple">
<dt>Supported Platforms:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">GPU</span></code></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">config</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Tag&#39;</span><span class="p">,</span> <span class="s1">&#39;predator_num&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">env</span> <span class="o">=</span> <span class="n">MsEnvironment</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">observation</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">action</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">action_space</span><span class="o">.</span><span class="n">sample</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">observation</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">done</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">observation</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(2, 5, 21)</span>
</pre></div>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.MsEnvironment.action_space">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">action_space</span></span><a class="headerlink" href="#mindspore_rl.environment.MsEnvironment.action_space" title="Permalink to this definition"></a></dt>
<dd><p>Get the valid action space of the environment.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.MsEnvironment.config">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">config</span></span><a class="headerlink" href="#mindspore_rl.environment.MsEnvironment.config" title="Permalink to this definition"></a></dt>
<dd><p>Get environment configuration.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.MsEnvironment.done_space">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">done_space</span></span><a class="headerlink" href="#mindspore_rl.environment.MsEnvironment.done_space" title="Permalink to this definition"></a></dt>
<dd><p>Get the valid done space of the environment.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.MsEnvironment.observation_space">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">observation_space</span></span><a class="headerlink" href="#mindspore_rl.environment.MsEnvironment.observation_space" title="Permalink to this definition"></a></dt>
<dd><p>Get the valid observation space of the environment.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.environment.MsEnvironment.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/ms_environment.html#MsEnvironment.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.MsEnvironment.reset" title="Permalink to this definition"></a></dt>
<dd><p>Reset the environment to initial observation and return the initial observation.</p>
<dl class="simple">
<dt>Inputs:</dt><dd><p>No inputs.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Tensor, the initial observation.</p>
</dd>
</dl>
<dl class="simple">
<dt>Supported Platforms:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">GPU</span></code></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">config</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Tag&#39;</span><span class="p">,</span> <span class="s1">&#39;predator_num&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">env</span> <span class="o">=</span> <span class="n">MsEnvironment</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">observation</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">observation</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(2, 5, 21)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.MsEnvironment.reward_space">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">reward_space</span></span><a class="headerlink" href="#mindspore_rl.environment.MsEnvironment.reward_space" title="Permalink to this definition"></a></dt>
<dd><p>Get the valid reward space of the environment.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.environment.MsEnvironment.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/ms_environment.html#MsEnvironment.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.MsEnvironment.step" title="Permalink to this definition"></a></dt>
<dd><p>Run one timestep of environment to interact with environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>action</strong> (<em>Tensor</em>) – Action provided by the all of agents.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>Tuple of 3 tensors, the observation, the reward and the done.</p>
<ul class="simple">
<li><p><strong>observation</strong> (Tensor) - Observations of all agents after action.</p></li>
<li><p><strong>reward</strong> (Tensor) - Amount of reward returned by the environment.</p></li>
<li><p><strong>done</strong> (Tensor) - Whether the episode has ended.</p></li>
</ul>
</p>
</dd>
</dl>
<dl class="simple">
<dt>Supported Platforms:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">GPU</span></code></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">config</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Tag&#39;</span><span class="p">,</span> <span class="s1">&#39;predator_num&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">env</span> <span class="o">=</span> <span class="n">MsEnvironment</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">observation</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">action</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">action_space</span><span class="o">.</span><span class="n">sample</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">observation</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">done</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">observation</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(2, 5, 21)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.environment.MultiEnvironmentWrapper">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.environment.</span></span><span class="sig-name descname"><span class="pre">MultiEnvironmentWrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_instance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_proc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/multi_environment_wrapper.html#MultiEnvironmentWrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.MultiEnvironmentWrapper" title="Permalink to this definition"></a></dt>
<dd><p>The MultiEnvironmentWrapper is a wrapper for multi environment scenario. User implements
their single environment class and set the environment number larger than 1 in configuration
file, framework will automatically invoke this class to create a multi environment class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env_instance</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em>(</em><em>Class</em><em>)</em>) – A list that contains instance of environment (subclass of Environment).</p></li>
<li><p><strong>num_proc</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Number of processing uses during interacting with environment. Default: None.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Supported Plantforms:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">Ascend</span></code> <code class="docutils literal notranslate"><span class="pre">GPU</span></code> <code class="docutils literal notranslate"><span class="pre">CPU</span></code></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">env_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;CartPole-v0&#39;</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">multi_env</span> <span class="o">=</span> <span class="p">[</span><span class="n">GymEnvironment</span><span class="p">(</span><span class="n">env_params</span><span class="p">),</span> <span class="n">GymEnvironment</span><span class="p">(</span><span class="n">env_params</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wrapper</span> <span class="o">=</span> <span class="n">MultiEnvironmentWrapper</span><span class="p">(</span><span class="n">multi_env</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">wrapper</span><span class="p">)</span>
<span class="go">MultiEnvironmentWrapper&lt;&gt;</span>
</pre></div>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.MultiEnvironmentWrapper.action_space">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">action_space</span></span><a class="headerlink" href="#mindspore_rl.environment.MultiEnvironmentWrapper.action_space" title="Permalink to this definition"></a></dt>
<dd><p>Get the action space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tuple which states for the space of action.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.MultiEnvironmentWrapper.config">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">config</span></span><a class="headerlink" href="#mindspore_rl.environment.MultiEnvironmentWrapper.config" title="Permalink to this definition"></a></dt>
<dd><p>Get the config of environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A dictionary which contains environment’s info.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.MultiEnvironmentWrapper.done_space">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">done_space</span></span><a class="headerlink" href="#mindspore_rl.environment.MultiEnvironmentWrapper.done_space" title="Permalink to this definition"></a></dt>
<dd><p>Get the done space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tuple which states for the space of done.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.MultiEnvironmentWrapper.observation_space">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">observation_space</span></span><a class="headerlink" href="#mindspore_rl.environment.MultiEnvironmentWrapper.observation_space" title="Permalink to this definition"></a></dt>
<dd><p>Get the state space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tuple which states for the space of state.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.environment.MultiEnvironmentWrapper.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/multi_environment_wrapper.html#MultiEnvironmentWrapper.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.MultiEnvironmentWrapper.reset" title="Permalink to this definition"></a></dt>
<dd><p>Reset the environment to the initial state. It is always used at the beginning of each
episode. It will return the value of initial state of each environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A list of tensor which states for all the initial states of each environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.MultiEnvironmentWrapper.reward_space">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">reward_space</span></span><a class="headerlink" href="#mindspore_rl.environment.MultiEnvironmentWrapper.reward_space" title="Permalink to this definition"></a></dt>
<dd><p>Get the reward space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tuple which states for the space of reward.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.environment.MultiEnvironmentWrapper.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/multi_environment_wrapper.html#MultiEnvironmentWrapper.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.MultiEnvironmentWrapper.step" title="Permalink to this definition"></a></dt>
<dd><p>Execute the environment step, which means that interact with environment once.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>action</strong> (<em>Tensor</em>) – A tensor that contains the action information.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>state (list(Tensor)), a list of environment state after performing the action.</p></li>
<li><p>reward (list(Tensor)), a list of reward after performing the action.</p></li>
<li><p>done (list(Tensor)), whether the simulations of each environment finishes or not.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.environment.Space">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.environment.</span></span><span class="sig-name descname"><span class="pre">Space</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feature_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">low</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">high</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/space.html#Space"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.Space" title="Permalink to this definition"></a></dt>
<dd><p>The class for environment action/observation space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>feature_shape</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em>(</em><a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>)</em><em>, </em><a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em>(</em><a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>)</em><em>, </em><a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>]</em>) – The action/observation shape before batching.</p></li>
<li><p><strong>dtype</strong> (<em>np.dtype</em>) – The action/observation space dtype.</p></li>
<li><p><strong>low</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a><em>, </em><em>optional</em>) – The action/observation space lower boundary.</p></li>
<li><p><strong>high</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a><em>, </em><em>optional</em>) – The action/observation space upper boundary.</p></li>
<li><p><strong>batch_shape</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em>(</em><a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>)</em><em>, </em><a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em>(</em><a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>)</em><em>, </em><a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>]</em><em>, </em><em>optional</em>) – The batch shape for vectorization.
It usually be used in multi-environment and multi-agent cases.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">action_space</span> <span class="o">=</span> <span class="n">Space</span><span class="p">(</span><span class="n">feature_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">action_space</span><span class="o">.</span><span class="n">ms_dtype</span><span class="p">)</span>
<span class="go">Int32</span>
</pre></div>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.Space.boundary">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">boundary</span></span><a class="headerlink" href="#mindspore_rl.environment.Space.boundary" title="Permalink to this definition"></a></dt>
<dd><p>The space boundary of current Space.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.Space.is_discrete">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_discrete</span></span><a class="headerlink" href="#mindspore_rl.environment.Space.is_discrete" title="Permalink to this definition"></a></dt>
<dd><p>Is discrete space.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.Space.ms_dtype">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ms_dtype</span></span><a class="headerlink" href="#mindspore_rl.environment.Space.ms_dtype" title="Permalink to this definition"></a></dt>
<dd><p>MindSpore data type or current Space.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.Space.np_dtype">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">np_dtype</span></span><a class="headerlink" href="#mindspore_rl.environment.Space.np_dtype" title="Permalink to this definition"></a></dt>
<dd><p>Numpy data type of current Space.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.Space.num_values">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_values</span></span><a class="headerlink" href="#mindspore_rl.environment.Space.num_values" title="Permalink to this definition"></a></dt>
<dd><p>available action number of current Space.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.environment.Space.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/space.html#Space.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.Space.sample" title="Permalink to this definition"></a></dt>
<dd><p>Sample a valid action from the space</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Tensor, a valid action.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.Space.shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">shape</span></span><a class="headerlink" href="#mindspore_rl.environment.Space.shape" title="Permalink to this definition"></a></dt>
<dd><p>Space shape after batching.</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.environment.StarCraft2Environment">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.environment.</span></span><span class="sig-name descname"><span class="pre">StarCraft2Environment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/sc2_environment.html#StarCraft2Environment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.StarCraft2Environment" title="Permalink to this definition"></a></dt>
<dd><p>StarCraft2Environment is a wrapper of SMAC. SMAC is WhiRL’s environment for research in the
field of collaborative multi-agent reinforcement learning (MARL) based on Blizzard’s
StarCraft II RTS game. SMAC makes use of Blizzard’s StarCraft II Machine Learning API and
DeepMind’s PySC2 to provide a convenient interface for autonomous agents to interact with
StarCraft II, getting observations and performing actions. Unlike the PySC2, SMAC concentrates
on decentralised micromanagement scenarios, where each unit of the game is controlled by an
individual RL agent. More detail please have a look at the official github of SMAC:
<a class="reference external" href="https://github.com/oxwhirl/smac">https://github.com/oxwhirl/smac</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – <p>A dictionary contains all the parameters which are used in this class.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 35%" />
<col style="width: 65%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Configuration Parameters</p></th>
<th class="head"><p>Notices</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>sc2_args</p></td>
<td><p>a dict which contains key value that is used to create
instance of SMAC, such as map_name. For more detail
please have a look at its official github.</p></td>
</tr>
</tbody>
</table>
</p></li>
<li><p><strong>env_id</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – A integer which is used to set the seed of this environment.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Supported Platforms:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">Ascend</span></code> <code class="docutils literal notranslate"><span class="pre">GPU</span></code> <code class="docutils literal notranslate"><span class="pre">CPU</span></code></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">env_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;sc2_args&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;map_name&#39;</span><span class="p">:</span> <span class="s1">&#39;2s3z&#39;</span><span class="p">}}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">environment</span> <span class="o">=</span> <span class="n">StarCraft2Environment</span><span class="p">(</span><span class="n">env_params</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">environment</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.StarCraft2Environment.action_space">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">action_space</span></span><a class="headerlink" href="#mindspore_rl.environment.StarCraft2Environment.action_space" title="Permalink to this definition"></a></dt>
<dd><p>Get the action space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tuple which states for the space of observation.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.StarCraft2Environment.config">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">config</span></span><a class="headerlink" href="#mindspore_rl.environment.StarCraft2Environment.config" title="Permalink to this definition"></a></dt>
<dd><p>Get the config of environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A dictionary which contains environment’s info.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.StarCraft2Environment.done_space">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">done_space</span></span><a class="headerlink" href="#mindspore_rl.environment.StarCraft2Environment.done_space" title="Permalink to this definition"></a></dt>
<dd><p>Get the done space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The done space of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.environment.StarCraft2Environment.get_step_info">
<span class="sig-name descname"><span class="pre">get_step_info</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/sc2_environment.html#StarCraft2Environment.get_step_info"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.StarCraft2Environment.get_step_info" title="Permalink to this definition"></a></dt>
<dd><p>Get the information after interacting with environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>battle_won, whether this game is won or not.</p></li>
<li><p>dead_allies, how many allies are dead.</p></li>
<li><p>dead_enemies, how many enemies are dead.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.StarCraft2Environment.observation_space">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">observation_space</span></span><a class="headerlink" href="#mindspore_rl.environment.StarCraft2Environment.observation_space" title="Permalink to this definition"></a></dt>
<dd><p>Get the state space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tuple which states for the space of state.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.environment.StarCraft2Environment.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/sc2_environment.html#StarCraft2Environment.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.StarCraft2Environment.reset" title="Permalink to this definition"></a></dt>
<dd><p>Reset the environment to the initial state. It is always used at the beginning of each
episode. It will return the value of initial state, the global observation and
an new available action.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tuple of Tensor contains initial state, global observation and available actions.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.StarCraft2Environment.reward_space">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">reward_space</span></span><a class="headerlink" href="#mindspore_rl.environment.StarCraft2Environment.reward_space" title="Permalink to this definition"></a></dt>
<dd><p>Get the reward space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The reward space of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.environment.StarCraft2Environment.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/sc2_environment.html#StarCraft2Environment.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.StarCraft2Environment.step" title="Permalink to this definition"></a></dt>
<dd><p>Execute the environment step, which means that interact with environment once.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>action</strong> (<em>Tensor</em>) – A tensor that contains the action information.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>state (Tensor), the environment state after performing the action.</p></li>
<li><p>reward (Tensor), the reward after performing the action.</p></li>
<li><p>done (mindspore.bool_), whether the simulation finishes or not.</p></li>
<li><p>global_obs, the global observation of this environment.</p></li>
<li><p>avail_actions, the available actions in this state.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.environment.TicTacToeEnvironment">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.environment.</span></span><span class="sig-name descname"><span class="pre">TicTacToeEnvironment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/tic_tac_toe_environment.html#TicTacToeEnvironment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.TicTacToeEnvironment" title="Permalink to this definition"></a></dt>
<dd><p>Tic-Tac-Toe is a famous paper-and-pencil game (en.wikipedia.org/wiki/Tic-tac-toe). The rule is that two players
draw Os or Xs in a three-by-tree grid. When three of their marks are in a Horizontal, vertical or diagonal row,
that player will be the winner. The following figure is an example of Tic-Tac-Toe.</p>
<blockquote>
<div><table class="docutils align-default">
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>o</p></td>
<td></td>
<td><p>x</p></td>
</tr>
<tr class="row-even"><td><p>x</p></td>
<td><p>o</p></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>x</p></td>
<td><p>o</p></td>
</tr>
</tbody>
</table>
</div></blockquote>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – A dictionary contains all the parameters which are used in this class.</p></li>
<li><p><strong>env_id</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – A integer which is used to set the seed of this environment.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Supported Platforms:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">Ascend</span></code> <code class="docutils literal notranslate"><span class="pre">GPU</span></code> <code class="docutils literal notranslate"><span class="pre">CPU</span></code></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">env_params</span> <span class="o">=</span> <span class="p">{}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">environment</span> <span class="o">=</span> <span class="n">TicTacToeEnvironment</span><span class="p">(</span><span class="n">env_params</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">environment</span><span class="p">)</span>
<span class="go">TicTacToeEnvironment&lt;&gt;</span>
</pre></div>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.TicTacToeEnvironment.action_space">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">action_space</span></span><a class="headerlink" href="#mindspore_rl.environment.TicTacToeEnvironment.action_space" title="Permalink to this definition"></a></dt>
<dd><p>Get the action space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The action space of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.environment.TicTacToeEnvironment.calculate_rewards">
<span class="sig-name descname"><span class="pre">calculate_rewards</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/tic_tac_toe_environment.html#TicTacToeEnvironment.calculate_rewards"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.TicTacToeEnvironment.calculate_rewards" title="Permalink to this definition"></a></dt>
<dd><p>Return the rewards of current state.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tensor which states for the rewards of current state.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.TicTacToeEnvironment.config">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">config</span></span><a class="headerlink" href="#mindspore_rl.environment.TicTacToeEnvironment.config" title="Permalink to this definition"></a></dt>
<dd><p>Get the config of environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A dictionary which contains environment’s info.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.environment.TicTacToeEnvironment.current_player">
<span class="sig-name descname"><span class="pre">current_player</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/tic_tac_toe_environment.html#TicTacToeEnvironment.current_player"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.TicTacToeEnvironment.current_player" title="Permalink to this definition"></a></dt>
<dd><p>Return the current player of current state.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tensor which states for current player.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.TicTacToeEnvironment.done_space">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">done_space</span></span><a class="headerlink" href="#mindspore_rl.environment.TicTacToeEnvironment.done_space" title="Permalink to this definition"></a></dt>
<dd><p>Get the done space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The done space of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.environment.TicTacToeEnvironment.is_terminal">
<span class="sig-name descname"><span class="pre">is_terminal</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/tic_tac_toe_environment.html#TicTacToeEnvironment.is_terminal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.TicTacToeEnvironment.is_terminal" title="Permalink to this definition"></a></dt>
<dd><p>Return whether the current state is terminal.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>whether the current state is terminal or not.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.environment.TicTacToeEnvironment.legal_action">
<span class="sig-name descname"><span class="pre">legal_action</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/tic_tac_toe_environment.html#TicTacToeEnvironment.legal_action"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.TicTacToeEnvironment.legal_action" title="Permalink to this definition"></a></dt>
<dd><p>Return the legal action of current state.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tensor which states for the legal action.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.environment.TicTacToeEnvironment.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/tic_tac_toe_environment.html#TicTacToeEnvironment.load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.TicTacToeEnvironment.load" title="Permalink to this definition"></a></dt>
<dd><p>Load the input state. It will update the legal action, current state and done info of the game to the
input checkpoint.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>state</strong> (<em>Tensor</em>) – The input checkpoint state.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>state (Tensor), the state of checkpoint.</p></li>
<li><p>reward (Tensor), the reward of checkpoint.</p></li>
<li><p>done (Tensor), whether the checkpoint is terminal.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.environment.TicTacToeEnvironment.max_utility">
<span class="sig-name descname"><span class="pre">max_utility</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/tic_tac_toe_environment.html#TicTacToeEnvironment.max_utility"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.TicTacToeEnvironment.max_utility" title="Permalink to this definition"></a></dt>
<dd><p>Return the max utility of Tic-Tac-Toe.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tensor which states for max utility</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.TicTacToeEnvironment.observation_space">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">observation_space</span></span><a class="headerlink" href="#mindspore_rl.environment.TicTacToeEnvironment.observation_space" title="Permalink to this definition"></a></dt>
<dd><p>Get the state space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The state space of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.environment.TicTacToeEnvironment.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/tic_tac_toe_environment.html#TicTacToeEnvironment.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.TicTacToeEnvironment.reset" title="Permalink to this definition"></a></dt>
<dd><p>Reset the environment to the initial state. It is always used at the beginning of each
episode. It will return the value of initial state.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A Tensor which states for initial state.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.TicTacToeEnvironment.reward_space">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">reward_space</span></span><a class="headerlink" href="#mindspore_rl.environment.TicTacToeEnvironment.reward_space" title="Permalink to this definition"></a></dt>
<dd><p>Get the reward space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The reward space of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.environment.TicTacToeEnvironment.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/tic_tac_toe_environment.html#TicTacToeEnvironment.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.TicTacToeEnvironment.save" title="Permalink to this definition"></a></dt>
<dd><p>Return a repilca of environment. Tic-Tac-Toe do not need a replica, thus it will return the current
state</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tensor which states for the current state.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.environment.TicTacToeEnvironment.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/tic_tac_toe_environment.html#TicTacToeEnvironment.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.TicTacToeEnvironment.step" title="Permalink to this definition"></a></dt>
<dd><p>Execute the environment step, which means that interact with environment once.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>action</strong> (<em>Tensor</em>) – A tensor that contains the action information.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>state (Tensor), the environment state after performing the action.</p></li>
<li><p>reward (Tensor), the reward after performing the action.</p></li>
<li><p>done (Tensor), whether the simulation finishes or not.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-mindspore_rl.network">
<span id="mindspore-rl-network"></span><h2>mindspore_rl.network<a class="headerlink" href="#module-mindspore_rl.network" title="Permalink to this headline"></a></h2>
<p>Network component used to implement polices.</p>
<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.network.FullyConnectedLayers">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.network.</span></span><span class="sig-name descname"><span class="pre">FullyConnectedLayers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fc_layer_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_layer_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">nn.ReLU()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'normal'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias_init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'zeros'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/network/fully_connected_net.html#FullyConnectedLayers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.network.FullyConnectedLayers" title="Permalink to this definition"></a></dt>
<dd><p>This is a fully connected layers module. User can input abitrary number of fc_layer_params, then
this module can create corresponding number of fully connect layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fc_layer_params</strong> (<em>List</em><em>[</em><a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>]</em>) – A list of int states for the input and output size of fully
connected layer. For example, if the input list is [10, 20, 3], then the module will
create two fully connected layers whose input and output size are (10, 20) and (20, 3)
respectively. The length of fc_layer_params should be larger than 3.</p></li>
<li><p><strong>dropout_layer_params</strong> (<em>List</em><em>[</em><a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a><em>]</em>) – A list of float states for the dropout rate. If the input
list if [0.5, 0.3], then two dropout layers will be created after each fully connected
layer. The length of dropout_layer_params should be one less than fc_layer_params.
dropout_layer_params is a optional value. Default: None.</p></li>
<li><p><strong>activation_fn</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a><em>, </em><em>Cell</em><em>, </em><em>Primitive</em>) – An instance of activation function. Default: nn.ReLu().</p></li>
<li><p><strong>weight_init</strong> (<em>Union</em><em>[</em><em>Tensor</em><em>, </em><a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a><em>, </em><em>Initializer</em><em>, </em><a class="reference external" href="https://docs.python.org/library/numbers.html#numbers.Number" title="(in Python v3.8)"><em>numbers.Number</em></a><em>]</em>) – The trainable weight_init parameter.
The dtype is same as <cite>x</cite>. The values of str refer to the function <cite>initializer</cite>. Default: ‘normal’.</p></li>
<li><p><strong>bias_init</strong> (<em>Union</em><em>[</em><em>Tensor</em><em>, </em><a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a><em>, </em><em>Initializer</em><em>, </em><a class="reference external" href="https://docs.python.org/library/numbers.html#numbers.Number" title="(in Python v3.8)"><em>numbers.Number</em></a><em>]</em>) – The trainable bias_init parameter. The
dtype is same as <cite>x</cite>. The values of str refer to the function <cite>initializer</cite>. Default: ‘zeros’.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Inputs:</dt><dd><ul class="simple">
<li><p><strong>x</strong> (Tensor) - Tensor of shape <span class="math notranslate nohighlight">\((*, fc\_layers\_params[0])\)</span>.</p></li>
</ul>
</dd>
<dt>Outputs:</dt><dd><p>Tensor of shape <span class="math notranslate nohighlight">\((*, fc\_layers\_params[-1])\)</span>.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">input</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">net</span> <span class="o">=</span> <span class="n">FullyConnectedLayers</span><span class="p">(</span><span class="n">fc_layer_params</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">net</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(2, 2)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.network.FullyConnectedLayers.construct">
<span class="sig-name descname"><span class="pre">construct</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/network/fully_connected_net.html#FullyConnectedLayers.construct"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.network.FullyConnectedLayers.construct" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> (<em>Tensor</em>) – Tensor of shape <span class="math notranslate nohighlight">\((*, fc\_layers\_params[0])\)</span>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Tensor of shape <span class="math notranslate nohighlight">\((*, fc\_layers\_params[-1])\)</span>.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.network.FullyConnectedNet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.network.</span></span><span class="sig-name descname"><span class="pre">FullyConnectedNet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">mstype.float32</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/network/fully_connected_net.html#FullyConnectedNet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.network.FullyConnectedNet" title="Permalink to this definition"></a></dt>
<dd><p>A basic fully connected neural network.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_size</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – numbers of input size.</p></li>
<li><p><strong>hidden_size</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – numbers of hidden layers.</p></li>
<li><p><strong>output_size</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – numbers of output size.</p></li>
<li><p><strong>compute_type</strong> (<em>mindspore.dtype</em>) – data type used for fully connected layer. Default: mindspore.dtype.float32</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">input</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">net</span> <span class="o">=</span> <span class="n">FullyConnectedNet</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">net</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(2, 2)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.network.FullyConnectedNet.construct">
<span class="sig-name descname"><span class="pre">construct</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/network/fully_connected_net.html#FullyConnectedNet.construct"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.network.FullyConnectedNet.construct" title="Permalink to this definition"></a></dt>
<dd><p>Returns output of Dense layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> (<em>Tensor</em>) – Tensor as the input of network.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The output of the Dense layer.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.network.GruNet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.network.</span></span><span class="sig-name descname"><span class="pre">GruNet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'normal'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">has_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_first</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bidirectional</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/network/gru_net.html#GruNet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.network.GruNet" title="Permalink to this definition"></a></dt>
<dd><p>Stacked GRU (Gated Recurrent Unit) layers.</p>
<p>Apply GRU layer to the input.</p>
<p>For detailed information, please refer to <code class="xref py py-class docutils literal notranslate"><span class="pre">mindspore.nn.GRU</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_size</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Number of features of input.</p></li>
<li><p><strong>hidden_size</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Number of features of hidden layer.</p></li>
<li><p><strong>weight_init</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a><em> or </em><em>initializer</em>) – Initialize method. Default: normal.</p></li>
<li><p><strong>num_layers</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Number of layers of stacked GRU. Default: 1.</p></li>
<li><p><strong>has_bias</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Whether the cell has bias. Default: True.</p></li>
<li><p><strong>batch_first</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Specifies whether the first dimension of input <cite>x</cite> is batch_size. Default: False.</p></li>
<li><p><strong>dropout</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – If not 0.0, append <cite>Dropout</cite> layer on the outputs of each
GRU layer except the last layer. Default 0.0. The range of dropout is [0.0, 1.0).</p></li>
<li><p><strong>bidirectional</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Specifies whether it is a bidirectional GRU,
num_directions=2 if bidirectional=True otherwise 1. Default: False.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Inputs:</dt><dd><ul class="simple">
<li><p><strong>x_in</strong> (Tensor) - Tensor of data type mindspore.float32 and
shape (seq_len, batch_size, <cite>input_size</cite>) or (batch_size, seq_len, <cite>input_size</cite>).</p></li>
<li><p><strong>h_in</strong> (Tensor) - Tensor of data type mindspore.float32 and
shape (num_directions * <cite>num_layers</cite>, batch_size, <cite>hidden_size</cite>). The data type of <cite>h_in</cite> must be the same as
<cite>x_in</cite>.</p></li>
</ul>
</dd>
<dt>Outputs:</dt><dd><p>Tuple, a tuple contains (<cite>x_out</cite>, <cite>h_out</cite>).</p>
<ul class="simple">
<li><p><strong>x_out</strong> (Tensor) - Tensor of shape (seq_len, batch_size, num_directions * <cite>hidden_size</cite>) or
(batch_size, seq_len, num_directions * <cite>hidden_size</cite>).</p></li>
<li><p><strong>h_out</strong> (Tensor) - Tensor of shape (num_directions * <cite>num_layers</cite>, batch_size, <cite>hidden_size</cite>).</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">net</span> <span class="o">=</span> <span class="n">GruNet</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">has_bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bidirectional</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x_in</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h_in</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">16</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x_out</span><span class="p">,</span> <span class="n">h_out</span> <span class="o">=</span> <span class="n">net</span><span class="p">(</span><span class="n">x_in</span><span class="p">,</span> <span class="n">h_in</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">x_out</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(3, 5, 16)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.network.GruNet.construct">
<span class="sig-name descname"><span class="pre">construct</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h_in</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/network/gru_net.html#GruNet.construct"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.network.GruNet.construct" title="Permalink to this definition"></a></dt>
<dd><p>The forward calculation of gru net</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_in</strong> (<em>Tensor</em>) – Tensor of data type mindspore.float32 and shape (seq_len, batch_size, <cite>input_size</cite>)
or (batch_size, seq_len, <cite>input_size</cite>).</p></li>
<li><p><strong>h_in</strong> (<em>Tensor</em>) – Tensor of data type mindspore.float32 and shape (num_directions * <cite>num_layers</cite>,
batch_size, <cite>hidden_size</cite>). The data type of <cite>h_in</cite> must be the same as <cite>x_in</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>x_out</strong> (Tensor) - Tensor of shape (seq_len, batch_size, num_directions * <cite>hidden_size</cite>) or
(batch_size, seq_len, num_directions * <cite>hidden_size</cite>).</p></li>
<li><p><strong>h_out</strong> (Tensor) - Tensor of shape (num_directions * <cite>num_layers</cite>, batch_size, <cite>hidden_size</cite>).</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-mindspore_rl.policy">
<span id="mindspore-rl-policy"></span><h2>mindspore_rl.policy<a class="headerlink" href="#module-mindspore_rl.policy" title="Permalink to this headline"></a></h2>
<p>Policies used in RL algorithms.</p>
<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.policy.EpsilonGreedyPolicy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.policy.</span></span><span class="sig-name descname"><span class="pre">EpsilonGreedyPolicy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_network</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsi_high</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsi_low</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decay</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_space_dim</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/policy/epsilon_greedy_policy.html#EpsilonGreedyPolicy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.policy.EpsilonGreedyPolicy" title="Permalink to this definition"></a></dt>
<dd><p>Produces an epsilon-greedy sample action base on the given policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_network</strong> (<em>Cell</em>) – A network returns policy action.</p></li>
<li><p><strong>size</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Shape of epsilon.</p></li>
<li><p><strong>epsi_high</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – A high epsilon for exploration betweens [0, 1].</p></li>
<li><p><strong>epsi_low</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – A low epsilon for exploration betweens [0, epsi_high].</p></li>
<li><p><strong>decay</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – A decay factor applied to epsilon.</p></li>
<li><p><strong>action_space_dim</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Dimensions of the action space.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">state_dim</span><span class="p">,</span> <span class="n">hidden_dim</span><span class="p">,</span> <span class="n">action_dim</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_net</span> <span class="o">=</span> <span class="n">FullyConnectedNet</span><span class="p">(</span><span class="n">state_dim</span><span class="p">,</span> <span class="n">hidden_dim</span><span class="p">,</span> <span class="n">action_dim</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">policy</span> <span class="o">=</span> <span class="n">EpsilonGreedyPolicy</span><span class="p">(</span><span class="n">input_net</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">action_dim</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">state</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="n">state_dim</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">step</span> <span class="o">=</span>  <span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">10</span><span class="p">,])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">policy</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(1,)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.policy.EpsilonGreedyPolicy.construct">
<span class="sig-name descname"><span class="pre">construct</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/policy/epsilon_greedy_policy.html#EpsilonGreedyPolicy.construct"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.policy.EpsilonGreedyPolicy.construct" title="Permalink to this definition"></a></dt>
<dd><p>The interface of the construct function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<em>Tensor</em>) – The input tensor for network.</p></li>
<li><p><strong>step</strong> (<em>Tensor</em>) – The current step, effects the epsilon decay.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The output action.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.policy.GreedyPolicy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.policy.</span></span><span class="sig-name descname"><span class="pre">GreedyPolicy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_network</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/policy/greedy_policy.html#GreedyPolicy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.policy.GreedyPolicy" title="Permalink to this definition"></a></dt>
<dd><p>Produces a greedy action base on the given policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input_network</strong> (<em>Cell</em>) – network used to generate action probs by input state.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">state_dim</span><span class="p">,</span> <span class="n">hidden_dim</span><span class="p">,</span> <span class="n">action_dim</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_net</span> <span class="o">=</span> <span class="n">FullyConnectedNet</span><span class="p">(</span><span class="n">state_dim</span><span class="p">,</span> <span class="n">hidden_dim</span><span class="p">,</span> <span class="n">action_dim</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">policy</span> <span class="o">=</span> <span class="n">GreedyPolicy</span><span class="p">(</span><span class="n">input_net</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">state</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">policy</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(2,)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.policy.GreedyPolicy.construct">
<span class="sig-name descname"><span class="pre">construct</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/policy/greedy_policy.html#GreedyPolicy.construct"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.policy.GreedyPolicy.construct" title="Permalink to this definition"></a></dt>
<dd><p>Returns the best action.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>state</strong> (<em>Tensor</em>) – State tensor as the input of network.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>action_max, the best action.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.policy.Policy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.policy.</span></span><span class="sig-name descname"><span class="pre">Policy</span></span><a class="reference internal" href="_modules/mindspore_rl/policy/policy.html#Policy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.policy.Policy" title="Permalink to this definition"></a></dt>
<dd><p>The virtual base class for the policy. This class should be overridden before calling in the model.</p>
<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.policy.Policy.construct">
<span class="sig-name descname"><span class="pre">construct</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/policy/policy.html#Policy.construct"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.policy.Policy.construct" title="Permalink to this definition"></a></dt>
<dd><p>The interface of the construct function. Inherited and used by users.
Args can refer to ‘epsilongreedypolicy’, ‘randompolicy’, etc.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong> – it’s depended on the user definition.</p></li>
<li><p><strong>kwargs</strong> – it’s depended on the user definition.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>User defined. Usually, it returns an action value or the probability distribution of an action.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.policy.RandomPolicy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.policy.</span></span><span class="sig-name descname"><span class="pre">RandomPolicy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action_space_dim</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/policy/random_policy.html#RandomPolicy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.policy.RandomPolicy" title="Permalink to this definition"></a></dt>
<dd><p>Produces a random action betweens [0, <cite>acton_space_dim</cite>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>action_space_dim</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – dimension of the action space.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">action_space_dim</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">policy</span> <span class="o">=</span> <span class="n">RandomPolicy</span><span class="p">(</span><span class="n">action_space_dim</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">policy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(1,)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.policy.RandomPolicy.construct">
<span class="sig-name descname"><span class="pre">construct</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/policy/random_policy.html#RandomPolicy.construct"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.policy.RandomPolicy.construct" title="Permalink to this definition"></a></dt>
<dd><p>Returns a random number betweens [0, <cite>acton_space_dim</cite>).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A random integer betweens [0, <cite>acton_space_dim</cite>).</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>


           </div>
           
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="dqn.html" class="btn btn-neutral float-left" title="Deep Q Learning (DQN) with MindSpore Reinforcement" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="RELEASE.html" class="btn btn-neutral float-right" title="MindSpore Reinforcement Release Notes" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, MindSpore.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   
	<script async="async" src="https://cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</body>
</html>