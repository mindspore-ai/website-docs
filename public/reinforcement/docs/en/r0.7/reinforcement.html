<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>mindspore_rl &mdash; MindSpore master documentation</title><script>;(()=>{const e=localStorage.getItem("ms-theme"),t=window.matchMedia("(prefers-color-scheme: dark)").matches;(e?"dark"===e:t)&&document.documentElement.setAttribute("data-o-theme","dark")})();</script><link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script><script src="_static/jquery.js"></script>
        <script src="_static/js/theme.js"></script><script src="_static/underscore.js"></script><script src="_static/doctools.js"></script><script crossorigin="anonymous" integrity="sha256-1fEPhSsRKlFKGfK3eO710tEweHh1fwokU5wFGDHO+vg=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js"></script><script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script><script async="async" src="https://mindspore-website.obs.cn-north-4.myhuaweicloud.com/mathjax/MathJax-3.2.2/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="Release Notes" href="RELEASE.html" />
    <link rel="prev" title="Reinforcement Learning Environment Access" href="environment.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> MindSpore
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Installation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="reinforcement_install.html">MindSpore Reinforcement Installation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="custom_config_info.html">MindSpore RL Configuration Instruction</a></li>
<li class="toctree-l1"><a class="reference internal" href="dqn.html">Deep Q Learning (DQN) with MindSpore Reinforcement</a></li>
<li class="toctree-l1"><a class="reference internal" href="replaybuffer.html">ReplayBuffer Usage Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="environment.html">Reinforcement Learning Environment Access</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API References</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">mindspore_rl</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-mindspore_rl.agent">mindspore_rl.agent</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-mindspore_rl.core">mindspore_rl.core</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-mindspore_rl.environment">mindspore_rl.environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-mindspore_rl.network">mindspore_rl.network</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-mindspore_rl.policy">mindspore_rl.policy</a></li>
<li class="toctree-l2"><a class="reference internal" href="#mindspore-rl-utils">mindspore_rl.utils</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">RELEASE NOTES</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="RELEASE.html">Release Notes</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">MindSpore</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>mindspore_rl</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/reinforcement.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="module-mindspore_rl">
<span id="mindspore-rl"></span><h1>mindspore_rl<a class="headerlink" href="#module-mindspore_rl" title="Permalink to this headline"></a></h1>
<p>Components for MindSpore Reinforcement Learning Framework.</p>
<section id="module-mindspore_rl.agent">
<span id="mindspore-rl-agent"></span><h2>mindspore_rl.agent<a class="headerlink" href="#module-mindspore_rl.agent" title="Permalink to this headline"></a></h2>
<p>Components for agent, actor, learner, trainer.</p>
<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.agent.Actor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.agent.</span></span><span class="sig-name descname"><span class="pre">Actor</span></span><a class="reference internal" href="_modules/mindspore_rl/agent/actor.html#Actor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.agent.Actor" title="Permalink to this definition"></a></dt>
<dd><p>Base class for all actors. Actor is a class used to interact with the environment and generate data.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.agent.actor</span> <span class="kn">import</span> <span class="n">Actor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.network</span> <span class="kn">import</span> <span class="n">FullyConnectedNet</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.environment</span> <span class="kn">import</span> <span class="n">GymEnvironment</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">MyActor</span><span class="p">(</span><span class="n">Actor</span><span class="p">):</span>
<span class="gp">... </span>  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">super</span><span class="p">(</span><span class="n">MyActor</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">argmax</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">Argmax</span><span class="p">()</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">actor_net</span> <span class="o">=</span> <span class="n">FullyConnectedNet</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">env</span> <span class="o">=</span> <span class="n">GymEnvironment</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;CartPole-v0&#39;</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_actor</span> <span class="o">=</span> <span class="n">MyActor</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">my_actor</span><span class="p">)</span>
<span class="go">MyActor&lt;</span>
<span class="go">(actor_net): FullyConnectedNet&lt;</span>
<span class="go">(linear1): Dense&lt;input_channels=4, output_channels=10, has_bias=True&gt;</span>
<span class="go">(linear2): Dense&lt;input_channels=10, output_channels=2, has_bias=True&gt;</span>
<span class="go">(relu): ReLU&lt;&gt;</span>
<span class="go">&gt;</span>
<span class="go">(environment): GymEnvironment&lt;&gt;</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.agent.Actor.act">
<span class="sig-name descname"><span class="pre">act</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/agent/actor.html#Actor.act"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.agent.Actor.act" title="Permalink to this definition"></a></dt>
<dd><p>The act function will take an enumerate value and observation or other data which is needed during
calculating the action. It will return a set of output which contains new observation, or other
experience. In this function, agent will interact with environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phase</strong> (<em>enum</em>) – A enumerate value states for init, collect, eval or other user-defined stage.</p></li>
<li><p><strong>params</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em>(</em><em>Tensor</em><em>)</em>) – A tuple of tensor as input, which is used to calculate action</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>tuple(Tensor), a tuple of tensor as output, which states for experience data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.agent.Actor.get_action">
<span class="sig-name descname"><span class="pre">get_action</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/agent/actor.html#Actor.get_action"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.agent.Actor.get_action" title="Permalink to this definition"></a></dt>
<dd><p>get_action is the method used to obtain the action.
User will need to overload this function according to
the algorithm. But argument of this function should be
phase and params. This interface will not interact with
environment</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phase</strong> (<em>enum</em>) – A enumerate value states for init, collect, eval or other user-defined stage.</p></li>
<li><p><strong>params</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em>(</em><em>Tensor</em><em>)</em>) – A tuple of tensor as input, which is used to calculate action</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>tuple(Tensor), a tuple of tensor as output, containing actions and other data.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.agent.Agent">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.agent.</span></span><span class="sig-name descname"><span class="pre">Agent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">actors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learner</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/agent/agent.html#Agent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.agent.Agent" title="Permalink to this definition"></a></dt>
<dd><p>The base class for the Agent. As the definition of agent, it is composed of actor and leanrner.
It has basic act and learn functions for interaction with environment and update itself.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>actors</strong> (<a class="reference internal" href="#mindspore_rl.agent.Actor" title="mindspore_rl.agent.Actor"><em>Actor</em></a>) – The actor instance.</p></li>
<li><p><strong>learner</strong> (<a class="reference internal" href="#mindspore_rl.agent.Learner" title="mindspore_rl.agent.Learner"><em>Learner</em></a>) – The learner instance.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.agent.learner</span> <span class="kn">import</span> <span class="n">Learner</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.agent.actor</span> <span class="kn">import</span> <span class="n">Actor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.agent.agent</span> <span class="kn">import</span> <span class="n">Agent</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">actors</span> <span class="o">=</span> <span class="n">Actor</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">learner</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">agent</span> <span class="o">=</span> <span class="n">Agent</span><span class="p">(</span><span class="n">actors</span><span class="p">,</span> <span class="n">learner</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">agent</span><span class="p">)</span>
<span class="go">Agent&lt;</span>
<span class="go">(_actors): Actor&lt;&gt;</span>
<span class="go">(_learner): Learner&lt;&gt;</span>
<span class="go">&gt;</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.agent.Agent.act">
<span class="sig-name descname"><span class="pre">act</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/agent/agent.html#Agent.act"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.agent.Agent.act" title="Permalink to this definition"></a></dt>
<dd><p>The act function will take an enumerate value and observation or other data which is needed during
calculating the action. It will return a set of output which contains new observation, or other
experience. In this function, agent will interact with environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phase</strong> (<em>enum</em>) – A enumerate value states for init, collect or eval stage.</p></li>
<li><p><strong>params</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em>(</em><em>Tensor</em><em>)</em>) – A tuple of tensor as input, which is used to calculate action</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>tuple(Tensor), a tuple of tensor as output, which states for experience</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.agent.Agent.get_action">
<span class="sig-name descname"><span class="pre">get_action</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/agent/agent.html#Agent.get_action"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.agent.Agent.get_action" title="Permalink to this definition"></a></dt>
<dd><p>The get_action function will take an enumerate value and observation or other data which is needed during
calculating the action. It will return a set of outputs containing actions and other data. In this
function, agent will not interact with environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phase</strong> (<em>enum</em>) – A enumerate value states for init, collect or eval stage.</p></li>
<li><p><strong>params</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em>(</em><em>Tensor</em><em>)</em>) – A tuple of tensor as input, which is used to calculate action</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>tuple(Tensor), a tuple of tensor as output, containing actions and other data.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.agent.Agent.learn">
<span class="sig-name descname"><span class="pre">learn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">experience</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/agent/agent.html#Agent.learn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.agent.Agent.learn" title="Permalink to this definition"></a></dt>
<dd><p>The learn function will take a set of experience as input to calculate the loss and update
the weights.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>experience</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em>(</em><em>Tensor</em><em>)</em>) – A tuple of tensor states for experience</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>tuple(Tensor), result which outputs after updating weights</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.agent.Learner">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.agent.</span></span><span class="sig-name descname"><span class="pre">Learner</span></span><a class="reference internal" href="_modules/mindspore_rl/agent/learner.html#Learner"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.agent.Learner" title="Permalink to this definition"></a></dt>
<dd><p>The base class of the learner. Calculate and update the self generated network through the input experience.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.agent.learner</span> <span class="kn">import</span> <span class="n">Learner</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.network</span> <span class="kn">import</span> <span class="n">FullyConnectedNet</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">MyLearner</span><span class="p">(</span><span class="n">Learner</span><span class="p">):</span>
<span class="gp">... </span>  <span class="k">def</span> <span class="nf">init</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">super</span><span class="p">(</span><span class="n">MyLearner</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">target_network</span> <span class="o">=</span> <span class="n">FullyConnectedNet</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_learner</span> <span class="o">=</span> <span class="n">MyLearner</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">my_learner</span><span class="p">)</span>
<span class="go">MyLearner&lt;</span>
<span class="go">(target_network): FullyConnectedNet&lt;</span>
<span class="go">(linear1): Dense&lt;input_channels=4, output_channels=10, has_bias=True&gt;</span>
<span class="go">(linear2): Dense&lt;input_channels=10, output_channels=2, has_bias=True&gt;</span>
<span class="go">(relu): ReLU&lt;&gt;</span>
<span class="go">&gt;</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.agent.Learner.learn">
<span class="sig-name descname"><span class="pre">learn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">experience</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/agent/learner.html#Learner.learn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.agent.Learner.learn" title="Permalink to this definition"></a></dt>
<dd><p>The interface for the learn function. The behavior of the <cite>learn</cite> function
depend on the user’s implementation. Usually, it takes the <cite>samples</cite> form
replay buffer or other Tensors, and calculates the loss for updating the networks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>experience</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em>(</em><em>Tensor</em><em>)</em>) – Sampling from the buffer.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>tuple(Tensor), result which outputs after updating weights</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.agent.Trainer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.agent.</span></span><span class="sig-name descname"><span class="pre">Trainer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msrl</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/agent/trainer.html#Trainer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.agent.Trainer" title="Permalink to this definition"></a></dt>
<dd><p>The trainer base class. It is a process class that provides the basic mode of training.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Reference to <a class="reference external" href="https://gitee.com/mindspore/docs/blob/master/docs/reinforcement/docs/source_en/dqn.md#defining-the-dqntrainer-class">dqn_trainer.py</a>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>msrl</strong> (<a class="reference internal" href="#mindspore_rl.core.MSRL" title="mindspore_rl.core.MSRL"><em>MSRL</em></a>) – the function handler class.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.agent.Trainer.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/agent/trainer.html#Trainer.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.agent.Trainer.evaluate" title="Permalink to this definition"></a></dt>
<dd><p>The interface of the evaluate function for evaluate in train.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.agent.Trainer.load_and_eval">
<span class="sig-name descname"><span class="pre">load_and_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ckpt_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/agent/trainer.html#Trainer.load_and_eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.agent.Trainer.load_and_eval" title="Permalink to this definition"></a></dt>
<dd><p>The interface of the eval function for offline. A checkpoint must be provided.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ckpt_path</strong> (<em>string</em>) – The checkpoint file to restore net. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.agent.Trainer.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">episodes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callbacks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ckpt_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/agent/trainer.html#Trainer.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.agent.Trainer.train" title="Permalink to this definition"></a></dt>
<dd><p>The train method provides a standard training process, including the whole loop and callbacks.
Users can inherit or overwrite as needed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>episodes</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – the number of training episodes.</p></li>
<li><p><strong>callbacks</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em>[</em><em>Callback</em><em>]</em><em>]</em>) – List of callback objects. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>ckpt_path</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a><em>]</em>) – The checkpoint file path to init or restore net. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.agent.Trainer.train_one_episode">
<span class="sig-name descname"><span class="pre">train_one_episode</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/agent/trainer.html#Trainer.train_one_episode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.agent.Trainer.train_one_episode" title="Permalink to this definition"></a></dt>
<dd><p>The interface of train one episode function in train.
And the output of this function must be constricted as <cite>loss, rewards, steps, [optional]others</cite> in order.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.agent.Trainer.trainable_variables">
<span class="sig-name descname"><span class="pre">trainable_variables</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/agent/trainer.html#Trainer.trainable_variables"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.agent.Trainer.trainable_variables" title="Permalink to this definition"></a></dt>
<dd><p>The variables for saving to checkpoint.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-mindspore_rl.core">
<span id="mindspore-rl-core"></span><h2>mindspore_rl.core<a class="headerlink" href="#module-mindspore_rl.core" title="Permalink to this headline"></a></h2>
<p>Helper components used to implement RL algorithms.</p>
<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.core.MSRL">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.core.</span></span><span class="sig-name descname"><span class="pre">MSRL</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alg_config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deploy_config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/msrl.html#MSRL"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.core.MSRL" title="Permalink to this definition"></a></dt>
<dd><p>The MSRL class provides the function handlers and APIs for reinforcement
learning algorithm development.</p>
<p>It exposes the following function handler to the user. The input and output of
these function handlers are identical to the user defined functions.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">agent_act</span>
<span class="n">agent_get_action</span>
<span class="n">sample_buffer</span>
<span class="n">agent_learn</span>
<span class="n">replay_buffer_sample</span>
<span class="n">replay_buffer_insert</span>
<span class="n">replay_buffer_reset</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>alg_config</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – provides the algorithm configuration.</p></li>
<li><p><strong>deploy_config</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – <p>provides the distribute configuration.</p>
<ul>
<li><p>Top level: defines the algorithm components.</p>
<ul>
<li><p>key: ‘actor’,              value: the actor configuration (dict).</p></li>
<li><p>key: ‘learner’,            value: the learner configuration (dict).</p></li>
<li><p>key: ‘policy_and_network’, value: the policy and networks used by
actor and learner (dict).</p></li>
<li><p>key: ‘collect_environment’,     value: the collect environment configuration (dict).</p></li>
<li><p>key: ‘eval_environment’,        value: the eval environment configuration (dict).</p></li>
<li><p>key: ‘replay_buffer’,           value: the replay buffer configuration (dict).</p></li>
</ul>
</li>
<li><p>Second level: the configuration of each algorithm component.</p>
<ul>
<li><p>key: ‘number’,      value: the number of actor/learner (int).</p></li>
<li><p>key: ‘type’,        value: the type of the
actor/learner/policy_and_network/environment (class name).</p></li>
<li><p>key: ‘params’,      value: the parameters of
actor/learner/policy_and_network/environment (dict).</p></li>
<li><p>key: ‘policies’,    value: the list of policies used by the
actor/learner (list).</p></li>
<li><p>key: ‘networks’,    value: the list of networks used by the
actor/learner (list).</p></li>
<li><p>key: ‘pass_environment’, value: <code class="docutils literal notranslate"><span class="pre">True</span></code> user needs to pass the environment
instance into actor, <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise (Bool).</p></li>
</ul>
</li>
</ul>
</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.core.MSRL.create_environments">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">create_environments</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deploy_config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">need_batched</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/msrl.html#MSRL.create_environments"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.core.MSRL.create_environments" title="Permalink to this definition"></a></dt>
<dd><p>Create the environments object from the configuration file, and return the instance
of environment and evaluate environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – algorithm configuration file.</p></li>
<li><p><strong>env_type</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – type of environment in collect_environment and eval_environment.</p></li>
<li><p><strong>deploy_config</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – the configuration for deploy. Default: None.</p></li>
<li><p><strong>need_batched</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – whether to create batched environment. Default: False.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>env (object), created environment object.</p></li>
<li><p>num_env (int), the number of environment.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.core.MSRL.get_replay_buffer">
<span class="sig-name descname"><span class="pre">get_replay_buffer</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/msrl.html#MSRL.get_replay_buffer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.core.MSRL.get_replay_buffer" title="Permalink to this definition"></a></dt>
<dd><p>It will return the instance of replay buffer.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Buffers (object), The instance of relay buffer. If the buffer is <code class="docutils literal notranslate"><span class="pre">None</span></code>, the return
value will be <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.core.MSRL.get_replay_buffer_elements">
<span class="sig-name descname"><span class="pre">get_replay_buffer_elements</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">transpose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/msrl.html#MSRL.get_replay_buffer_elements"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.core.MSRL.get_replay_buffer_elements" title="Permalink to this definition"></a></dt>
<dd><p>It will return all the elements in the replay buffer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>transpose</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – whether the output element needs to be transpose,
if <cite>transpose</cite> is <code class="docutils literal notranslate"><span class="pre">True</span></code>, <cite>shape</cite> will also need to be filled. Default: <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>shape</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>]</em>) – the shape used in transpose. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>elements (List[Tensor]), A set of tensor contains all the elements in the replay buffer.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.core.MSRL.init">
<span class="sig-name descname"><span class="pre">init</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/msrl.html#MSRL.init"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.core.MSRL.init" title="Permalink to this definition"></a></dt>
<dd><p>Initialization of MSRL object.
The function creates all the data/objects that the algorithm requires.
It also initializes all the function handler.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>config</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – algorithm configuration file.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.core.PriorityReplayBuffer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.core.</span></span><span class="sig-name descname"><span class="pre">PriorityReplayBuffer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alpha</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">capacity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sample_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shapes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">types</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed0</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">seed1</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/priority_replay_buffer.html#PriorityReplayBuffer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.core.PriorityReplayBuffer" title="Permalink to this definition"></a></dt>
<dd><p>PriorityReplayBuffer is experience container used in Deep Q-Networks.
The algorithm is proposed in <cite>Prioritized Experience Replay &lt;https://arxiv.org/abs/1511.05952&gt;</cite>.
Same as the normal replay buffer, it lets the reinforcement learning agents remember and reuse experiences from the
past. Besides, it replays important transitions more frequently and improve sample effciency.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>alpha</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – parameter to control degree of prioritization.
<code class="docutils literal notranslate"><span class="pre">0</span></code> means the uniform sampling, <code class="docutils literal notranslate"><span class="pre">1</span></code> means priority sampling.</p></li>
<li><p><strong>capacity</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – the capacity of the buffer.</p></li>
<li><p><strong>sample_size</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – size for sampling from the buffer.</p></li>
<li><p><strong>shapes</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>]</em>) – the shape of each tensor in a buffer element.</p></li>
<li><p><strong>types</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em>[</em><em>mindspore.dtype</em><em>]</em>) – the data type of each tensor in a buffer element.</p></li>
<li><p><strong>seed0</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Seed0 value for random generating. Default: <code class="docutils literal notranslate"><span class="pre">0</span></code>.</p></li>
<li><p><strong>seed1</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Seed1 value for random generating. Default: <code class="docutils literal notranslate"><span class="pre">0</span></code>.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mindspore</span> <span class="k">as</span> <span class="nn">ms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore</span> <span class="kn">import</span> <span class="n">Tensor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.core.priority_replay_buffer</span> <span class="kn">import</span> <span class="n">PriorityReplayBuffer</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">capacity</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">batch_size</span> <span class="o">=</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shapes</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">4</span><span class="p">,),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">types</span> <span class="o">=</span> <span class="p">[</span><span class="n">ms</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">ms</span><span class="o">.</span><span class="n">int32</span><span class="p">,</span> <span class="n">ms</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">ms</span><span class="o">.</span><span class="n">float32</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">replaybuffer</span> <span class="o">=</span> <span class="n">PriorityReplayBuffer</span><span class="p">(</span><span class="n">alpha</span><span class="p">,</span> <span class="n">capacity</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">,</span> <span class="n">shapes</span><span class="p">,</span> <span class="n">types</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">replaybuffer</span><span class="p">)</span>
<span class="go">PriorityReplayBuffer&lt;&gt;</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.core.PriorityReplayBuffer.destroy">
<span class="sig-name descname"><span class="pre">destroy</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/priority_replay_buffer.html#PriorityReplayBuffer.destroy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.core.PriorityReplayBuffer.destroy" title="Permalink to this definition"></a></dt>
<dd><p>Destroy the replay buffer.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Priority replay buffer instance handle with dtype int64 and shape <span class="math notranslate nohighlight">\((1,)\)</span>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.core.PriorityReplayBuffer.full">
<span class="sig-name descname"><span class="pre">full</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/priority_replay_buffer.html#PriorityReplayBuffer.full"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.core.PriorityReplayBuffer.full" title="Permalink to this definition"></a></dt>
<dd><p>whether the buffer is full</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.core.PriorityReplayBuffer.insert">
<span class="sig-name descname"><span class="pre">insert</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">transition</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/priority_replay_buffer.html#PriorityReplayBuffer.insert"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.core.PriorityReplayBuffer.insert" title="Permalink to this definition"></a></dt>
<dd><p>Push a transition to the buffer. If the buffer is full, the oldest one will be removed.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>transition</strong> (<em>List</em><em>[</em><em>Tensor</em><em>]</em>) – insert a list of tensor which matches with the initialized shapes
and dtypes into the buffer.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>handle(Tensor), Priority replay buffer instance handle with dtype int64 and shape <span class="math notranslate nohighlight">\((1,)\)</span>.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.core.PriorityReplayBuffer.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/priority_replay_buffer.html#PriorityReplayBuffer.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.core.PriorityReplayBuffer.reset" title="Permalink to this definition"></a></dt>
<dd><p>reset the buffer</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.core.PriorityReplayBuffer.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">beta</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/priority_replay_buffer.html#PriorityReplayBuffer.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.core.PriorityReplayBuffer.sample" title="Permalink to this definition"></a></dt>
<dd><p>Samples a batch of transitions from the replay buffer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>beta</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – parameter to control degree of sampling correction.
<code class="docutils literal notranslate"><span class="pre">0</span></code> means the no correction, <code class="docutils literal notranslate"><span class="pre">1</span></code> means full correction.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>indices (Tensor), the transition indices in the replay buffer.
weights (Tensor), the weight used to correct for sampling bias.
transitions (tuple(Tensor)), transitions with variable-length tensors.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.core.PriorityReplayBuffer.update_priorities">
<span class="sig-name descname"><span class="pre">update_priorities</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">indices</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">priorities</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/priority_replay_buffer.html#PriorityReplayBuffer.update_priorities"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.core.PriorityReplayBuffer.update_priorities" title="Permalink to this definition"></a></dt>
<dd><p>Update transition prorities.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>indices</strong> (<em>Tensor</em>) – transition indices. The caller needs to ensure the validity of the indices.</p></li>
<li><p><strong>priorities</strong> (<em>Tensor</em>) – transition priorities.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>tuple(Tensor), Transition with its indices and correction weights.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.core.Session">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.core.</span></span><span class="sig-name descname"><span class="pre">Session</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">alg_config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">deploy_config</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callbacks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/session.html#Session"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.core.Session" title="Permalink to this definition"></a></dt>
<dd><p>The Session is a class for running MindSpore RL algorithms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>alg_config</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – the algorithm configuration or the deployment configuration of the algorithm.</p></li>
<li><p><strong>deploy_config</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – the deployment configuration for distribution. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code>.
For more details of configuration of algorithm, please have a look at
<a class="reference external" href="https://www.mindspore.cn/reinforcement/docs/zh-CN/master/custom_config_info.html">detail</a>.</p></li>
<li><p><strong>params</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – The algorithm specific training parameters. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>callbacks</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em>[</em><em>Callback</em><em>]</em>) – The callback list. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.core.Session.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">class_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_train</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">episode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">duration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/session.html#Session.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.core.Session.run" title="Permalink to this definition"></a></dt>
<dd><p>Execute the reinforcement learning algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>class_type</strong> (<a class="reference internal" href="#mindspore_rl.agent.Trainer" title="mindspore_rl.agent.Trainer"><em>Trainer</em></a>) – The class type of the algorithm”s trainer class. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>is_train</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Run the algorithm in train mode or eval mode. Default: <code class="docutils literal notranslate"><span class="pre">True</span></code>.</p></li>
<li><p><strong>episode</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The number of episode of the training. Default: <code class="docutils literal notranslate"><span class="pre">0</span></code>.</p></li>
<li><p><strong>duration</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The number of duration of the training. Default: <code class="docutils literal notranslate"><span class="pre">0</span></code>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.core.UniformReplayBuffer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.core.</span></span><span class="sig-name descname"><span class="pre">UniformReplayBuffer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">sample_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">capacity</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shapes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">types</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/uniform_replay_buffer.html#UniformReplayBuffer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.core.UniformReplayBuffer" title="Permalink to this definition"></a></dt>
<dd><p>The replay buffer class.
The replay buffer will store the experience from environment. In replay
buffer, each element is a list of tensors. Therefore, the constructor of the
UniformReplayBuffer class takes the shape and type of each tensor as an argument.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>sample_size</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – size for sampling from the buffer.</p></li>
<li><p><strong>capacity</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – the capacity of the buffer.</p></li>
<li><p><strong>shapes</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>]</em>) – the shape of each tensor in a buffer element.</p></li>
<li><p><strong>types</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em>[</em><em>mindspore.dtype</em><em>]</em>) – the data type of each tensor in a buffer element.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mindspore</span> <span class="k">as</span> <span class="nn">ms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.core.uniform_replay_buffer</span> <span class="kn">import</span> <span class="n">UniformReplayBuffer</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">sample_size</span> <span class="o">=</span> <span class="mi">10</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">capacity</span> <span class="o">=</span> <span class="mi">10000</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shapes</span> <span class="o">=</span> <span class="p">[(</span><span class="mi">4</span><span class="p">,),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,),</span> <span class="p">(</span><span class="mi">4</span><span class="p">,)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">types</span> <span class="o">=</span> <span class="p">[</span><span class="n">ms</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">ms</span><span class="o">.</span><span class="n">int32</span><span class="p">,</span> <span class="n">ms</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">ms</span><span class="o">.</span><span class="n">float32</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">replaybuffer</span> <span class="o">=</span> <span class="n">UniformReplayBuffer</span><span class="p">(</span><span class="n">sample_size</span><span class="p">,</span> <span class="n">capacity</span><span class="p">,</span> <span class="n">shapes</span><span class="p">,</span> <span class="n">types</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">replaybuffer</span><span class="p">)</span>
<span class="go">UniformReplayBuffer&lt;&gt;</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.core.UniformReplayBuffer.full">
<span class="sig-name descname"><span class="pre">full</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/uniform_replay_buffer.html#UniformReplayBuffer.full"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.core.UniformReplayBuffer.full" title="Permalink to this definition"></a></dt>
<dd><p>Check if the replaybuffer is full or not.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Full(bool), <code class="docutils literal notranslate"><span class="pre">True</span></code> if the replaybuffer is full, <code class="docutils literal notranslate"><span class="pre">False</span></code> otherwise.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.core.UniformReplayBuffer.get_item">
<span class="sig-name descname"><span class="pre">get_item</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/uniform_replay_buffer.html#UniformReplayBuffer.get_item"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.core.UniformReplayBuffer.get_item" title="Permalink to this definition"></a></dt>
<dd><p>Get an element from the replaybuffer in specific position(index).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>index</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – the location of the item.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>element (List[Tensor]), the element from the buffer.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.core.UniformReplayBuffer.insert">
<span class="sig-name descname"><span class="pre">insert</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">exp</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/uniform_replay_buffer.html#UniformReplayBuffer.insert"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.core.UniformReplayBuffer.insert" title="Permalink to this definition"></a></dt>
<dd><p>Insert an element to the buffer. If the buffer is full, FIFO strategy will be used to
replace the element in the buffer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>exp</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em>[</em><em>Tensor</em><em>]</em>) – insert a list of tensor which matches with the initialized shape
and type into the buffer.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>element (list[Tensor]), return the whole buffer after insertion</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.core.UniformReplayBuffer.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/uniform_replay_buffer.html#UniformReplayBuffer.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.core.UniformReplayBuffer.reset" title="Permalink to this definition"></a></dt>
<dd><p>Reset the replaybuffer. It changes the value of self.count to zero.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>success (boolean), whether the reset successful or not.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.core.UniformReplayBuffer.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/uniform_replay_buffer.html#UniformReplayBuffer.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.core.UniformReplayBuffer.sample" title="Permalink to this definition"></a></dt>
<dd><p>Sampling the replaybuffer, which means that it will randomly choose a set of element
and output them.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>data (Tuple(Tensor)), A set of sampled elements from the buffer.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.core.UniformReplayBuffer.size">
<span class="sig-name descname"><span class="pre">size</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/uniform_replay_buffer.html#UniformReplayBuffer.size"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.core.UniformReplayBuffer.size" title="Permalink to this definition"></a></dt>
<dd><p>Return the size of the replybuffer.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>size (int), the number of element in the replaybuffer.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-mindspore_rl.environment">
<span id="mindspore-rl-environment"></span><h2>mindspore_rl.environment<a class="headerlink" href="#module-mindspore_rl.environment" title="Permalink to this headline"></a></h2>
<p>Component used to implement custom environments.</p>
<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.environment.DeepMindControlEnvironment">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.environment.</span></span><span class="sig-name descname"><span class="pre">DeepMindControlEnvironment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/dmc_environment.html#DeepMindControlEnvironment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.DeepMindControlEnvironment" title="Permalink to this definition"></a></dt>
<dd><p>DeepMindControlEnvironment is a wrapper which encapsulates the DeepMind Control Suite(DMC).
It stacks for physics-based simulation and Reinforcement Learning environments, using MUJOCO
physics.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – <p>A dictionary contains all the parameters which are used in this class.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 52%" />
<col style="width: 48%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Configuration Parameters</p></th>
<th class="head"><p>Notices</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>env_name</p></td>
<td><p>the name of game in DMC</p></td>
</tr>
<tr class="row-odd"><td><p>seed</p></td>
<td><p>seed used in Gym</p></td>
</tr>
<tr class="row-even"><td><p>camera</p></td>
<td><p>The camera pos used in
render</p></td>
</tr>
<tr class="row-odd"><td><p>action_repeat</p></td>
<td><p>How many times an action
interacts with env</p></td>
</tr>
<tr class="row-even"><td><p>normalize_action</p></td>
<td><p>Whether needs to normalize
the input action</p></td>
</tr>
<tr class="row-odd"><td><p>img_size</p></td>
<td><p>The rendered img size</p></td>
</tr>
</tbody>
</table>
</p></li>
<li><p><strong>env_id</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>optional</em>) – A integer which is used to set the seed of this environment,
default value means the 0th environment. Default: <code class="docutils literal notranslate"><span class="pre">0</span></code> .</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">env_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;env_name&#39;</span><span class="p">:</span> <span class="s1">&#39;walker_walk&#39;</span><span class="p">,</span> <span class="s1">&#39;img_size&#39;</span><span class="p">:</span> <span class="p">(</span><span class="mi">64</span><span class="p">,</span> <span class="mi">64</span><span class="p">),</span>
<span class="go">                  &#39;action_repeat&#39;: 2, &#39;normalize_action&#39;: True, &#39;seed&#39;: 1,</span>
<span class="go">                  &#39;episode_limits&#39;: 1000, &#39;prefill_value&#39;: 5000}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">environment</span> <span class="o">=</span> <span class="n">DeepMindControlEnvironment</span><span class="p">(</span><span class="n">env_params</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">environment</span><span class="p">)</span>
<span class="go">DeepMindControlEnvironment&lt;&gt;</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.environment.DeepMindControlEnvironment.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/dmc_environment.html#DeepMindControlEnvironment.close"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.DeepMindControlEnvironment.close" title="Permalink to this definition"></a></dt>
<dd><p>Close the environment to release the resource.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Success(np.bool_), Whether shutdown the process or threading successfully.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.environment.Environment">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.environment.</span></span><span class="sig-name descname"><span class="pre">Environment</span></span><a class="reference internal" href="_modules/mindspore_rl/environment/environment.html#Environment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.Environment" title="Permalink to this definition"></a></dt>
<dd><p>The abstract base class for environment. All the environments or wrappers need to inherit
this base class. Moreover, subclass needs to overridden corresponding functions and properties.</p>
<dl class="simple">
<dt>Supported Platforms:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">Ascend</span></code> <code class="docutils literal notranslate"><span class="pre">GPU</span></code> <code class="docutils literal notranslate"><span class="pre">CPU</span></code></p>
</dd>
</dl>
<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.Environment.action_space">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">action_space</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#mindspore_rl.environment.Space" title="mindspore_rl.environment.space.Space"><span class="pre">mindspore_rl.environment.space.Space</span></a></em><a class="headerlink" href="#mindspore_rl.environment.Environment.action_space" title="Permalink to this definition"></a></dt>
<dd><p>Get the action space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>action_space (Space), The action space of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.Environment.batched">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">batched</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v3.8)"><span class="pre">bool</span></a></em><a class="headerlink" href="#mindspore_rl.environment.Environment.batched" title="Permalink to this definition"></a></dt>
<dd><p>Whether the environment is batched.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>batched (bool), Whether the environment is batched. Default is <code class="docutils literal notranslate"><span class="pre">False</span></code> .</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.environment.Environment.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/environment.html#Environment.close"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.Environment.close" title="Permalink to this definition"></a></dt>
<dd><p>Close the environment to release the resource.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Success (np.bool_), Whether shutdown the process or threading successfully.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.Environment.config">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">config</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/library/stdtypes.html#dict" title="(in Python v3.8)"><span class="pre">dict</span></a></em><a class="headerlink" href="#mindspore_rl.environment.Environment.config" title="Permalink to this definition"></a></dt>
<dd><p>Get the config of environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>config (dict), A dictionary which contains environment’s info.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.Environment.done_space">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">done_space</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#mindspore_rl.environment.Space" title="mindspore_rl.environment.space.Space"><span class="pre">mindspore_rl.environment.space.Space</span></a></em><a class="headerlink" href="#mindspore_rl.environment.Environment.done_space" title="Permalink to this definition"></a></dt>
<dd><p>Get the done space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>done_space (Space), The done space of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.Environment.num_agent">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_agent</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><span class="pre">int</span></a></em><a class="headerlink" href="#mindspore_rl.environment.Environment.num_agent" title="Permalink to this definition"></a></dt>
<dd><p>Number of agents in the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><dl class="simple">
<dt>num_agent (int), Number of agent in the current environment. If the environment is</dt><dd><p>single agent, it will return <code class="docutils literal notranslate"><span class="pre">1</span></code> . Otherwise, subclass needs to override this property
to return correct number of agent. Default: <code class="docutils literal notranslate"><span class="pre">1</span></code> .</p>
</dd>
</dl>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.Environment.num_environment">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_environment</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><span class="pre">int</span></a></em><a class="headerlink" href="#mindspore_rl.environment.Environment.num_environment" title="Permalink to this definition"></a></dt>
<dd><p>Number of environment</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>num_env (int),  Number of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.Environment.observation_space">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">observation_space</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#mindspore_rl.environment.Space" title="mindspore_rl.environment.space.Space"><span class="pre">mindspore_rl.environment.space.Space</span></a></em><a class="headerlink" href="#mindspore_rl.environment.Environment.observation_space" title="Permalink to this definition"></a></dt>
<dd><p>Get the state space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>observation_space (Space), The state space of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.environment.Environment.recv">
<span class="sig-name descname"><span class="pre">recv</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/environment.html#Environment.recv"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.Environment.recv" title="Permalink to this definition"></a></dt>
<dd><p>Receive the result of interacting with environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>state (Union[np.ndarray, Tensor]), The environment state after performing the action.</p></li>
<li><p>reward (Union[np.ndarray, Tensor]), The reward after performing the action.</p></li>
<li><p>done (Union[np.ndarray, Tensor]), whether the simulation finishes or not.</p></li>
<li><p>env_id (Union[np.ndarray, Tensor]), Which environments are interacted.env</p></li>
<li><p>args (Union[np.ndarray, Tensor], optional), Support arbitrary outputs, but user needs to ensure the
dtype. This output is optional.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.environment.Environment.render">
<span class="sig-name descname"><span class="pre">render</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/environment.html#Environment.render"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.Environment.render" title="Permalink to this definition"></a></dt>
<dd><p>Generate the image for current frame of environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>img (Union[Tensor, np.ndarray]), The image of environment at current frame.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.environment.Environment.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/environment.html#Environment.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.Environment.reset" title="Permalink to this definition"></a></dt>
<dd><p>Reset the environment to the initial state. It is always used at the beginning of each
episode. It will return the value of initial state or other initial information.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p><ul class="simple">
<li><p>state (Union[np.ndarray, Tensor]), A numpy array or Tensor which states for
the initial state of environment.</p></li>
<li><p>args (Union[np.ndarray, Tensor], optional), Support arbitrary outputs, but user needs to ensure the
dtype. This output is optional.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.Environment.reward_space">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">reward_space</span></span><em class="property"><span class="p"><span class="pre">:</span></span><span class="w"> </span><a class="reference internal" href="#mindspore_rl.environment.Space" title="mindspore_rl.environment.space.Space"><span class="pre">mindspore_rl.environment.space.Space</span></a></em><a class="headerlink" href="#mindspore_rl.environment.Environment.reward_space" title="Permalink to this definition"></a></dt>
<dd><p>Get the reward space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>reward_space (Space), The reward space of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.environment.Environment.send">
<span class="sig-name descname"><span class="pre">send</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">np.ndarray</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_id</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">np.ndarray</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/environment.html#Environment.send"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.Environment.send" title="Permalink to this definition"></a></dt>
<dd><p>Execute the environment step asynchronously. User can obtain result by using recv.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>action</strong> (<em>Union</em><em>[</em><em>Tensor</em><em>, </em><em>np.ndarray</em><em>]</em>) – A tensor or array that contains the action information.</p></li>
<li><p><strong>env_id</strong> (<em>Union</em><em>[</em><em>Tensor</em><em>, </em><em>np.ndarray</em><em>]</em>) – Which environment these actions will interact with.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Success (bool), True if the <cite>action</cite> is successfully executed, otherwise False.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.environment.Environment.set_seed">
<span class="sig-name descname"><span class="pre">set_seed</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">seed_value</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><span class="pre">int</span></a><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Sequence</span><span class="p"><span class="pre">[</span></span><a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><span class="pre">int</span></a><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/environment.html#Environment.set_seed"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.Environment.set_seed" title="Permalink to this definition"></a></dt>
<dd><p>Set seed to control the randomness of environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>seed_value</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>Sequence</em><em>[</em><a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>]</em><em>]</em>) – The value that is used to set.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Success (np.bool_), Whether successfully set the seed.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.environment.Environment.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Union</span><span class="p"><span class="pre">[</span></span><span class="pre">Tensor</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">np.ndarray</span><span class="p"><span class="pre">]</span></span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/environment.html#Environment.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.Environment.step" title="Permalink to this definition"></a></dt>
<dd><p>Execute the environment step, which means that interact with environment once.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>action</strong> (<em>Union</em><em>[</em><em>Tensor</em><em>, </em><em>np.ndarray</em><em>]</em>) – A tensor that contains the action information.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>state (Union[np.ndarray, Tensor]), The environment state after performing the action.</p></li>
<li><p>reward (Union[np.ndarray, Tensor]), The reward after performing the action.</p></li>
<li><p>done (Union[np.ndarray, Tensor]), Whether the simulation finishes or not.</p></li>
<li><p>args (Union[np.ndarray, Tensor], optional), Support arbitrary outputs, but user needs to ensure the
dtype. This output is optional.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.environment.EnvironmentProcess">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.environment.</span></span><span class="sig-name descname"><span class="pre">EnvironmentProcess</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">proc_no</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_num</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">envs</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">actions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_states</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/env_process.html#EnvironmentProcess"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.EnvironmentProcess" title="Permalink to this definition"></a></dt>
<dd><p>An independent process responsible for creating and interacting with one or more environments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>proc_no</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The process number assigned by the caller.</p></li>
<li><p><strong>env_num</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The number of input environments.</p></li>
<li><p><strong>envs</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em>(</em><a class="reference internal" href="#mindspore_rl.environment.Environment" title="mindspore_rl.environment.Environment"><em>Environment</em></a><em>)</em>) – A list that contains instance of environment (subclass of Environment).</p></li>
<li><p><strong>actions</strong> (<em>Queue</em>) – The queue used to pass actions to the environment process.</p></li>
<li><p><strong>observations</strong> (<em>Queue</em>) – The queue used to pass observations to the caller process.</p></li>
<li><p><strong>initial_states</strong> (<em>Queue</em>) – The queue used to pass initial states to the caller process.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">multiprocessing</span> <span class="kn">import</span> <span class="n">Queue</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">actions</span> <span class="o">=</span> <span class="n">Queue</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">observations</span> <span class="o">=</span> <span class="n">Queue</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">initial_states</span> <span class="o">=</span> <span class="n">Queue</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">proc_no</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">env_num</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">env_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;CartPole-v0&#39;</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">multi_env</span> <span class="o">=</span> <span class="p">[</span><span class="n">GymEnvironment</span><span class="p">(</span><span class="n">env_params</span><span class="p">),</span> <span class="n">GymEnvironment</span><span class="p">(</span><span class="n">env_params</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">env_proc</span> <span class="o">=</span> <span class="n">EnvironmentProcess</span><span class="p">(</span><span class="n">proc_no</span><span class="p">,</span> <span class="n">env_num</span><span class="p">,</span> <span class="n">multi_env</span><span class="p">,</span> <span class="n">actions</span><span class="p">,</span> <span class="n">observations</span><span class="p">,</span> <span class="n">initial_states</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">env_proc</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.environment.EnvironmentProcess.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/env_process.html#EnvironmentProcess.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.EnvironmentProcess.run" title="Permalink to this definition"></a></dt>
<dd><p>Method to be run in sub-process; can be overridden in sub-class</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.environment.GymEnvironment">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.environment.</span></span><span class="sig-name descname"><span class="pre">GymEnvironment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/gym_environment.html#GymEnvironment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.GymEnvironment" title="Permalink to this definition"></a></dt>
<dd><p>The GymEnvironment class is a wrapper that encapsulates <a class="reference external" href="https://gym.openai.com/">Gym</a> to
provide the ability to interact with Gym environments in MindSpore Graph Mode.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – <p>A dictionary contains all the parameters which are used in this class.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 52%" />
<col style="width: 48%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Configuration Parameters</p></th>
<th class="head"><p>Notices</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>name</p></td>
<td><p>the name of game in Gym</p></td>
</tr>
<tr class="row-odd"><td><p>seed</p></td>
<td><p>seed used in Gym</p></td>
</tr>
</tbody>
</table>
</p></li>
<li><p><strong>env_id</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>optional</em>) – A integer which is used to set the seed of this environment,
default value means the 0th environment. Default: <code class="docutils literal notranslate"><span class="pre">0</span></code> .</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Supported Platforms:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">Ascend</span></code> <code class="docutils literal notranslate"><span class="pre">GPU</span></code> <code class="docutils literal notranslate"><span class="pre">CPU</span></code></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">env_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;CartPole-v0&#39;</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">environment</span> <span class="o">=</span> <span class="n">GymEnvironment</span><span class="p">(</span><span class="n">env_params</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">environment</span><span class="p">)</span>
<span class="go">GymEnvironment&lt;&gt;</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.environment.GymEnvironment.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/gym_environment.html#GymEnvironment.close"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.GymEnvironment.close" title="Permalink to this definition"></a></dt>
<dd><p>Close the environment to release the resource.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Success(np.bool_), Whether shutdown the process or threading successfully.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.environment.MsEnvironment">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.environment.</span></span><span class="sig-name descname"><span class="pre">MsEnvironment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/ms_environment.html#MsEnvironment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.MsEnvironment" title="Permalink to this definition"></a></dt>
<dd><p>Class encapsulates built-in environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kwargs</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – <p>The dictionary of environment specific configurations. See below table for details:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 21%" />
<col style="width: 31%" />
<col style="width: 19%" />
<col style="width: 29%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Environment name</p></th>
<th class="head"><p>Configuration Parameters</p></th>
<th class="head"><p>Default value</p></th>
<th class="head"><p>Notices</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td rowspan="10"><p>Tag</p></td>
<td><p>seed</p></td>
<td><p>42</p></td>
<td><p>random seed</p></td>
</tr>
<tr class="row-odd"><td><p>environment_num</p></td>
<td><p>2</p></td>
<td><p>number of environments</p></td>
</tr>
<tr class="row-even"><td><p>predator_num</p></td>
<td><p>10</p></td>
<td><p>number of predators</p></td>
</tr>
<tr class="row-odd"><td><p>max_timestep</p></td>
<td><p>100</p></td>
<td><p>max timestep per episode</p></td>
</tr>
<tr class="row-even"><td><p>map_length</p></td>
<td><p>100</p></td>
<td><p>length of map</p></td>
</tr>
<tr class="row-odd"><td><p>map_width</p></td>
<td><p>100</p></td>
<td><p>width of map</p></td>
</tr>
<tr class="row-even"><td><p>wall_hit_penalty</p></td>
<td><p>0.1</p></td>
<td><p>agent wall hit penalty</p></td>
</tr>
<tr class="row-odd"><td><p>catch_reward</p></td>
<td><p>10</p></td>
<td><p>predator catch reward</p></td>
</tr>
<tr class="row-even"><td><p>caught_penalty</p></td>
<td><p>5</p></td>
<td><p>prey caught penalty</p></td>
</tr>
<tr class="row-odd"><td><p>step_cost</p></td>
<td><p>0.01</p></td>
<td><p>step cost</p></td>
</tr>
</tbody>
</table>
</p>
</dd>
</dl>
<dl class="simple">
<dt>Supported Platforms:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">GPU</span></code></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">config</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Tag&#39;</span><span class="p">,</span> <span class="s1">&#39;predator_num&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">env</span> <span class="o">=</span> <span class="n">MsEnvironment</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">observation</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">action</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">action_space</span><span class="o">.</span><span class="n">sample</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">observation</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">done</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">observation</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(2, 5, 21)</span>
</pre></div>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.MsEnvironment.action_space">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">action_space</span></span><a class="headerlink" href="#mindspore_rl.environment.MsEnvironment.action_space" title="Permalink to this definition"></a></dt>
<dd><p>Get the valid action space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The action space of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.MsEnvironment.config">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">config</span></span><a class="headerlink" href="#mindspore_rl.environment.MsEnvironment.config" title="Permalink to this definition"></a></dt>
<dd><p>Get environment configuration.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The configuration of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.MsEnvironment.done_space">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">done_space</span></span><a class="headerlink" href="#mindspore_rl.environment.MsEnvironment.done_space" title="Permalink to this definition"></a></dt>
<dd><p>Get the valid done space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The done space of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.MsEnvironment.observation_space">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">observation_space</span></span><a class="headerlink" href="#mindspore_rl.environment.MsEnvironment.observation_space" title="Permalink to this definition"></a></dt>
<dd><p>Get the valid observation space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The state space of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.environment.MsEnvironment.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/ms_environment.html#MsEnvironment.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.MsEnvironment.reset" title="Permalink to this definition"></a></dt>
<dd><p>Reset the environment to initial observation and return the initial observation.</p>
<dl class="simple">
<dt>Inputs:</dt><dd><p>No inputs.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Tensor, the initial observation.</p>
</dd>
</dl>
<dl class="simple">
<dt>Supported Platforms:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">GPU</span></code></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">config</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Tag&#39;</span><span class="p">,</span> <span class="s1">&#39;predator_num&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">env</span> <span class="o">=</span> <span class="n">MsEnvironment</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">observation</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">observation</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(2, 5, 21)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.MsEnvironment.reward_space">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">reward_space</span></span><a class="headerlink" href="#mindspore_rl.environment.MsEnvironment.reward_space" title="Permalink to this definition"></a></dt>
<dd><p>Get the valid reward space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The reward space of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.environment.MsEnvironment.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/ms_environment.html#MsEnvironment.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.MsEnvironment.step" title="Permalink to this definition"></a></dt>
<dd><p>Run one timestep of environment to interact with environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>action</strong> (<em>Tensor</em>) – Action provided by the all of agents.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>Tuple of 3 tensors, the observation, the reward and the done.</p>
<ul class="simple">
<li><p><strong>observation</strong> (Tensor) - Observations of all agents after action.</p></li>
<li><p><strong>reward</strong> (Tensor) - Amount of reward returned by the environment.</p></li>
<li><p><strong>done</strong> (Tensor) - Whether the episode has ended.</p></li>
</ul>
</p>
</dd>
</dl>
<dl class="simple">
<dt>Supported Platforms:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">GPU</span></code></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">config</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Tag&#39;</span><span class="p">,</span> <span class="s1">&#39;predator_num&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">env</span> <span class="o">=</span> <span class="n">MsEnvironment</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">observation</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">action</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">action_space</span><span class="o">.</span><span class="n">sample</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">observation</span><span class="p">,</span> <span class="n">reward</span><span class="p">,</span> <span class="n">done</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">observation</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(2, 5, 21)</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.environment.MultiEnvironmentWrapper">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.environment.</span></span><span class="sig-name descname"><span class="pre">MultiEnvironmentWrapper</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env_instance</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_proc</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/multi_environment_wrapper.html#MultiEnvironmentWrapper"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.MultiEnvironmentWrapper" title="Permalink to this definition"></a></dt>
<dd><p>The MultiEnvironmentWrapper is a wrapper for multi environment scenario. User implements
their single environment class and set the environment number larger than 1 in configuration
file, framework will automatically invoke this class to create a multi environment class.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env_instance</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em>[</em><a class="reference internal" href="#mindspore_rl.environment.Environment" title="mindspore_rl.environment.Environment"><em>Environment</em></a><em>]</em>) – A list that contains instance of environment (subclass of Environment).</p></li>
<li><p><strong>num_proc</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>optional</em>) – Number of processing uses during interacting with environment. Default: <code class="docutils literal notranslate"><span class="pre">1</span></code> .</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Supported Platforms:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">Ascend</span></code> <code class="docutils literal notranslate"><span class="pre">GPU</span></code> <code class="docutils literal notranslate"><span class="pre">CPU</span></code></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">env_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;CartPole-v0&#39;</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">multi_env</span> <span class="o">=</span> <span class="p">[</span><span class="n">GymEnvironment</span><span class="p">(</span><span class="n">env_params</span><span class="p">),</span> <span class="n">GymEnvironment</span><span class="p">(</span><span class="n">env_params</span><span class="p">)]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">wrapper</span> <span class="o">=</span> <span class="n">MultiEnvironmentWrapper</span><span class="p">(</span><span class="n">multi_env</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">wrapper</span><span class="p">)</span>
<span class="go">MultiEnvironmentWrapper&lt;&gt;</span>
</pre></div>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.MultiEnvironmentWrapper.action_space">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">action_space</span></span><a class="headerlink" href="#mindspore_rl.environment.MultiEnvironmentWrapper.action_space" title="Permalink to this definition"></a></dt>
<dd><p>Get the action space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tuple which states for the space of action.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.environment.MultiEnvironmentWrapper.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/multi_environment_wrapper.html#MultiEnvironmentWrapper.close"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.MultiEnvironmentWrapper.close" title="Permalink to this definition"></a></dt>
<dd><p>Close the environment to release the resource.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Success(np.bool_), Whether shutdown the process or threading successfully.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.MultiEnvironmentWrapper.config">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">config</span></span><a class="headerlink" href="#mindspore_rl.environment.MultiEnvironmentWrapper.config" title="Permalink to this definition"></a></dt>
<dd><p>Get the config of environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A dictionary which contains environment’s info.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.MultiEnvironmentWrapper.done_space">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">done_space</span></span><a class="headerlink" href="#mindspore_rl.environment.MultiEnvironmentWrapper.done_space" title="Permalink to this definition"></a></dt>
<dd><p>Get the done space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tuple which states for the space of done.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.MultiEnvironmentWrapper.observation_space">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">observation_space</span></span><a class="headerlink" href="#mindspore_rl.environment.MultiEnvironmentWrapper.observation_space" title="Permalink to this definition"></a></dt>
<dd><p>Get the state space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tuple which states for the space of state.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.environment.MultiEnvironmentWrapper.render">
<span class="sig-name descname"><span class="pre">render</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/multi_environment_wrapper.html#MultiEnvironmentWrapper.render"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.MultiEnvironmentWrapper.render" title="Permalink to this definition"></a></dt>
<dd><p>Render the game. Only support on PyNative mode.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.environment.MultiEnvironmentWrapper.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/multi_environment_wrapper.html#MultiEnvironmentWrapper.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.MultiEnvironmentWrapper.reset" title="Permalink to this definition"></a></dt>
<dd><p>Reset the environment to the initial state. It is always used at the beginning of each
episode. It will return the value of initial state of each environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A list of tensor which states for all the initial states of each environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.MultiEnvironmentWrapper.reward_space">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">reward_space</span></span><a class="headerlink" href="#mindspore_rl.environment.MultiEnvironmentWrapper.reward_space" title="Permalink to this definition"></a></dt>
<dd><p>Get the reward space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tuple which states for the space of reward.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.environment.MultiEnvironmentWrapper.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/multi_environment_wrapper.html#MultiEnvironmentWrapper.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.MultiEnvironmentWrapper.step" title="Permalink to this definition"></a></dt>
<dd><p>Execute the environment step, which means that interact with environment once.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>action</strong> (<em>Tensor</em>) – A tensor that contains the action information.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>state (list(Tensor)), a list of environment state after performing the action.</p></li>
<li><p>reward (list(Tensor)), a list of reward after performing the action.</p></li>
<li><p>done (list(Tensor)), whether the simulations of each environment finishes or not.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.environment.PettingZooMPEEnvironment">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.environment.</span></span><span class="sig-name descname"><span class="pre">PettingZooMPEEnvironment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/petting_zoo_mpe_environment.html#PettingZooMPEEnvironment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.PettingZooMPEEnvironment" title="Permalink to this definition"></a></dt>
<dd><p>The PettingZooMPEEnvironment class is a wrapper that encapsulates
<a class="reference external" href="https://pettingzoo.farama.org/environments/mpe/">PettingZoo</a> to
provide the ability to interact with PettingZoo environments in MindSpore Graph Mode.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – <p>A dictionary contains all the parameters which are used in this class.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 49%" />
<col style="width: 51%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Configuration Parameters</p></th>
<th class="head"><p>Notices</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>scenario_name</p></td>
<td><p>the name of game</p></td>
</tr>
<tr class="row-odd"><td><p>num</p></td>
<td><p>Number of Environment</p></td>
</tr>
<tr class="row-even"><td><p>continuous_actions</p></td>
<td><p>type of actions space</p></td>
</tr>
</tbody>
</table>
</p></li>
<li><p><strong>env_id</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>optional</em>) – A integer which is used to set the seed of this environment,
default value means the 0th environment. Default: <code class="docutils literal notranslate"><span class="pre">0</span></code> .</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Supported Platforms:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">Ascend</span></code> <code class="docutils literal notranslate"><span class="pre">GPU</span></code> <code class="docutils literal notranslate"><span class="pre">CPU</span></code></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">env_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;simple_spread&#39;</span><span class="p">,</span> <span class="s1">&#39;num&#39;</span><span class="p">:</span> <span class="mi">3</span><span class="p">,</span> <span class="s1">&#39;continuous_actions&#39;</span><span class="p">:</span> <span class="kc">False</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">environment</span> <span class="o">=</span> <span class="n">PettingZooMPEEnvironment</span><span class="p">(</span><span class="n">env_params</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">environment</span><span class="p">)</span>
<span class="go">PettingZooMPEEnvironment&lt;&gt;</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.environment.PettingZooMPEEnvironment.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/petting_zoo_mpe_environment.html#PettingZooMPEEnvironment.close"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.PettingZooMPEEnvironment.close" title="Permalink to this definition"></a></dt>
<dd><p>Close the environment to release the resource.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Success(np.bool_), Whether shutdown the process or threading successfully.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.environment.Space">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.environment.</span></span><span class="sig-name descname"><span class="pre">Space</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feature_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">low</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">high</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">mask</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/space.html#Space"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.Space" title="Permalink to this definition"></a></dt>
<dd><p>The class for environment action/observation space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>feature_shape</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em>(</em><a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>)</em><em>, </em><a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em>(</em><a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>)</em><em>, </em><a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>]</em>) – The action/observation shape before batching.</p></li>
<li><p><strong>dtype</strong> (<em>np.dtype</em>) – The action/observation space dtype.</p></li>
<li><p><strong>low</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a><em>]</em><em>, </em><em>optional</em>) – The action/observation space lower boundary. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code> .</p></li>
<li><p><strong>high</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a><em>]</em><em>, </em><em>optional</em>) – The action/observation space upper boundary. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code> .</p></li>
<li><p><strong>batch_shape</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em>(</em><a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>)</em><em>, </em><a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em>(</em><a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>)</em><em>, </em><a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>]</em><em>, </em><em>optional</em>) – The batch shape for vectorization.
It usually be used in multi-environment and multi-agent cases. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code> .</p></li>
<li><p><strong>mask</strong> (<em>Sequence</em><em>[</em><a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>]</em><em>, </em><em>optional</em>) – The mask for discrete action space. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code> .</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">action_space</span> <span class="o">=</span> <span class="n">Space</span><span class="p">(</span><span class="n">feature_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">action_space</span><span class="o">.</span><span class="n">ms_dtype</span><span class="p">)</span>
<span class="go">Int32</span>
</pre></div>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.Space.boundary">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">boundary</span></span><a class="headerlink" href="#mindspore_rl.environment.Space.boundary" title="Permalink to this definition"></a></dt>
<dd><p>The space boundary of current Space.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Uppoer and lower boundary of current space.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.Space.is_discrete">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_discrete</span></span><a class="headerlink" href="#mindspore_rl.environment.Space.is_discrete" title="Permalink to this definition"></a></dt>
<dd><p>Is discrete space.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Whether the current space is discrete or continuous.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.Space.ms_dtype">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ms_dtype</span></span><a class="headerlink" href="#mindspore_rl.environment.Space.ms_dtype" title="Permalink to this definition"></a></dt>
<dd><p>MindSpore data type of current Space.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The mindspore data type of current space.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.Space.np_dtype">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">np_dtype</span></span><a class="headerlink" href="#mindspore_rl.environment.Space.np_dtype" title="Permalink to this definition"></a></dt>
<dd><p>Numpy data type of current Space.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The numpy dtype of current space.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.Space.num_values">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_values</span></span><a class="headerlink" href="#mindspore_rl.environment.Space.num_values" title="Permalink to this definition"></a></dt>
<dd><p>available action number of current Space.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The available action of current space.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.environment.Space.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/space.html#Space.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.Space.sample" title="Permalink to this definition"></a></dt>
<dd><p>Sample a valid action from the space</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Tensor, a valid action.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.Space.shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">shape</span></span><a class="headerlink" href="#mindspore_rl.environment.Space.shape" title="Permalink to this definition"></a></dt>
<dd><p>Space shape after batching.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The shape of current space.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.environment.StarCraft2Environment">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.environment.</span></span><span class="sig-name descname"><span class="pre">StarCraft2Environment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/sc2_environment.html#StarCraft2Environment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.StarCraft2Environment" title="Permalink to this definition"></a></dt>
<dd><p>StarCraft2Environment is a wrapper of SMAC. SMAC is WhiRL’s environment for research in the
field of collaborative multi-agent reinforcement learning (MARL) based on Blizzard’s
StarCraft II RTS game. SMAC makes use of Blizzard’s StarCraft II Machine Learning API and
DeepMind’s PySC2 to provide a convenient interface for autonomous agents to interact with
StarCraft II, getting observations and performing actions. More detail please have a look
at the official github of SMAC: <a class="reference external" href="https://github.com/oxwhirl/smac">https://github.com/oxwhirl/smac</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – <p>A dictionary contains all the parameters which are used in this class.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 35%" />
<col style="width: 65%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Configuration Parameters</p></th>
<th class="head"><p>Notices</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>sc2_args</p></td>
<td><p>a dict which contains key value that is used to create
instance of SMAC, such as map_name. For more detail
please have a look at its official github.</p></td>
</tr>
</tbody>
</table>
</p></li>
<li><p><strong>env_id</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>optional</em>) – A integer which is used to set the seed of this environment,
default value means the 0th environment. Default: <code class="docutils literal notranslate"><span class="pre">0</span></code> .</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Supported Platforms:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">Ascend</span></code> <code class="docutils literal notranslate"><span class="pre">GPU</span></code> <code class="docutils literal notranslate"><span class="pre">CPU</span></code></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">env_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;sc2_args&#39;</span><span class="p">:</span> <span class="p">{</span><span class="s1">&#39;map_name&#39;</span><span class="p">:</span> <span class="s1">&#39;2s3z&#39;</span><span class="p">}}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">environment</span> <span class="o">=</span> <span class="n">StarCraft2Environment</span><span class="p">(</span><span class="n">env_params</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">environment</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.environment.StarCraft2Environment.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/sc2_environment.html#StarCraft2Environment.close"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.StarCraft2Environment.close" title="Permalink to this definition"></a></dt>
<dd><p>Close the environment to release the resource.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Success(np.bool_), Whether shutdown the process or threading successfully.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.environment.TicTacToeEnvironment">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.environment.</span></span><span class="sig-name descname"><span class="pre">TicTacToeEnvironment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_id</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/tic_tac_toe_environment.html#TicTacToeEnvironment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.TicTacToeEnvironment" title="Permalink to this definition"></a></dt>
<dd><p>Tic-Tac-Toe is a famous paper-and-pencil game (<a class="reference external" href="https://en.wikipedia.org/wiki/Tic-tac-toe">https://en.wikipedia.org/wiki/Tic-tac-toe</a>). The rule is that two
players draw Os or Xs in a three-by-tree grid. When three of their marks are in a Horizontal, vertical or diagonal
row, that player will be the winner. The following figure is an example of Tic-Tac-Toe.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<tbody>
<tr class="row-odd"><td><p>o</p></td>
<td></td>
<td><p>x</p></td>
</tr>
<tr class="row-even"><td><p>x</p></td>
<td><p>o</p></td>
<td></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>x</p></td>
<td><p>o</p></td>
</tr>
</tbody>
</table>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>params</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – A dictionary contains all the parameters which are used in this class.</p></li>
<li><p><strong>env_id</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>optional</em>) – A integer which is used to set the seed of this environment,
default value means the 0th environment. Default: <code class="docutils literal notranslate"><span class="pre">0</span></code> .</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Supported Platforms:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">Ascend</span></code> <code class="docutils literal notranslate"><span class="pre">GPU</span></code> <code class="docutils literal notranslate"><span class="pre">CPU</span></code></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.environment</span> <span class="kn">import</span> <span class="n">TicTacToeEnvironment</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">env_params</span> <span class="o">=</span> <span class="p">{}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">environment</span> <span class="o">=</span> <span class="n">TicTacToeEnvironment</span><span class="p">(</span><span class="n">env_params</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">environment</span><span class="p">)</span>
<span class="go">TicTacToeEnvironment&lt;&gt;</span>
</pre></div>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.TicTacToeEnvironment.action_space">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">action_space</span></span><a class="headerlink" href="#mindspore_rl.environment.TicTacToeEnvironment.action_space" title="Permalink to this definition"></a></dt>
<dd><p>Get the action space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The action space of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.environment.TicTacToeEnvironment.calculate_rewards">
<span class="sig-name descname"><span class="pre">calculate_rewards</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/tic_tac_toe_environment.html#TicTacToeEnvironment.calculate_rewards"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.TicTacToeEnvironment.calculate_rewards" title="Permalink to this definition"></a></dt>
<dd><p>Return the rewards of current state.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tensor which states for the rewards of current state.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.TicTacToeEnvironment.config">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">config</span></span><a class="headerlink" href="#mindspore_rl.environment.TicTacToeEnvironment.config" title="Permalink to this definition"></a></dt>
<dd><p>Get the config of environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A dictionary which contains environment’s info.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.environment.TicTacToeEnvironment.current_player">
<span class="sig-name descname"><span class="pre">current_player</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/tic_tac_toe_environment.html#TicTacToeEnvironment.current_player"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.TicTacToeEnvironment.current_player" title="Permalink to this definition"></a></dt>
<dd><p>Return the current player of current state.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tensor which states for current player.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.TicTacToeEnvironment.done_space">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">done_space</span></span><a class="headerlink" href="#mindspore_rl.environment.TicTacToeEnvironment.done_space" title="Permalink to this definition"></a></dt>
<dd><p>Get the done space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The done space of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.environment.TicTacToeEnvironment.is_terminal">
<span class="sig-name descname"><span class="pre">is_terminal</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/tic_tac_toe_environment.html#TicTacToeEnvironment.is_terminal"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.TicTacToeEnvironment.is_terminal" title="Permalink to this definition"></a></dt>
<dd><p>Return whether the current state is terminal.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>whether the current state is terminal or not.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.environment.TicTacToeEnvironment.legal_action">
<span class="sig-name descname"><span class="pre">legal_action</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/tic_tac_toe_environment.html#TicTacToeEnvironment.legal_action"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.TicTacToeEnvironment.legal_action" title="Permalink to this definition"></a></dt>
<dd><p>Return the legal action of current state.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tensor which states for the legal action.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.environment.TicTacToeEnvironment.load">
<span class="sig-name descname"><span class="pre">load</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/tic_tac_toe_environment.html#TicTacToeEnvironment.load"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.TicTacToeEnvironment.load" title="Permalink to this definition"></a></dt>
<dd><p>Load the input state. It will update the legal action, current state and done info of the game to the
input checkpoint.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>state</strong> (<em>Tensor</em>) – The input checkpoint state.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>state (Tensor), the state of checkpoint.</p></li>
<li><p>reward (Tensor), the reward of checkpoint.</p></li>
<li><p>done (Tensor), whether the checkpoint is terminal.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.environment.TicTacToeEnvironment.max_utility">
<span class="sig-name descname"><span class="pre">max_utility</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/tic_tac_toe_environment.html#TicTacToeEnvironment.max_utility"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.TicTacToeEnvironment.max_utility" title="Permalink to this definition"></a></dt>
<dd><p>Return the max utility of Tic-Tac-Toe.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tensor which states for max utility.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.TicTacToeEnvironment.observation_space">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">observation_space</span></span><a class="headerlink" href="#mindspore_rl.environment.TicTacToeEnvironment.observation_space" title="Permalink to this definition"></a></dt>
<dd><p>Get the state space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The state space of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.environment.TicTacToeEnvironment.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/tic_tac_toe_environment.html#TicTacToeEnvironment.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.TicTacToeEnvironment.reset" title="Permalink to this definition"></a></dt>
<dd><p>Reset the environment to the initial state. It is always used at the beginning of each
episode. It will return the value of initial state.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A Tensor which states for initial state.</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.TicTacToeEnvironment.reward_space">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">reward_space</span></span><a class="headerlink" href="#mindspore_rl.environment.TicTacToeEnvironment.reward_space" title="Permalink to this definition"></a></dt>
<dd><p>Get the reward space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>The reward space of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.environment.TicTacToeEnvironment.save">
<span class="sig-name descname"><span class="pre">save</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/tic_tac_toe_environment.html#TicTacToeEnvironment.save"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.TicTacToeEnvironment.save" title="Permalink to this definition"></a></dt>
<dd><p>Return a repilca of environment. Tic-Tac-Toe do not need a replica, thus it will return the current
state</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tensor which states for the current state.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.environment.TicTacToeEnvironment.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/tic_tac_toe_environment.html#TicTacToeEnvironment.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.TicTacToeEnvironment.step" title="Permalink to this definition"></a></dt>
<dd><p>Execute the environment step, which means that interact with environment once.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>action</strong> (<em>Tensor</em>) – A tensor that contains the action information.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>state (Tensor), the environment state after performing the action.</p></li>
<li><p>reward (Tensor), the reward after performing the action.</p></li>
<li><p>done (Tensor), whether the simulation finishes or not.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.environment.TicTacToeEnvironment.total_num_player">
<span class="sig-name descname"><span class="pre">total_num_player</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/tic_tac_toe_environment.html#TicTacToeEnvironment.total_num_player"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.TicTacToeEnvironment.total_num_player" title="Permalink to this definition"></a></dt>
<dd><p>Return the total number of player</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Tensor, the total number of player.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-mindspore_rl.network">
<span id="mindspore-rl-network"></span><h2>mindspore_rl.network<a class="headerlink" href="#module-mindspore_rl.network" title="Permalink to this headline"></a></h2>
<p>Network component used to implement polices.</p>
<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.network.FullyConnectedLayers">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.network.</span></span><span class="sig-name descname"><span class="pre">FullyConnectedLayers</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">fc_layer_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout_layer_params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation_fn</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">nn.ReLU()</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'normal'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bias_init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'zeros'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/network/fully_connected_net.html#FullyConnectedLayers"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.network.FullyConnectedLayers" title="Permalink to this definition"></a></dt>
<dd><p>This is a fully connected layers module. User can input abitrary number of <cite>fc_layer_params</cite>, then
this module can create corresponding number of fully connect layers.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>fc_layer_params</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>]</em>) – A list of int states for the input and output size of fully
connected layer. For example, if the input list is [10, 20, 3], then the module will
create two fully connected layers whose input and output size are (10, 20) and (20, 3)
respectively. The length of <cite>fc_layer_params</cite> should be greater than or equal to 3.</p></li>
<li><p><strong>dropout_layer_params</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a><em>]</em>) – A list of float states for the dropout rate. If the input
list if [0.5, 0.3], then two dropout layers will be created after each fully connected
layer. The length of <cite>dropout_layer_params</cite> should be one less than <cite>fc_layer_params</cite>.
<cite>dropout_layer_params</cite> is a optional value. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code> .</p></li>
<li><p><strong>activation_fn</strong> (<em>Union</em><em>[</em><a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a><em>, </em><em>Cell</em><em>, </em><em>Primitive</em><em>]</em>) – An instance of activation function.
Default: <code class="docutils literal notranslate"><span class="pre">nn.ReLu()</span></code> .</p></li>
<li><p><strong>weight_init</strong> (<em>Union</em><em>[</em><em>Tensor</em><em>, </em><a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a><em>, </em><em>Initializer</em><em>, </em><a class="reference external" href="https://docs.python.org/library/numbers.html#numbers.Number" title="(in Python v3.8)"><em>numbers.Number</em></a><em>]</em>) – The trainable <cite>weight_init</cite> parameter.
The dtype is same as <cite>x</cite>. The values of str refer to the function <cite>initializer</cite>,
e.g.  <code class="docutils literal notranslate"><span class="pre">normal</span></code> , <code class="docutils literal notranslate"><span class="pre">uniform</span></code> . Default: <code class="docutils literal notranslate"><span class="pre">'normal'</span></code> .</p></li>
<li><p><strong>bias_init</strong> (<em>Union</em><em>[</em><em>Tensor</em><em>, </em><a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a><em>, </em><em>Initializer</em><em>, </em><a class="reference external" href="https://docs.python.org/library/numbers.html#numbers.Number" title="(in Python v3.8)"><em>numbers.Number</em></a><em>]</em>) – The trainable <cite>bias_init</cite> parameter. The
dtype is same as <cite>x</cite>. The values of str refer to the function <cite>initializer</cite>,
e.g.  <code class="docutils literal notranslate"><span class="pre">normal</span></code> , <code class="docutils literal notranslate"><span class="pre">uniform</span></code> . Default: <code class="docutils literal notranslate"><span class="pre">'zeros'</span></code> .</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Inputs:</dt><dd><ul class="simple">
<li><p><strong>x</strong> (Tensor) - Tensor of shape <span class="math notranslate nohighlight">\((*, fc\_layers\_params[0])\)</span>.</p></li>
</ul>
</dd>
<dt>Outputs:</dt><dd><p>Tensor of shape <span class="math notranslate nohighlight">\((*, fc\_layers\_params[-1])\)</span>.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore</span> <span class="kn">import</span> <span class="n">Tensor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.network.fully_connected_net</span> <span class="kn">import</span> <span class="n">FullyConnectedLayers</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">input</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">net</span> <span class="o">=</span> <span class="n">FullyConnectedLayers</span><span class="p">(</span><span class="n">fc_layer_params</span><span class="o">=</span><span class="p">[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">net</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(2, 2)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.network.FullyConnectedLayers.construct">
<span class="sig-name descname"><span class="pre">construct</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/network/fully_connected_net.html#FullyConnectedLayers.construct"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.network.FullyConnectedLayers.construct" title="Permalink to this definition"></a></dt>
<dd><dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> (<em>Tensor</em>) – Tensor of shape <span class="math notranslate nohighlight">\((*, fc\_layers\_params[0])\)</span>.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Tensor of shape <span class="math notranslate nohighlight">\((*, fc\_layers\_params[-1])\)</span>.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.network.FullyConnectedNet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.network.</span></span><span class="sig-name descname"><span class="pre">FullyConnectedNet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">mstype.float32</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/network/fully_connected_net.html#FullyConnectedNet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.network.FullyConnectedNet" title="Permalink to this definition"></a></dt>
<dd><p>A basic fully connected neural network.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_size</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – numbers of input size.</p></li>
<li><p><strong>hidden_size</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – numbers of hidden layers.</p></li>
<li><p><strong>output_size</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – numbers of output size.</p></li>
<li><p><strong>compute_type</strong> (<em>mindspore.dtype</em>) – data type used for fully connected layer.
Default: <code class="docutils literal notranslate"><span class="pre">mindspore.dtype.float32</span></code> .</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore</span> <span class="kn">import</span> <span class="n">Tensor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.network.fully_connected_net</span> <span class="kn">import</span> <span class="n">FullyConnectedNet</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">input</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">net</span> <span class="o">=</span> <span class="n">FullyConnectedNet</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">net</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(2, 2)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.network.FullyConnectedNet.construct">
<span class="sig-name descname"><span class="pre">construct</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/network/fully_connected_net.html#FullyConnectedNet.construct"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.network.FullyConnectedNet.construct" title="Permalink to this definition"></a></dt>
<dd><p>Returns output of Dense layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> (<em>Tensor</em>) – Tensor as the input of network.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The output of the Dense layer.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.network.GruNet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.network.</span></span><span class="sig-name descname"><span class="pre">GruNet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'normal'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">has_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_first</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bidirectional</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">enable_fusion</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/network/gru_net.html#GruNet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.network.GruNet" title="Permalink to this definition"></a></dt>
<dd><p>Stacked GRU (Gated Recurrent Unit) layers.</p>
<p>Apply GRU layer to the input.</p>
<p>For detailed information, please refer to
<a class="reference external" href="https://www.mindspore.cn/docs/en/master/api_python/nn/mindspore.nn.GRU.html">mindspore.nn.GRU</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_size</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Number of features of input.</p></li>
<li><p><strong>hidden_size</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Number of features of hidden layer.</p></li>
<li><p><strong>weight_init</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a><em> or </em><em>Initializer</em>) – Initialize method, e.g. <code class="docutils literal notranslate"><span class="pre">'normal'</span></code> , <code class="docutils literal notranslate"><span class="pre">'uniform'</span></code>.
Default: <code class="docutils literal notranslate"><span class="pre">'normal'</span></code> .</p></li>
<li><p><strong>num_layers</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Number of layers of stacked GRU. Default: <code class="docutils literal notranslate"><span class="pre">1</span></code> .</p></li>
<li><p><strong>has_bias</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Whether the cell has bias. Default: <code class="docutils literal notranslate"><span class="pre">True</span></code> .</p></li>
<li><p><strong>batch_first</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Specifies whether the first dimension of input <cite>x</cite> is batch_size. Default: <code class="docutils literal notranslate"><span class="pre">False</span></code> .</p></li>
<li><p><strong>dropout</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – If not <code class="docutils literal notranslate"><span class="pre">0.0</span></code> , append <cite>Dropout</cite> layer on the outputs of each
GRU layer except the last layer. Default <code class="docutils literal notranslate"><span class="pre">0.0</span></code> . The range of dropout is [0.0, 1.0).</p></li>
<li><p><strong>bidirectional</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Specifies whether it is a bidirectional GRU,
num_directions is 2 if <cite>bidirectional</cite> is <code class="docutils literal notranslate"><span class="pre">True</span></code> otherwise 1. Default: <code class="docutils literal notranslate"><span class="pre">False</span></code> .</p></li>
<li><p><strong>enable_fusion</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Whether need to use GRU fusion ops. Default: <code class="docutils literal notranslate"><span class="pre">True</span></code> .</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Inputs:</dt><dd><ul class="simple">
<li><p><strong>x_in</strong> (Tensor) - Tensor of data type mindspore.float32 and
shape <span class="math notranslate nohighlight">\((seq\_len, batch\_size, input\_size)\)</span> or <span class="math notranslate nohighlight">\((batch\_size, seq\_len, input\_size)\)</span>.</p></li>
<li><p><strong>h_in</strong> (Tensor) - Tensor of data type mindspore.float32 and
shape <span class="math notranslate nohighlight">\((num\_directions * num\_layers, batch\_size, hidden\_size)\)</span>. The data type of <cite>h_in</cite>
must be the same as <cite>x_in</cite>.</p></li>
</ul>
</dd>
<dt>Outputs:</dt><dd><p>Tuple, a tuple contains (<cite>x_out</cite>, <cite>h_out</cite>).</p>
<ul class="simple">
<li><p><strong>x_out</strong> (Tensor) - Tensor of shape <span class="math notranslate nohighlight">\((seq\_len, batch\_size, num\_directions * hidden\_size)\)</span> or
<span class="math notranslate nohighlight">\((batch\_size, seq\_len, num\_directions * hidden\_size)\)</span>.</p></li>
<li><p><strong>h_out</strong> (Tensor) - Tensor of shape <span class="math notranslate nohighlight">\((num\_directions * num\_layers, batch\_size, hidden\_size)\)</span>.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">net</span> <span class="o">=</span> <span class="n">GruNet</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">has_bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bidirectional</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x_in</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h_in</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">16</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x_out</span><span class="p">,</span> <span class="n">h_out</span> <span class="o">=</span> <span class="n">net</span><span class="p">(</span><span class="n">x_in</span><span class="p">,</span> <span class="n">h_in</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">x_out</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(3, 5, 16)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.network.GruNet.construct">
<span class="sig-name descname"><span class="pre">construct</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h_in</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/network/gru_net.html#GruNet.construct"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.network.GruNet.construct" title="Permalink to this definition"></a></dt>
<dd><p>The forward calculation of gru net</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_in</strong> (<em>Tensor</em>) – Tensor of data type mindspore.float32 and shape <span class="math notranslate nohighlight">\((seq\_len, batch\_size, input\_size)\)</span>
or <span class="math notranslate nohighlight">\((batch\_size, seq\_len, input\_size)\)</span>.</p></li>
<li><p><strong>h_in</strong> (<em>Tensor</em>) – Tensor of data type mindspore.float32 and shape <span class="math notranslate nohighlight">\((num\_directions * num\_layers,
batch\_size, hidden\_size)\)</span>. The data type of <cite>h_in</cite> must be the same as <cite>x_in</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>x_out</strong> (Tensor) - Tensor of shape <span class="math notranslate nohighlight">\((seq\_len, batch\_size, num\_directions * hidden\_size)\)</span> or
<span class="math notranslate nohighlight">\((batch\_size, seq\_len, num\_directions * hidden\_size)\)</span>.</p></li>
<li><p><strong>h_out</strong> (Tensor) - Tensor of shape <span class="math notranslate nohighlight">\((num\_directions * num\_layers, batch\_size, hidden\_size)\)</span>.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-mindspore_rl.policy">
<span id="mindspore-rl-policy"></span><h2>mindspore_rl.policy<a class="headerlink" href="#module-mindspore_rl.policy" title="Permalink to this headline"></a></h2>
<p>Policies used in RL algorithms.</p>
<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.policy.EpsilonGreedyPolicy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.policy.</span></span><span class="sig-name descname"><span class="pre">EpsilonGreedyPolicy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_network</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsi_high</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsi_low</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decay</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_space_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/policy/epsilon_greedy_policy.html#EpsilonGreedyPolicy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.policy.EpsilonGreedyPolicy" title="Permalink to this definition"></a></dt>
<dd><p>Produces a sample action base on the given epsilon-greedy policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_network</strong> (<em>Cell</em>) – A network returns policy action.</p></li>
<li><p><strong>size</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Shape of epsilon.</p></li>
<li><p><strong>epsi_high</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – A high epsilon for exploration betweens [0, 1].</p></li>
<li><p><strong>epsi_low</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – A low epsilon for exploration betweens [0, epsi_high].</p></li>
<li><p><strong>decay</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – A decay factor applied to epsilon.</p></li>
<li><p><strong>action_space_dim</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Dimensions of the action space.</p></li>
<li><p><strong>shape</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em>, </em><em>optional</em>) – Shape of output action in random policy, it should be the same as action get in
greedy policy. Default: (1,).</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">state_dim</span><span class="p">,</span> <span class="n">hidden_dim</span><span class="p">,</span> <span class="n">action_dim</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_net</span> <span class="o">=</span> <span class="n">FullyConnectedNet</span><span class="p">(</span><span class="n">state_dim</span><span class="p">,</span> <span class="n">hidden_dim</span><span class="p">,</span> <span class="n">action_dim</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">policy</span> <span class="o">=</span> <span class="n">EpsilonGreedyPolicy</span><span class="p">(</span><span class="n">input_net</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">action_dim</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">state</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="n">state_dim</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">step</span> <span class="o">=</span>  <span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">10</span><span class="p">,])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">policy</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(1,)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.policy.EpsilonGreedyPolicy.construct">
<span class="sig-name descname"><span class="pre">construct</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/policy/epsilon_greedy_policy.html#EpsilonGreedyPolicy.construct"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.policy.EpsilonGreedyPolicy.construct" title="Permalink to this definition"></a></dt>
<dd><p>The interface of the construct function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<em>Tensor</em>) – The input tensor for network.</p></li>
<li><p><strong>step</strong> (<em>Tensor</em>) – The current step, effects the epsilon decay.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The output action.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.policy.GreedyPolicy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.policy.</span></span><span class="sig-name descname"><span class="pre">GreedyPolicy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_network</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/policy/greedy_policy.html#GreedyPolicy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.policy.GreedyPolicy" title="Permalink to this definition"></a></dt>
<dd><p>Produces a sample action base on the given greedy policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input_network</strong> (<em>Cell</em>) – network used to generate action probs by input state.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">state_dim</span><span class="p">,</span> <span class="n">hidden_dim</span><span class="p">,</span> <span class="n">action_dim</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_net</span> <span class="o">=</span> <span class="n">FullyConnectedNet</span><span class="p">(</span><span class="n">state_dim</span><span class="p">,</span> <span class="n">hidden_dim</span><span class="p">,</span> <span class="n">action_dim</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">policy</span> <span class="o">=</span> <span class="n">GreedyPolicy</span><span class="p">(</span><span class="n">input_net</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">state</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">policy</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(2,)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.policy.GreedyPolicy.construct">
<span class="sig-name descname"><span class="pre">construct</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/policy/greedy_policy.html#GreedyPolicy.construct"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.policy.GreedyPolicy.construct" title="Permalink to this definition"></a></dt>
<dd><p>Returns the best action.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>state</strong> (<em>Tensor</em>) – State tensor as the input of network.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>action_max, the best action.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.policy.Policy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.policy.</span></span><span class="sig-name descname"><span class="pre">Policy</span></span><a class="reference internal" href="_modules/mindspore_rl/policy/policy.html#Policy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.policy.Policy" title="Permalink to this definition"></a></dt>
<dd><p>The virtual base class for the policy. This class should be overridden before calling in the model.</p>
<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.policy.Policy.construct">
<span class="sig-name descname"><span class="pre">construct</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/policy/policy.html#Policy.construct"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.policy.Policy.construct" title="Permalink to this definition"></a></dt>
<dd><p>The interface of the construct function. Inherited and used by users.
Args can refer to ‘epsilongreedypolicy’, ‘randompolicy’, etc.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong> – it’s depended on the user definition.</p></li>
<li><p><strong>kwargs</strong> – it’s depended on the user definition.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>User defined. Usually, it returns an action value or the probability distribution of an action.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.policy.RandomPolicy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.policy.</span></span><span class="sig-name descname"><span class="pre">RandomPolicy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action_space_dim</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">(1,)</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/policy/random_policy.html#RandomPolicy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.policy.RandomPolicy" title="Permalink to this definition"></a></dt>
<dd><p>Produces a random action betweens [0, <cite>acton_space_dim</cite>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>action_space_dim</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – dimension of the action space.</p></li>
<li><p><strong>shape</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em>, </em><em>optional</em>) – shape of output action in random policy. Default: (1,).</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">action_space_dim</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">policy</span> <span class="o">=</span> <span class="n">RandomPolicy</span><span class="p">(</span><span class="n">action_space_dim</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">policy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(1,)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.policy.RandomPolicy.construct">
<span class="sig-name descname"><span class="pre">construct</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/policy/random_policy.html#RandomPolicy.construct"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.policy.RandomPolicy.construct" title="Permalink to this definition"></a></dt>
<dd><p>Returns a random number betweens [0, <cite>acton_space_dim</cite>).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A random integer betweens [0, <cite>acton_space_dim</cite>).</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="mindspore-rl-utils">
<h2>mindspore_rl.utils<a class="headerlink" href="#mindspore-rl-utils" title="Permalink to this headline"></a></h2>
<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.utils.DiscountedReturn">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.utils.</span></span><span class="sig-name descname"><span class="pre">DiscountedReturn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">gamma</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">need_bprop</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">ms.float32</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/discounted_return.html#DiscountedReturn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.utils.DiscountedReturn" title="Permalink to this definition"></a></dt>
<dd><p>Calculate discounted return.</p>
<p>Set discounted return as <span class="math notranslate nohighlight">\(G\)</span>, discounted factor as <span class="math notranslate nohighlight">\(\gamma\)</span>, reward as <span class="math notranslate nohighlight">\(R\)</span>,
timestep as <span class="math notranslate nohighlight">\(t\)</span>, max timestep as <span class="math notranslate nohighlight">\(N\)</span>. Then <span class="math notranslate nohighlight">\(G_{t} = \Sigma_{t=0}^N{\gamma^tR_{t+1}}\)</span></p>
<p>For the reward sequence contain multi-episode, <span class="math notranslate nohighlight">\(done\)</span> is introduced for indicating episode boundary,
<span class="math notranslate nohighlight">\(last\_state\_value\)</span> represents value after final step of last episode.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>gamma</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – Discounted factor between [0, 1].</p></li>
<li><p><strong>need_bprop</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Whether need to calculate the backpropagation of discounted returns. Default: <code class="docutils literal notranslate"><span class="pre">False</span></code> .</p></li>
<li><p><strong>dtype</strong> (<em>mindspore.dtype</em>) – Data type for the output. Default: <code class="docutils literal notranslate"><span class="pre">ms.float32</span></code> .</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Inputs:</dt><dd><ul class="simple">
<li><p><strong>reward</strong> (Tensor) - The reward sequence contains multi-episode.
Tensor of shape <span class="math notranslate nohighlight">\((Timestep, Batch, ...)\)</span></p></li>
<li><p><strong>done</strong> (Tensor) - The episode done flag. Tensor of shape <span class="math notranslate nohighlight">\((Timestep, Batch)\)</span>.
The data type must be bool.</p></li>
<li><p><strong>last_state_value</strong> (Tensor) - The value after final step of last episode.
Tensor of shape <span class="math notranslate nohighlight">\((Batch, ...)\)</span></p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Discounted return.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">net</span> <span class="o">=</span> <span class="n">DiscountedReturn</span><span class="p">(</span><span class="n">gamma</span><span class="o">=</span><span class="mf">0.99</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">reward</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">done</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">([[</span><span class="kc">False</span><span class="p">,</span> <span class="kc">False</span><span class="p">,</span> <span class="kc">True</span><span class="p">,</span> <span class="kc">False</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">last_state_value</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">([</span><span class="mf">2.</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ret</span> <span class="o">=</span> <span class="n">net</span><span class="p">(</span><span class="n">reward</span><span class="p">,</span> <span class="n">done</span><span class="p">,</span> <span class="n">last_state_value</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(2, 2)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.utils.OUNoise">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.utils.</span></span><span class="sig-name descname"><span class="pre">OUNoise</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stddev</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">damping</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_shape</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/noise.html#OUNoise"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.utils.OUNoise" title="Permalink to this definition"></a></dt>
<dd><p>Perform Ornstein-Uhlenbeck (OU) noise base on actions.</p>
<p>Set zero-mean normal distribution as <span class="math notranslate nohighlight">\(N(0, stddev)\)</span>,
Then the next temporal value is <span class="math notranslate nohighlight">\(x\_next = (1 - damping) * x - N(0, stddev)\)</span>,
The action with OU Noise is <span class="math notranslate nohighlight">\(action += x\_next\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stddev</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – stddev of Ornstein-Uhlenbeck (OU) noise.</p></li>
<li><p><strong>damping</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – damping of Ornstein-Uhlenbeck (OU) noise.</p></li>
<li><p><strong>action_shape</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a>) – action shape.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Inputs:</dt><dd><ul class="simple">
<li><p><strong>actions</strong> (Tensor) - Actions before perferming noise.</p></li>
</ul>
</dd>
<dt>Outputs:</dt><dd><ul class="simple">
<li><p><strong>actions</strong> (Tensor) - Actions after perferming noise.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore</span> <span class="kn">import</span> <span class="n">Tensor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.utils</span> <span class="kn">import</span> <span class="n">OUNoise</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">action_shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">6</span><span class="p">,)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">actions</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">action_shape</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">net</span> <span class="o">=</span> <span class="n">OUNoise</span><span class="p">(</span><span class="n">stddev</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">damping</span><span class="o">=</span><span class="mf">0.15</span><span class="p">,</span> <span class="n">action_shape</span><span class="o">=</span><span class="n">action_shape</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">actions</span> <span class="o">=</span> <span class="n">net</span><span class="p">(</span><span class="n">actions</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">actions</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(6,)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.utils.SoftUpdate">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.utils.</span></span><span class="sig-name descname"><span class="pre">SoftUpdate</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">factor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">update_interval</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">behavior_params</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">target_params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/soft_update.html#SoftUpdate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.utils.SoftUpdate" title="Permalink to this definition"></a></dt>
<dd><p>Update target network parameters with moving average algorithm.</p>
<p>Set target network parameter as <span class="math notranslate nohighlight">\(target\_param\)</span>, behavior network parameter as <span class="math notranslate nohighlight">\(behavior\_param\)</span>,
moving averaget factor as <span class="math notranslate nohighlight">\(factor\)</span>.
Then <span class="math notranslate nohighlight">\(target\_param = (1. - factor) * behavior\_param + factor * target\_param\)</span>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>factor</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – moving average factor between [0, 1].</p></li>
<li><p><strong>update_interval</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The target network parameters will be updated every <cite>update_interval</cite> steps.</p></li>
<li><p><strong>behavior_params</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em>(</em><em>Parameter</em><em>)</em>) – list of behavior network parameters.</p></li>
<li><p><strong>target_params</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em>(</em><em>Parameter</em><em>)</em>) – list of target network parameters.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mindspore.nn</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore.common.parameter</span> <span class="kn">import</span> <span class="n">ParameterTuple</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.utils</span> <span class="kn">import</span> <span class="n">SoftUpdate</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Net</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Cell</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="nb">super</span><span class="p">()</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="bp">self</span><span class="o">.</span><span class="n">behavior_params</span> <span class="o">=</span> <span class="n">ParameterTuple</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">trainable_params</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="bp">self</span><span class="o">.</span><span class="n">target_params</span> <span class="o">=</span> <span class="n">ParameterTuple</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">20</span><span class="p">)</span><span class="o">.</span><span class="n">trainable_params</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="bp">self</span><span class="o">.</span><span class="n">updater</span> <span class="o">=</span> <span class="n">SoftUpdate</span><span class="p">(</span><span class="mf">0.9</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">behavior_params</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">target_params</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="k">def</span> <span class="nf">construct</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>        <span class="k">return</span> <span class="bp">self</span><span class="o">.</span><span class="n">updater</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">net</span> <span class="o">=</span> <span class="n">Net</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">for</span> <span class="n">_</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">10</span><span class="p">):</span>
<span class="gp">&gt;&gt;&gt; </span>    <span class="n">net</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">np</span><span class="o">.</span><span class="n">allclose</span><span class="p">(</span><span class="n">net</span><span class="o">.</span><span class="n">behavior_params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">asnumpy</span><span class="p">(),</span> <span class="n">net</span><span class="o">.</span><span class="n">target_params</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">asnumpy</span><span class="p">(),</span> <span class="n">atol</span><span class="o">=</span><span class="mf">1e-5</span><span class="p">)</span>
<span class="go">True</span>
</pre></div>
</div>
</dd></dl>

<span class="target" id="module-mindspore_rl.utils"></span><p>Network component used to implement polices.</p>
<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.utils.AlgorithmFunc">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.utils.</span></span><span class="sig-name descname"><span class="pre">AlgorithmFunc</span></span><a class="reference internal" href="_modules/mindspore_rl/utils/mcts/mcts.html#AlgorithmFunc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.utils.AlgorithmFunc" title="Permalink to this definition"></a></dt>
<dd><p>This is the base class for user to customize algorithm in MCTS. User need to
inherit this base class and implement all the functions with SAME input and output.</p>
<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.utils.AlgorithmFunc.calculate_prior">
<span class="sig-name descname"><span class="pre">calculate_prior</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legal_action</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/mcts/mcts.html#AlgorithmFunc.calculate_prior"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.utils.AlgorithmFunc.calculate_prior" title="Permalink to this definition"></a></dt>
<dd><p>Calculate prior of the input legal actions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>new_state</strong> (<em>mindspore.float32</em>) – The state of environment.</p></li>
<li><p><strong>legal_action</strong> (<em>mindspore.int32</em>) – The legal action of environment</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>prior (mindspore.float32), The probability (or prior) of all the input legal actions.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.utils.AlgorithmFunc.simulation">
<span class="sig-name descname"><span class="pre">simulation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/mcts/mcts.html#AlgorithmFunc.simulation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.utils.AlgorithmFunc.simulation" title="Permalink to this definition"></a></dt>
<dd><p>Simulation phase in MCTS. It takes the state as input and return the rewards.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>new_state</strong> (<em>mindspore.float32</em>) – The state of environment.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>rewards (mindspore.float32), The results of simulation.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.utils.BatchRead">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.utils.</span></span><span class="sig-name descname"><span class="pre">BatchRead</span></span><a class="reference internal" href="_modules/mindspore_rl/utils/batch_read_write.html#BatchRead"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.utils.BatchRead" title="Permalink to this definition"></a></dt>
<dd><p>Read a list of parameters to assign the target.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is an experiential prototype that is subject to change and/or deletion.</p>
</div>
<dl class="simple">
<dt>Supported Platforms:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">GPU</span></code> <code class="docutils literal notranslate"><span class="pre">CPU</span></code></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mindspore</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore</span> <span class="kn">import</span> <span class="n">nn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore.common.parameter</span> <span class="kn">import</span> <span class="n">Parameter</span><span class="p">,</span> <span class="n">ParameterTuple</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.utils</span> <span class="kn">import</span> <span class="n">BatchRead</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">SNet</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Cell</span><span class="p">):</span>
<span class="gp">... </span>  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">super</span><span class="p">(</span><span class="n">SNet</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="n">Tensor</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">mstype</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;a&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">dense</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">in_channels</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">out_channels</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">weight_init</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">DNet</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Cell</span><span class="p">):</span>
<span class="gp">... </span>  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">super</span><span class="p">(</span><span class="n">DNet</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="n">Tensor</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">mstype</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;a&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">dense</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">in_channels</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">out_channels</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Read</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Cell</span><span class="p">):</span>
<span class="gp">... </span>  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dst</span><span class="p">,</span> <span class="n">src</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">super</span><span class="p">(</span><span class="n">Read</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">read</span> <span class="o">=</span> <span class="n">BatchRead</span><span class="p">()</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">dst</span> <span class="o">=</span> <span class="n">ParameterTuple</span><span class="p">(</span><span class="n">dst</span><span class="o">.</span><span class="n">trainable_params</span><span class="p">())</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">src</span> <span class="o">=</span> <span class="n">ParameterTuple</span><span class="p">(</span><span class="n">src</span><span class="o">.</span><span class="n">trainable_params</span><span class="p">())</span>
<span class="gp">... </span>  <span class="k">def</span> <span class="nf">construct</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">success</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dst</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">src</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">success</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dst_net</span> <span class="o">=</span> <span class="n">DNet</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">source_net</span> <span class="o">=</span> <span class="n">SNet</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nets</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">CellList</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dst_net</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">source_net</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">success</span> <span class="o">=</span> <span class="n">Read</span><span class="p">(</span><span class="n">nets</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nets</span><span class="p">[</span><span class="mi">1</span><span class="p">])()</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.utils.BatchRead.construct">
<span class="sig-name descname"><span class="pre">construct</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dst</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/batch_read_write.html#BatchRead.construct"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.utils.BatchRead.construct" title="Permalink to this definition"></a></dt>
<dd><p>Read the source parameter list to assign the dst.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dst</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em>(</em><em>Parameters</em><em>)</em>) – A paramameter tuple of the dst model.</p></li>
<li><p><strong>src</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em>(</em><em>Parameters</em><em>)</em>) – A paramameter tuple of the source model.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>True.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.utils.BatchWrite">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.utils.</span></span><span class="sig-name descname"><span class="pre">BatchWrite</span></span><a class="reference internal" href="_modules/mindspore_rl/utils/batch_read_write.html#BatchWrite"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.utils.BatchWrite" title="Permalink to this definition"></a></dt>
<dd><p>Write a list of parameters to assign the target.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is an experiential prototype that is subject to change and/or deletion.</p>
</div>
<dl class="simple">
<dt>Supported Platforms:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">GPU</span></code> <code class="docutils literal notranslate"><span class="pre">CPU</span></code></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mindspore</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore</span> <span class="kn">import</span> <span class="n">nn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore.common.parameter</span> <span class="kn">import</span> <span class="n">Parameter</span><span class="p">,</span> <span class="n">ParameterTuple</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.utils</span> <span class="kn">import</span> <span class="n">BatchWrite</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">SourceNet</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Cell</span><span class="p">):</span>
<span class="gp">... </span>  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">super</span><span class="p">(</span><span class="n">SourceNet</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="n">Tensor</span><span class="p">(</span><span class="mf">0.5</span><span class="p">,</span> <span class="n">mstype</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;a&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">dense</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">in_channels</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">out_channels</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">weight_init</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">DstNet</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Cell</span><span class="p">):</span>
<span class="gp">... </span>  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">super</span><span class="p">(</span><span class="n">DstNet</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">a</span> <span class="o">=</span> <span class="n">Parameter</span><span class="p">(</span><span class="n">Tensor</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="n">mstype</span><span class="o">.</span><span class="n">float32</span><span class="p">),</span> <span class="n">name</span><span class="o">=</span><span class="s2">&quot;a&quot;</span><span class="p">)</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">dense</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">in_channels</span><span class="o">=</span><span class="mi">16</span><span class="p">,</span> <span class="n">out_channels</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Write</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Cell</span><span class="p">):</span>
<span class="gp">... </span>  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">dst</span><span class="p">,</span> <span class="n">src</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">super</span><span class="p">(</span><span class="n">Write</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">w</span> <span class="o">=</span> <span class="n">BatchWrite</span><span class="p">()</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">dst</span> <span class="o">=</span> <span class="n">ParameterTuple</span><span class="p">(</span><span class="n">dst</span><span class="o">.</span><span class="n">trainable_params</span><span class="p">())</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">src</span> <span class="o">=</span> <span class="n">ParameterTuple</span><span class="p">(</span><span class="n">src</span><span class="o">.</span><span class="n">trainable_params</span><span class="p">())</span>
<span class="gp">... </span>  <span class="k">def</span> <span class="nf">construct</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>    <span class="n">success</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">w</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">dst</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">src</span><span class="p">)</span>
<span class="gp">... </span>    <span class="k">return</span> <span class="n">success</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">dst_net</span> <span class="o">=</span> <span class="n">DstNet</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">source_net</span> <span class="o">=</span> <span class="n">SourceNet</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nets</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">CellList</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">dst_net</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">nets</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">source_net</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">success</span> <span class="o">=</span> <span class="n">Write</span><span class="p">(</span><span class="n">nets</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">nets</span><span class="p">[</span><span class="mi">1</span><span class="p">])()</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.utils.BatchWrite.construct">
<span class="sig-name descname"><span class="pre">construct</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dst</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">src</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/batch_read_write.html#BatchWrite.construct"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.utils.BatchWrite.construct" title="Permalink to this definition"></a></dt>
<dd><p>Write the source parameter list to assign the dst.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dst</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em>(</em><em>Parameters</em><em>)</em>) – A paramameter tuple of the dst model.</p></li>
<li><p><strong>src</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em>(</em><em>Parameters</em><em>)</em>) – A paramameter tuple of the source model.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>True.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.utils.CallbackManager">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.utils.</span></span><span class="sig-name descname"><span class="pre">CallbackManager</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">callbacks</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/callback.html#CallbackManager"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.utils.CallbackManager" title="Permalink to this definition"></a></dt>
<dd><p>Execute callbacks sequentially</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>callbacks</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em>[</em><em>Callback</em><em>]</em>) – a list of Callbacks.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.utils.CallbackManager.begin">
<span class="sig-name descname"><span class="pre">begin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/callback.html#CallbackManager.begin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.utils.CallbackManager.begin" title="Permalink to this definition"></a></dt>
<dd><p>Call only once before training.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>params</strong> (<a class="reference internal" href="#mindspore_rl.utils.CallbackParam" title="mindspore_rl.utils.CallbackParam"><em>CallbackParam</em></a>) – Parameters for begin.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.utils.CallbackManager.end">
<span class="sig-name descname"><span class="pre">end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/callback.html#CallbackManager.end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.utils.CallbackManager.end" title="Permalink to this definition"></a></dt>
<dd><p>Call only once after training.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>params</strong> (<a class="reference internal" href="#mindspore_rl.utils.CallbackParam" title="mindspore_rl.utils.CallbackParam"><em>CallbackParam</em></a>) – Parameters for end.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.utils.CallbackManager.episode_begin">
<span class="sig-name descname"><span class="pre">episode_begin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/callback.html#CallbackManager.episode_begin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.utils.CallbackManager.episode_begin" title="Permalink to this definition"></a></dt>
<dd><p>Call before each episode start</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>params</strong> (<a class="reference internal" href="#mindspore_rl.utils.CallbackParam" title="mindspore_rl.utils.CallbackParam"><em>CallbackParam</em></a>) – Parameters for episode begin.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.utils.CallbackManager.episode_end">
<span class="sig-name descname"><span class="pre">episode_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/callback.html#CallbackManager.episode_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.utils.CallbackManager.episode_end" title="Permalink to this definition"></a></dt>
<dd><p>Call before each episode end.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>params</strong> (<a class="reference internal" href="#mindspore_rl.utils.CallbackParam" title="mindspore_rl.utils.CallbackParam"><em>CallbackParam</em></a>) – Parameters for episode end.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.utils.CallbackParam">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.utils.</span></span><span class="sig-name descname"><span class="pre">CallbackParam</span></span><a class="reference internal" href="_modules/mindspore_rl/utils/callback.html#CallbackParam"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.utils.CallbackParam" title="Permalink to this definition"></a></dt>
<dd><p>It contains the parameters required for the execution of the callback function.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.utils.CheckpointCallback">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.utils.</span></span><span class="sig-name descname"><span class="pre">CheckpointCallback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">save_per_episode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">directory</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_ckpt_nums</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/callback.html#CheckpointCallback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.utils.CheckpointCallback" title="Permalink to this definition"></a></dt>
<dd><p>Save the checkpoint file for all the model weights. And keep the latest <cite>max_ckpt_nums</cite> checkpoint files.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>save_per_episode</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>optional</em>) – The frequency to save checkpoint. Default: <code class="docutils literal notranslate"><span class="pre">0</span></code> (not saved).</p></li>
<li><p><strong>directory</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a><em>, </em><em>optional</em>) – The directory for saving checkpoints. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code> , saving to <code class="docutils literal notranslate"><span class="pre">'./'</span></code> .</p></li>
<li><p><strong>max_ckpt_nums</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>optional</em>) – Numbers of how many checkpoint files to be kept. Default: <code class="docutils literal notranslate"><span class="pre">5</span></code> .</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.utils.callback</span> <span class="kn">import</span> <span class="n">CheckpointCallback</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.core</span> <span class="kn">import</span> <span class="n">Session</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.algorithm.dqn</span> <span class="kn">import</span> <span class="n">config</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ckpt_cb</span> <span class="o">=</span> <span class="n">CheckpointCallback</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cbs</span> <span class="o">=</span> <span class="p">[</span><span class="n">ckpt_cb</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">session</span> <span class="o">=</span> <span class="n">Session</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">algorithm_config</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">cbs</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.utils.CheckpointCallback.episode_end">
<span class="sig-name descname"><span class="pre">episode_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/callback.html#CheckpointCallback.episode_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.utils.CheckpointCallback.episode_end" title="Permalink to this definition"></a></dt>
<dd><p>Save checkpoint in the end of episode.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>params</strong> (<a class="reference internal" href="#mindspore_rl.utils.CallbackParam" title="mindspore_rl.utils.CallbackParam"><em>CallbackParam</em></a>) – Parameters of the tarining.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.utils.EvaluateCallback">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.utils.</span></span><span class="sig-name descname"><span class="pre">EvaluateCallback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">eval_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/callback.html#EvaluateCallback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.utils.EvaluateCallback" title="Permalink to this definition"></a></dt>
<dd><p>Evaluate callback.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>eval_rate</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>optional</em>) – The frequency to eval. Default: <code class="docutils literal notranslate"><span class="pre">0</span></code> (will not evaluate).</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.utils.callback</span> <span class="kn">import</span> <span class="n">EvaluateCallback</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.core</span> <span class="kn">import</span> <span class="n">Session</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.algorithm.dqn</span> <span class="kn">import</span> <span class="n">config</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">eval_cb</span> <span class="o">=</span> <span class="n">EvaluateCallback</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cbs</span> <span class="o">=</span> <span class="p">[</span><span class="n">eval_cb</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">session</span> <span class="o">=</span> <span class="n">Session</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">algorithm_config</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">cbs</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.utils.EvaluateCallback.begin">
<span class="sig-name descname"><span class="pre">begin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/callback.html#EvaluateCallback.begin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.utils.EvaluateCallback.begin" title="Permalink to this definition"></a></dt>
<dd><p>Store the eval rate in the begin of training, run once.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>params</strong> (<a class="reference internal" href="#mindspore_rl.utils.CallbackParam" title="mindspore_rl.utils.CallbackParam"><em>CallbackParam</em></a>) – Parameters for episode begin.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.utils.EvaluateCallback.episode_end">
<span class="sig-name descname"><span class="pre">episode_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/callback.html#EvaluateCallback.episode_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.utils.EvaluateCallback.episode_end" title="Permalink to this definition"></a></dt>
<dd><p>Run evaluate in the end of episode, and print the rewards.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>params</strong> (<a class="reference internal" href="#mindspore_rl.utils.CallbackParam" title="mindspore_rl.utils.CallbackParam"><em>CallbackParam</em></a>) – Parameters for episode end.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.utils.LossCallback">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.utils.</span></span><span class="sig-name descname"><span class="pre">LossCallback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">print_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/callback.html#LossCallback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.utils.LossCallback" title="Permalink to this definition"></a></dt>
<dd><p>Print loss in each episode end.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>print_rate</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>optional</em>) – The frequency to print loss. Default: <code class="docutils literal notranslate"><span class="pre">1</span></code> .</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.utils.callback</span> <span class="kn">import</span> <span class="n">LossCallback</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.core</span> <span class="kn">import</span> <span class="n">Session</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.algorithm.dqn</span> <span class="kn">import</span> <span class="n">config</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">loss_cb</span> <span class="o">=</span> <span class="n">LossCallback</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cbs</span> <span class="o">=</span> <span class="p">[</span><span class="n">loss_cb</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">session</span> <span class="o">=</span> <span class="n">Session</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">algorithm_config</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">cbs</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.utils.LossCallback.episode_end">
<span class="sig-name descname"><span class="pre">episode_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/callback.html#LossCallback.episode_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.utils.LossCallback.episode_end" title="Permalink to this definition"></a></dt>
<dd><p>Print loss in the end of episode.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>params</strong> (<a class="reference internal" href="#mindspore_rl.utils.CallbackParam" title="mindspore_rl.utils.CallbackParam"><em>CallbackParam</em></a>) – Parameters of the tarining.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.utils.MCTS">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.utils.</span></span><span class="sig-name descname"><span class="pre">MCTS</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">tree_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">node_type</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">root_player</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">customized_func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">device</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">args</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">has_init_reward</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_action</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">-</span> <span class="pre">1.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_iteration</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/mcts/mcts.html#MCTS"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.utils.MCTS" title="Permalink to this definition"></a></dt>
<dd><p>Monte Carlo Tree Search(MCTS) is a general search algorithm for some kinds of decision processes,
most notably those employed in software that plays board games, such as Go, chess. It was originally
proposed in 2006. A general MCTS has four phases:</p>
<ol class="arabic simple">
<li><p>Selection - selects the next node according to the selection policy (like UCT, RAVE, AMAF and etc.).</p></li>
<li><p>Expansion - unless the selection reached a terminal state, expansion adds a new child node to
the last node (leaf node) that is selected in Selection phase.</p></li>
<li><p>Simulation - performs an algorithm (random, neural net or other algorithms) to obtain the payoff.</p></li>
<li><p>Backpropagation - propagates the payoff for all visited node.</p></li>
</ol>
<p>As the time goes by, these four phases of MCTS is evolved. AlphaGo introduced neural network to
MCTS, which makes the MCTS more powerful.</p>
<p>This class is a mindspore ops implementation MCTS. User can use provided MCTS algorithm, or develop
their own MCTS by derived base class (MonteCarloTreeNode) in c++.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>env</strong> (<a class="reference internal" href="#mindspore_rl.environment.Environment" title="mindspore_rl.environment.Environment"><em>Environment</em></a>) – It must be the subclass of Environment.</p></li>
<li><p><strong>tree_type</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – The name of tree type.</p></li>
<li><p><strong>node_type</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – The name of node type.</p></li>
<li><p><strong>root_player</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – The root player, which should be less than the total number of player.</p></li>
<li><p><strong>customized_func</strong> (<a class="reference internal" href="#mindspore_rl.utils.AlgorithmFunc" title="mindspore_rl.utils.AlgorithmFunc"><em>AlgorithmFunc</em></a>) – Some algorithm specific class. For more detail, please have a look at
documentation of AlgorithmFunc.</p></li>
<li><p><strong>device</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – The device type <code class="docutils literal notranslate"><span class="pre">&quot;CPU&quot;</span></code> , <code class="docutils literal notranslate"><span class="pre">&quot;GPU&quot;</span></code> . <code class="docutils literal notranslate"><span class="pre">&quot;Ascend&quot;</span></code> is not support yet.</p></li>
<li><p><strong>args</strong> (<em>Tensor</em>) – any values which will be the input of MctsCreation. Please following the table below
to provide the input value. These value will not be reset after invoke <cite>restore_tree_data</cite>.</p></li>
<li><p><strong>has_init_reward</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a><em>, </em><em>optional</em>) – Whether pass the reward to each node during the node initialization.
Default: <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>max_action</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a><em>, </em><em>optional</em>) – The max number of action in environment. If the <cite>max_action</cite> is <code class="docutils literal notranslate"><span class="pre">-1.0</span></code> ,
the step in Environment will accept the last action. Otherwise, it will accept max_action number
of action. Default: <code class="docutils literal notranslate"><span class="pre">-1.0</span></code> .</p></li>
<li><p><strong>max_iteration</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>optional</em>) – <p>The max training iteration of MCTS. Default: <code class="docutils literal notranslate"><span class="pre">1000</span></code> .</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 29%" />
<col style="width: 17%" />
<col style="width: 28%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>MCTS Tree Type</p></th>
<th class="head"><p>MCTS Node Type</p></th>
<th class="head"><p>Configuration Parameter</p></th>
<th class="head"><p>Notices</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>CPUCommon</p></td>
<td><p>CPUVanilla</p></td>
<td><p>UCT const</p></td>
<td rowspan="2"><p>UCT const is used to
calculate UCT value in
Selection phase</p></td>
</tr>
<tr class="row-odd"><td><p>GPUCommon</p></td>
<td><p>GPUVanilla</p></td>
<td><p>UCT const</p></td>
</tr>
</tbody>
</table>
</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore</span> <span class="kn">import</span> <span class="n">Tensor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mindspore</span> <span class="k">as</span> <span class="nn">ms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.environment</span> <span class="kn">import</span> <span class="n">TicTacToeEnvironment</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.utils</span> <span class="kn">import</span> <span class="n">VanillaFunc</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.utils</span> <span class="kn">import</span> <span class="n">MCTS</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">env</span> <span class="o">=</span> <span class="n">TicTacToeEnvironment</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vanilla_func</span> <span class="o">=</span> <span class="n">VanillaFunc</span><span class="p">(</span><span class="n">env</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">uct</span> <span class="o">=</span> <span class="p">(</span><span class="n">Tensor</span><span class="p">(</span><span class="n">uct</span><span class="p">,</span> <span class="n">ms</span><span class="o">.</span><span class="n">float32</span><span class="p">),)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">root_player</span> <span class="o">=</span> <span class="mf">0.0</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">mcts</span> <span class="o">=</span> <span class="n">MCTS</span><span class="p">(</span><span class="n">env</span><span class="p">,</span> <span class="s2">&quot;CPUCommon&quot;</span><span class="p">,</span> <span class="s2">&quot;CPUVanilla&quot;</span><span class="p">,</span> <span class="n">root_player</span><span class="p">,</span> <span class="n">vanilla_func</span><span class="p">,</span> <span class="n">device</span><span class="p">,</span> <span class="n">args</span><span class="o">=</span><span class="n">uct</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">action</span><span class="p">,</span> <span class="n">handle</span> <span class="o">=</span> <span class="n">mcts</span><span class="o">.</span><span class="n">mcts_search</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.utils.MCTS.destroy">
<span class="sig-name descname"><span class="pre">destroy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">handle</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/mcts/mcts.html#MCTS.destroy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.utils.MCTS.destroy" title="Permalink to this definition"></a></dt>
<dd><p>destroy will destroy current tree. Please call this function ONLY when
do not use this tree any more.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>handle</strong> (<em>mindspore.int64</em>) – The unique handle of mcts tree.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>success (mindspore.bool_), Whether destroy is successful.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.utils.MCTS.mcts_search">
<span class="sig-name descname"><span class="pre">mcts_search</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">args</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/mcts/mcts.html#MCTS.mcts_search"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.utils.MCTS.mcts_search" title="Permalink to this definition"></a></dt>
<dd><p>mcts_search is the main function of MCTS. Invoke this function will return the best
action of current state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>*args</strong> (<em>Tensor</em>) – The variable which updates during each iteration. They will be restored
after invoking <cite>restore_tree_data</cite>. The input value needs to match provied
algorithm.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>action (mindspore.int32), The action which is returned by monte carlo tree search.</p></li>
<li><p>handle (mindspore.int64), The unique handle of mcts tree.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.utils.MCTS.restore_tree_data">
<span class="sig-name descname"><span class="pre">restore_tree_data</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">handle</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/mcts/mcts.html#MCTS.restore_tree_data"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.utils.MCTS.restore_tree_data" title="Permalink to this definition"></a></dt>
<dd><p>restore_tree_data will restore all the data in the tree, back to the initial state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>handle</strong> (<em>mindspore.int64</em>) – The unique handle of mcts tree.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>success (mindspore.bool_), Whether restore is successful.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.utils.TensorArray">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.utils.</span></span><span class="sig-name descname"><span class="pre">TensorArray</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dtype</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">element_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dynamic_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'TA'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/tensor_array.html#TensorArray"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.utils.TensorArray" title="Permalink to this definition"></a></dt>
<dd><p>TensorArray: a dynamic array to store tensors.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is an experiential prototype that is subject to change and/or deletion.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dtype</strong> (<em>mindspore.dtype</em>) – the data type in the TensorArray.</p></li>
<li><p><strong>element_shape</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em>(</em><a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>)</em>) – the shape of each tensor in a TensorArray.</p></li>
<li><p><strong>dynamic_size</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a><em>, </em><em>optional</em>) – if <code class="docutils literal notranslate"><span class="pre">True</span></code> , the size of TensorArray can be increased, otherwise it is a fixed size.
Default: <code class="docutils literal notranslate"><span class="pre">True</span></code> .</p></li>
<li><p><strong>size</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>optional</em>) – if <cite>dynamic_size</cite> is <code class="docutils literal notranslate"><span class="pre">False</span></code>, <cite>size</cite> means the max size of the TensorArray. Default: <code class="docutils literal notranslate"><span class="pre">0</span></code> .</p></li>
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a><em>, </em><em>optional</em>) – the name of this TensorArray, any str. Default: <code class="docutils literal notranslate"><span class="pre">&quot;TA&quot;</span></code> .</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Supported Platforms:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">GPU</span></code> <code class="docutils literal notranslate"><span class="pre">CPU</span></code></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mindspore</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.utils</span> <span class="kn">import</span> <span class="n">TensorArray</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span> <span class="o">=</span> <span class="n">TensorArray</span><span class="p">(</span><span class="n">mindspore</span><span class="o">.</span><span class="n">int64</span><span class="p">,</span> <span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ans</span> <span class="o">=</span> <span class="n">ta</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ans</span><span class="p">)</span>
<span class="go">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">s</span> <span class="o">=</span> <span class="n">ta</span><span class="o">.</span><span class="n">stack</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">s</span><span class="p">)</span>
<span class="go">[1 2]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ans</span> <span class="o">=</span> <span class="n">ta</span><span class="o">.</span><span class="n">read</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">ans</span><span class="p">)</span>
<span class="go">3</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ta</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.utils.TensorArray.clear">
<span class="sig-name descname"><span class="pre">clear</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/tensor_array.html#TensorArray.clear"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.utils.TensorArray.clear" title="Permalink to this definition"></a></dt>
<dd><p>Clear the created TensorArray. Only reset the TensorArray, clear the data and reset the size
in TensorArray and keep the instance of this TensorArray.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Bool, true.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.utils.TensorArray.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/tensor_array.html#TensorArray.close"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.utils.TensorArray.close" title="Permalink to this definition"></a></dt>
<dd><p>Close the created TensorArray.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Once close the TensorArray, every functions belong to this TensorArray will be disaviliable.
Every resources created in TensorArray will be removed. If this TensorArray will be used in next step
or somewhere, eg: next loop, please use <cite>clear</cite> instead.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Bool, true.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.utils.TensorArray.read">
<span class="sig-name descname"><span class="pre">read</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/tensor_array.html#TensorArray.read"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.utils.TensorArray.read" title="Permalink to this definition"></a></dt>
<dd><p>Read tensor form the TensorArray by the given position index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>index</strong> (<em>[</em><a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>mindspore.int64</em><em>]</em>) – The given index to get the tensor.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Tensor, the value in position index.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.utils.TensorArray.size">
<span class="sig-name descname"><span class="pre">size</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/tensor_array.html#TensorArray.size"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.utils.TensorArray.size" title="Permalink to this definition"></a></dt>
<dd><p>The logical size of TensorArray.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Tensor, the size of TensorArray.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.utils.TensorArray.stack">
<span class="sig-name descname"><span class="pre">stack</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/tensor_array.html#TensorArray.stack"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.utils.TensorArray.stack" title="Permalink to this definition"></a></dt>
<dd><p>Stack the values in TensorArray into a stacked Tensor.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Tensor, all the values will be stacked into one tensor.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.utils.TensorArray.write">
<span class="sig-name descname"><span class="pre">write</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">index</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">value</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/tensor_array.html#TensorArray.write"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.utils.TensorArray.write" title="Permalink to this definition"></a></dt>
<dd><p>Write value(Tensor) to TensorArray in position index.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>index</strong> (<em>[</em><a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>mindspore.int64</em><em>]</em>) – The position to write.</p></li>
<li><p><strong>value</strong> (<em>Tensor</em>) – The value to add into the TensorArray.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Bool, true.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.utils.TensorsQueue">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.utils.</span></span><span class="sig-name descname"><span class="pre">TensorsQueue</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dtype</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shapes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'TQ'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/tensors_queue.html#TensorsQueue"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.utils.TensorsQueue" title="Permalink to this definition"></a></dt>
<dd><p>TensorsQueue: a queue which stores tensors lists.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This is an experiential prototype that is subject to change and/or deletion.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dtype</strong> (<em>mindspore.dtype</em>) – the data type in the TensorsQueue. Each tensor should have the same dtype.</p></li>
<li><p><strong>shapes</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em>[</em><em>int64</em><em>]</em>) – the shape of each element in TensorsQueue.</p></li>
<li><p><strong>size</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>optional</em>) – the size of the TensorsQueue. Default: <code class="docutils literal notranslate"><span class="pre">0</span></code> .</p></li>
<li><p><strong>name</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a><em>, </em><em>optional</em>) – the name of this TensorsQueue. Default: <code class="docutils literal notranslate"><span class="pre">&quot;TQ&quot;</span></code> .</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/library/exceptions.html#TypeError" title="(in Python v3.8)"><strong>TypeError</strong></a> – If <cite>dtype</cite> is not MindSpore number type.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/library/exceptions.html#ValueError" title="(in Python v3.8)"><strong>ValueError</strong></a> – If <cite>size</cite> is less than 0.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/library/exceptions.html#ValueError" title="(in Python v3.8)"><strong>ValueError</strong></a> – If <cite>shapes</cite> size is less than 1.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Supported Platforms:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">GPU</span></code> <code class="docutils literal notranslate"><span class="pre">CPU</span></code></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mindspore</span> <span class="k">as</span> <span class="nn">ms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore</span> <span class="kn">import</span> <span class="n">Tensor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.utils</span> <span class="kn">import</span> <span class="n">TensorsQueue</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data1</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">data2</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tq</span> <span class="o">=</span> <span class="n">TensorsQueue</span><span class="p">(</span><span class="n">dtype</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">shapes</span><span class="o">=</span><span class="p">((</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="p">(</span><span class="mi">1</span><span class="p">,)),</span> <span class="n">size</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">tq</span><span class="o">.</span><span class="n">put</span><span class="p">((</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ans</span> <span class="o">=</span> <span class="n">tq</span><span class="o">.</span><span class="n">pop</span><span class="p">()</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.utils.TensorsQueue.clear">
<span class="sig-name descname"><span class="pre">clear</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/tensors_queue.html#TensorsQueue.clear"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.utils.TensorsQueue.clear" title="Permalink to this definition"></a></dt>
<dd><p>Clear the created TensorsQueue. Only reset the TensorsQueue, clear the data and reset the size
in TensorsQueue and keep the instance of this TensorsQueue.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Bool, true.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.utils.TensorsQueue.close">
<span class="sig-name descname"><span class="pre">close</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/tensors_queue.html#TensorsQueue.close"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.utils.TensorsQueue.close" title="Permalink to this definition"></a></dt>
<dd><p>Close the created TensorsQueue.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Once close the TensorsQueue, every functions belong to this TensorsQueue will be disaviliable.
Every resources created in TensorsQueue will be removed. If this TensorsQueue will be used in next step
or somewhere, eg: next loop, please use <cite>clear</cite> instead.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Bool, true.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.utils.TensorsQueue.get">
<span class="sig-name descname"><span class="pre">get</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/tensors_queue.html#TensorsQueue.get"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.utils.TensorsQueue.get" title="Permalink to this definition"></a></dt>
<dd><p>Get one element int the front of the TensorsQueue.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>tuple(Tensors), the element in TensorsQueue.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.utils.TensorsQueue.pop">
<span class="sig-name descname"><span class="pre">pop</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/tensors_queue.html#TensorsQueue.pop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.utils.TensorsQueue.pop" title="Permalink to this definition"></a></dt>
<dd><p>Get one element int the front of the TensorsQueue, and remove it.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>tuple(Tensors), the element in TensorsQueue.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.utils.TensorsQueue.put">
<span class="sig-name descname"><span class="pre">put</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">element</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/tensors_queue.html#TensorsQueue.put"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.utils.TensorsQueue.put" title="Permalink to this definition"></a></dt>
<dd><p>Put element(tuple(Tensors)) to TensorsQueue in the end of queue.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>element</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em>(</em><em>Tensor</em><em>) or </em><a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em>[</em><em>tensor</em><em>]</em>) – The input element.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Bool, true.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.utils.TensorsQueue.size">
<span class="sig-name descname"><span class="pre">size</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/tensors_queue.html#TensorsQueue.size"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.utils.TensorsQueue.size" title="Permalink to this definition"></a></dt>
<dd><p>Get the used size of the TensorsQueue.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Tensor(mindspore.int64), the used size of TensorsQueue.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.utils.TimeCallback">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.utils.</span></span><span class="sig-name descname"><span class="pre">TimeCallback</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">print_rate</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fixed_steps_in_episode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/callback.html#TimeCallback"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.utils.TimeCallback" title="Permalink to this definition"></a></dt>
<dd><p>Time Callback to monitor time costs for each episode.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>print_rate</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>optional</em>) – The frequency to print time. Default: <code class="docutils literal notranslate"><span class="pre">1</span></code> .</p></li>
<li><p><strong>fixed_steps_in_episode</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>optional</em>) – If the number of steps in each episode is fixed, this number
is used to calculate the step time. If <code class="docutils literal notranslate"><span class="pre">None</span></code> , the real steps number should be provided in params.
Default: <code class="docutils literal notranslate"><span class="pre">None</span></code> .</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.utils.callback</span> <span class="kn">import</span> <span class="n">TimeCallback</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.core</span> <span class="kn">import</span> <span class="n">Session</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.algorithm.dqn</span> <span class="kn">import</span> <span class="n">config</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">time_cb</span> <span class="o">=</span> <span class="n">TimeCallback</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">cbs</span> <span class="o">=</span> <span class="p">[</span><span class="n">time_cb</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">session</span> <span class="o">=</span> <span class="n">Session</span><span class="p">(</span><span class="n">config</span><span class="o">.</span><span class="n">algorithm_config</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="kc">None</span><span class="p">,</span> <span class="n">cbs</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.utils.TimeCallback.episode_begin">
<span class="sig-name descname"><span class="pre">episode_begin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/callback.html#TimeCallback.episode_begin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.utils.TimeCallback.episode_begin" title="Permalink to this definition"></a></dt>
<dd><p>Get time in the begin of episode.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>params</strong> (<a class="reference internal" href="#mindspore_rl.utils.CallbackParam" title="mindspore_rl.utils.CallbackParam"><em>CallbackParam</em></a>) – Parameters of the tarining.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.utils.TimeCallback.episode_end">
<span class="sig-name descname"><span class="pre">episode_end</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/callback.html#TimeCallback.episode_end"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.utils.TimeCallback.episode_end" title="Permalink to this definition"></a></dt>
<dd><p>Print time in the end of episode.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>params</strong> (<a class="reference internal" href="#mindspore_rl.utils.CallbackParam" title="mindspore_rl.utils.CallbackParam"><em>CallbackParam</em></a>) – Parameters of the tarining.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.utils.VanillaFunc">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.utils.</span></span><span class="sig-name descname"><span class="pre">VanillaFunc</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">env</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/mcts/mcts.html#VanillaFunc"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.utils.VanillaFunc" title="Permalink to this definition"></a></dt>
<dd><p>This is the customized algorithm for VanillaMCTS. The prior of each legal action is uniform
distribution and it plays randomly to obtain the result of simulation.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>env</strong> (<a class="reference internal" href="#mindspore_rl.environment.Environment" title="mindspore_rl.environment.Environment"><em>Environment</em></a>) – The input environment.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">env</span> <span class="o">=</span> <span class="n">TicTacToeEnvironment</span><span class="p">(</span><span class="kc">None</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">vanilla_func</span> <span class="o">=</span> <span class="n">VanillaFunc</span><span class="p">(</span><span class="n">env</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">legal_action</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">legal_action</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">prior</span> <span class="o">=</span> <span class="n">vanilla_func</span><span class="o">.</span><span class="n">calculate_prior</span><span class="p">(</span><span class="n">legal_action</span><span class="p">,</span> <span class="n">legal_action</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">prior</span><span class="p">)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.utils.VanillaFunc.calculate_prior">
<span class="sig-name descname"><span class="pre">calculate_prior</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">legal_action</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/mcts/mcts.html#VanillaFunc.calculate_prior"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.utils.VanillaFunc.calculate_prior" title="Permalink to this definition"></a></dt>
<dd><p>The functionality of calculate_prior is to calculate prior of the input legal actions.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>new_state</strong> (<em>mindspore.float32</em>) – The state of environment.</p></li>
<li><p><strong>legal_action</strong> (<em>mindspore.int32</em>) – The legal action of environment</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>prior (mindspore.float32), The probability (or prior) of all the input legal actions.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.utils.VanillaFunc.simulation">
<span class="sig-name descname"><span class="pre">simulation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">new_state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/mcts/mcts.html#VanillaFunc.simulation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.utils.VanillaFunc.simulation" title="Permalink to this definition"></a></dt>
<dd><p>The functionality of simulation is to calculate reward of the input state.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>new_state</strong> (<em>mindspore.float32</em>) – The state of environment.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>rewards (mindspore.float32), The results of simulation.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="mindspore_rl.utils.update_config">
<span class="sig-prename descclassname"><span class="pre">mindspore_rl.utils.</span></span><span class="sig-name descname"><span class="pre">update_config</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_yaml</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">algo_yaml</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/utils/utils.html#update_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.utils.update_config" title="Permalink to this definition"></a></dt>
<dd><p>Update the config by the provided yamls. Eg: see <cite>mindspore_rl/algorithm/dqn/config.py</cite>,
<cite>mindspore_rl/example/env_yaml/</cite> and <cite>mindspore_rl/example/algo_yaml/</cite> for usage.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>config</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – the config to be update.</p></li>
<li><p><strong>env_yaml</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – the environment yaml file.</p></li>
<li><p><strong>algo_yaml</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a>) – the algorithm yaml file.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="environment.html" class="btn btn-neutral float-left" title="Reinforcement Learning Environment Access" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="RELEASE.html" class="btn btn-neutral float-right" title="Release Notes" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright MindSpore.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 
</body>
</html>