<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>mindspore_rl &mdash; MindSpore master documentation</title><script>;(()=>{const e=localStorage.getItem("ms-theme"),t=window.matchMedia("(prefers-color-scheme: dark)").matches;(e?"dark"===e:t)&&document.documentElement.setAttribute("data-o-theme","dark")})();</script><link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script><script src="_static/jquery.js"></script>
        <script src="_static/js/theme.js"></script><script src="_static/underscore.js"></script><script src="_static/doctools.js"></script><script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="使用MindSpore Reinforcement实现深度Q学习（DQN）" href="dqn.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> MindSpore
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">安装部署</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="reinforcement_install.html">安装MindSpore Reinforcement</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">使用指南</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="custom_config_info.html">强化学习配置说明</a></li>
<li class="toctree-l1"><a class="reference internal" href="dqn.html">使用MindSpore Reinforcement实现深度Q学习（DQN）</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API参考</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">mindspore_rl</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#module-mindspore_rl.agent">mindspore_rl.agent</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-mindspore_rl.core">mindspore_rl.core</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-mindspore_rl.environment">mindspore_rl.environment</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-mindspore_rl.network">mindspore_rl.network</a></li>
<li class="toctree-l2"><a class="reference internal" href="#module-mindspore_rl.policy">mindspore_rl.policy</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">MindSpore</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>mindspore_rl</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/reinforcement.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="module-mindspore_rl">
<span id="mindspore-rl"></span><h1>mindspore_rl<a class="headerlink" href="#module-mindspore_rl" title="Permalink to this headline"></a></h1>
<p>Components for MindSpore Reinforcement Learning Framework.</p>
<section id="module-mindspore_rl.agent">
<span id="mindspore-rl-agent"></span><h2>mindspore_rl.agent<a class="headerlink" href="#module-mindspore_rl.agent" title="Permalink to this headline"></a></h2>
<p>Components for agent, actor, learner, trainer.</p>
<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.agent.Actor">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.agent.</span></span><span class="sig-name descname"><span class="pre">Actor</span></span><a class="reference internal" href="_modules/mindspore_rl/agent/actor.html#Actor"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.agent.Actor" title="Permalink to this definition"></a></dt>
<dd><p>Base class for all actors.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.agent.actor</span> <span class="kn">import</span> <span class="n">Actor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.network</span> <span class="kn">import</span> <span class="n">FullyConnectedNet</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.environment</span> <span class="kn">import</span> <span class="n">GymEnvironment</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">MyActor</span><span class="p">(</span><span class="n">Actor</span><span class="p">):</span>
<span class="gp">... </span>  <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">super</span><span class="p">(</span><span class="n">MyActor</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">argmax</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">Argmax</span><span class="p">()</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">actor_net</span> <span class="o">=</span> <span class="n">FullyConnectedNet</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">env</span> <span class="o">=</span> <span class="n">GymEnvironment</span><span class="p">({</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;CartPole-v0&#39;</span><span class="p">})</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_actor</span> <span class="o">=</span> <span class="n">MyActor</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">my_actor</span><span class="p">)</span>
<span class="go">MyActor&lt;</span>
<span class="go">(actor_net): FullyConnectedNet&lt;</span>
<span class="go">(linear1): Dense&lt;input_channels=4, output_channels=10, has_bias=True&gt;</span>
<span class="go">(linear2): Dense&lt;input_channels=10, output_channels=2, has_bias=True&gt;</span>
<span class="go">(relu): ReLU&lt;&gt;</span>
<span class="go">&gt;</span>
<span class="go">(environment): GymEnvironment&lt;&gt;</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.agent.Actor.act">
<span class="sig-name descname"><span class="pre">act</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/agent/actor.html#Actor.act"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.agent.Actor.act" title="Permalink to this definition"></a></dt>
<dd><p>The interface of the act function.
User will need to overload this function according to
the algorithm. But argument of this function should be
phase and params. This interface will interact with
environment</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phase</strong> (<em>enum</em>) – A enumerate value states for init, collect, eval or other user-defined stage.</p></li>
<li><p><strong>params</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em>(</em><em>Tensor</em><em>)</em>) – A tuple of tensor as input, which is used to calculate action</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tuple of tensor as output, which states for experience</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>observation (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)">tuple</a>(Tensor))</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.agent.Actor.get_action">
<span class="sig-name descname"><span class="pre">get_action</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/agent/actor.html#Actor.get_action"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.agent.Actor.get_action" title="Permalink to this definition"></a></dt>
<dd><p>The interface of the act function.
User will need to overload this function according to
the algorithm. But argument of this function should be
phase and params. This interface will not interact with
environment</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phase</strong> (<em>enum</em>) – A enumerate value states for init, collect, eval or other user-defined stage.</p></li>
<li><p><strong>params</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em>(</em><em>Tensor</em><em>)</em>) – A tuple of tensor as input, which is used to calculate action</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tuple of tensor as output, which states for experience</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>observation (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)">tuple</a>(Tensor))</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.agent.Agent">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.agent.</span></span><span class="sig-name descname"><span class="pre">Agent</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">actors</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learner</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/agent/agent.html#Agent"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.agent.Agent" title="Permalink to this definition"></a></dt>
<dd><p>The base class for the Agent.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>actors</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#object" title="(in Python v3.8)"><em>object</em></a>) – The actor instance.</p></li>
<li><p><strong>learner</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#object" title="(in Python v3.8)"><em>object</em></a>) – The learner instance.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.agent.learner</span> <span class="kn">import</span> <span class="n">Learner</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.agent.actor</span> <span class="kn">import</span> <span class="n">Actor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.agent.agent</span> <span class="kn">import</span> <span class="n">Agent</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">actors</span> <span class="o">=</span> <span class="n">Actor</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">learner</span> <span class="o">=</span> <span class="n">Learner</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">agent</span> <span class="o">=</span> <span class="n">Agent</span><span class="p">(</span><span class="n">actors</span><span class="p">,</span> <span class="n">learner</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">agent</span><span class="p">)</span>
<span class="go">Agent&lt;</span>
<span class="go">(_actors): Actor&lt;&gt;</span>
<span class="go">(_learner): Learner&lt;&gt;</span>
<span class="go">&gt;</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.agent.Agent.act">
<span class="sig-name descname"><span class="pre">act</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/agent/agent.html#Agent.act"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.agent.Agent.act" title="Permalink to this definition"></a></dt>
<dd><p>The act function will take an enumerate value and observation or other data which is needed during
calculating the action. It will return a set of output which contains new observation, or other
experience. In this function, agent will interact with environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phase</strong> (<em>enum</em>) – A enumerate value states for init, collect or eval stage.</p></li>
<li><p><strong>params</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em>(</em><em>Tensor</em><em>)</em>) – A tuple of tensor as input, which is used to calculate action</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tuple of tensor as output, which states for experience</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>observation (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)">tuple</a>(Tensor))</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.agent.Agent.get_action">
<span class="sig-name descname"><span class="pre">get_action</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">phase</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/agent/agent.html#Agent.get_action"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.agent.Agent.get_action" title="Permalink to this definition"></a></dt>
<dd><p>The get_action function will take an enumerate value and observation or other data which is needed during
calculating the action. It will return a set of output which contains actions of experience. In this
function, agent will not interact with environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>phase</strong> (<em>enum</em>) – A enumerate value states for init, collect or eval stage.</p></li>
<li><p><strong>params</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em>(</em><em>Tensor</em><em>)</em>) – A tuple of tensor as input, which is used to calculate action</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>A tuple of tensor as output, which states for experience</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>observation (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)">tuple</a>(Tensor))</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.agent.Agent.learn">
<span class="sig-name descname"><span class="pre">learn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">experience</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/agent/agent.html#Agent.learn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.agent.Agent.learn" title="Permalink to this definition"></a></dt>
<dd><p>The learn function will take a set of experience as input to calculate the loss and update
the weights.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>experience</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em>(</em><em>Tensor</em><em>)</em>) – A tuple of tensor states for experience</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Result which outputs after updating weights</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>results (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)">tuple</a>(Tensor))</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.agent.Learner">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.agent.</span></span><span class="sig-name descname"><span class="pre">Learner</span></span><a class="reference internal" href="_modules/mindspore_rl/agent/learner.html#Learner"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.agent.Learner" title="Permalink to this definition"></a></dt>
<dd><p>The base class of the learner.</p>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.agent.learner</span> <span class="kn">import</span> <span class="n">Learner</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_rl.network</span> <span class="kn">import</span> <span class="n">FullyConnectedNet</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">MyLearner</span><span class="p">(</span><span class="n">Learner</span><span class="p">):</span>
<span class="gp">... </span>  <span class="k">def</span> <span class="nf">init</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
<span class="gp">... </span>    <span class="nb">super</span><span class="p">(</span><span class="n">MyLearner</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
<span class="gp">... </span>    <span class="bp">self</span><span class="o">.</span><span class="n">target_network</span> <span class="o">=</span> <span class="n">FullyConnectedNet</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">my_learner</span> <span class="o">=</span> <span class="n">MyLearner</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">my_learner</span><span class="p">)</span>
<span class="go">MyLearner&lt;</span>
<span class="go">(target_network): FullyConnectedNet&lt;</span>
<span class="go">(linear1): Dense&lt;input_channels=4, output_channels=10, has_bias=True&gt;</span>
<span class="go">(linear2): Dense&lt;input_channels=10, output_channels=2, has_bias=True&gt;</span>
<span class="go">(relu): ReLU&lt;&gt;</span>
<span class="go">&gt;</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.agent.Learner.learn">
<span class="sig-name descname"><span class="pre">learn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">experience</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/agent/learner.html#Learner.learn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.agent.Learner.learn" title="Permalink to this definition"></a></dt>
<dd><p>The interface for the learn function. The behavior of the <cite>learn</cite> function
depend on the user’s implementation. Usually, it takes the <cite>samples</cite> form
replay buffer or other Tensors, and calculates the loss for updating the networks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>experience</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em>(</em><em>Tensor</em><em>)</em>) – Sampling from the buffer.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Result which outputs after updating weights</p>
</dd>
<dt class="field-odd">Return type</dt>
<dd class="field-odd"><p>results (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)">tuple</a>(Tensor))</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.agent.Trainer">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.agent.</span></span><span class="sig-name descname"><span class="pre">Trainer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">msrl</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/agent/trainer.html#Trainer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.agent.Trainer" title="Permalink to this definition"></a></dt>
<dd><p>The trainer base class.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Reference to <a class="reference external" href="https://gitee.com/mindspore/docs/blob/master/docs/reinforcement/docs/source_en/dqn.md#defining-the-dqntrainer-class">dqn_trainer.py</a>.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>msrl</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#object" title="(in Python v3.8)"><em>object</em></a>) – the function handler class.</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.agent.Trainer.evaluate">
<span class="sig-name descname"><span class="pre">evaluate</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/agent/trainer.html#Trainer.evaluate"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.agent.Trainer.evaluate" title="Permalink to this definition"></a></dt>
<dd><p>The interface of the evaluate function for evaluate in train.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.agent.Trainer.load_and_eval">
<span class="sig-name descname"><span class="pre">load_and_eval</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ckpt_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/agent/trainer.html#Trainer.load_and_eval"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.agent.Trainer.load_and_eval" title="Permalink to this definition"></a></dt>
<dd><p>The interface of the eval function for offline. A checkpoint must be provided.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>ckpt_path</strong> (<em>string</em>) – The checkpoint file to restore net.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.agent.Trainer.train">
<span class="sig-name descname"><span class="pre">train</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">episodes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callbacks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ckpt_path</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/agent/trainer.html#Trainer.train"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.agent.Trainer.train" title="Permalink to this definition"></a></dt>
<dd><p>The interface of the train function. User will implement
this function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>episodes</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – the number of training episodes.</p></li>
<li><p><strong>callbacks</strong> (<em>Optional</em><em>[</em><a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em>[</em><em>Callback</em><em>]</em><em>]</em>) – List of callback objects. Default: None</p></li>
<li><p><strong>ckpt_path</strong> (<em>Optional</em><em>[</em><em>string</em><em>]</em>) – The checkpoint file to init or restore net. Default: None.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.agent.Trainer.train_one_episode">
<span class="sig-name descname"><span class="pre">train_one_episode</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/agent/trainer.html#Trainer.train_one_episode"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.agent.Trainer.train_one_episode" title="Permalink to this definition"></a></dt>
<dd><p>The interface of train one episode function in train.
And the output of this function must be constricted as <cite>loss, rewards, steps, [optional]others</cite> in order.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.agent.Trainer.trainable_variables">
<span class="sig-name descname"><span class="pre">trainable_variables</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/agent/trainer.html#Trainer.trainable_variables"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.agent.Trainer.trainable_variables" title="Permalink to this definition"></a></dt>
<dd><p>The variables for saving to checkpoint.</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-mindspore_rl.core">
<span id="mindspore-rl-core"></span><h2>mindspore_rl.core<a class="headerlink" href="#module-mindspore_rl.core" title="Permalink to this headline"></a></h2>
<p>Helper components used to implement RL algorithms.</p>
<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.core.MSRL">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.core.</span></span><span class="sig-name descname"><span class="pre">MSRL</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/msrl.html#MSRL"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.core.MSRL" title="Permalink to this definition"></a></dt>
<dd><p>The MSRL class provides the function handlers and APIs for reinforcement
learning algorithm development.</p>
<p>It exposes the following function handler to the user. The input and output of
these function handlers are identical to the user defined functions.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">agent_act_init</span>
<span class="n">agent_act_collect</span>
<span class="n">agent_act_eval</span>
<span class="n">agent_act</span>
<span class="n">agent_reset</span>
<span class="n">sample_buffer</span>
<span class="n">agent_learn</span>
</pre></div>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>config</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – <p>provides the algorithm configuration.</p>
<ul class="simple">
<li><p>Top level: defines the algorithm components.</p>
<ul>
<li><p>key: ‘actor’,              value: the actor configuration (dict).</p></li>
<li><p>key: ‘learner’,            value: the learner configuration (dict).</p></li>
<li><p>key: ‘policy_and_network’, value: the policy and networks used by
actors and learners (dict).</p></li>
<li><p>key: ‘env’,                value: the environment configuration (dict).</p></li>
</ul>
</li>
<li><p>Second level: the configuration of each algorithm component.</p>
<ul>
<li><p>key: ‘number’,      value: the number of actors/learner (int).</p></li>
<li><p>key: ‘type’,        value: the type of the
actor/learner/policy_and_network/environment (class name).</p></li>
<li><p>key: ‘params’,      value: the parameters of
actor/learner/policy_and_network/environment (dict).</p></li>
<li><p>key: ‘policies’,    value: the list of policies used by the
actor/learner (list).</p></li>
<li><p>key: ‘networks’,    value: the list of networks used by the
actor/learner (list).</p></li>
<li><p>key: ‘environment’, value: True if the component needs to interact
with the environment, False otherwise (Bool).</p></li>
<li><p>key: ‘buffer’,      value: the buffer configuration (dict).</p></li>
</ul>
</li>
</ul>
</p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.core.MSRL.get_replay_buffer">
<span class="sig-name descname"><span class="pre">get_replay_buffer</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/msrl.html#MSRL.get_replay_buffer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.core.MSRL.get_replay_buffer" title="Permalink to this definition"></a></dt>
<dd><p>It will return the instance of replay buffer.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Buffers (object), The instance of relay buffer. If the buffer is None, the return
value will be None.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.core.MSRL.get_replay_buffer_elements">
<span class="sig-name descname"><span class="pre">get_replay_buffer_elements</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">transpose</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/msrl.html#MSRL.get_replay_buffer_elements"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.core.MSRL.get_replay_buffer_elements" title="Permalink to this definition"></a></dt>
<dd><p>It will return all the elements in the replay buffer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>transpose</strong> (<em>boolean</em>) – whether the output element needs to be transpose,
if transpose is true, shape will also need to be filled. Default: False</p></li>
<li><p><strong>shape</strong> (<em>Tuple</em><em>[</em><a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>]</em>) – the shape used in transpose. Default: None</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>elements (List[Tensor]), A set of tensor contains all the elements in the replay buffer</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.core.MSRL.init">
<span class="sig-name descname"><span class="pre">init</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/msrl.html#MSRL.init"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.core.MSRL.init" title="Permalink to this definition"></a></dt>
<dd><p>Initialization of MSRL object.
The function creates all the data/objects that the algorithm requires.
It also initializes all the function handler.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>config</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – algorithm configuration file.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.core.Session">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.core.</span></span><span class="sig-name descname"><span class="pre">Session</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">config</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/session.html#Session"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.core.Session" title="Permalink to this definition"></a></dt>
<dd><p>The Session is a class for running MindSpore RL algorithms.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>config</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – the algorithm configuration or the deployment configuration of the algorithm.
For more details of configuration of algorithm, please have a look at
<a class="reference external" href="https://www.mindspore.cn/reinforcement/docs/zh-CN/master/custom_config_info.html">https://www.mindspore.cn/reinforcement/docs/zh-CN/master/custom_config_info.html</a></p>
</dd>
</dl>
<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.core.Session.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">class_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">is_train</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">episode</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">params</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">callbacks</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/core/session.html#Session.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.core.Session.run" title="Permalink to this definition"></a></dt>
<dd><p>Execute the reinforcement learning algorithm.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>class_type</strong> (<em>class type</em>) – The class type of the algorithm’s trainer class. Default: None.</p></li>
<li><p><strong>is_train</strong> (<em>boolean</em>) – Run the algorithm in train mode or eval mode. Default: True</p></li>
<li><p><strong>episode</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The number of episode of the training. Default: 0.</p></li>
<li><p><strong>params</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – The algorithm specific training parameters. Default: None.</p></li>
<li><p><strong>callbacks</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em>[</em><em>Callback</em><em>]</em>) – The callback list. Default: None.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-mindspore_rl.environment">
<span id="mindspore-rl-environment"></span><h2>mindspore_rl.environment<a class="headerlink" href="#module-mindspore_rl.environment" title="Permalink to this headline"></a></h2>
<p>Component used to implement custom environments.</p>
<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.environment.Environment">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.environment.</span></span><span class="sig-name descname"><span class="pre">Environment</span></span><a class="reference internal" href="_modules/mindspore_rl/environment/environment.html#Environment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.Environment" title="Permalink to this definition"></a></dt>
<dd><p>The virtual base class for the environment. This class should be overridden before calling in the model.</p>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.environment.EnvironmentProcess">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.environment.</span></span><span class="sig-name descname"><span class="pre">EnvironmentProcess</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">proc_no</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_num</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">env_create_func</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">actions</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">observations</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">initial_states</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/env_process.html#EnvironmentProcess"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.EnvironmentProcess" title="Permalink to this definition"></a></dt>
<dd><p>An independent process responsible for creating and interacting with one or more environments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>proc_no</strong> (<em>-</em>) – The process number assigned by the caller.</p></li>
<li><p><strong>env_num</strong> (<em>-</em>) – The number of environments created by this process.</p></li>
<li><p><strong>env_create_func</strong> (<em>-</em>) – The function used to create the environment.</p></li>
<li><p><strong>actions</strong> (<em>-</em>) – The queue used to pass actions to the environment process.</p></li>
<li><p><strong>observations</strong> (<em>-</em>) – The queue used to pass observations to the caller process.</p></li>
<li><p><strong>initial_states</strong> (<em>-</em>) – The queue used to pass initial states to the caller process.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">actions</span> <span class="o">=</span> <span class="n">Queue</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">observations</span> <span class="o">=</span> <span class="n">Queue</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">initial_states</span> <span class="o">=</span> <span class="n">Queue</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">proc_no</span> <span class="o">=</span> <span class="mi">1</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">env_num</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">env_proc</span> <span class="o">=</span> <span class="n">GymEnvironmentProcess</span><span class="p">(</span><span class="n">proc_no</span><span class="p">,</span> <span class="n">env_num</span><span class="p">,</span> <span class="n">create_env</span><span class="p">,</span> \
<span class="go">        actions, observations, initial_states)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">env_proc</span><span class="o">.</span><span class="n">start</span><span class="p">()</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.environment.EnvironmentProcess.run">
<span class="sig-name descname"><span class="pre">run</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/env_process.html#EnvironmentProcess.run"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.EnvironmentProcess.run" title="Permalink to this definition"></a></dt>
<dd><p>Method to be run in sub-process; can be overridden in sub-class</p>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.environment.GymEnvironment">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.environment.</span></span><span class="sig-name descname"><span class="pre">GymEnvironment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/gym_environment.html#GymEnvironment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.GymEnvironment" title="Permalink to this definition"></a></dt>
<dd><p>The GymEnvironment class provides the functions to interact with
different environments.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>params</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – A dictionary contains all the parameters which are used to create the
instance of GymEnvironment, such as name of environment.</p>
</dd>
</dl>
<dl class="simple">
<dt>Supported Platforms:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">Ascend</span></code> <code class="docutils literal notranslate"><span class="pre">GPU</span></code> <code class="docutils literal notranslate"><span class="pre">CPU</span></code></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">env_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;CartPole-v0&#39;</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">environment</span> <span class="o">=</span> <span class="n">GymEnvironment</span><span class="p">(</span><span class="n">env_params</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">environment</span><span class="p">)</span>
<span class="go">GymEnvironment&lt;&gt;</span>
</pre></div>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.GymEnvironment.action_space">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">action_space</span></span><a class="headerlink" href="#mindspore_rl.environment.GymEnvironment.action_space" title="Permalink to this definition"></a></dt>
<dd><p>Get the action space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tuple which states for the space of action</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.GymEnvironment.observation_space">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">observation_space</span></span><a class="headerlink" href="#mindspore_rl.environment.GymEnvironment.observation_space" title="Permalink to this definition"></a></dt>
<dd><p>Get the state space of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tuple which states for the space of state</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.environment.GymEnvironment.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/gym_environment.html#GymEnvironment.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.GymEnvironment.reset" title="Permalink to this definition"></a></dt>
<dd><p>Reset the environment to the initial state. It is always used at the beginning of each
episode. It will return the value of initial state.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tensor which states for the initial state of environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.environment.GymEnvironment.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/gym_environment.html#GymEnvironment.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.GymEnvironment.step" title="Permalink to this definition"></a></dt>
<dd><p>Execute the environment step, which means that interact with environment once.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>action</strong> (<em>Tensor</em>) – A tensor that contains the action information.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>state (Tensor), the environment state after performing the action.</p></li>
<li><p>reward (Tensor), the reward after performing the action.</p></li>
<li><p>done (mindspore.bool_), whether the simulation finishes or not.</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.environment.GymMultiEnvironment">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.environment.</span></span><span class="sig-name descname"><span class="pre">GymMultiEnvironment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">params</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/gym_multi_environment.html#GymMultiEnvironment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.GymMultiEnvironment" title="Permalink to this definition"></a></dt>
<dd><p>The GymMultiEnvironment class provides the functions to interact with
different environments. It is the multi-environment version of GymEnvironment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>params</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – A dictionary contains all the parameters which are used to create the
instance of GymEnvironment, such as name of environment, number of environment.</p>
</dd>
</dl>
<dl class="simple">
<dt>Supported Platforms:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">Ascend</span></code> <code class="docutils literal notranslate"><span class="pre">GPU</span></code> <code class="docutils literal notranslate"><span class="pre">CPU</span></code></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">env_params</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;CartPole-v0&#39;</span><span class="p">,</span> <span class="s1">&#39;env_nums&#39;</span><span class="p">:</span> <span class="mi">10</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">environment</span> <span class="o">=</span> <span class="n">GymMultiEnvironment</span><span class="p">(</span><span class="n">env_params</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">environment</span><span class="p">)</span>
<span class="go">GymMultiEnvironment&lt;&gt;</span>
</pre></div>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.GymMultiEnvironment.action_space">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">action_space</span></span><a class="headerlink" href="#mindspore_rl.environment.GymMultiEnvironment.action_space" title="Permalink to this definition"></a></dt>
<dd><p>Get the action space dim of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tuple which states for the space dimension of action</p>
</dd>
</dl>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.GymMultiEnvironment.observation_space">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">observation_space</span></span><a class="headerlink" href="#mindspore_rl.environment.GymMultiEnvironment.observation_space" title="Permalink to this definition"></a></dt>
<dd><p>Get the state space dim of the environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A tuple which states for the space dimension of state</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.environment.GymMultiEnvironment.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/gym_multi_environment.html#GymMultiEnvironment.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.GymMultiEnvironment.reset" title="Permalink to this definition"></a></dt>
<dd><p>Reset the environment to the initial state. It is always used at the beginning of each
episode. It will return the value of initial state of each environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A list of tensor which states for all the initial states of each environment.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.environment.GymMultiEnvironment.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/gym_multi_environment.html#GymMultiEnvironment.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.GymMultiEnvironment.step" title="Permalink to this definition"></a></dt>
<dd><p>Execute the environment step, which means that interact with environment once.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>action</strong> (<em>Tensor</em>) – A tensor that contains the action information.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p>state (Tensor), a list of environment state after performing the action.</p></li>
<li><p>reward (Tensor), a list of reward after performing the action.</p></li>
<li><p>done (Tensor), whether the simulations of each environment finishes or not</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.environment.MsEnvironment">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.environment.</span></span><span class="sig-name descname"><span class="pre">MsEnvironment</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">kwargs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/ms_environment.html#MsEnvironment"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.MsEnvironment" title="Permalink to this definition"></a></dt>
<dd><p>Class encapsulates built-in environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>kwargs</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – <p>The dictionary of environment specific configurations. See below table for details:</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 21%" />
<col style="width: 31%" />
<col style="width: 19%" />
<col style="width: 29%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Environment name</p></th>
<th class="head"><p>Configuration Parameters</p></th>
<th class="head"><p>Default value</p></th>
<th class="head"><p>Notices</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td rowspan="10"><p>Tag</p></td>
<td><p>seed</p></td>
<td><p>42</p></td>
<td><p>random seed</p></td>
</tr>
<tr class="row-odd"><td><p>environment_num</p></td>
<td><p>2</p></td>
<td><p>number of environments</p></td>
</tr>
<tr class="row-even"><td><p>predator_num</p></td>
<td><p>10</p></td>
<td><p>number of predators</p></td>
</tr>
<tr class="row-odd"><td><p>max_timestep</p></td>
<td><p>100</p></td>
<td><p>max timestep per episode</p></td>
</tr>
<tr class="row-even"><td><p>map_length</p></td>
<td><p>100</p></td>
<td><p>length of map</p></td>
</tr>
<tr class="row-odd"><td><p>map_width</p></td>
<td><p>100</p></td>
<td><p>width of map</p></td>
</tr>
<tr class="row-even"><td><p>wall_hit_penalty</p></td>
<td><p>0.1</p></td>
<td><p>agent wall hit penalty</p></td>
</tr>
<tr class="row-odd"><td><p>catch_reward</p></td>
<td><p>10</p></td>
<td><p>predator catch reward</p></td>
</tr>
<tr class="row-even"><td><p>caught_penalty</p></td>
<td><p>5</p></td>
<td><p>prey caught penalty</p></td>
</tr>
<tr class="row-odd"><td><p>step_cost</p></td>
<td><p>0.01</p></td>
<td><p>step cost</p></td>
</tr>
</tbody>
</table>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">config</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;name&#39;</span><span class="p">:</span> <span class="s1">&#39;Tag&#39;</span><span class="p">,</span> <span class="s1">&#39;predator_num&#39;</span><span class="p">:</span> <span class="mi">4</span><span class="p">}</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">env</span> <span class="o">=</span> <span class="n">MsEnvironment</span><span class="p">(</span><span class="n">config</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">observation</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">action</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">action_space</span><span class="o">.</span><span class="n">sample</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ret</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ret</span><span class="p">))</span>
<span class="go">3</span>
</pre></div>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.MsEnvironment.action_space">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">action_space</span></span><a class="headerlink" href="#mindspore_rl.environment.MsEnvironment.action_space" title="Permalink to this definition"></a></dt>
<dd><p>Get the valid action space of the environment.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.MsEnvironment.config">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">config</span></span><a class="headerlink" href="#mindspore_rl.environment.MsEnvironment.config" title="Permalink to this definition"></a></dt>
<dd><p>Get environment configuration.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.MsEnvironment.done_space">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">done_space</span></span><a class="headerlink" href="#mindspore_rl.environment.MsEnvironment.done_space" title="Permalink to this definition"></a></dt>
<dd><p>Get the valid done space of the environment.</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.MsEnvironment.observation_space">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">observation_space</span></span><a class="headerlink" href="#mindspore_rl.environment.MsEnvironment.observation_space" title="Permalink to this definition"></a></dt>
<dd><p>Get the valid observation space of the environment.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.environment.MsEnvironment.reset">
<span class="sig-name descname"><span class="pre">reset</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/ms_environment.html#MsEnvironment.reset"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.MsEnvironment.reset" title="Permalink to this definition"></a></dt>
<dd><p>Reset the environment to initial observation and return the initial observation.</p>
<dl class="simple">
<dt>Inputs:</dt><dd><p>No inputs.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>Tensor, the initial observation.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">env</span> <span class="o">=</span> <span class="n">MsEnvironment</span><span class="p">(</span><span class="s1">&#39;Tag&#39;</span><span class="p">,</span> <span class="n">predator_num</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">observation</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
</pre></div>
</div>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.MsEnvironment.reward_space">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">reward_space</span></span><a class="headerlink" href="#mindspore_rl.environment.MsEnvironment.reward_space" title="Permalink to this definition"></a></dt>
<dd><p>Get the valid reward space of the environment.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.environment.MsEnvironment.step">
<span class="sig-name descname"><span class="pre">step</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/ms_environment.html#MsEnvironment.step"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.MsEnvironment.step" title="Permalink to this definition"></a></dt>
<dd><p>Run one timestep of environment.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>action</strong> (<em>Tensor</em>) – Action provided by the all of agents.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><p>Tuple of 3 tensors, the observation, the reward and the done.</p>
<ul class="simple">
<li><p><strong>observation</strong> (Tensor) - Observations of all agents after action.</p></li>
<li><p><strong>reward</strong> (Tensor) - Amount of reward returned by the environment.</p></li>
<li><p><strong>done</strong> (Tensor) - Whether the episode has ended.</p></li>
</ul>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">env</span> <span class="o">=</span> <span class="n">MsEnvironment</span><span class="p">(</span><span class="s1">&#39;Tag&#39;</span><span class="p">,</span> <span class="n">predator_num</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">observation</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">reset</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">action</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">(</span><span class="n">env</span><span class="o">.</span><span class="n">action_space</span><span class="o">.</span><span class="n">sample</span><span class="p">())</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ret</span> <span class="o">=</span> <span class="n">env</span><span class="o">.</span><span class="n">step</span><span class="p">(</span><span class="n">action</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">ret</span><span class="p">))</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.environment.Space">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.environment.</span></span><span class="sig-name descname"><span class="pre">Space</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">feature_shape</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dtype</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">low</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">high</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_shape</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/space.html#Space"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.Space" title="Permalink to this definition"></a></dt>
<dd><p>The class for environment action/observation space.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>feature_shape</strong> (<em>-</em>) – The action/observation shape before batching.</p></li>
<li><p><strong>dtype</strong> (<em>-</em>) – The action/observation space dtype.</p></li>
<li><p><strong>low</strong> (<em>-</em>) – The action/observation space lower boundary.</p></li>
<li><p><strong>high</strong> (<em>-</em>) – The action/observation space upper boundary.</p></li>
<li><p><strong>batch_shape</strong> (<em>-</em>) – The batch shape for vectorization.
It usually be used in multi-environment and multi-agent cases.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">action_space</span> <span class="o">=</span> <span class="n">Space</span><span class="p">(</span><span class="n">feature_shape</span><span class="o">=</span><span class="p">(</span><span class="mi">6</span><span class="p">,),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">action_space</span><span class="o">.</span><span class="n">ms_dtype</span><span class="p">)</span>
<span class="go">Int32</span>
</pre></div>
</div>
<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.Space.is_discrete">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">is_discrete</span></span><a class="headerlink" href="#mindspore_rl.environment.Space.is_discrete" title="Permalink to this definition"></a></dt>
<dd><p>Is discrete space</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.Space.ms_dtype">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">ms_dtype</span></span><a class="headerlink" href="#mindspore_rl.environment.Space.ms_dtype" title="Permalink to this definition"></a></dt>
<dd><p>MindSpore data type</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.Space.np_dtype">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">np_dtype</span></span><a class="headerlink" href="#mindspore_rl.environment.Space.np_dtype" title="Permalink to this definition"></a></dt>
<dd><p>Numpy data type</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.Space.num_values">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">num_values</span></span><a class="headerlink" href="#mindspore_rl.environment.Space.num_values" title="Permalink to this definition"></a></dt>
<dd><p>The number of optional enumeration values</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.environment.Space.sample">
<span class="sig-name descname"><span class="pre">sample</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/environment/space.html#Space.sample"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.environment.Space.sample" title="Permalink to this definition"></a></dt>
<dd><p>Take a sample from the space</p>
</dd></dl>

<dl class="py property">
<dt class="sig sig-object py" id="mindspore_rl.environment.Space.shape">
<em class="property"><span class="pre">property</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">shape</span></span><a class="headerlink" href="#mindspore_rl.environment.Space.shape" title="Permalink to this definition"></a></dt>
<dd><p>Space shape after batching</p>
</dd></dl>

</dd></dl>

</section>
<section id="module-mindspore_rl.network">
<span id="mindspore-rl-network"></span><h2>mindspore_rl.network<a class="headerlink" href="#module-mindspore_rl.network" title="Permalink to this headline"></a></h2>
<p>Network component used to implement polices.</p>
<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.network.FullyConnectedNet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.network.</span></span><span class="sig-name descname"><span class="pre">FullyConnectedNet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">compute_type</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">mstype.float32</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/network/fully_connected_net.html#FullyConnectedNet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.network.FullyConnectedNet" title="Permalink to this definition"></a></dt>
<dd><p>A basic fully connected neural network.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_size</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – numbers of input size.</p></li>
<li><p><strong>hidden_size</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – numbers of hidden layers.</p></li>
<li><p><strong>output_size</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – numbers of output size.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="nb">input</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">net</span> <span class="o">=</span> <span class="n">FullyConnectedNet</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">net</span><span class="p">(</span><span class="nb">input</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(2, 2)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.network.FullyConnectedNet.construct">
<span class="sig-name descname"><span class="pre">construct</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/network/fully_connected_net.html#FullyConnectedNet.construct"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.network.FullyConnectedNet.construct" title="Permalink to this definition"></a></dt>
<dd><p>Returns output of Dense layer.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>x</strong> (<em>Tensor</em>) – Tensor as the input of network.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The output of the Dense layer.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.network.GruNet">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.network.</span></span><span class="sig-name descname"><span class="pre">GruNet</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hidden_size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">weight_init</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">'normal'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_layers</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">has_bias</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_first</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dropout</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">bidirectional</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/network/gru_net.html#GruNet"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.network.GruNet" title="Permalink to this definition"></a></dt>
<dd><p>Stacked GRU (Gated Recurrent Unit) layers.</p>
<p>Apply GRU layer to the input.</p>
<p>For detailed information, please refer to <code class="xref py py-class docutils literal notranslate"><span class="pre">mindspore.nn.GRU</span></code>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_size</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Number of features of input.</p></li>
<li><p><strong>hidden_size</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Number of features of hidden layer.</p></li>
<li><p><strong>weight_init</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a><em> or </em><em>initializer</em>) – Initialize method. Default: normal.</p></li>
<li><p><strong>num_layers</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Number of layers of stacked GRU. Default: 1.</p></li>
<li><p><strong>has_bias</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Whether the cell has bias <cite>b_ih</cite> and <cite>b_hh</cite>. Default: True.</p></li>
<li><p><strong>batch_first</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Specifies whether the first dimension of input <cite>x</cite> is batch_size. Default: False.</p></li>
<li><p><strong>dropout</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – If not 0.0, append <cite>Dropout</cite> layer on the outputs of each
GRU layer except the last layer. Default 0.0. The range of dropout is [0.0, 1.0).</p></li>
<li><p><strong>bidirectional</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a>) – Specifies whether it is a bidirectional GRU,
num_directions=2 if bidirectional=True otherwise 1. Default: False.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Inputs:</dt><dd><ul class="simple">
<li><p><strong>x_in</strong> (Tensor) - Tensor of data type mindspore.float32 and
shape (seq_len, batch_size, <cite>input_size</cite>) or (batch_size, seq_len, <cite>input_size</cite>).</p></li>
<li><p><strong>h_in</strong> (Tensor) - Tensor of data type mindspore.float32 and
shape (num_directions * <cite>num_layers</cite>, batch_size, <cite>hidden_size</cite>). The data type of <cite>h_in</cite> must be the same as
<cite>x_in</cite>.</p></li>
</ul>
</dd>
<dt>Outputs:</dt><dd><p>Tuple, a tuple contains (<cite>x_out</cite>, <cite>h_out</cite>).</p>
<ul class="simple">
<li><p><strong>x_out</strong> (Tensor) - Tensor of shape (seq_len, batch_size, num_directions * <cite>hidden_size</cite>) or
(batch_size, seq_len, num_directions * <cite>hidden_size</cite>).</p></li>
<li><p><strong>h_out</strong> (Tensor) - Tensor of shape (num_directions * <cite>num_layers</cite>, batch_size, <cite>hidden_size</cite>).</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">net</span> <span class="o">=</span> <span class="n">GruNet</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="n">has_bias</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">bidirectional</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x_in</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">10</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">h_in</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">16</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">x_out</span><span class="p">,</span> <span class="n">h_out</span> <span class="o">=</span> <span class="n">net</span><span class="p">(</span><span class="n">x_in</span><span class="p">,</span> <span class="n">h_in</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">x_out</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(3, 5, 16)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.network.GruNet.construct">
<span class="sig-name descname"><span class="pre">construct</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">x_in</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">h_in</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/network/gru_net.html#GruNet.construct"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.network.GruNet.construct" title="Permalink to this definition"></a></dt>
<dd><p>The forward calculation of gru net</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>x_in</strong> (<em>Tensor</em>) – Tensor of data type mindspore.float32 and shape (seq_len, batch_size, <cite>input_size</cite>)
or (batch_size, seq_len, <cite>input_size</cite>).</p></li>
<li><p><strong>h_in</strong> (<em>Tensor</em>) – Tensor of data type mindspore.float32 and shape (num_directions * <cite>num_layers</cite>,
batch_size, <cite>hidden_size</cite>). The data type of <cite>h_in</cite> must be the same as <cite>x_in</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p><ul class="simple">
<li><p><strong>x_out</strong> (Tensor) - Tensor of shape (seq_len, batch_size, num_directions * <cite>hidden_size</cite>) or
(batch_size, seq_len, num_directions * <cite>hidden_size</cite>).</p></li>
<li><p><strong>h_out</strong> (Tensor) - Tensor of shape (num_directions * <cite>num_layers</cite>, batch_size, <cite>hidden_size</cite>).</p></li>
</ul>
</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<section id="module-mindspore_rl.policy">
<span id="mindspore-rl-policy"></span><h2>mindspore_rl.policy<a class="headerlink" href="#module-mindspore_rl.policy" title="Permalink to this headline"></a></h2>
<p>Policies used in RL algorithms.</p>
<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.policy.EpsilonGreedyPolicy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.policy.</span></span><span class="sig-name descname"><span class="pre">EpsilonGreedyPolicy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_network</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsi_high</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">epsi_low</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">decay</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">action_space_dim</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/policy/epsilon_greedy_policy.html#EpsilonGreedyPolicy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.policy.EpsilonGreedyPolicy" title="Permalink to this definition"></a></dt>
<dd><p>Produces an epsilon-greedy sample action base on the given policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>input_network</strong> (<em>Cell</em>) – A network returns policy action.</p></li>
<li><p><strong>size</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Shape of epsilon.</p></li>
<li><p><strong>epsi_high</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – A high epsilon for exploration betweens [0, 1].</p></li>
<li><p><strong>epsi_low</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – A low epsilon for exploration betweens [0, epsi_high].</p></li>
<li><p><strong>decay</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a>) – A decay factor applied to epsilon.</p></li>
<li><p><strong>action_space_dim</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – Dimensions of the action space.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">state_dim</span><span class="p">,</span> <span class="n">hidden_dim</span><span class="p">,</span> <span class="n">action_dim</span> <span class="o">=</span> <span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_net</span> <span class="o">=</span> <span class="n">FullyConnectedNet</span><span class="p">(</span><span class="n">state_dim</span><span class="p">,</span> <span class="n">hidden_dim</span><span class="p">,</span> <span class="n">action_dim</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">policy</span> <span class="o">=</span> <span class="n">EpsilonGreedyPolicy</span><span class="p">(</span><span class="n">input_net</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="mi">100</span><span class="p">,</span> <span class="n">action_dim</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">state</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="n">state_dim</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">step</span> <span class="o">=</span>  <span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">10</span><span class="p">,])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">policy</span><span class="p">(</span><span class="n">state</span><span class="p">,</span> <span class="n">step</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(1,)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.policy.EpsilonGreedyPolicy.construct">
<span class="sig-name descname"><span class="pre">construct</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">step</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/policy/epsilon_greedy_policy.html#EpsilonGreedyPolicy.construct"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.policy.EpsilonGreedyPolicy.construct" title="Permalink to this definition"></a></dt>
<dd><p>The interface of the construct function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>state</strong> (<em>Tensor</em>) – The input tensor for network.</p></li>
<li><p><strong>step</strong> (<em>Tensor</em>) – The current step, effects the epsilon decay.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>The output action.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.policy.GreedyPolicy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.policy.</span></span><span class="sig-name descname"><span class="pre">GreedyPolicy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">input_network</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/policy/greedy_policy.html#GreedyPolicy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.policy.GreedyPolicy" title="Permalink to this definition"></a></dt>
<dd><p>Produces a greedy action base on the given policy.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>input_network</strong> (<em>Cell</em>) – network used to generate action probs by input state.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">state_dim</span><span class="p">,</span> <span class="n">hidden_dim</span><span class="p">,</span> <span class="n">action_dim</span> <span class="o">=</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_net</span> <span class="o">=</span> <span class="n">FullyConnectedNet</span><span class="p">(</span><span class="n">state_dim</span><span class="p">,</span> <span class="n">hidden_dim</span><span class="p">,</span> <span class="n">action_dim</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">policy</span> <span class="o">=</span> <span class="n">GreedyPolicy</span><span class="p">(</span><span class="n">input_net</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">state</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">policy</span><span class="p">(</span><span class="n">state</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(2,)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.policy.GreedyPolicy.construct">
<span class="sig-name descname"><span class="pre">construct</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">state</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/policy/greedy_policy.html#GreedyPolicy.construct"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.policy.GreedyPolicy.construct" title="Permalink to this definition"></a></dt>
<dd><p>Returns the best action.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>state</strong> (<em>Tensor</em>) – State tensor as the input of network.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>action_max, the best action.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.policy.Policy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.policy.</span></span><span class="sig-name descname"><span class="pre">Policy</span></span><a class="reference internal" href="_modules/mindspore_rl/policy/policy.html#Policy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.policy.Policy" title="Permalink to this definition"></a></dt>
<dd><p>The virtual base class for the policy. This class should be overridden before calling in the model.</p>
<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.policy.Policy.construct">
<span class="sig-name descname"><span class="pre">construct</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="o"><span class="pre">*</span></span><span class="n"><span class="pre">inputs</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/policy/policy.html#Policy.construct"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.policy.Policy.construct" title="Permalink to this definition"></a></dt>
<dd><p>The interface of the construct function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>inputs</strong> – it’s depended on the user definition.</p></li>
<li><p><strong>kwargs</strong> – it’s depended on the user definition.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>User defined.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_rl.policy.RandomPolicy">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_rl.policy.</span></span><span class="sig-name descname"><span class="pre">RandomPolicy</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">action_space_dim</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/policy/random_policy.html#RandomPolicy"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.policy.RandomPolicy" title="Permalink to this definition"></a></dt>
<dd><p>Produces a random action betweens [0, <cite>acton_space_dim</cite>).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>acton_space_dim</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – dimension of the action space.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="n">action_space_dim</span> <span class="o">=</span> <span class="mi">2</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">policy</span> <span class="o">=</span> <span class="n">RandomPolicy</span><span class="p">(</span><span class="n">action_space_dim</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">output</span> <span class="o">=</span> <span class="n">policy</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">output</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(1,)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mindspore_rl.policy.RandomPolicy.construct">
<span class="sig-name descname"><span class="pre">construct</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_rl/policy/random_policy.html#RandomPolicy.construct"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_rl.policy.RandomPolicy.construct" title="Permalink to this definition"></a></dt>
<dd><p>Returns a random number betweens [0, <cite>acton_space_dim</cite>).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns</dt>
<dd class="field-odd"><p>A random integer betweens [0, <cite>acton_space_dim</cite>).</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="dqn.html" class="btn btn-neutral float-left" title="使用MindSpore Reinforcement实现深度Q学习（DQN）" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright MindSpore.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 
</body>
</html>