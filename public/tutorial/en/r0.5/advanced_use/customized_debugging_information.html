

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Customized Debugging Information &mdash; MindSpore r0.5 documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Training Process Visualization" href="visualization_tutorials.html" />
    <link rel="prev" title="Debugging in PyNative Mode" href="debugging_in_pynative_mode.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home"> MindSpore
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Quick Start</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../quick_start/quick_start.html">Implementing an Image Classification Application</a></li>
</ul>
<p class="caption"><span class="caption-text">Use</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../use/data_preparation/data_preparation.html">Data Preparation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../use/defining_the_network.html">Defining the Network</a></li>
<li class="toctree-l1"><a class="reference internal" href="../use/saving_and_loading_model_parameters.html">Saving and Loading Model Parameters</a></li>
<li class="toctree-l1"><a class="reference internal" href="../use/multi_platform_inference.html">Multi-platform Inference</a></li>
</ul>
<p class="caption"><span class="caption-text">Application</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="computer_vision_application.html">Computer Vision Applications</a></li>
<li class="toctree-l1"><a class="reference internal" href="nlp_application.html">Natural Language Processing (NLP) Application</a></li>
</ul>
<p class="caption"><span class="caption-text">Model Optimization</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="debugging_in_pynative_mode.html">Debugging in PyNative Mode</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Customized Debugging Information</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#overview">Overview</a></li>
<li class="toctree-l2"><a class="reference internal" href="#introduction-to-callback">Introduction to Callback</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#callback-capabilities-of-mindspore">Callback Capabilities of MindSpore</a></li>
<li class="toctree-l3"><a class="reference internal" href="#custom-callback">Custom Callback</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#mindspore-metrics">MindSpore Metrics</a></li>
<li class="toctree-l2"><a class="reference internal" href="#mindspore-print-operator">MindSpore Print Operator</a></li>
<li class="toctree-l2"><a class="reference internal" href="#log-related-environment-variables-and-configurations">Log-related Environment Variables and Configurations</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="visualization_tutorials.html">Training Process Visualization</a></li>
</ul>
<p class="caption"><span class="caption-text">Performance Optimization</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="distributed_training_tutorials.html">Distributed training</a></li>
<li class="toctree-l1"><a class="reference internal" href="mixed_precision.html">Mixed Precision</a></li>
</ul>
<p class="caption"><span class="caption-text">Usage on Device</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="on_device_inference.html">On-Device Inference</a></li>
</ul>
<p class="caption"><span class="caption-text">Network Migration</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="network_migration.html">Network Migration</a></li>
</ul>
<p class="caption"><span class="caption-text">AI Security and Privacy</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="model_security.html">Model Security</a></li>
<li class="toctree-l1"><a class="reference internal" href="differential_privacy.html">Differential Privacy in Machine Learning</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MindSpore</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html">Docs</a> &raquo;</li>
        
      <li>Customized Debugging Information</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../_sources/advanced_use/customized_debugging_information.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="customized-debugging-information">
<h1>Customized Debugging Information<a class="headerlink" href="#customized-debugging-information" title="Permalink to this headline">¶</a></h1>
<!-- TOC --><ul class="simple">
<li><p><a class="reference external" href="#customized-debugging-information">Customized Debugging Information</a></p>
<ul>
<li><p><a class="reference external" href="#overview">Overview</a></p></li>
<li><p><a class="reference external" href="#introduction-to-callback">Introduction to Callback</a></p>
<ul>
<li><p><a class="reference external" href="#callback-capabilities-of-mindspore">Callback Capabilities of MindSpore</a></p></li>
<li><p><a class="reference external" href="#custom-callback">Custom Callback</a></p></li>
</ul>
</li>
<li><p><a class="reference external" href="#mindspore-metrics">MindSpore Metrics</a></p></li>
<li><p><a class="reference external" href="#mindspore-print-operator">MindSpore Print Operator</a></p></li>
<li><p><a class="reference external" href="#log-related-environment-variables-and-configurations">Log-related Environment Variables and Configurations</a></p></li>
</ul>
</li>
</ul>
<!-- /TOC --><p><a href="https://gitee.com/mindspore/docs/blob/r0.5/tutorials/source_en/advanced_use/customized_debugging_information.md" target="_blank"><img src="../_static/logo_source.png"></a></p>
<div class="section" id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline">¶</a></h2>
<p>This section describes how to use the customized capabilities provided by MindSpore, such as <code class="docutils literal notranslate"><span class="pre">callback</span></code>, <code class="docutils literal notranslate"><span class="pre">metrics</span></code>,<code class="docutils literal notranslate"><span class="pre">Print</span></code> operator and log printing, to help you quickly debug the training network.</p>
</div>
<div class="section" id="introduction-to-callback">
<h2>Introduction to Callback<a class="headerlink" href="#introduction-to-callback" title="Permalink to this headline">¶</a></h2>
<p>Callback here is not a function but a class. You can use callback to observe the internal status and related information of the network during training or perform specific actions in a specific period.
For example, you can monitor the loss, save model parameters, dynamically adjust parameters, and terminate training tasks in advance.</p>
<div class="section" id="callback-capabilities-of-mindspore">
<h3>Callback Capabilities of MindSpore<a class="headerlink" href="#callback-capabilities-of-mindspore" title="Permalink to this headline">¶</a></h3>
<p>MindSpore provides the callback capabilities to allow users to insert customized operations in a specific phase of training or inference, including:</p>
<ul class="simple">
<li><p>Callback functions such as <code class="docutils literal notranslate"><span class="pre">ModelCheckpoint</span></code>, <code class="docutils literal notranslate"><span class="pre">LossMonitor</span></code>, and <code class="docutils literal notranslate"><span class="pre">SummaryStep</span></code> provided by the MindSpore framework</p></li>
<li><p>Custom callback functions</p></li>
</ul>
<p>Usage: Transfer the callback object in the <code class="docutils literal notranslate"><span class="pre">model.train</span></code> method. The callback object can be a list, for example:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ckpt_cb</span> <span class="o">=</span> <span class="n">ModelCheckpoint</span><span class="p">()</span>                                                            
<span class="n">loss_cb</span> <span class="o">=</span> <span class="n">LossMonitor</span><span class="p">()</span>
<span class="n">summary_cb</span> <span class="o">=</span> <span class="n">SummaryStep</span><span class="p">()</span>
<span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">epoch</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">ckpt_cb</span><span class="p">,</span> <span class="n">loss_cb</span><span class="p">,</span> <span class="n">summary_cb</span><span class="p">])</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">ModelCheckpoint</span></code> can save model parameters for retraining or inference.
<code class="docutils literal notranslate"><span class="pre">LossMonitor</span></code> can output loss information in logs for users to view. In addition, <code class="docutils literal notranslate"><span class="pre">LossMonitor</span></code> monitors the loss value change during training. When the loss value is <code class="docutils literal notranslate"><span class="pre">Nan</span></code> or <code class="docutils literal notranslate"><span class="pre">Inf</span></code>, the training terminates.
SummaryStep can save the training information to a file for later use.
During the training process, the callback list will execute the callback function in the defined order. Therefore, in the definition process, the dependency between callbacks needs to be considered.</p>
</div>
<div class="section" id="custom-callback">
<h3>Custom Callback<a class="headerlink" href="#custom-callback" title="Permalink to this headline">¶</a></h3>
<p>You can customize callback based on the <code class="docutils literal notranslate"><span class="pre">callback</span></code> base class as required.</p>
<p>The callback base class is defined as follows:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">Callback</span><span class="p">():</span>
    <span class="sd">&quot;&quot;&quot;Callback base class&quot;&quot;&quot;</span> 
    <span class="k">def</span> <span class="nf">begin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">run_context</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Called once before the network executing.&quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">epoch_begin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">run_context</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Called before each epoch beginning.&quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">epoch_end</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">run_context</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Called after each epoch finished.&quot;&quot;&quot;</span> 
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">step_begin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">run_context</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Called before each epoch beginning.&quot;&quot;&quot;</span> 
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">step_end</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">run_context</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Called after each step finished.&quot;&quot;&quot;</span>
        <span class="k">pass</span>

    <span class="k">def</span> <span class="nf">end</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">run_context</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Called once after network training.&quot;&quot;&quot;</span>
        <span class="k">pass</span>
</pre></div>
</div>
<p>The callback can record important information during training and transfer the information to the callback object through a dictionary variable <code class="docutils literal notranslate"><span class="pre">cb_params</span></code>,
You can obtain related attributes from each custom callback and perform customized operations. You can also customize other variables and transfer them to the <code class="docutils literal notranslate"><span class="pre">cb_params</span></code> object.</p>
<p>The main attributes of <code class="docutils literal notranslate"><span class="pre">cb_params</span></code> are as follows:</p>
<ul class="simple">
<li><p>loss_fn: Loss function</p></li>
<li><p>optimizer: Optimizer</p></li>
<li><p>train_dataset: Training dataset</p></li>
<li><p>cur_epoch_num: Number of current epochs</p></li>
<li><p>cur_step_num: Number of current steps</p></li>
<li><p>batch_num: Number of steps in an epoch</p></li>
<li><p>…</p></li>
</ul>
<p>You can inherit the callback base class to customize a callback object.</p>
<p>The following example describes how to use a custom callback function.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">StopAtTime</span><span class="p">(</span><span class="n">Callback</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">run_time</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">StopAtTime</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">run_time</span> <span class="o">=</span> <span class="n">run_time</span><span class="o">*</span><span class="mi">60</span>

    <span class="k">def</span> <span class="nf">begin</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">run_context</span><span class="p">):</span>
        <span class="n">cb_params</span> <span class="o">=</span> <span class="n">run_context</span><span class="o">.</span><span class="n">original_args</span><span class="p">()</span>
        <span class="n">cb_params</span><span class="o">.</span><span class="n">init_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
    
    <span class="k">def</span> <span class="nf">step_end</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">run_context</span><span class="p">):</span>
        <span class="n">cb_params</span> <span class="o">=</span> <span class="n">run_context</span><span class="o">.</span><span class="n">original_args</span><span class="p">()</span>
        <span class="n">epoch_num</span> <span class="o">=</span> <span class="n">cb_params</span><span class="o">.</span><span class="n">cur_epoch_num</span>
        <span class="n">step_num</span> <span class="o">=</span> <span class="n">cb_params</span><span class="o">.</span><span class="n">cur_step_num</span>
        <span class="n">loss</span> <span class="o">=</span> <span class="n">cb_params</span><span class="o">.</span><span class="n">net_outputs</span>
	<span class="n">cur_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
	<span class="k">if</span> <span class="p">(</span><span class="n">cur_time</span> <span class="o">-</span> <span class="n">cb_params</span><span class="o">.</span><span class="n">init_time</span><span class="p">)</span> <span class="o">&gt;</span> <span class="bp">self</span><span class="o">.</span><span class="n">run_time</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;epoch: &quot;</span><span class="p">,</span> <span class="n">epoch_num</span><span class="p">,</span> <span class="s2">&quot; step: &quot;</span><span class="p">,</span> <span class="n">step_num</span><span class="p">,</span> <span class="s2">&quot; loss: &quot;</span><span class="p">,</span> <span class="n">loss</span><span class="p">)</span>
            <span class="n">run_context</span><span class="o">.</span><span class="n">request_stop</span><span class="p">()</span>

<span class="n">stop_cb</span> <span class="o">=</span> <span class="n">StopAtTime</span><span class="p">(</span><span class="n">run_time</span><span class="o">=</span><span class="mi">10</span><span class="p">)</span>
<span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="n">dataset</span><span class="p">,</span> <span class="n">callbacks</span><span class="o">=</span><span class="n">stop_cb</span><span class="p">)</span>
</pre></div>
</div>
<p>The output is as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">epoch</span><span class="p">:</span> <span class="mi">20</span> <span class="n">step</span><span class="p">:</span> <span class="mi">32</span> <span class="n">loss</span><span class="p">:</span> <span class="mf">2.298344373703003</span>
</pre></div>
</div>
<p>This callback function is used to terminate the training within a specified period. You can use the <code class="docutils literal notranslate"><span class="pre">run_context.original_args</span></code> method to obtain the <code class="docutils literal notranslate"><span class="pre">cb_params</span></code> dictionary, which contains the main attribute information described above.
In addition, you can modify and add values in the dictionary. In the preceding example, an <code class="docutils literal notranslate"><span class="pre">init_time</span></code> object is defined in <code class="docutils literal notranslate"><span class="pre">begin</span></code> and transferred to the <code class="docutils literal notranslate"><span class="pre">cb_params</span></code> dictionary.
A decision is made at each <code class="docutils literal notranslate"><span class="pre">step_end</span></code>. When the training time is greater than the configured time threshold, a training termination signal will be sent to the <code class="docutils literal notranslate"><span class="pre">run_context</span></code> to terminate the training in advance and the current values of epoch, step, and loss will be printed.</p>
</div>
</div>
<div class="section" id="mindspore-metrics">
<h2>MindSpore Metrics<a class="headerlink" href="#mindspore-metrics" title="Permalink to this headline">¶</a></h2>
<p>After the training is complete, you can use metrics to evaluate the training result.</p>
<p>MindSpore provides multiple metrics, such as <code class="docutils literal notranslate"><span class="pre">accuracy</span></code>, <code class="docutils literal notranslate"><span class="pre">loss</span></code>, <code class="docutils literal notranslate"><span class="pre">tolerance</span></code>, <code class="docutils literal notranslate"><span class="pre">recall</span></code>, and <code class="docutils literal notranslate"><span class="pre">F1</span></code>.</p>
<p>You can define a metrics dictionary object that contains multiple metrics and transfer them to the <code class="docutils literal notranslate"><span class="pre">model.eval</span></code> interface to verify the training precision.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">metrics</span> <span class="o">=</span> <span class="p">{</span>
    <span class="s1">&#39;accuracy&#39;</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Accuracy</span><span class="p">(),</span>
    <span class="s1">&#39;loss&#39;</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Loss</span><span class="p">(),</span>
    <span class="s1">&#39;precision&#39;</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Precision</span><span class="p">(),</span>
    <span class="s1">&#39;recall&#39;</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">Recall</span><span class="p">(),</span>
    <span class="s1">&#39;f1_score&#39;</span><span class="p">:</span> <span class="n">nn</span><span class="o">.</span><span class="n">F1</span><span class="p">()</span>
<span class="p">}</span>
<span class="n">net</span> <span class="o">=</span> <span class="n">ResNet</span><span class="p">()</span>
<span class="n">loss</span> <span class="o">=</span> <span class="n">CrossEntropyLoss</span><span class="p">()</span>
<span class="n">opt</span> <span class="o">=</span> <span class="n">Momentum</span><span class="p">()</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="n">loss_fn</span><span class="o">=</span><span class="n">loss</span><span class="p">,</span> <span class="n">optimizer</span><span class="o">=</span><span class="n">opt</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="n">metrics</span><span class="p">)</span>
<span class="n">ds_eval</span> <span class="o">=</span> <span class="n">create_dataset</span><span class="p">()</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">ds_eval</span><span class="p">)</span>
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">model.eval</span></code> method returns a dictionary that contains the metrics and results transferred to the metrics.</p>
<p>You can also define your own metrics class by inheriting the <code class="docutils literal notranslate"><span class="pre">Metric</span></code> base class and rewriting the <code class="docutils literal notranslate"><span class="pre">clear</span></code>, <code class="docutils literal notranslate"><span class="pre">update</span></code>, and <code class="docutils literal notranslate"><span class="pre">eval</span></code> methods.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">accuracy</span></code> operator is used as an example to describe the internal implementation principle.</p>
<p>The <code class="docutils literal notranslate"><span class="pre">accuracy</span></code> inherits the <code class="docutils literal notranslate"><span class="pre">EvaluationBase</span></code> base class and rewrites the preceding three methods.
The <code class="docutils literal notranslate"><span class="pre">clear</span></code> method initializes related calculation parameters in the class.
The <code class="docutils literal notranslate"><span class="pre">update</span></code> method accepts the predicted value and tag value and updates the internal variables of accuracy.
The <code class="docutils literal notranslate"><span class="pre">eval</span></code> method calculates related indicators and returns the calculation result.
By invoking the <code class="docutils literal notranslate"><span class="pre">eval</span></code> method of <code class="docutils literal notranslate"><span class="pre">accuracy</span></code>, you will obtain the calculation result.</p>
<p>You can understand how <code class="docutils literal notranslate"><span class="pre">accuracy</span></code> runs by using the following code:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.3</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">]]))</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">]))</span>
<span class="n">metric</span> <span class="o">=</span> <span class="n">Accuracy</span><span class="p">()</span>
<span class="n">metric</span><span class="o">.</span><span class="n">clear</span><span class="p">()</span>
<span class="n">metric</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
<span class="n">accuracy</span> <span class="o">=</span> <span class="n">metric</span><span class="o">.</span><span class="n">eval</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s1">&#39;Accuracy is &#39;</span><span class="p">,</span> <span class="n">accuracy</span><span class="p">)</span>
</pre></div>
</div>
<p>The output is as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Accuracy</span> <span class="ow">is</span> <span class="mf">0.6667</span>
</pre></div>
</div>
</div>
<div class="section" id="mindspore-print-operator">
<h2>MindSpore Print Operator<a class="headerlink" href="#mindspore-print-operator" title="Permalink to this headline">¶</a></h2>
<p>MindSpore-developed <code class="docutils literal notranslate"><span class="pre">Print</span></code> operator is used to print the tensors or character strings input by users. Multiple strings, multiple tensors, and a combination of tensors and strings are supported, which are separated by comma (,).
The use method of MindSpore <code class="docutils literal notranslate"><span class="pre">Print</span></code> operator is the same that of other operators. You need to assert MindSpore <code class="docutils literal notranslate"><span class="pre">Print</span></code> operator in <code class="docutils literal notranslate"><span class="pre">__init__</span></code> and invoke using <code class="docutils literal notranslate"><span class="pre">construct</span></code>. The following is an example.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">mindspore</span> <span class="kn">import</span> <span class="n">Tensor</span>
<span class="kn">from</span> <span class="nn">mindspore.ops</span> <span class="kn">import</span> <span class="n">operations</span> <span class="k">as</span> <span class="n">P</span>
<span class="kn">import</span> <span class="nn">mindspore.nn</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="kn">import</span> <span class="nn">mindspore.context</span> <span class="k">as</span> <span class="nn">context</span>

<span class="n">context</span><span class="o">.</span><span class="n">set_context</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="n">context</span><span class="o">.</span><span class="n">GRAPH_MODE</span><span class="p">)</span>

<span class="k">class</span> <span class="nc">PrintDemo</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Cell</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">PrintDemo</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">print</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">Print</span><span class="p">()</span>

    <span class="k">def</span> <span class="nf">construct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;print Tensor x and Tensor y:&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">x</span>

<span class="n">x</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">))</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">))</span>
<span class="n">net</span> <span class="o">=</span> <span class="n">PrintDemo</span><span class="p">()</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">net</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
<p>The output is as follows：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span> <span class="n">Tensor</span> <span class="n">x</span> <span class="ow">and</span> <span class="n">Tensor</span> <span class="n">y</span><span class="p">:</span>
<span class="n">Tensor</span> <span class="n">shape</span><span class="p">:[[</span><span class="n">const</span> <span class="n">vector</span><span class="p">][</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">]]</span><span class="n">Int32</span>
<span class="n">val</span><span class="p">:[[</span><span class="mi">1</span><span class="p">]</span>
<span class="p">[</span><span class="mi">1</span><span class="p">]]</span>
<span class="n">Tensor</span> <span class="n">shape</span><span class="p">:[[</span><span class="n">const</span> <span class="n">vector</span><span class="p">][</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">]]</span><span class="n">Int32</span>
<span class="n">val</span><span class="p">:[[</span><span class="mi">1</span> <span class="mi">1</span><span class="p">]</span>
<span class="p">[</span><span class="mi">1</span> <span class="mi">1</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="section" id="log-related-environment-variables-and-configurations">
<h2>Log-related Environment Variables and Configurations<a class="headerlink" href="#log-related-environment-variables-and-configurations" title="Permalink to this headline">¶</a></h2>
<p>MindSpore uses glog to output logs. The following environment variables are commonly used:</p>
<ol class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">GLOG_v</span></code> specifies the log level. The default value is 2, indicating the WARNING level. The values are as follows: 0: DEBUG; 1: INFO; 2: WARNING; 3: ERROR.</p></li>
<li><p>When <code class="docutils literal notranslate"><span class="pre">GLOG_logtostderr</span></code> is set to 1, logs are output to the screen. If the value is set to 0, logs are output to a file. Default value: 1</p></li>
<li><p>GLOG_log_dir=<em>YourPath</em> specifies the log output path. If <code class="docutils literal notranslate"><span class="pre">GLOG_logtostderr</span></code> is set to 0, value of this variable must be specified. If <code class="docutils literal notranslate"><span class="pre">GLOG_log_dir</span> <span class="pre">is</span></code> specified and the value of <code class="docutils literal notranslate"><span class="pre">GLOG_logtostderr</span></code> is 1, logs are output to the screen but not to a file. Logs of C++ and Python will be output to different files. The file name of C++ log complies with the naming rule of GLOG log file. Here, the name is <code class="docutils literal notranslate"><span class="pre">mindspore.MachineName.UserName.log.LogLevel.Timestamp</span></code>. The file name of Python log is <code class="docutils literal notranslate"><span class="pre">mindspore.log</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">MS_SUBMODULE_LOG_v=&quot;{SubModule1:LogLevel1,SubModule2:LogLevel2,...}&quot;</span></code> specifies log levels of C++ sub modules of MindSpore. The specified sub module log level will overwrite the global log level. The meaning of submodule log level is same as <code class="docutils literal notranslate"><span class="pre">GLOG_v</span></code>, the sub modules of MindSpore grouped by source directory is as the bellow table. E.g. when set <code class="docutils literal notranslate"><span class="pre">GLOG_v=1</span> <span class="pre">MS_SUBMODULE_LOG_v=&quot;{PARSER:2,ANALYZER:2}&quot;</span></code> then log levels of <code class="docutils literal notranslate"><span class="pre">PARSER</span></code> and <code class="docutils literal notranslate"><span class="pre">ANALYZER</span></code> are WARNING, other modules’ log levels are INFO.</p></li>
</ol>
<p>Sub moudles of MindSpore grouped by source directory:</p>
<table border="1" class="docutils">
<thead>
<tr>
<th>Source Files</th>
<th>Sub Module Name</th>
</tr>
</thead>
<tbody>
<tr>
<td>mindspore/ccsrc/common</td>
<td>COMMON</td>
</tr>
<tr>
<td>mindspore/ccsrc/dataset</td>
<td>MD</td>
</tr>
<tr>
<td>mindspore/ccsrc/debug</td>
<td>DEBUG</td>
</tr>
<tr>
<td>mindspore/ccsrc/device</td>
<td>DEVICE</td>
</tr>
<tr>
<td>mindspore/ccsrc/gvar</td>
<td>COMMON</td>
</tr>
<tr>
<td>mindspore/ccsrc/ir</td>
<td>IR</td>
</tr>
<tr>
<td>mindspore/ccsrc/kernel</td>
<td>KERNEL</td>
</tr>
<tr>
<td>mindspore/ccsrc/mindrecord</td>
<td>MD</td>
</tr>
<tr>
<td>mindspore/ccsrc</td>
<td>ME</td>
</tr>
<tr>
<td>mindspore/ccsrc/onnx</td>
<td>ONNX</td>
</tr>
<tr>
<td>mindspore/ccsrc/operator</td>
<td>ANALYZER</td>
</tr>
<tr>
<td>mindspore/ccsrc/optimizer</td>
<td>OPTIMIZER</td>
</tr>
<tr>
<td>mindspore/ccsrc/parallel</td>
<td>PARALLEL</td>
</tr>
<tr>
<td>mindspore/ccsrc/pipeline/*.cc</td>
<td>PIPELINE</td>
</tr>
<tr>
<td>mindspore/ccsrc/pipeline/parse</td>
<td>PARSER</td>
</tr>
<tr>
<td>mindspore/ccsrc/pipeline/static_analysis</td>
<td>ANALYZER</td>
</tr>
<tr>
<td>mindspore/ccsrc/pre_activate</td>
<td>PRE_ACT</td>
</tr>
<tr>
<td>mindspore/ccsrc/pybind_api</td>
<td>COMMON</td>
</tr>
<tr>
<td>mindspore/ccsrc/pynative</td>
<td>PYNATIVE</td>
</tr>
<tr>
<td>mindspore/ccsrc/session</td>
<td>SESSION</td>
</tr>
<tr>
<td>mindspore/ccsrc/transform</td>
<td>GE_ADPT</td>
</tr>
<tr>
<td>mindspore/ccsrc/utils</td>
<td>UTILS</td>
</tr>
<tr>
<td>mindspore/ccsrc/vm</td>
<td>VM</td>
</tr>
</tbody>
</table></div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="visualization_tutorials.html" class="btn btn-neutral float-right" title="Training Process Visualization" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="debugging_in_pynative_mode.html" class="btn btn-neutral float-left" title="Debugging in PyNative Mode" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, MindSpore

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>