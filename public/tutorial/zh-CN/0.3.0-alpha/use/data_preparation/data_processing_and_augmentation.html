

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>数据处理与数据增强 &mdash; MindSpore 0.3.0-alpha documentation</title>
  

  
  
  
  

  
  <script type="text/javascript" src="../../_static/js/modernizr.min.js"></script>
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/language_data.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="定义网络" href="../defining_the_network.html" />
    <link rel="prev" title="将数据集转换为MindSpore数据格式" href="converting_datasets.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> MindSpore
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">快速入门</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../quick_start/quick_start.html">实现一个图片分类应用</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../quick_start/quick_video.html">手把手安装和体验</a></li>
</ul>
<p class="caption"><span class="caption-text">使用指南</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="reference internal" href="data_preparation.html">准备数据</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="loading_the_datasets.html">加载数据集</a></li>
<li class="toctree-l2"><a class="reference internal" href="converting_datasets.html">将数据集转换为MindSpore数据格式</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">数据处理与数据增强</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#id2">概述</a></li>
<li class="toctree-l3"><a class="reference internal" href="#mindspore">MindSpore支持的数据处理操作</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#repeat">repeat</a></li>
<li class="toctree-l4"><a class="reference internal" href="#batch">batch</a></li>
<li class="toctree-l4"><a class="reference internal" href="#shuffle">shuffle</a></li>
<li class="toctree-l4"><a class="reference internal" href="#map">map</a></li>
<li class="toctree-l4"><a class="reference internal" href="#zip">zip</a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#id3">数据增强</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#c-transforms">使用<code class="docutils literal notranslate"><span class="pre">c_transforms</span></code>模块进行数据增强</a></li>
<li class="toctree-l4"><a class="reference internal" href="#py-transforms">使用<code class="docutils literal notranslate"><span class="pre">py_transforms</span></code>模块进行数据增强</a></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../defining_the_network.html">定义网络</a></li>
<li class="toctree-l1"><a class="reference internal" href="../saving_and_loading_model_parameters.html">模型参数的保存和加载</a></li>
<li class="toctree-l1"><a class="reference internal" href="../multi_platform_inference.html">多平台推理</a></li>
</ul>
<p class="caption"><span class="caption-text">应用实践</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../advanced_use/computer_vision_application.html">计算机视觉应用</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../advanced_use/nlp_application.html">自然语言处理应用</a></li>
</ul>
<p class="caption"><span class="caption-text">模型调优</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../advanced_use/debugging_in_pynative_mode.html">使用PyNative模式调试</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../advanced_use/customized_debugging_information.html">自定义调试信息</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../advanced_use/visualization_tutorials.html">训练过程可视</a></li>
</ul>
<p class="caption"><span class="caption-text">性能优化</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../advanced_use/distributed_training_tutorials.html">分布式并行训练</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../advanced_use/mixed_precision.html">混合精度</a></li>
</ul>
<p class="caption"><span class="caption-text">端云使用</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../advanced_use/use_on_the_cloud.html">在云上使用MindSpore</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../advanced_use/on_device_inference.html">端侧推理</a></li>
</ul>
<p class="caption"><span class="caption-text">网络迁移</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../advanced_use/network_migration.html">网络迁移</a></li>
</ul>
<p class="caption"><span class="caption-text">AI安全和隐私</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../advanced_use/model_security.html">模型安全</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../advanced_use/differential_privacy.html">机器学习中的差分隐私</a></li>
</ul>

            
          
        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">MindSpore</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html">Docs</a> &raquo;</li>
        
          <li><a href="data_preparation.html">准备数据</a> &raquo;</li>
        
      <li>数据处理与数据增强</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="../../_sources/use/data_preparation/data_processing_and_augmentation.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="id1">
<h1>数据处理与数据增强<a class="headerlink" href="#id1" title="Permalink to this headline">¶</a></h1>
<!-- TOC --><ul class="simple">
<li><p><a class="reference external" href="#%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%E4%B8%8E%E6%95%B0%E6%8D%AE%E5%A2%9E%E5%BC%BA">数据处理与数据增强</a></p>
<ul>
<li><p><a class="reference external" href="#%E6%A6%82%E8%BF%B0">概述</a></p></li>
<li><p><a class="reference external" href="#mindspore%E6%94%AF%E6%8C%81%E7%9A%84%E6%95%B0%E6%8D%AE%E5%A4%84%E7%90%86%E6%93%8D%E4%BD%9C">MindSpore支持的数据处理操作</a></p>
<ul>
<li><p><a class="reference external" href="#repeat">repeat</a></p></li>
<li><p><a class="reference external" href="#batch">batch</a></p></li>
<li><p><a class="reference external" href="#shuffle">shuffle</a></p></li>
<li><p><a class="reference external" href="#map">map</a></p></li>
<li><p><a class="reference external" href="#zip">zip</a></p></li>
</ul>
</li>
<li><p><a class="reference external" href="#%E6%95%B0%E6%8D%AE%E5%A2%9E%E5%BC%BA">数据增强</a></p>
<ul>
<li><p><a class="reference external" href="#%E4%BD%BF%E7%94%A8c_transforms%E6%A8%A1%E5%9D%97%E8%BF%9B%E8%A1%8C%E6%95%B0%E6%8D%AE%E5%A2%9E%E5%BC%BA">使用<code class="docutils literal notranslate"><span class="pre">c_transforms</span></code>模块进行数据增强</a></p></li>
<li><p><a class="reference external" href="#%E4%BD%BF%E7%94%A8py_transforms%E6%A8%A1%E5%9D%97%E8%BF%9B%E8%A1%8C%E6%95%B0%E6%8D%AE%E5%A2%9E%E5%BC%BA">使用<code class="docutils literal notranslate"><span class="pre">py_transforms</span></code>模块进行数据增强</a></p></li>
</ul>
</li>
</ul>
</li>
</ul>
<!-- /TOC --><p><a href="https://gitee.com/mindspore/docs/blob/r0.3/tutorials/source_zh_cn/use/data_preparation/data_processing_and_augmentation.md" target="_blank"><img src="../../_static/logo_source.png"></a></p>
<div class="section" id="id2">
<h2>概述<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h2>
<p>数据是深度学习的基础，有好的数据输入，可以对整个深度神经网络训练起到非常积极的作用。所以在获取到原始的数据集后，数据加载训练前，因为数据量、性能等等限制，往往会需要先进行数据处理或者数据增强，从而获得更加优化的数据输入。<br />同样，MindSpore也为用户提供了数据处理以及数据增强的功能。</p>
<blockquote>
<div><p>从本质上来说，数据增强是通过数据处理中的<code class="docutils literal notranslate"><span class="pre">map</span></code>（映射）进行实现，但是因为数据增强提供丰富的变换操作，所以将其单独提出进行描述。</p>
</div></blockquote>
</div>
<div class="section" id="mindspore">
<h2>MindSpore支持的数据处理操作<a class="headerlink" href="#mindspore" title="Permalink to this headline">¶</a></h2>
<p>MindSpore支持多种处理数据操作，包括复制、分批、洗牌、映射等等，详细见下表：</p>
<table border="1" class="docutils">
<thead>
<tr>
<th>数据处理</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td>repeat</td>
<td>对数据集进行复制，来加倍数据量。</td>
</tr>
<tr>
<td>batch</td>
<td>将数据分批处理，有益于加速训练过程。</td>
</tr>
<tr>
<td>shuffle</td>
<td>对数据进行混洗。</td>
</tr>
<tr>
<td>map</td>
<td>将提供的函数或算子作用于指定的列数据。</td>
</tr>
<tr>
<td>zip</td>
<td>将多个数据集合并成一个数据集。</td>
</tr>
</tbody>
</table><p>各个操作可以单独进行使用，实际使用过程中往往会根据实际需要进行组合使用，组合使用时推荐使用的顺序如下所示：</p>
<p><img alt="avatar" src="../../_images/dataset_pipeline.png" /></p>
<p>如下示例中，读取MNIST数据集时，对数据进行shuffle、batch、repeat操作。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mindspore.dataset</span> <span class="k">as</span> <span class="nn">ds</span>

<span class="n">ds1</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">MnistDataset</span><span class="p">(</span><span class="n">MNIST_DATASET_PATH</span><span class="p">,</span> <span class="n">MNIST_SCHEMA</span><span class="p">)</span>  <span class="c1"># Create MNIST dataset.</span>

<span class="n">ds1</span> <span class="o">=</span> <span class="n">ds1</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">buffer_size</span><span class="o">=</span><span class="mi">10000</span><span class="p">)</span> 
<span class="n">ds1</span> <span class="o">=</span> <span class="n">ds1</span><span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="mi">32</span><span class="p">,</span> <span class="n">drop_remainder</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">ds1</span> <span class="o">=</span> <span class="n">ds1</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">10</span><span class="p">)</span>
</pre></div>
</div>
<p>上面操作先对数据进行混洗，再将每32条数据组成一个batch，最后将数据集重复10次。</p>
<p>下面将构造一个简单数据集<code class="docutils literal notranslate"><span class="pre">ds1</span></code>，并对其进行数据处理操作，来介绍各类数据处理操作的详细使用。</p>
<ol>
<li><p>导入数据处理操作依赖的模块。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mindspore.dataset</span> <span class="k">as</span> <span class="nn">ds</span>
</pre></div>
</div>
</li>
<li><p>定义一个生成数据集的函数——<code class="docutils literal notranslate"><span class="pre">generator_func()</span></code>用于生成数据集。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span> <span class="k">def</span> <span class="nf">generator_func</span><span class="p">():</span>
     <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
         <span class="k">yield</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">i</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="mi">2</span><span class="p">]),)</span>
</pre></div>
</div>
</li>
<li><p>通过<code class="docutils literal notranslate"><span class="pre">GeneratorDataset</span></code>创建<code class="docutils literal notranslate"><span class="pre">ds1</span></code>数据集，用于执行数据处理操作。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ds1</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">GeneratorDataset</span><span class="p">(</span><span class="n">generator_func</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">])</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ds1:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">ds1</span><span class="o">.</span><span class="n">create_dict_iterator</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">])</span>
</pre></div>
</div>
<p>输出：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ds1</span><span class="p">:</span>
<span class="p">[</span><span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span><span class="p">]</span>
<span class="p">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">]</span>
<span class="p">[</span><span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span><span class="p">]</span>
<span class="p">[</span><span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span><span class="p">]</span>
<span class="p">[</span><span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span><span class="p">]</span>
</pre></div>
</div>
</li>
</ol>
<div class="section" id="repeat">
<h3>repeat<a class="headerlink" href="#repeat" title="Permalink to this headline">¶</a></h3>
<p>在有限的数据集内，为了优化网络，通常会将一个数据集训练多次。</p>
<p><img alt="avatar" src="../../_images/repeat.png" /></p>
<blockquote>
<div><p>在机器学习中，每训练完一个完整的数据集，我们称为训练完了一个epoch。</p>
</div></blockquote>
<p>加倍数据集，通常用在多个epoch（迭代）训练中，通过<code class="docutils literal notranslate"><span class="pre">repeat()</span></code>来加倍数据量。<code class="docutils literal notranslate"><span class="pre">repeat()</span></code>定义如下：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">repeat</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">count</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</pre></div>
</div>
<p>我们可以定义<code class="docutils literal notranslate"><span class="pre">ds2</span></code>数据集，调用<code class="docutils literal notranslate"><span class="pre">repeat</span></code>来加倍数据量。示例代码如下：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ds2</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">GeneratorDataset</span><span class="p">(</span><span class="n">generator_func</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">])</span>
<span class="n">ds2</span> <span class="o">=</span> <span class="n">ds2</span><span class="o">.</span><span class="n">repeat</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ds2:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">ds2</span><span class="o">.</span><span class="n">create_dict_iterator</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">])</span>
</pre></div>
</div>
<p>其中，将倍数设为2，故<code class="docutils literal notranslate"><span class="pre">ds2</span></code>数据量为原始数据集<code class="docutils literal notranslate"><span class="pre">ds1</span></code>的2倍，输出：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">ds2</span><span class="p">:</span>
<span class="p">[</span><span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span><span class="p">]</span>
<span class="p">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">]</span>
<span class="p">[</span><span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span><span class="p">]</span>
<span class="p">[</span><span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span><span class="p">]</span>
<span class="p">[</span><span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span><span class="p">]</span>
<span class="p">[</span><span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span><span class="p">]</span>
<span class="p">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">]</span>
<span class="p">[</span><span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span><span class="p">]</span>
<span class="p">[</span><span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span><span class="p">]</span>
<span class="p">[</span><span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="batch">
<h3>batch<a class="headerlink" href="#batch" title="Permalink to this headline">¶</a></h3>
<p>将数据集进行分批。在实际训练中，可将数据分批处理，将几个数据作为1组，进行训练，减少训练轮次，达到加速训练过程的目的。MindSpore通过<code class="docutils literal notranslate"><span class="pre">batch()</span></code>函数来实现数据集分批，函数定义如下：</p>
<p><img alt="avatar" src="../../_images/batch.png" /></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">batch</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">batch_size</span><span class="p">,</span> <span class="n">drop_remainder</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">num_parallel_workers</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<p>使用GeneratorDataset产生的数据集<code class="docutils literal notranslate"><span class="pre">ds1</span></code>构建2个数据集。</p>
<ul class="simple">
<li><p>第1个数据集<code class="docutils literal notranslate"><span class="pre">ds2</span></code>，每2条数据为1组。</p></li>
<li><p>第2个数据集<code class="docutils literal notranslate"><span class="pre">ds3</span></code>，每3条数据为1组，并将不足1组的数据截掉。</p></li>
</ul>
<p><code class="docutils literal notranslate"><span class="pre">ds2</span></code>示例代码如下：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ds2</span> <span class="o">=</span> <span class="n">ds1</span><span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>  <span class="c1"># Default drop_remainder is False, the last remainder batch isn&#39;t dropped.</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;batch size:2    drop remainder:False&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">ds2</span><span class="o">.</span><span class="n">create_dict_iterator</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">])</span>
</pre></div>
</div>
<p>输出如下所示：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">batch</span> <span class="n">size</span><span class="p">:</span><span class="mi">2</span>    <span class="n">drop</span> <span class="n">remainder</span><span class="p">:</span><span class="kc">False</span>
<span class="p">[[</span><span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span><span class="p">]</span>
 <span class="p">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">]]</span>
<span class="p">[[</span><span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span><span class="p">]</span>
 <span class="p">[</span><span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span><span class="p">]]</span>
<span class="p">[[</span><span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span><span class="p">]]</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">ds3</span></code>示例代码如下：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ds3</span> <span class="o">=</span> <span class="n">ds1</span><span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="n">batch_size</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">drop_remainder</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># When drop_remainder is True, the last remainder batch will be dropped.</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;batch size:3    drop remainder:True&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">ds3</span><span class="o">.</span><span class="n">create_dict_iterator</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">])</span>
</pre></div>
</div>
<p>输出如下所示：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">batch</span> <span class="n">size</span><span class="p">:</span><span class="mi">3</span>    <span class="n">drop</span> <span class="n">remainder</span><span class="p">:</span><span class="kc">True</span>
<span class="p">[[</span><span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span><span class="p">]</span>
 <span class="p">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">]</span>
 <span class="p">[</span><span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span><span class="p">]]</span>
</pre></div>
</div>
</div>
<div class="section" id="shuffle">
<h3>shuffle<a class="headerlink" href="#shuffle" title="Permalink to this headline">¶</a></h3>
<p>对于有序的数据集或者进行过repeat的数据集可以进行混洗。</p>
<p><img alt="avatar" src="../../_images/shuffle.png" /></p>
<p>shuffle操作主要用来将数据混洗，设定的buffer_size越大，混洗程度越大，但时间、计算资源消耗会大。
<code class="docutils literal notranslate"><span class="pre">shuffle()</span></code>定义如下：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">shuffle</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">buffer_size</span><span class="p">):</span>
</pre></div>
</div>
<p>调用<code class="docutils literal notranslate"><span class="pre">shuffle()</span></code>对数据集<code class="docutils literal notranslate"><span class="pre">ds1</span></code>进行混洗,示例代码如下：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Before shuffle:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">ds1</span><span class="o">.</span><span class="n">create_dict_iterator</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">])</span>

<span class="n">ds2</span> <span class="o">=</span> <span class="n">ds1</span><span class="o">.</span><span class="n">shuffle</span><span class="p">(</span><span class="n">buffer_size</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;After shuffle:&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">ds2</span><span class="o">.</span><span class="n">create_dict_iterator</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">])</span>
</pre></div>
</div>
<p>可能的输出如下，可以看到进行数据混洗后，数据的顺序发生了随机的变化。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">Before</span> <span class="n">shuffle</span><span class="p">:</span>
<span class="p">[</span><span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span><span class="p">]</span>
<span class="p">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">]</span>
<span class="p">[</span><span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span><span class="p">]</span>
<span class="p">[</span><span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span><span class="p">]</span>
<span class="p">[</span><span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span><span class="p">]</span>
<span class="n">After</span> <span class="n">shuffle</span><span class="p">:</span>
<span class="p">[</span><span class="mi">3</span> <span class="mi">4</span> <span class="mi">5</span><span class="p">]</span>
<span class="p">[</span><span class="mi">2</span> <span class="mi">3</span> <span class="mi">4</span><span class="p">]</span>
<span class="p">[</span><span class="mi">4</span> <span class="mi">5</span> <span class="mi">6</span><span class="p">]</span>
<span class="p">[</span><span class="mi">1</span> <span class="mi">2</span> <span class="mi">3</span><span class="p">]</span>
<span class="p">[</span><span class="mi">0</span> <span class="mi">1</span> <span class="mi">2</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="map">
<h3>map<a class="headerlink" href="#map" title="Permalink to this headline">¶</a></h3>
<p>map（映射）即对数据进行处理，譬如将彩色图片的数据集转化为灰色图片的数据集等，应用非常灵活。
MindSpore提供<code class="docutils literal notranslate"><span class="pre">map()</span></code>函数对数据集进行映射操作，用户可以将提供的函数或算子作用于指定的列数据。<br />用户可以自定义函数，也可以直接使用<code class="docutils literal notranslate"><span class="pre">c_transforms</span></code>或<code class="docutils literal notranslate"><span class="pre">py_transforms</span></code>做数据增强。</p>
<blockquote>
<div><p>详细的数据增强操作，将在文后数据增强章节进行介绍。</p>
</div></blockquote>
<p><img alt="avatar" src="../../_images/map.png" /></p>
<p><code class="docutils literal notranslate"><span class="pre">map()</span></code>函数定义如下：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">map</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">input_columns</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">operations</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">output_columns</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">columns_order</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">num_parallel_workers</span><span class="o">=</span><span class="kc">None</span><span class="p">):</span>
</pre></div>
</div>
<p>在以下示例中，使用<code class="docutils literal notranslate"><span class="pre">map()</span></code>函数，将定义的匿名函数（lambda函数）作用于数据集<code class="docutils literal notranslate"><span class="pre">ds1</span></code>，使数据集中数据乘以2。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">func</span> <span class="o">=</span> <span class="k">lambda</span> <span class="n">x</span> <span class="p">:</span> <span class="n">x</span><span class="o">*</span><span class="mi">2</span>  <span class="c1"># Define lambda function to multiply each element by 2.</span>
<span class="n">ds2</span> <span class="o">=</span> <span class="n">ds1</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">input_columns</span><span class="o">=</span><span class="s2">&quot;data&quot;</span><span class="p">,</span> <span class="n">operations</span><span class="o">=</span><span class="n">func</span><span class="p">)</span>
<span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">ds2</span><span class="o">.</span><span class="n">create_dict_iterator</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;data&quot;</span><span class="p">])</span>
</pre></div>
</div>
<p>代码输出如下，可以看到数据集<code class="docutils literal notranslate"><span class="pre">ds2</span></code>中各行的数据均乘以了2。</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="mi">0</span> <span class="mi">2</span> <span class="mi">4</span><span class="p">]</span>
<span class="p">[</span><span class="mi">2</span> <span class="mi">4</span> <span class="mi">6</span><span class="p">]</span>
<span class="p">[</span><span class="mi">4</span> <span class="mi">6</span> <span class="mi">8</span><span class="p">]</span>
<span class="p">[</span><span class="mi">6</span> <span class="mi">8</span> <span class="mi">10</span><span class="p">]</span>
<span class="p">[</span><span class="mi">8</span> <span class="mi">10</span> <span class="mi">12</span><span class="p">]</span>
</pre></div>
</div>
</div>
<div class="section" id="zip">
<h3>zip<a class="headerlink" href="#zip" title="Permalink to this headline">¶</a></h3>
<p>MindSpore提供<code class="docutils literal notranslate"><span class="pre">zip()</span></code>函数，可将多个数据集合并成1个数据集。</p>
<blockquote>
<div><p>如果两个数据集的列名相同，则不会合并，请注意列的命名。<br />如果两个数据集的行数不同，合并后的行数将和较小行数保持一致。</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">zip</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">datasets</span><span class="p">):</span>
</pre></div>
</div>
<ol>
<li><p>采用前面构造数据集<code class="docutils literal notranslate"><span class="pre">ds1</span></code>的方法，构造1个数据集<code class="docutils literal notranslate"><span class="pre">ds2</span></code>。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">generator_func2</span><span class="p">():</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">5</span><span class="p">):</span>
        <span class="k">yield</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">i</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="n">i</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">]),)</span>

<span class="n">ds2</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">GeneratorDataset</span><span class="p">(</span><span class="n">generator_func2</span><span class="p">,</span> <span class="p">[</span><span class="s2">&quot;data2&quot;</span><span class="p">])</span>
</pre></div>
</div>
</li>
<li><p>通过<code class="docutils literal notranslate"><span class="pre">zip()</span></code>将数据集<code class="docutils literal notranslate"><span class="pre">ds1</span></code>的<code class="docutils literal notranslate"><span class="pre">data1</span></code>列和数据集<code class="docutils literal notranslate"><span class="pre">ds2</span></code>的<code class="docutils literal notranslate"><span class="pre">data2</span></code>列合并成数据集<code class="docutils literal notranslate"><span class="pre">ds3</span></code>。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ds3</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">zip</span><span class="p">((</span><span class="n">ds1</span><span class="p">,</span> <span class="n">ds2</span><span class="p">))</span>
<span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">ds3</span><span class="o">.</span><span class="n">create_dict_iterator</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
<p>输出如下所示：</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">{</span><span class="s1">&#39;data1&#39;</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int64</span><span class="p">),</span> <span class="s1">&#39;data2&#39;</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">3</span><span class="p">,</span> <span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int64</span><span class="p">)}</span>
<span class="p">{</span><span class="s1">&#39;data1&#39;</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int64</span><span class="p">),</span> <span class="s1">&#39;data2&#39;</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="mi">0</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int64</span><span class="p">)}</span>
<span class="p">{</span><span class="s1">&#39;data1&#39;</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int64</span><span class="p">),</span> <span class="s1">&#39;data2&#39;</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span>  <span class="mi">0</span><span class="p">,</span>  <span class="mi">1</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int64</span><span class="p">)}</span>
<span class="p">{</span><span class="s1">&#39;data1&#39;</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int64</span><span class="p">),</span> <span class="s1">&#39;data2&#39;</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int64</span><span class="p">)}</span>
<span class="p">{</span><span class="s1">&#39;data1&#39;</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int64</span><span class="p">),</span> <span class="s1">&#39;data2&#39;</span><span class="p">:</span> <span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">int64</span><span class="p">)}</span>
</pre></div>
</div>
</li>
</ol>
</div>
</div>
<div class="section" id="id3">
<h2>数据增强<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h2>
<p>在图片训练中，尤其在数据集较小的情况下，用户可以通过一系列的数据增强操作对图片进行预处理，从而丰富了数据集。<br />MindSpore提供<code class="docutils literal notranslate"><span class="pre">c_transforms</span></code>模块以及<code class="docutils literal notranslate"><span class="pre">py_transforms</span></code>模块函数供用户进行数据增强操作，用户也可以自定义函数或者算子进行数据增强。MindSpore提供的两个模块的简要说明如下表，详细的介绍请参考API中对应模块的说明。</p>
<table border="1" class="docutils">
<thead>
<tr>
<th>模块名称</th>
<th>实现</th>
<th>说明</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>c_transforms</code></td>
<td>基于C++的<a href="https://opencv.org/">OpenCV</a>实现</td>
<td>具有较高的性能。</td>
</tr>
<tr>
<td><code>py_transforms</code></td>
<td>基于Python的<a href="https://pypi.org/project/Pillow/">PIL</a>实现</td>
<td>该模块提供了多种图像增强功能，并提供了PIL Image和numpy数组之间的传输方法。</td>
</tr>
</tbody>
</table><p>对于喜欢在图像学习任务中使用Python PIL的用户，<code class="docutils literal notranslate"><span class="pre">py_transforms</span></code>模块是处理图像增强的好工具。用户还可以使用Python PIL自定义自己的扩展。<br />数据增强需要使用<code class="docutils literal notranslate"><span class="pre">map()</span></code>函数，详细<code class="docutils literal notranslate"><span class="pre">map()</span></code>函数的使用，可参考<a class="reference external" href="#map">map</a>章节。</p>
<div class="section" id="c-transforms">
<h3>使用<code class="docutils literal notranslate"><span class="pre">c_transforms</span></code>模块进行数据增强<a class="headerlink" href="#c-transforms" title="Permalink to this headline">¶</a></h3>
<ol>
<li><p>将该模块引入进代码。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mindspore.dataset.transforms.vision.c_transforms</span> <span class="k">as</span> <span class="nn">transforms</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.image</span> <span class="k">as</span> <span class="nn">mpimg</span>
</pre></div>
</div>
</li>
<li><p>定义数据增强算子，以<code class="docutils literal notranslate"><span class="pre">Resize</span></code>为例：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dataset</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">ImageFolderDatasetV2</span><span class="p">(</span><span class="n">DATA_DIR</span><span class="p">,</span> <span class="n">decode</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>  <span class="c1"># Deocde images. </span>
<span class="n">resize_op</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">Resize</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span><span class="mi">500</span><span class="p">),</span> <span class="n">interpolation</span><span class="o">=</span><span class="n">Inter</span><span class="o">.</span><span class="n">LINEAR</span><span class="p">)</span>
<span class="n">dataset</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">input_columns</span><span class="o">=</span><span class="s2">&quot;image&quot;</span><span class="p">,</span> <span class="n">operations</span><span class="o">=</span><span class="n">resize_op</span><span class="p">)</span>

<span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">dataset</span><span class="o">.</span><span class="n">create_dict_iterator</span><span class="p">():</span>
    <span class="n">imgplot_resized</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;image&quot;</span><span class="p">])</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</li>
</ol>
<p>运行结果可以看到，原始图片与进行数据处理（<code class="docutils literal notranslate"><span class="pre">Resize()</span></code>）后的图片对比，可以看到图片由原来的1024*683像素，变化为500*500像素。
<img alt="avatar" src="../../_images/image.png" /></p>
<p>图1：原始图片</p>
<p><img alt="avatar" src="../../_images/image_resized.png" /></p>
<p>图2：重设尺寸后的图片</p>
</div>
<div class="section" id="py-transforms">
<h3>使用<code class="docutils literal notranslate"><span class="pre">py_transforms</span></code>模块进行数据增强<a class="headerlink" href="#py-transforms" title="Permalink to this headline">¶</a></h3>
<ol>
<li><p>将该模块引入到代码。</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mindspore.dataset.transforms.vision.py_transforms</span> <span class="k">as</span> <span class="nn">transforms</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">matplotlib.image</span> <span class="k">as</span> <span class="nn">mpimg</span>
</pre></div>
</div>
</li>
<li><p>定义数据增强算子，通过<code class="docutils literal notranslate"><span class="pre">ComposeOp</span></code>接口将多个数据增强组合使用, 以<code class="docutils literal notranslate"><span class="pre">RandomCrop</span></code>为例：</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">dataset</span> <span class="o">=</span> <span class="n">ds</span><span class="o">.</span><span class="n">ImageFolderDatasetV2</span><span class="p">(</span><span class="n">DATA_DIR</span><span class="p">)</span>

<span class="n">transforms_list</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">transforms</span><span class="o">.</span><span class="n">Decode</span><span class="p">(),</span>  <span class="c1"># Decode images to PIL format.</span>
    <span class="n">transforms</span><span class="o">.</span><span class="n">RandomCrop</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">500</span><span class="p">,</span><span class="mi">500</span><span class="p">)),</span>
    <span class="n">transforms</span><span class="o">.</span><span class="n">ToTensor</span><span class="p">()</span>  <span class="c1"># Convert PIL images to Numpy ndarray.</span>
<span class="p">]</span>
<span class="n">compose</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">ComposeOp</span><span class="p">(</span><span class="n">transforms_list</span><span class="p">)</span>
<span class="n">dataset</span> <span class="o">=</span> <span class="n">dataset</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">input_columns</span><span class="o">=</span><span class="s2">&quot;image&quot;</span><span class="p">,</span> <span class="n">operations</span><span class="o">=</span><span class="n">compose</span><span class="p">())</span>
<span class="k">for</span> <span class="n">data</span> <span class="ow">in</span> <span class="n">dataset</span><span class="o">.</span><span class="n">create_dict_iterator</span><span class="p">():</span>
     <span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;image&quot;</span><span class="p">])</span>
     <span class="n">imgplot_resized</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;image&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">transpose</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">0</span><span class="p">))</span>
     <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</li>
</ol>
<p>运行结果可以看到，原始图片与进行数据处理（<code class="docutils literal notranslate"><span class="pre">RandomCrop()</span></code>）后的图片对比，可以看到图片由原来的1024*683像素，变化为500*500像素。
<img alt="avatar" src="../../_images/image.png" /></p>
<p>图1：原始图片</p>
<p><img alt="avatar" src="../../_images/image_random_crop.png" /></p>
<p>图2：按500*500随机裁剪后的图片</p>
</div>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="../defining_the_network.html" class="btn btn-neutral float-right" title="定义网络" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="converting_datasets.html" class="btn btn-neutral float-left" title="将数据集转换为MindSpore数据格式" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2020, MindSpore

    </p>
  </div>
  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  


  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>