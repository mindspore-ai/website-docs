<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Tensor &mdash; MindSpore master documentation</title><script>;(()=>{const e=localStorage.getItem("ms-theme"),t=window.matchMedia("(prefers-color-scheme: dark)").matches;(e?"dark"===e:t)&&document.documentElement.setAttribute("data-o-theme","dark")})();</script>
      <link rel="stylesheet" href="../_static/css/bootstrap.min.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/training.css" type="text/css" /><link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script><script src="../_static/jquery.js"></script>
        <script src="../_static/js/theme.js"></script><script src="../_static/underscore.js"></script><script src="../_static/doctools.js"></script><script src="../_static/js/training.js"></script><script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script><script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script><script async="async" src="https://cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Dataset" href="dataset.html" />
    <link rel="prev" title="Quick Start" href="quick_start.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> MindSpore
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Quick Start</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="quick_start.html">Quick Start</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Tensor</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#creating-a-tensor">Creating a Tensor</a></li>
<li class="toctree-l2"><a class="reference internal" href="#tensor-attributes">Tensor Attributes</a></li>
<li class="toctree-l2"><a class="reference internal" href="#tensor-indexing">Tensor Indexing</a></li>
<li class="toctree-l2"><a class="reference internal" href="#tensor-operation">Tensor Operation</a></li>
<li class="toctree-l2"><a class="reference internal" href="#conversion-between-tensor-and-numpy">Conversion Between Tensor and NumPy</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#tensor-to-numpy">Tensor to NumPy</a></li>
<li class="toctree-l3"><a class="reference internal" href="#numpy-to-tensor">NumPy to Tensor</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#sparse-tensor">Sparse Tensor</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#csrtensor">CSRTensor</a></li>
<li class="toctree-l3"><a class="reference internal" href="#cootensor">COOTensor</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="dataset.html">Dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="transforms.html">Transforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="model.html">Building a Network</a></li>
<li class="toctree-l1"><a class="reference internal" href="autograd.html">Automatic Differentiation</a></li>
<li class="toctree-l1"><a class="reference internal" href="train.html">Model Training</a></li>
<li class="toctree-l1"><a class="reference internal" href="save_load.html">Saving and Loading the Model</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Advanced</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../advanced/model.html">Advanced Encapsulation: Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/modules.html">Model Module Customization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/dataset.html">Advanced Data Processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/derivation.html">Advanced Automatic Differentiation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/compute_graph.html">Computational Graph</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/mixed_precision.html">Automatic Mix Precision</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MindSpore</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Tensor</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/beginner/tensor.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<p><a class="reference external" href="https://gitee.com/mindspore/docs/blob/r2.0/tutorials/source_en/beginner/tensor.md"><img alt="View Source On Gitee" src="https://mindspore-website.obs.cn-north-4.myhuaweicloud.com/website-images/r2.0/resource/_static/logo_source_en.png" /></a></p>
<p><a class="reference external" href="https://www.mindspore.cn/tutorials/en/r2.0/beginner/introduction.html">Introduction</a> || <a class="reference external" href="https://www.mindspore.cn/tutorials/en/r2.0/beginner/quick_start.html">Quick Start</a> || <strong>Tensor</strong> || <a class="reference external" href="https://www.mindspore.cn/tutorials/en/r2.0/beginner/dataset.html">Dataset</a> || <a class="reference external" href="https://www.mindspore.cn/tutorials/en/r2.0/beginner/transforms.html">Transforms</a> || <a class="reference external" href="https://www.mindspore.cn/tutorials/en/r2.0/beginner/model.html">Model</a> || <a class="reference external" href="https://www.mindspore.cn/tutorials/en/r2.0/beginner/autograd.html">Autograd</a> || <a class="reference external" href="https://www.mindspore.cn/tutorials/en/r2.0/beginner/train.html">Train</a> || <a class="reference external" href="https://www.mindspore.cn/tutorials/en/r2.0/beginner/save_load.html">Save and Load</a></p>
<section id="tensor">
<h1>Tensor<a class="headerlink" href="#tensor" title="Permalink to this headline">ÔÉÅ</a></h1>
<p>Tensor is a multilinear function that can be used to represent linear relationships between vectors, scalars, and other tensors. The basic examples of these linear relations are the inner product, the outer product, the linear map, and the Cartesian product. In the <span class="math notranslate nohighlight">\(n\)</span> dimensional space, its coordinates have <span class="math notranslate nohighlight">\(n^{r}\)</span> components. Each component is a function of coordinates, and these components are also linearly transformed according to certain rules when the coordinates are transformed. <span class="math notranslate nohighlight">\(r\)</span> is called the rank or order of this tensor (not related to the rank or order of the matrix).</p>
<p>A tensor is a special data structure that is similar to arrays and matrices. <a class="reference external" href="https://www.mindspore.cn/docs/en/r2.0/api_python/mindspore/mindspore.Tensor.html">Tensor</a> is the basic data structure in MindSpore network operations. This tutorial describes the attributes and usage of tensors and sparse tensors.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">mindspore</span>
<span class="kn">from</span> <span class="nn">mindspore</span> <span class="kn">import</span> <span class="n">ops</span>
<span class="kn">from</span> <span class="nn">mindspore</span> <span class="kn">import</span> <span class="n">Tensor</span><span class="p">,</span> <span class="n">CSRTensor</span><span class="p">,</span> <span class="n">COOTensor</span>
</pre></div>
</div>
<section id="creating-a-tensor">
<h2>Creating a Tensor<a class="headerlink" href="#creating-a-tensor" title="Permalink to this headline">ÔÉÅ</a></h2>
<p>There are multiple methods for creating tensors. When building a tensor, you can pass the <code class="docutils literal notranslate"><span class="pre">Tensor</span></code>, <code class="docutils literal notranslate"><span class="pre">float</span></code>, <code class="docutils literal notranslate"><span class="pre">int</span></code>, <code class="docutils literal notranslate"><span class="pre">bool</span></code>, <code class="docutils literal notranslate"><span class="pre">tuple</span></code>, <code class="docutils literal notranslate"><span class="pre">list</span></code>, and <code class="docutils literal notranslate"><span class="pre">numpy.ndarray</span></code> types.</p>
<ul>
<li><p><strong>Generating a tensor based on data</strong></p>
<p>You can create a tensor based on data. The data type can be set or automatically inferred by the framework.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">data</span> <span class="o">=</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">]</span>
<span class="n">x_data</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p><strong>Generating a tensor from the NumPy array</strong></p>
<p>You can create a tensor from the NumPy array.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">np_array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="n">x_np</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">(</span><span class="n">np_array</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p><strong>Generating a tensor by using init</strong></p>
<p>When <code class="docutils literal notranslate"><span class="pre">init</span></code> is used to initialize a tensor, the <code class="docutils literal notranslate"><span class="pre">init</span></code>, <code class="docutils literal notranslate"><span class="pre">shape</span></code>, and <code class="docutils literal notranslate"><span class="pre">dtype</span></code> parameters can be transferred.</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">init</span></code>: supports the subclass of <a class="reference external" href="https://mindspore.cn/docs/en/r2.0/api_python/mindspore.common.initializer.html">initializer</a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">shape</span></code>: supports <code class="docutils literal notranslate"><span class="pre">list</span></code>, <code class="docutils literal notranslate"><span class="pre">tuple</span></code>, and <code class="docutils literal notranslate"><span class="pre">int</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">dtype</span></code>: supports <a class="reference external" href="https://www.mindspore.cn/docs/en/r2.0/api_python/mindspore.html#mindspore.dtype">mindspore.dtype</a>.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mindspore.common.initializer</span> <span class="kn">import</span> <span class="n">One</span><span class="p">,</span> <span class="n">Normal</span>

<span class="c1"># Initialize a tensor with ones</span>
<span class="n">tensor1</span> <span class="o">=</span> <span class="n">mindspore</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">mindspore</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">init</span><span class="o">=</span><span class="n">One</span><span class="p">())</span>
<span class="c1"># Initialize a tensor from normal distribution</span>
<span class="n">tensor2</span> <span class="o">=</span> <span class="n">mindspore</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">mindspore</span><span class="o">.</span><span class="n">float32</span><span class="p">,</span> <span class="n">init</span><span class="o">=</span><span class="n">Normal</span><span class="p">())</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;tensor1:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">tensor1</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;tensor2:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">tensor2</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>tensor1:
[[1. 1.]
[1. 1.]]
tensor2:
[[-0.00063482 -0.00916224]
[ 0.01324238 -0.0171206 ]]
</pre></div>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">init</span></code> is used for delayed initialization in parallel mode. Usually, it is not recommended to use <code class="docutils literal notranslate"><span class="pre">init</span></code> interface to initialize parameters.</p>
</li>
<li><p><strong>Inheriting attributes of another tensor to form a new tensor</strong></p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mindspore</span> <span class="kn">import</span> <span class="n">ops</span>

<span class="n">x_ones</span> <span class="o">=</span> <span class="n">ops</span><span class="o">.</span><span class="n">ones_like</span><span class="p">(</span><span class="n">x_data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Ones Tensor: </span><span class="se">\n</span><span class="s2"> </span><span class="si">{</span><span class="n">x_ones</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="n">x_zeros</span> <span class="o">=</span> <span class="n">ops</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">x_data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Zeros Tensor: </span><span class="se">\n</span><span class="s2"> </span><span class="si">{</span><span class="n">x_zeros</span><span class="si">}</span><span class="s2"> </span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Ones Tensor:
[1 1 1 1]

Zeros Tensor:
[0 0 0 0]
</pre></div>
</div>
</li>
</ul>
</section>
<section id="tensor-attributes">
<h2>Tensor Attributes<a class="headerlink" href="#tensor-attributes" title="Permalink to this headline">ÔÉÅ</a></h2>
<p>Tensor attributes include shape, data type, transposed tensor, item size, number of bytes occupied, dimension, size of elements, and stride per dimension.</p>
<ul class="simple">
<li><p>shape: the shape of <code class="docutils literal notranslate"><span class="pre">Tensor</span></code>, a tuple.</p></li>
<li><p>dtype: the dtype of <code class="docutils literal notranslate"><span class="pre">Tensor</span></code>, a data type of MindSpore.</p></li>
<li><p>itemsize: the number of bytes occupied by each element in <code class="docutils literal notranslate"><span class="pre">Tensor</span></code>, which is an integer.</p></li>
<li><p>nbytes: the total number of bytes occupied by <code class="docutils literal notranslate"><span class="pre">Tensor</span></code>, which is an integer.</p></li>
<li><p>ndim: rank of <code class="docutils literal notranslate"><span class="pre">Tensor</span></code>, that is, len(tensor.shape), which is an integer.</p></li>
<li><p>size: the number of all elements in <code class="docutils literal notranslate"><span class="pre">Tensor</span></code>, which is an integer.</p></li>
<li><p>strides: the number of bytes to traverse in each dimension of <code class="docutils literal notranslate"><span class="pre">Tensor</span></code>, which is a tuple.</p></li>
</ul>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">]]),</span> <span class="n">mindspore</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;x_shape:&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;x_dtype:&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;x_itemsize:&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">itemsize</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;x_nbytes:&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">nbytes</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;x_ndim:&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">ndim</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;x_size:&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">size</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;x_strides:&quot;</span><span class="p">,</span> <span class="n">x</span><span class="o">.</span><span class="n">strides</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>x_shape: (2, 2)
x_dtype: Int32
x_itemsize: 4
x_nbytes: 16
x_ndim: 2
x_size: 4
x_strides: (8, 4)
</pre></div>
</div>
</section>
<section id="tensor-indexing">
<h2>Tensor Indexing<a class="headerlink" href="#tensor-indexing" title="Permalink to this headline">ÔÉÅ</a></h2>
<p>Tensor indexing is similar to NumPy indexing. Indexing starts from 0, negative indexing means indexing in reverse order, and colons <code class="docutils literal notranslate"><span class="pre">:</span></code> and <code class="docutils literal notranslate"><span class="pre">...</span></code> are used for slicing.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">tensor</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;First row: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tensor</span><span class="p">[</span><span class="mi">0</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;value of bottom right corner: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tensor</span><span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Last column: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tensor</span><span class="p">[:,</span> <span class="o">-</span><span class="mi">1</span><span class="p">]))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;First column: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">tensor</span><span class="p">[</span><span class="o">...</span><span class="p">,</span> <span class="mi">0</span><span class="p">]))</span>
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>First row: [0. 1.]
value of bottom right corner: 3.0
Last column: [1. 3.]
First column: [0. 2.]
</pre></div>
</div>
</section>
<section id="tensor-operation">
<h2>Tensor Operation<a class="headerlink" href="#tensor-operation" title="Permalink to this headline">ÔÉÅ</a></h2>
<p>There are many operations between tensors, including arithmetic, linear algebra, matrix processing (transposing, indexing, and slicing), and sampling. The usage of tensor operation is similar to that of NumPy. The following describes several operations.</p>
<blockquote>
<div><p>Common arithmetic operations include: addition (+), subtraction (-), multiplication (*), division (/), modulo (%), and exact division (//).</p>
</div></blockquote>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">x</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]),</span> <span class="n">mindspore</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]),</span> <span class="n">mindspore</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>

<span class="n">output_add</span> <span class="o">=</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span>
<span class="n">output_sub</span> <span class="o">=</span> <span class="n">x</span> <span class="o">-</span> <span class="n">y</span>
<span class="n">output_mul</span> <span class="o">=</span> <span class="n">x</span> <span class="o">*</span> <span class="n">y</span>
<span class="n">output_div</span> <span class="o">=</span> <span class="n">y</span> <span class="o">/</span> <span class="n">x</span>
<span class="n">output_mod</span> <span class="o">=</span> <span class="n">y</span> <span class="o">%</span> <span class="n">x</span>
<span class="n">output_floordiv</span> <span class="o">=</span> <span class="n">y</span> <span class="o">//</span> <span class="n">x</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;add:&quot;</span><span class="p">,</span> <span class="n">output_add</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;sub:&quot;</span><span class="p">,</span> <span class="n">output_sub</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;mul:&quot;</span><span class="p">,</span> <span class="n">output_mul</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;div:&quot;</span><span class="p">,</span> <span class="n">output_div</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;mod:&quot;</span><span class="p">,</span> <span class="n">output_mod</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;floordiv:&quot;</span><span class="p">,</span> <span class="n">output_floordiv</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>add: [5. 7. 9.]
sub: [-3. -3. -3.]
mul: [ 4. 10. 18.]
div: [4.  2.5 2. ]
mod: [0. 1. 0.]
floordiv: [4. 2. 2.]
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Concat</span></code> connects a series of tensors in a given dimension.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">data1</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>
<span class="n">data2</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">]])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">ops</span><span class="o">.</span><span class="n">concat</span><span class="p">((</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">),</span> <span class="n">axis</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;shape:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>[[0. 1.]
 [2. 3.]
 [4. 5.]
 [6. 7.]]
shape:
 (4, 2)
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">Stack</span></code> combines two tensors from another dimension.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">data1</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">]])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>
<span class="n">data2</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">6</span><span class="p">,</span> <span class="mi">7</span><span class="p">]])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">float32</span><span class="p">))</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">ops</span><span class="o">.</span><span class="n">stack</span><span class="p">([</span><span class="n">data1</span><span class="p">,</span> <span class="n">data2</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="n">output</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;shape:</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">,</span> <span class="n">output</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>[[[0. 1.]
  [2. 3.]]

 [[4. 5.]
  [6. 7.]]]
shape:
 (2, 2, 2)
</pre></div>
</div>
</section>
<section id="conversion-between-tensor-and-numpy">
<h2>Conversion Between Tensor and NumPy<a class="headerlink" href="#conversion-between-tensor-and-numpy" title="Permalink to this headline">ÔÉÅ</a></h2>
<p>Tensor and NumPy can be converted to each other.</p>
<section id="tensor-to-numpy">
<h3>Tensor to NumPy<a class="headerlink" href="#tensor-to-numpy" title="Permalink to this headline">ÔÉÅ</a></h3>
<p>Use <code class="docutils literal notranslate"><span class="pre">asnumpy()</span></code> to convert Tensor to NumPy, which is same as tensor building.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">t</span> <span class="o">=</span> <span class="n">ops</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">5</span><span class="p">,</span> <span class="n">mindspore</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;t: </span><span class="si">{</span><span class="n">t</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="n">n</span> <span class="o">=</span> <span class="n">t</span><span class="o">.</span><span class="n">asnumpy</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;n: </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>t: [1. 1. 1. 1. 1.]
n: [1. 1. 1. 1. 1.]
</pre></div>
</div>
</section>
<section id="numpy-to-tensor">
<h3>NumPy to Tensor<a class="headerlink" href="#numpy-to-tensor" title="Permalink to this headline">ÔÉÅ</a></h3>
<p>Use <code class="docutils literal notranslate"><span class="pre">Tensor()</span></code> to convert NumPy to Tensor.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">n</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="mi">5</span><span class="p">)</span>
<span class="n">t</span> <span class="o">=</span> <span class="n">Tensor</span><span class="o">.</span><span class="n">from_numpy</span><span class="p">(</span><span class="n">n</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">np</span><span class="o">.</span><span class="n">add</span><span class="p">(</span><span class="n">n</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="n">out</span><span class="o">=</span><span class="n">n</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;t: </span><span class="si">{</span><span class="n">t</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;n: </span><span class="si">{</span><span class="n">n</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>t: [2. 2. 2. 2. 2.]
n: [2. 2. 2. 2. 2.]
</pre></div>
</div>
</section>
</section>
<section id="sparse-tensor">
<h2>Sparse Tensor<a class="headerlink" href="#sparse-tensor" title="Permalink to this headline">ÔÉÅ</a></h2>
<p>A sparse tensor is a special tensor in which the value of the most significant element is zero.</p>
<p>In some scenarios (such as recommendation systems, molecular dynamics, graph neural networks), the data is sparse. If you use common dense tensors to represent the data, you may introduce many unnecessary calculations, storage, and communication costs. In this case, it is better to use sparse tensor to represent the data.</p>
<p>MindSpore now supports the two most commonly used <code class="docutils literal notranslate"><span class="pre">CSR</span></code> and <code class="docutils literal notranslate"><span class="pre">COO</span></code> sparse data formats.</p>
<p>The common structure of the sparse tensor is <code class="docutils literal notranslate"><span class="pre">&lt;indices:Tensor,</span> <span class="pre">values:Tensor,</span> <span class="pre">shape:Tensor&gt;</span></code>. <code class="docutils literal notranslate"><span class="pre">indices</span></code> means the indexes of non-zero elements, <code class="docutils literal notranslate"><span class="pre">values</span></code> means the values of non-zero elements, and <code class="docutils literal notranslate"><span class="pre">shape</span></code> means the dense shape of the sparse tensor. In this structure, we define data structure <code class="docutils literal notranslate"><span class="pre">CSRTensor</span></code>, <code class="docutils literal notranslate"><span class="pre">COOTensor</span></code>, and <code class="docutils literal notranslate"><span class="pre">RowTensor</span></code>.</p>
<section id="csrtensor">
<h3>CSRTensor<a class="headerlink" href="#csrtensor" title="Permalink to this headline">ÔÉÅ</a></h3>
<p>The compressed sparse row (<code class="docutils literal notranslate"><span class="pre">CSR</span></code>) is efficient in both storage and computation. All the non-zero values are stored in <code class="docutils literal notranslate"><span class="pre">values</span></code>, and their positions are stored in <code class="docutils literal notranslate"><span class="pre">indptr</span></code> (row) and <code class="docutils literal notranslate"><span class="pre">indices</span></code> (column). The meaning of each parameter is as follows:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">indptr</span></code>: 1-D integer tensor, indicating the start and end points of the non-zero elements in each row of the sparse data in <code class="docutils literal notranslate"><span class="pre">values</span></code>. The index data type can be int16, int32, or int64.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">indices</span></code>: 1-D integer tensor, indicating the position of the sparse tensor non-zero elements in the column and has the same length as <code class="docutils literal notranslate"><span class="pre">values</span></code>. The index data type can be int16, int32, or int64.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">values</span></code>: 1-D tensor, indicating that the value of the non-zero element corresponding to the <code class="docutils literal notranslate"><span class="pre">CSRTensor</span></code> and has the same length as <code class="docutils literal notranslate"><span class="pre">indices</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">shape</span></code>: indicates the shape of a compressed sparse tensor. The data type is <code class="docutils literal notranslate"><span class="pre">Tuple</span></code>. Currently, only 2-D <code class="docutils literal notranslate"><span class="pre">CSRTensor</span></code> is supported.</p></li>
</ul>
<blockquote>
<div><p>For details about <code class="docutils literal notranslate"><span class="pre">CSRTensor</span></code>, see <a class="reference external" href="https://www.mindspore.cn/docs/en/r2.0/api_python/mindspore/mindspore.CSRTensor.html">mindspore.CSRTensor</a>.</p>
</div></blockquote>
<p>The following are some examples of using the CSRTensor:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">indptr</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span>
<span class="n">indices</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">([</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>
<span class="n">values</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">mindspore</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

<span class="c1"># Make a CSRTensor</span>
<span class="n">csr_tensor</span> <span class="o">=</span> <span class="n">CSRTensor</span><span class="p">(</span><span class="n">indptr</span><span class="p">,</span> <span class="n">indices</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">shape</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">csr_tensor</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">mindspore</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Float64
</pre></div>
</div>
<p>The above code generates a <code class="docutils literal notranslate"><span class="pre">CSRTensor</span></code> as shown in the following equation:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
 \left[
 \begin{matrix}
   1 &amp; 0 &amp; 0 &amp; 0 \\
   0 &amp; 2 &amp; 0 &amp; 0
  \end{matrix}
  \right]
\end{split}\]</div>
</section>
<section id="cootensor">
<h3>COOTensor<a class="headerlink" href="#cootensor" title="Permalink to this headline">ÔÉÅ</a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">COO</span></code> (Coordinate Format) sparse tensor format is used to represent a collection of nonzero elements of a tensor on a given index. If the number of non-zero elements is <code class="docutils literal notranslate"><span class="pre">N</span></code> and the dimension of the compressed tensor is <code class="docutils literal notranslate"><span class="pre">ndims</span></code>. The meaning of each parameter is as follows:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">indices</span></code>: 2-D integer tensor. Each row indicates a non-zero element subscript. Shape: <code class="docutils literal notranslate"><span class="pre">[N,</span> <span class="pre">ndims]</span></code>. The index data type can be int16, int32, or int64.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">values</span></code>: 1-D tensor of any type, indicating the value of the non-zero element. Shape: <code class="docutils literal notranslate"><span class="pre">[N]</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">shape</span></code>: indicates the shape of a compressed sparse tensor. Currently, only 2-D <code class="docutils literal notranslate"><span class="pre">COOTensor</span></code> is supported.</p></li>
</ul>
<blockquote>
<div><p>For details about <code class="docutils literal notranslate"><span class="pre">COOTensor</span></code>, see <a class="reference external" href="https://www.mindspore.cn/docs/en/r2.0/api_python/mindspore/mindspore.COOTensor.html">mindspore.COOTensor</a>.</p>
</div></blockquote>
<p>The following are some examples of using COOTensor:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">indices</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">([[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">mindspore</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="n">values</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="n">dtype</span><span class="o">=</span><span class="n">mindspore</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="n">shape</span> <span class="o">=</span> <span class="p">(</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">)</span>

<span class="c1"># Make a COOTensor</span>
<span class="n">coo_tensor</span> <span class="o">=</span> <span class="n">COOTensor</span><span class="p">(</span><span class="n">indices</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">shape</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="n">coo_tensor</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">coo_tensor</span><span class="o">.</span><span class="n">indices</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">coo_tensor</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">coo_tensor</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">mindspore</span><span class="o">.</span><span class="n">float64</span><span class="p">)</span><span class="o">.</span><span class="n">dtype</span><span class="p">)</span>  <span class="c1"># COOTensor to float64</span>
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>[1. 2.]
[[0 1]
 [1 2]]
(3, 4)
Float64
</pre></div>
</div>
<p>The preceding code generates <code class="docutils literal notranslate"><span class="pre">COOTensor</span></code> as follows:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
 \left[
 \begin{matrix}
   0 &amp; 1 &amp; 0 &amp; 0 \\
   0 &amp; 0 &amp; 2 &amp; 0 \\
   0 &amp; 0 &amp; 0 &amp; 0
  \end{matrix}
  \right]
\end{split}\]</div>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="quick_start.html" class="btn btn-neutral float-left" title="Quick Start" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="dataset.html" class="btn btn-neutral float-right" title="Dataset" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, MindSpore.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 
</body>
</html>