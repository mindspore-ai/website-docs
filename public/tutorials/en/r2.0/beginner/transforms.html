<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Transforms &mdash; MindSpore master documentation</title>
      <link rel="stylesheet" href="../_static/css/bootstrap.min.css" type="text/css" />
      <link rel="stylesheet" href="../_static/css/training.css" type="text/css" /><link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/js/training.js"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
        <script>window.MathJax = {"tex": {"inlineMath": [["$", "$"], ["\\(", "\\)"]], "processEscapes": true}, "options": {"ignoreHtmlClass": "tex2jax_ignore|mathjax_ignore|document", "processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
        <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Building a Network" href="model.html" />
    <link rel="prev" title="Dataset" href="dataset.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../index.html" class="icon icon-home"> MindSpore
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Quick Start</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="introduction.html">Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="quick_start.html">Quick Start</a></li>
<li class="toctree-l1"><a class="reference internal" href="tensor.html">Tensor</a></li>
<li class="toctree-l1"><a class="reference internal" href="dataset.html">Dataset</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Transforms</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#common-transforms">Common Transforms</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#compose">Compose</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#vision-transforms">Vision Transforms</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#rescale">Rescale</a></li>
<li class="toctree-l3"><a class="reference internal" href="#normalize">Normalize</a></li>
<li class="toctree-l3"><a class="reference internal" href="#hwc2chw">HWC2CHW</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#text-transforms">Text Transforms</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#pythontokenizer">PythonTokenizer</a></li>
<li class="toctree-l3"><a class="reference internal" href="#lookup">Lookup</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#lambda-transforms">Lambda Transforms</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="model.html">Building a Network</a></li>
<li class="toctree-l1"><a class="reference internal" href="autograd.html">Automatic Differentiation</a></li>
<li class="toctree-l1"><a class="reference internal" href="train.html">Model Training</a></li>
<li class="toctree-l1"><a class="reference internal" href="save_load.html">Saving and Loading the Model</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Advanced</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../advanced/model.html">Advanced Encapsulation: Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/modules.html">Model Module Customization</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/dataset.html">Advanced Data Processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/derivation.html">Advanced Automatic Differentiation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/compute_graph.html">Computational Graph</a></li>
<li class="toctree-l1"><a class="reference internal" href="../advanced/mixed_precision.html">Automatic Mix Precision</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MindSpore</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Transforms</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/beginner/transforms.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<p><a href="https://gitee.com/mindspore/docs/blob/r2.0/tutorials/source_en/beginner/transforms.md" target="_blank"><img src="https://mindspore-website.obs.cn-north-4.myhuaweicloud.com/website-images/r2.0/resource/_static/logo_source_en.png"></a></p>
<p><a class="reference external" href="https://www.mindspore.cn/tutorials/en/r2.0/beginner/introduction.html">Introduction</a> || <a class="reference external" href="https://www.mindspore.cn/tutorials/en/r2.0/beginner/quick_start.html">Quick Start</a> || <a class="reference external" href="https://www.mindspore.cn/tutorials/en/r2.0/beginner/tensor.html">Tensor</a> || <a class="reference external" href="https://www.mindspore.cn/tutorials/en/r2.0/beginner/dataset.html">Dataset</a> || <strong>Transforms</strong> || <a class="reference external" href="https://www.mindspore.cn/tutorials/en/r2.0/beginner/model.html">Model</a> || <a class="reference external" href="https://www.mindspore.cn/tutorials/en/r2.0/beginner/autograd.html">Autograd</a> || <a class="reference external" href="https://www.mindspore.cn/tutorials/en/r2.0/beginner/train.html">Train</a> || <a class="reference external" href="https://www.mindspore.cn/tutorials/en/r2.0/beginner/save_load.html">Save and Load</a></p>
<section id="transforms">
<h1>Transforms<a class="headerlink" href="#transforms" title="Permalink to this headline"></a></h1>
<p>Usually, the directly-loaded raw data cannot be directly fed into the neural network for training, and we need to preprocess the data at this time. MindSpore provides different kinds of data transforms that can be used with the Data Processing Pipeline for data preprocessing. All Transforms can be passed in via the <code class="docutils literal notranslate"><span class="pre">map</span></code> method to process the specified data columns.</p>
<p><code class="docutils literal notranslate"><span class="pre">mindspore.dataset</span></code> provides Transforms for different data types such as image, text and audio, and also supports using Lambda functions. The descriptions are as follows.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">from</span> <span class="nn">download</span> <span class="kn">import</span> <span class="n">download</span>
<span class="kn">from</span> <span class="nn">mindspore.dataset</span> <span class="kn">import</span> <span class="n">transforms</span><span class="p">,</span> <span class="n">vision</span><span class="p">,</span> <span class="n">text</span>
<span class="kn">from</span> <span class="nn">mindspore.dataset</span> <span class="kn">import</span> <span class="n">GeneratorDataset</span><span class="p">,</span> <span class="n">MnistDataset</span>
</pre></div>
</div>
<section id="common-transforms">
<h2>Common Transforms<a class="headerlink" href="#common-transforms" title="Permalink to this headline"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">mindspore.dataset.transforms</span></code> module supports a set of common Transforms. Here we take <code class="docutils literal notranslate"><span class="pre">Compose</span></code> as an example to introduce its usage.</p>
<section id="compose">
<h3>Compose<a class="headerlink" href="#compose" title="Permalink to this headline"></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">Compose</span></code> takes a sequence of data enhancement operations and then combines them into a single data enhancement operation. We still present the application effect of Transforms based on the Mnist dataset.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Download data from open datasets</span>

<span class="n">url</span> <span class="o">=</span> <span class="s2">&quot;https://mindspore-website.obs.cn-north-4.myhuaweicloud.com/&quot;</span> \
      <span class="s2">&quot;notebook/datasets/MNIST_Data.zip&quot;</span>
<span class="n">path</span> <span class="o">=</span> <span class="n">download</span><span class="p">(</span><span class="n">url</span><span class="p">,</span> <span class="s2">&quot;./&quot;</span><span class="p">,</span> <span class="n">kind</span><span class="o">=</span><span class="s2">&quot;zip&quot;</span><span class="p">,</span> <span class="n">replace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">train_dataset</span> <span class="o">=</span> <span class="n">MnistDataset</span><span class="p">(</span><span class="s1">&#39;MNIST_Data/train&#39;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Downloading data from https://mindspore-website.obs.cn-north-4.myhuaweicloud.com/notebook/datasets/MNIST_Data.zip (10.3 MB)

file_sizes: 100%|██████████████████████████| 10.8M/10.8M [00:01&lt;00:00, 5.57MB/s]
Extracting zip file...
Successfully downloaded / unzipped to ./
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">image</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">train_dataset</span><span class="o">.</span><span class="n">create_tuple_iterator</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>(28, 28, 1)
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">composed</span> <span class="o">=</span> <span class="n">transforms</span><span class="o">.</span><span class="n">Compose</span><span class="p">(</span>
    <span class="p">[</span>
        <span class="n">vision</span><span class="o">.</span><span class="n">Rescale</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="mf">255.0</span><span class="p">,</span> <span class="mi">0</span><span class="p">),</span>
        <span class="n">vision</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">mean</span><span class="o">=</span><span class="p">(</span><span class="mf">0.1307</span><span class="p">,),</span> <span class="n">std</span><span class="o">=</span><span class="p">(</span><span class="mf">0.3081</span><span class="p">,)),</span>
        <span class="n">vision</span><span class="o">.</span><span class="n">HWC2CHW</span><span class="p">()</span>
    <span class="p">]</span>
<span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">train_dataset</span> <span class="o">=</span> <span class="n">train_dataset</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">composed</span><span class="p">,</span> <span class="s1">&#39;image&#39;</span><span class="p">)</span>
<span class="n">image</span><span class="p">,</span> <span class="n">label</span> <span class="o">=</span> <span class="nb">next</span><span class="p">(</span><span class="n">train_dataset</span><span class="o">.</span><span class="n">create_tuple_iterator</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="n">image</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>(1, 28, 28)
</pre></div>
</div>
<p>For more common Transforms, see <a class="reference external" href="https://www.mindspore.cn/docs/en/r2.0/api_python/mindspore.dataset.transforms.html">mindspore.dataset.transforms</a>.</p>
</section>
</section>
<section id="vision-transforms">
<h2>Vision Transforms<a class="headerlink" href="#vision-transforms" title="Permalink to this headline"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">mindspore.dataset.vision</span></code> module provides a series of Transforms for image data. <code class="docutils literal notranslate"><span class="pre">Rescale</span></code>, <code class="docutils literal notranslate"><span class="pre">Normalize</span></code> and <code class="docutils literal notranslate"><span class="pre">HWC2CHW</span></code> transforms are used in the Mnist data processing. The descriptions are as follows.</p>
<section id="rescale">
<h3>Rescale<a class="headerlink" href="#rescale" title="Permalink to this headline"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">Rescale</span></code> transform is used to resize the image pixel values and consists of two parameters:</p>
<ul class="simple">
<li><p>rescale: scaling factor.</p></li>
<li><p>shift: shift factor.</p></li>
</ul>
<p>Each pixel of the image will be adjusted according to these two parameters and the output pixel value will be <span class="math notranslate nohighlight">\(output_{i} = input_{i} * rescale + shift\)</span>.</p>
<p>Here we first use numpy to generate a random image with pixel values in [0, 255] and scale its pixel values.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">random_np</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">255</span><span class="p">,</span> <span class="p">(</span><span class="mi">48</span><span class="p">,</span> <span class="mi">48</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">uint8</span><span class="p">)</span>
<span class="n">random_image</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">fromarray</span><span class="p">(</span><span class="n">random_np</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">random_np</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>[[ 59  38 206 ... 126 244 226]
 [ 27 113 135 ... 248   3   0]
 [106  13 154 ... 149   7 126]
 ...
 [142 135 222 ... 253  58 228]
 [110 239 114 ...  75 142  65]
 [  0 108 141 ... 145 159  11]]
</pre></div>
</div>
<p>To present a more visual comparison of the data before and after Transform, we use <a class="reference external" href="https://mindspore.cn/tutorials/en/r2.0/advanced/dataset/eager.html">Eager mode</a> demo of Transforms. First instantiate the Transform object, and then call the object for data processing.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">rescale</span> <span class="o">=</span> <span class="n">vision</span><span class="o">.</span><span class="n">Rescale</span><span class="p">(</span><span class="mf">1.0</span> <span class="o">/</span> <span class="mf">255.0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">rescaled_image</span> <span class="o">=</span> <span class="n">rescale</span><span class="p">(</span><span class="n">random_image</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">rescaled_image</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>[[0.23137257 0.14901961 0.8078432  ... 0.49411768 0.9568628  0.8862746 ]
 [0.10588236 0.4431373  0.5294118  ... 0.9725491  0.01176471 0.        ]
 [0.4156863  0.0509804  0.6039216  ... 0.58431375 0.02745098 0.49411768]
 ...
 [0.5568628  0.5294118  0.8705883  ... 0.9921569  0.227451   0.8941177 ]
 [0.43137258 0.93725497 0.44705886 ... 0.29411766 0.5568628  0.25490198]
 [0.         0.42352945 0.5529412  ... 0.5686275  0.62352943 0.04313726]]
</pre></div>
</div>
<p>It can be seen that each pixel value is scaled after using <code class="docutils literal notranslate"><span class="pre">Rescale</span></code>.</p>
</section>
<section id="normalize">
<h3>Normalize<a class="headerlink" href="#normalize" title="Permalink to this headline"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">Normalize</span></code> transform is used for normalization of the input image and consists of three parameters:</p>
<ul class="simple">
<li><p>mean: the mean value of each channel in the image.</p></li>
<li><p>std: the standard deviation of each channel in the image.</p></li>
<li><p>is_hwc: whether the format of input image is (height, width, channel) or (channel, height, width).</p></li>
</ul>
<p>Each channel of the image will be adjusted according to <code class="docutils literal notranslate"><span class="pre">mean</span></code> and <code class="docutils literal notranslate"><span class="pre">std</span></code>, and the formula is <span class="math notranslate nohighlight">\(output_{c} = \frac{input_{c} - mean_{c}}{std_{c}}\)</span>, where <span class="math notranslate nohighlight">\(c\)</span> represents the channel index.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">normalize</span> <span class="o">=</span> <span class="n">vision</span><span class="o">.</span><span class="n">Normalize</span><span class="p">(</span><span class="n">mean</span><span class="o">=</span><span class="p">(</span><span class="mf">0.1307</span><span class="p">,),</span> <span class="n">std</span><span class="o">=</span><span class="p">(</span><span class="mf">0.3081</span><span class="p">,))</span>
<span class="n">normalized_image</span> <span class="o">=</span> <span class="n">normalize</span><span class="p">(</span><span class="n">rescaled_image</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">normalized_image</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>[[ 0.32675287  0.05945994  2.1978035  ...  1.1795447   2.6814764
   2.452368  ]\n&quot;,
 [-0.08055063  1.0140777   1.2940987  ...  2.7323892  -0.38602826
  -0.42421296]\n&quot;,
 [ 0.92498    -0.2587459   1.5359352  ...  1.472294   -0.33511534
   1.1795447 ]\n&quot;,
 ...\n&quot;,
 [ 1.3831964   1.2940987   2.4014552  ...  2.7960305   0.31402466
   2.4778247 ]\n&quot;,
 [ 0.9758929   2.617835    1.0268059  ...  0.5304046   1.3831964
   0.40312228]\n&quot;,
 [-0.42421296  0.9504364   1.3704681  ...  1.4213811   1.5995764
  -0.2842024 ]]
</pre></div>
</div>
</section>
<section id="hwc2chw">
<h3>HWC2CHW<a class="headerlink" href="#hwc2chw" title="Permalink to this headline"></a></h3>
<p>The <code class="docutils literal notranslate"><span class="pre">HWC2CHW</span></code> transform is used to convert the image format. The two different formats (height, width, channel) or (channel, height, width) may be targeted and optimized in different hardware devices. MindSpore sets HWC as the default image format and uses this transform for processing when CHW format is required.</p>
<p>Here we first process the <code class="docutils literal notranslate"><span class="pre">normalized_image</span></code> in the previous section to HWC format, and then convert it. You can see the change of the shape before and after the conversion.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">hwc_image</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">expand_dims</span><span class="p">(</span><span class="n">normalized_image</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">)</span>
<span class="n">hwc2chw</span> <span class="o">=</span> <span class="n">vision</span><span class="o">.</span><span class="n">HWC2CHW</span><span class="p">()</span>
<span class="n">chw_image</span> <span class="o">=</span> <span class="n">hwc2chw</span><span class="p">(</span><span class="n">hwc_image</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">hwc_image</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span> <span class="n">chw_image</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>(48, 48, 1) (1, 48, 48)
</pre></div>
</div>
<p>For more Vision Transforms, see <a class="reference external" href="https://mindspore.cn/docs/en/r2.0/api_python/mindspore.dataset.transforms.html#module-mindspore.dataset.vision">mindspore.dataset.vision</a>.</p>
</section>
</section>
<section id="text-transforms">
<h2>Text Transforms<a class="headerlink" href="#text-transforms" title="Permalink to this headline"></a></h2>
<p>The <code class="docutils literal notranslate"><span class="pre">mindspore.dataset.text</span></code> module provides a series of Transforms for text data. Unlike image data, text data requires operations such as Tokenize, building word lists, and Token to Index. Here is a brief description of its usage.</p>
<p>First we define three pieces of text as the data to be processed and load them by using <code class="docutils literal notranslate"><span class="pre">GeneratorDataset</span></code>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">texts</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Welcome to Beijing&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">test_dataset</span> <span class="o">=</span> <span class="n">GeneratorDataset</span><span class="p">(</span><span class="n">texts</span><span class="p">,</span> <span class="s1">&#39;text&#39;</span><span class="p">)</span>
</pre></div>
</div>
<section id="pythontokenizer">
<h3>PythonTokenizer<a class="headerlink" href="#pythontokenizer" title="Permalink to this headline"></a></h3>
<p>Tokenize is a basic transformation to process text data. MindSpore provides many different Tokenizers. Take <code class="docutils literal notranslate"><span class="pre">PythonTokenizer</span></code> as example, it allows users to customize the token strategy. Then we can perform tokenization on the input text based on the <code class="docutils literal notranslate"><span class="pre">map</span></code> operation.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">my_tokenizer</span><span class="p">(</span><span class="n">content</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">content</span><span class="o">.</span><span class="n">split</span><span class="p">()</span>

<span class="n">test_dataset</span> <span class="o">=</span> <span class="n">test_dataset</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">text</span><span class="o">.</span><span class="n">PythonTokenizer</span><span class="p">(</span><span class="n">my_tokenizer</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">test_dataset</span><span class="o">.</span><span class="n">create_tuple_iterator</span><span class="p">()))</span>
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>[Tensor(shape=[3], dtype=String, value= [&#39;Welcome&#39;, &#39;to&#39;, &#39;Beijing&#39;])]
</pre></div>
</div>
</section>
<section id="lookup">
<h3>Lookup<a class="headerlink" href="#lookup" title="Permalink to this headline"></a></h3>
<p><code class="docutils literal notranslate"><span class="pre">Lookup</span></code> is a vocabulary mapping transformation used to convert Token to Index. Before using <code class="docutils literal notranslate"><span class="pre">Lookup</span></code>, you need to construct a vocabulary, either by loading an existing vocabulary or by using <code class="docutils literal notranslate"><span class="pre">Vocab</span></code> to generate a vocabulary. Here we choose to use <code class="docutils literal notranslate"><span class="pre">Vocab.from_dataset</span></code> method to generate a vocabulary from a dataset.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">vocab</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">Vocab</span><span class="o">.</span><span class="n">from_dataset</span><span class="p">(</span><span class="n">test_dataset</span><span class="p">)</span>
</pre></div>
</div>
<p>After obtaining the vocabulary, we can use the <code class="docutils literal notranslate"><span class="pre">vocab</span></code> method to view the vocabulary.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="n">vocab</span><span class="o">.</span><span class="n">vocab</span><span class="p">())</span>
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>{&#39;to&#39;: 2, &#39;Beijing&#39;: 0, &#39;Welcome&#39;: 1}
</pre></div>
</div>
<p>After generating the vocabulary, you can perform the vocabulary mapping transformation with the <code class="docutils literal notranslate"><span class="pre">map</span></code> method to convert Token to Index.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">test_dataset</span> <span class="o">=</span> <span class="n">test_dataset</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="n">text</span><span class="o">.</span><span class="n">Lookup</span><span class="p">(</span><span class="n">vocab</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">next</span><span class="p">(</span><span class="n">test_dataset</span><span class="o">.</span><span class="n">create_tuple_iterator</span><span class="p">()))</span>
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>[Tensor(shape=[3], dtype=Int32, value= [1, 2, 0])]
</pre></div>
</div>
<p>For more Text Transforms, see <a class="reference external" href="https://mindspore.cn/docs/en/r2.0/api_python/mindspore.dataset.transforms.html#module-mindspore.dataset.text">mindspore.dataset.text</a>.</p>
</section>
</section>
<section id="lambda-transforms">
<h2>Lambda Transforms<a class="headerlink" href="#lambda-transforms" title="Permalink to this headline"></a></h2>
<p>Lambda functions are anonymous functions that do not require a name and consist of a single expression that is evaluated when called. Lambda Transforms can load arbitrarily-defined Lambda functions, providing enough flexibility. Here, we start with a simple Lambda function that multiplies the input data by 2:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">test_dataset</span> <span class="o">=</span> <span class="n">GeneratorDataset</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">],</span> <span class="s1">&#39;data&#39;</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">test_dataset</span> <span class="o">=</span> <span class="n">test_dataset</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span> <span class="o">*</span> <span class="mi">2</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">test_dataset</span><span class="o">.</span><span class="n">create_tuple_iterator</span><span class="p">()))</span>
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>[[Tensor(shape=[], dtype=Int64, value= 2)], [Tensor(shape=[], dtype=Int64, value= 4)], [Tensor(shape=[], dtype=Int64, value= 6)]]
</pre></div>
</div>
<p>You can see that after <code class="docutils literal notranslate"><span class="pre">map</span></code> is passed into the Lambda function, the data is iteratively obtained for the multiply-2 operation.</p>
<p>We can also define more complex functions that work with the Lambda function to achieve complex data processing:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">func</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">x</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="mi">2</span>

<span class="n">test_dataset</span> <span class="o">=</span> <span class="n">test_dataset</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">func</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="nb">print</span><span class="p">(</span><span class="nb">list</span><span class="p">(</span><span class="n">test_dataset</span><span class="o">.</span><span class="n">create_tuple_iterator</span><span class="p">()))</span>
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>[[Tensor(shape=[], dtype=Int64, value= 6)], [Tensor(shape=[], dtype=Int64, value= 18)], [Tensor(shape=[], dtype=Int64, value= 38)]]
</pre></div>
</div>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="dataset.html" class="btn btn-neutral float-left" title="Dataset" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="model.html" class="btn btn-neutral float-right" title="Building a Network" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, MindSpore.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 
        <script async="async" src="https://cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</body>
</html>