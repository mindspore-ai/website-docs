

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Function Debug &mdash; MindSpore master documentation</title>
  

  
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
   
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  
  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Error Analysis" href="error_analyze.html" />
    <link rel="prev" title="Model Compression" href="../infer/model_compression.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> MindSpore
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Data Processing</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../dataset/augment.html">Auto Augmentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dataset/cache.html">Single-Node Data Cache</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dataset/optimize.html">Optimizing the Data Processing</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Graph Compilation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../network/control_flow.html">Process Control Statements</a></li>
<li class="toctree-l1"><a class="reference internal" href="../network/op_overload.html">Compiling Performance Optimization for Static Graph Network</a></li>
<li class="toctree-l1"><a class="reference internal" href="../network/jit_class.html">Calling the Custom Class</a></li>
<li class="toctree-l1"><a class="reference internal" href="../network/constexpr.html">Construct Constants In the Network</a></li>
<li class="toctree-l1"><a class="reference internal" href="../network/dependency_control.html">Dependency Control</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Model Training Optimization</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../optimize/execution_opt.html">Sinking Mode</a></li>
<li class="toctree-l1"><a class="reference internal" href="../optimize/gradient_accumulation.html">Gradient Accumulation Algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../optimize/adaptive_summation.html">Adaptive Gradient Summation Algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../optimize/dimention_reduce_training.html">Dimension Reduction Training Algorithm</a></li>
<li class="toctree-l1"><a class="reference internal" href="../optimize/thor.html">Second-order Optimization</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Custom Operator</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../operation/op_custom.html">Custom Operators (Custom-based)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../operation/ms_kernel.html">MindSpore Hybrid Syntax Specification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../operation/op_custom_adv.html">Advanced Usage of Custom Operators</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Automatic Vectorization</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../vmap/vmap.html">Automatic Vectorization (Vmap)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Model Inference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../infer/inference.html">Inference Model Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../infer/ascend_310_air.html">Inference on the Ascend 310 AI Processor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../infer/model_compression.html">Model Compression</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Debugging and Tuning</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Function Debug</a><ul>
<li class="toctree-l2"><a class="reference internal" href="error_analyze.html">Error Analysis</a></li>
<li class="toctree-l2"><a class="reference internal" href="custom_debug.html">Custom Debugging Information</a></li>
<li class="toctree-l2"><a class="reference internal" href="mindir.html">Reading IR</a></li>
<li class="toctree-l2"><a class="reference internal" href="dump.html">Using Dump in the Graph Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="pynative_debug.html">Debugging in PyNative Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="pynative.html">Applying PyNative Mode</a></li>
<li class="toctree-l2"><a class="reference internal" href="fixing_randomness.html">Fixed Randomness to Reproduce Run Results of Script</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="performance_optimization.html">Performance Tuning</a></li>
<li class="toctree-l1"><a class="reference external" href="https://mindspore.cn/mindinsight/docs/en/master/accuracy_problem_preliminary_location.html">Precision Optimization↗</a></li>
<li class="toctree-l1"><a class="reference internal" href="fault_recover.html">Fault Recovery</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Distributed Parallel</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../parallel/overview.html">Distributed Parallelism Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../parallel/basic_cases.html">Distributed Basic Cases</a></li>
<li class="toctree-l1"><a class="reference internal" href="../parallel/operator_parallel.html">Operator-level Parallelism</a></li>
<li class="toctree-l1"><a class="reference internal" href="../parallel/pipeline_parallel.html">Pipeline Parallel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../parallel/optimizer_parallel.html">Optimizer Parallel</a></li>
<li class="toctree-l1"><a class="reference internal" href="../parallel/recompute.html">Recomputation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../parallel/host_device_training.html">Host&amp;Device Heterogeneous</a></li>
<li class="toctree-l1"><a class="reference internal" href="../parallel/parameter_server_training.html">Parameter Server Mode</a></li>
<li class="toctree-l1"><a class="reference internal" href="../parallel/startup_method.html">Distributed Parallel Startup Methods</a></li>
<li class="toctree-l1"><a class="reference internal" href="../parallel/distributed_inference.html">Distributed Inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../parallel/distributed_case.html">Distributed High-Level Configuration Case</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Environment Variables</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../env/env_var_list.html">Environment Variables</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MindSpore</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Function Debug</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/debug/function_debug.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="function-debug">
<h1>Function Debug<a class="headerlink" href="#function-debug" title="Permalink to this headline"></a></h1>
<a class="reference external image-reference" href="https://gitee.com/mindspore/docs/blob/master/tutorials/experts/source_en/debug/function_debug.rst"><img alt="https://mindspore-website.obs.cn-north-4.myhuaweicloud.com/website-images/master/resource/_static/logo_source_en.png" src="https://mindspore-website.obs.cn-north-4.myhuaweicloud.com/website-images/master/resource/_static/logo_source_en.png" /></a>
<div class="toctree-wrapper compound">
</div>
<section id="overview">
<h2>Overview<a class="headerlink" href="#overview" title="Permalink to this headline"></a></h2>
<p>This section is used to introduce the various functional debugging capabilities provided by MindSpore for neural network developers and framework developers. Functional debugging refers to the debugging capabilities of developers in the process of developing neural network or framework functions, which is different from the debugging and tuning of performance and accuracy after the functions are implemented. The functional debugging is divided into network development debugging and framework development debugging from different purposes of use. Network development debugging is used to meet the debugging requirements of network developers (also known as users) for error debugging, control and observation of network execution during neural network development, and framework development debugging is used to meet the debugging requirements of framework developers.</p>
<ul class="simple">
<li><p>network development debugging: The functional debugging capabilities for neural network developers can be divided into network error debugging and network execution debugging.</p>
<ul>
<li><p>network error debugging: Provide error diagnosis and debugging capabilities when network errors are reported, e.g., error description, debugging with PyNative.</p></li>
<li><p>network execution debugging: Provide the observation and execution control capabilities during normal network execution, e.g. callback, hook.</p></li>
</ul>
</li>
<li><p>Framework development debugging: Provide functional debugging capabilities for MindSpore framework developers, such as logging and RDR (run data saving).</p></li>
</ul>
<p>Network development debugging and framework development debugging are only distinguished from a more applicable perspective, not a strict functional division. Network developers can also use the framework development debugging function to debug problems, and vice versa.</p>
</section>
<section id="network-error-debugging">
<h2>Network Error Debugging<a class="headerlink" href="#network-error-debugging" title="Permalink to this headline"></a></h2>
<p>Network error debugging is to solve the problem of error reporting during network training or inference. By understanding the meaning of the error message, hypothesize the cause of the problem, and use debugging methods to verify the hypothesis. Network error debugging is usually a process of multiple hypothesis and verification cycles, which includes two parts: error analysis and debug positioning. Error analysis is the process of obtaining the content of reported errors, understanding the description and analyzing their causes, mainly including information summarization, error analysis and error retrieval. Debug positioning is the process of selecting a suitable debugging strategy for the problem scenario and verifying the assumptions of the reported error, which mainly includes strategy selection, fault recurrence, and debug verification.</p>
<section id="error-analysis">
<h3>Error Analysis<a class="headerlink" href="#error-analysis" title="Permalink to this headline"></a></h3>
<p>Error analysis is the process of obtaining the content of error reports, understanding their description and analyzing their causes.</p>
<section id="information-summarization">
<h4>Information Summarization<a class="headerlink" href="#information-summarization" title="Permalink to this headline"></a></h4>
<p>The first step in network error debugging is to summarize information, where information summarization refers to categorizing the information obtained and understanding its meaning to provide a basis for error analysis. Generally, several types of information needs to be obtained when an error is reproted:</p>
<ol class="arabic simple">
<li><p>Information about the environment in which the error is reported, including: OS type and version, MindSpore version, execution mode (dynamic graph mode OR static graph mode), device information (x86 or ARM, Ascend or GPU)</p></li>
<li><p>Error description information, including: error type, error description, error stacks, etc.</p></li>
<li><p>If suspect a frame problem, you need to get the log information printed by the frame.</p></li>
</ol>
<p>Understanding the meaning of error description information plays an important role in problem analysis, and the following will introduce how to read and understand MindSpore error messages.</p>
<p>MindSpore error messages are processed by using Python
Traceback processing, including Python stack information, error types and error descriptions, error messages related to networkdevelopers, and error messages related to framework developers. As shown in the following figure:</p>
<img alt="https://mindspore-website.obs.cn-north-4.myhuaweicloud.com/website-images/master/tutorials/experts/source_zh_cn/debug/images/graph_errmsg.png" src="https://mindspore-website.obs.cn-north-4.myhuaweicloud.com/website-images/master/tutorials/experts/source_zh_cn/debug/images/graph_errmsg.png" />
<ul>
<li><p>Python stack information:</p>
<p>As shown in figure ①, you can see the Python stack calling relationship from top to bottom.</p>
</li>
<li><p>Error type and error description:</p>
<p>As shown in figure ②, the error type is <code class="docutils literal notranslate"><span class="pre">TypeError</span></code>, that is, parameter type error. The error description is the cause of the error. The number of parameters in the function is not correct, and the number of input parameters is required to be 2, but the actual number of parameters provided is 3.</p>
</li>
<li><p>Error messages related to networkdevelopers</p>
<p>As shown in figure ③, it contains <code class="docutils literal notranslate"><span class="pre">The</span> <span class="pre">Traceback</span> <span class="pre">of</span> <span class="pre">Net</span> <span class="pre">Construct</span> <span class="pre">Code</span></code>and other error messages related to network developers. <code class="docutils literal notranslate"><span class="pre">The</span> <span class="pre">Traceback</span> <span class="pre">of</span> <span class="pre">Net</span> <span class="pre">Construct</span> <span class="pre">Code</span></code>is the C++ back-end compilation error location mapped to the Python front-end code call stack, printed in reverse order, corresponding to the <code class="docutils literal notranslate"><span class="pre">construct</span></code>function or <code class="docutils literal notranslate"><span class="pre">&#64;ms_function</span></code>decorator-modified function in the neural network.</p>
</li>
<li><p>Error messages related to framework developers</p>
<p>As shown in figure ④, it contains C++ stack information and other error reporting information related to framework developers, marked by \ <code class="docutils literal notranslate"><span class="pre">For</span> <span class="pre">framework</span> <span class="pre">developers</span></code>. You can set the environment variable <code class="docutils literal notranslate"><span class="pre">export</span> <span class="pre">MS_EXCEPTION_DISPLAY_LEVEL=1</span></code>to hide the error message related to the framework developer. The default value of this environment variable is 0, indicating that error messages related to the framework developer are displayed by default.</p>
</li>
</ul>
</section>
<section id="error-analysis-1">
<h4>Error Analysis<a class="headerlink" href="#error-analysis-1" title="Permalink to this headline"></a></h4>
<p>Performing error analysis is an important step in network error debugging. Error analysis refers to the analysis of error causes based on various information obtained from the network and framework (e.g., error messages, network codes, and other information) to infer the possible causes of errors.</p>
<p>The general process of MindSpore network training is data loading and processing, network construction and training. In distributed parallel scenario, it also includes distributed parallel mode configuration. The error analysis of network error reporting usually includes the following steps:</p>
<ol class="arabic simple">
<li><p>Based on the error message, identify which problem scenario it is, such as data loading and processing problem scenario, network construction and training problem scenario, or distributed parallelism problem scenario. Usually, a distinction can be made by using the error message related to the network developer.</p></li>
<li><p>Analyze the problem scenarios and further identify which type of problem it is under that problem scenario. For example, the data loading and processing problem scenario includes three types: data preparation problems, data loading problems and data enhancement problems. Usually, the distinction needs to be made based on the type of error reported and the description of the error reported.</p></li>
<li><p>Analyze the location where the error is reported based on the Python call stack and the error information. In dynamic graph mode, it is easier to determine the location of the code error. In the static graph mode, you need to analyze the location of the error report according to the error message “The Traceback of Net Construct Code” part of the error message.</p></li>
<li><p>Based on possible error problem scenarios and types, hypothesize the possible causes of the error problem.</p></li>
</ol>
<p>Please refer to error analysis for details on how to perform error analysis based on different scenarios.</p>
</section>
<section id="error-search">
<h4>Error Search<a class="headerlink" href="#error-search" title="Permalink to this headline"></a></h4>
<p>Based on the error message and the location of the error code, combined with the common errors and possible causes in different scenarios, we can generally solve the common problems of parameter configuration errors, API interface usage errors, static graph syntax errors, etc. For more complex error reporting analysis, you can first try to search for cases. Of course, to improve the efficiency of problem solving, when you encounter an error reporting problem, you can directly perform an error search.</p>
<ul>
<li><p>FAQ</p>
<p>MindSpore provides FAQ for common error reporting issues, including data processing, compilation execution, distributed parallelism and other scenarios. Based on the problem scenarios derived from the error analysis, you can search for problems by using the error description information.</p>
<p>The search address is as follows: <a class="reference external" href="https://www.mindspore.cn/docs/en/master/faq/installation.html">FAQ</a>.</p>
</li>
<li><p>Error reporting case</p>
<p>To cover more error reporting scenarios and improve users’ problem solving ability, MindSpore in Huawei Cloud Forum provides common typical error reporting cases and introduces error analysis and solution methods. The prerequisite for error search is to select the appropriate search keywords. Usually, the search keywords are selected in the Error Report Type and Error Report Description sections of the error message. Usually, when searching in Cloud Forum, you can use the structure of subject + predicate + object, verb + object, subject + tense + epithet to search. For example, there is the following error message reported:</p>
<div class="highlight-cpp notranslate"><div class="highlight"><pre><span></span>Unexpected error. Invalid file, DB file can not match file

Exceed function call depth limit 1000, (function call depth: 1001, simulate call depth: 997).

&#39;self.val&#39; should be initialized as a &#39;Parameter&#39; type
</pre></div>
</div>
<p>You can choose “DB file can not match file”, “Exceed function call depth limit”, and “should be initialized as a Parameter” as key words.</p>
<p>The search address is as follows: <a class="reference external" href="https://www.hiascend.com/forum/forum-0106101385921175002-1.html?filterCondition=1&amp;topicClassId=0631105934233557004">Error reporting case</a>.</p>
</li>
<li><p>Community Issue</p>
<p>In addition, MindSpore open source community has a lot of issues feedbacked by developers, involving network development error reporting, framework failure and many other issues. Users can search for similar problems using, for example, network name, error reporting content keywords. The keyword selection can refer to the error reporting case.</p>
<p>The search address is as follows: <a class="reference external" href="https://www.hiascend.com/forum/forum-0106101385921175002-1.html?filterCondition=1&amp;topicClassId=0631105934233557004">MindSpore
Issues</a>.</p>
</li>
</ul>
</section>
</section>
<section id="debug-positioning">
<h3>Debug Positioning<a class="headerlink" href="#debug-positioning" title="Permalink to this headline"></a></h3>
<section id="strategy-selection">
<h4>Strategy Selection<a class="headerlink" href="#strategy-selection" title="Permalink to this headline"></a></h4>
<ul>
<li><p>Static to Dynamic Debugging Strategy</p>
<p>Dynamic graph mode is a better debugging execution mode.
Set the dynamic graph mode way: <code class="docutils literal notranslate"><span class="pre">set_context(mode=mindspore.PYNATIVE_MODE)</span></code>.
The program in dynamic graph mode is executed line by line according to the order in which the code is written, avoiding the back-end and front-end compilation optimization in static graph mode and ensuring uniform user code and execution logic. Dynamic diagrams are executed line by line to avoid the black box execution of the whole diagram sinking in diagram mode, which is more convenient to print the execution results and track the execution process.</p>
</li>
<li><p>Asynchronous-to-synchronous Debugging Strategy</p>
<p>Dynamic diagram mode uses asynchronous execution by default in order to improve the efficiency of dynamic diagram execution, and error information are displayed at the last stage of execution. In Figure 3, you can see that the asynchronous execution method of error reporting will have alarm messages that interfere with the error reporting analysis.</p>
<p>MindSpore provides a way to switch synchronous execution by setting <code class="docutils literal notranslate"><span class="pre">set_context(mode=mindspore.PYNATIVE_MODE,</span> <span class="pre">pynative_synchronize=True)</span></code> to switch to synchronous execution. If the operator execution error occurs, the task terminates directly and displays the current error message. For details, see <a class="reference external" href="https://www.mindspore.cn/tutorials/en/master/advanced/compute_graph.html">PyNative Synchronous Execution</a>.</p>
</li>
<li><p>Dichotomy Strategy</p>
<p>Simplifying the problem scenario is an effective way to improve debugging efficiency. Based on the error message, it is usually a reliable way to confirm the scope of the error reporting problem and eliminate unnecessary influencing factors. In the case where the scope of error reporting cannot be accurately determined, a dichotomous approach can be attempted. For example, if the network calculation process contains nan values, the dichotomy method can be used to debug the data processing module and the network calculation module separately to verify whether the data input to the network calculation contains nan values and to confirm whether the outliers are introduced by the data or generated during the calculation process.</p>
</li>
<li><p>Deductive Inference Strategy</p>
<p>Deductive inference is the process of deducing the cause of a problem and further verifying the conclusion. MindSpore error debugging is a step-by-step reverse inference based on the causal chain of problem propagation to locate the root cause of the problem. For example, the execution of MindSpore operator reports an error problem, which is directly caused by the fact that the input data of the operator contains illegal values, and the illegal values are derived from the computation of the previous operator, so we need to analyze whether the input data and computation process of the previous operator are correct. If there is a problem with the computation process of the previous operator, i.e., the scope of the problem is confirmed, if there are also illegal values in the input data of the previous operator, it is necessary to continue analyzing the previous operator until the root cause of the problem is found.</p>
</li>
</ul>
</section>
<section id="problem-recurrence">
<h4>Problem Recurrence<a class="headerlink" href="#problem-recurrence" title="Permalink to this headline"></a></h4>
<p>Stable problem recurrence is a prerequisite for network debugging and a condition to verify whether the problem is completely solved. The network training process introduces randomness due to random initialization of network parameters, and different input data, which can easily cause inconsistent running results or error reporting locations. MindSpore provides ideas and methods for fixed randomness. Please refer to <a class="reference external" href="https://mindspore.cn/tutorials/experts/en/master/debug/fixing_randomness.html">Fixed Randomness</a>for details.</p>
</section>
<section id="debugging-verification">
<h4>Debugging Verification<a class="headerlink" href="#debugging-verification" title="Permalink to this headline"></a></h4>
<ul>
<li><p>Dynamic graph debugging</p>
<p>Due to the line-by-line code execution, single-step debugging, breakpoint debugging and process tracing can be performed by using the debugging tool pdb.
Debugging Steps:</p>
<ol class="arabic simple">
<li><p>insert import pdb; pdb.set_trace() before the code you want to debug to enable pdb debugging.</p></li>
<li><p>run the .py file normally. The following similar result will appear in the terminal, debug by entering the corresponding pdb command after the (Pdb).</p></li>
<li><p>Enter commands such as l and p in pdb interactive mode to view the corresponding code and variables, and then troubleshoot the related problems.</p></li>
</ol>
<p>For details, please refer to PyNative Debugging.</p>
</li>
<li><p>Static graph debugging</p>
<ol class="arabic">
<li><p>ops.Print</p>
<p>In static graph mode, MindSpore provides ops.Print operator to print Tensor information or string information in the computational graph.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="k">class</span> <span class="nc">PrintDemo</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Cell</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">super</span><span class="p">(</span><span class="n">PrintDemo</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">print</span> <span class="o">=</span> <span class="n">ops</span><span class="o">.</span><span class="n">Print</span><span class="p">()</span>
    <span class="k">def</span> <span class="nf">construct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">):</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">print</span><span class="p">(</span><span class="s1">&#39;print Tensor x and Tensor y:&#39;</span><span class="p">,</span> <span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">x</span>
<span class="n">x</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">))</span>
<span class="n">y</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">([</span><span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">])</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int32</span><span class="p">))</span>
<span class="n">net</span> <span class="o">=</span> <span class="n">PrintDemo</span><span class="p">()</span>
<span class="n">output</span> <span class="o">=</span> <span class="n">net</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>
</pre></div>
</div>
</li>
<li><p>Debugger</p>
<p>The Debugger can be used for reporting errors during the execution phase of the computational graph. Using the debugger, the following can be implemented.</p>
<ol class="arabic simple">
<li><p>View the output of the graph node in the debugger interface in conjunction with the computational graph.</p></li>
<li><p>Set monitoring points to monitor for training anomalies (such as check tensor overflows) and to track the cause of errors when they occur.</p></li>
<li><p>View changes in parameters such as weights.</p></li>
<li><p>Check the correspondence between diagram nodes and source code.</p></li>
</ol>
<p>For details, refer to <a class="reference external" href="https://www.mindspore.cn/mindinsight/docs/en/master/debugger.html">Visual Debugger</a>.</p>
</li>
</ol>
</li>
</ul>
</section>
</section>
</section>
<section id="network-execution-debugging">
<h2>Network Execution Debugging<a class="headerlink" href="#network-execution-debugging" title="Permalink to this headline"></a></h2>
<p>Network execution debugging is the corresponding debugging capability provided by MindSpore to meet the demands of network developers for network execution process observation and execution control, which can be divided into network execution observation and network execution control.</p>
<ul class="simple">
<li><p>Network execution observation: Obtain the internal state or data of the network to observe the network execution information during the network execution, for example, visualization of training process, intermediate file (i.e. IR) saving function.</p></li>
<li><p>Network execution control: Perform specific actions during specific periods of network execution, for example, monitor loss, save model parameters, terminate training tasks early.</p></li>
</ul>
<table class="docutils align-default">
<colgroup>
<col style="width: 12%" />
<col style="width: 18%" />
<col style="width: 47%" />
<col style="width: 24%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Function classification</p></th>
<th class="head"><p>Main debugging functions</p></th>
<th class="head"><p>Description of use</p></th>
<th class="head"><p>Detailed introduction</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Execution observation</p></td>
<td><p>Visualization of the training process</p></td>
<td><p>The scalar, image, computation graph, training optimization process
and model superparameter information during the training process are recorded in a file
and made available for users to view through the MindSpore Insight visualization interface,
including: scalar visualization, parameter distribution visualization, computational graph visualization,
data graph visualization, image visualization, tensor visualization and optimization process visualization.</p></td>
<td><p><a class="reference external" href="https://www.mindspore.cn/mindinsight/docs/en/master/summary_record.html">Collect Summary data</a></p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>Training traceability and comparison</p></td>
<td><p>The model traceability, data traceability, and comparison dashboard allow users to observe
different scalar trend graphs to identify problems and then use the traceability function
to locate the cause of the problem, providing users with the ability to efficiently
tune the data augmentation and deep neural networks.</p></td>
<td><p><a class="reference external" href="https://www.mindspore.cn/mindinsight/docs/en/master/lineage_and_scalars_comparison.html">Viewing Lineage and Scalars Comparison</a></p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>metrics</p></td>
<td><p>When the training is finished,
metrics can be used to evaluate the training results.
A variety of metrics are provided for evaluation,
such as: accuracy, loss, preci sion, recall, F1.</p></td>
<td><p><a class="reference external" href="https://www.mindspore.cn/tutorials/experts/en/master/debug/custom_debug.html#mindspore-metrics-introduction">MindSpore metrics function
introduction</a></p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>Print operator</p></td>
<td><p>The Print operator prints out the Tensor or
string information entered by the user.</p></td>
<td><p><a class="reference external" href="https://www.mindspore.cn/tutorials/experts/en/master/debug/custom_debug.html#mindspore-print-operator-introduction">Print operator introduction</a></p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>Intermediate file saving</p></td>
<td><p>Used to save the intermediate files generated
during the diagram compilation process, which we call IR files, to support
the diagnosis of problems related to diagram structure and diagram information.</p></td>
<td><p><a class="reference external" href="https://www.mindspore.cn/tutorials/experts/en/master/debug/mindir.html">Reading IR</a></p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>Data Dump</p></td>
<td><p>When training the network, if the training result deviates from the expectation,
the operator input and output data are saved for debugging by the Du mp function.</p></td>
<td><p><a class="reference external" href="https://www.mindspore.cn/tutorials/experts/en/master/debug/dump.html">Dump function debugging</a></p></td>
</tr>
<tr class="row-even"><td><p>Execution control</p></td>
<td><p>Callback</p></td>
<td><p>Users can use callback functions to perform specific actions
at specific times or to observe network information
during training, e.g., save model parameters, monitor loss,
dynamically adjust parameters, terminate training tasks early.</p></td>
<td><p><a class="reference external" href="https://www.mindspore.cn/tutorials/experts/en/master/debug/custom_debug.html#introduction-to-callback">Callback mechanism</a></p></td>
</tr>
<tr class="row-odd"><td></td>
<td><p>Hook</p></td>
<td><p>The Hook function in pynative mode captures the input and output data
and the backward gradient of the middle layer operator.
Four forms of Hook functions are available:
HookBackward operator and register_forward_pre_hook, register_forward_hook,
and register_backward_hook functions
registered on the Cell object.</p></td>
<td><p><a class="reference external" href="https://www.mindspore.cn/tutorials/experts/en/master/debug/pynative.html#hook-function">Hook function</a></p></td>
</tr>
<tr class="row-even"><td></td>
<td><p>Synchronous execution</p></td>
<td><p>In dynamic graph mode, operators are executed asynchronously
on the device to improve performance,
so operator execution errors may be displayed at the end of program execution.
In this case, MindSpore provides a synchronous execution setting
to control whether the arithmetic is executed asynchronously on the device.</p></td>
<td><p><a class="reference external" href="https://www.mindspore.cn/tutorials/en/master/advanced/compute_graph.html#dynamic-graphs">Synchronized execution of dynamic graph</a></p></td>
</tr>
</tbody>
</table>
</section>
<section id="framework-development-debugging">
<h2>Framework Development Debugging<a class="headerlink" href="#framework-development-debugging" title="Permalink to this headline"></a></h2>
<p>MindSpore provides framework developers with rich debugging tools. Debugging features cover the framework’s execution process, the framework’s execution data, the framework’s special control, for example: the log can record the framework’s execution process, and the RDR can record the framework’s key state information, memory reuse control.</p>
<table class="docutils align-default">
<colgroup>
<col style="width: 15%" />
<col style="width: 15%" />
<col style="width: 37%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Function classification</p></th>
<th class="head"><p>Main debugging functions</p></th>
<th class="head"><p>Description of use</p></th>
<th class="head"><p>Detailed introduction</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Process records</p></td>
<td><p>Logs</p></td>
<td><p>used to record information at each stage of the framework
implementation to provide information for understanding
the framework implementation process or for problem diagnosis.</p></td>
<td><p><a class="reference external" href="https://www.mindspore.cn/tutorials/experts/en/master/debug/custom_debug.html#log-related-environment-variables-and-configurations">Log-related environment variables and configurations</a></p></td>
</tr>
<tr class="row-odd"><td><p>Data records</p></td>
<td><p>RDR</p></td>
<td><p>Running Data Recorder (RDR) provides the ability
to record framework execution status data
while the training program is running.
It can also save key frame state data, such as IR,
graph execution order,</p></td>
<td><p><a class="reference external" href="https://www.mindspore.cn/ps://www.mindtutorials/experts/en/master/debug/custom_debug.html#running-data-recorder">Running Data Recorder</a></p></td>
</tr>
<tr class="row-even"><td><p>Specialized control</p></td>
<td><p>Memory reuse</p></td>
<td><p>Configure memory reuse on and off for troubleshooting
or debugging suspected problems related to memory reuse.</p></td>
<td><p><a class="reference external" href="https://www.mindspore.cn/tutorials/experts/en/master/debug/custom_debug.html#memory-reuse">Memory Reuse</a></p></td>
</tr>
</tbody>
</table>
</section>
</section>


           </div>
           
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="../infer/model_compression.html" class="btn btn-neutral float-left" title="Model Compression" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="error_analyze.html" class="btn btn-neutral float-right" title="Error Analysis" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, MindSpore.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   
</body>
</html>