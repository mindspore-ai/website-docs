

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Lightweight Data Processing &mdash; MindSpore master documentation</title>
  

  
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
   
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  
  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Single-Node Tensor Cache" href="cache.html" />
    <link rel="prev" title="Auto Augmentation" href="augment.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> MindSpore
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Data Processing</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="augment.html">Auto Augmentation</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Lightweight Data Processing</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#example">example</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#data-preparation">data preparation</a></li>
<li class="toctree-l3"><a class="reference internal" href="#vision">vision</a></li>
<li class="toctree-l3"><a class="reference internal" href="#text">text</a></li>
<li class="toctree-l3"><a class="reference internal" href="#transforms">transforms</a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="cache.html">Single-Node Tensor Cache</a></li>
<li class="toctree-l1"><a class="reference internal" href="optimize.html">Optimizing the Data Processing</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Operator Execution</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../operation/op_classification.html">Operators Classification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../operation/op_overload.html">Operation Overloading</a></li>
<li class="toctree-l1"><a class="reference internal" href="../operation/op_ascend.html">Custom Operators (Ascend)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../operation/op_custom.html">Custom Operators (Custom based)</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Model Inference</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../infer/inference.html">Inference Model Overview</a></li>
<li class="toctree-l1"><a class="reference internal" href="../infer/cpu_gpu_mindir.html">Inference on a GPU</a></li>
<li class="toctree-l1"><a class="reference internal" href="../infer/ascend_910_mindir.html">Inference on the Ascend 910 AI processor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../infer/ascend_310_mindir.html">Inference Using the MindIR Model on Ascend 310 AI Processors</a></li>
<li class="toctree-l1"><a class="reference internal" href="../infer/ascend_310_air.html">Inference on the Ascend 310 AI Processor</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Debugging and Tuning</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../debug/mindir.html">Reading IR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../debug/dump.html">Using Dump in the Graph Mode</a></li>
<li class="toctree-l1"><a class="reference internal" href="../debug/custom_debug.html">Custom Debugging Information</a></li>
<li class="toctree-l1"><a class="reference internal" href="../debug/op_compilation.html">Incremental Operator Build</a></li>
<li class="toctree-l1"><a class="reference internal" href="../debug/auto_tune.html">AutoTune</a></li>
<li class="toctree-l1"><a class="reference internal" href="../debug/dataset_autotune.html">Dataset AutoTune for Dataset Pipeline</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Distributed Parallel</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../parallel/introduction.html">Distributed Parallel Training Mode</a></li>
<li class="toctree-l1"><a class="reference internal" href="../parallel/train_ascend.html">Parallel Distributed Training Example (Ascend)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../parallel/train_gpu.html">Distributed Parallel Training Example (GPU)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../parallel/distributed_inference.html">Distributed Inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../parallel/save_load.html">Saving and Loading Models in Hybrid Parallel Mode</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Advanced Features</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../others/mixed_precision.html">Enabling Mixed Precision</a></li>
<li class="toctree-l1"><a class="reference internal" href="../others/gradient_accumulation.html">Gradient Accumulation Algorithm</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MindSpore</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Lightweight Data Processing</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/dataset/eager.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section id="lightweight-data-processing">
<h1>Lightweight Data Processing<a class="headerlink" href="#lightweight-data-processing" title="Permalink to this headline"></a></h1>
<p><a href="https://gitee.com/mindspore/docs/blob/r1.7/tutorials/experts/source_en/dataset/eager.md" target="_blank"><img src="https://mindspore-website.obs.cn-north-4.myhuaweicloud.com/website-images/r1.7/resource/_static/logo_source_en.png"></a></p>
<p>When resource conditions permit, in order to pursue higher performance, data transformations are generally executed in the data pipeline mode. That is, users have to define the <code class="docutils literal notranslate"><span class="pre">map</span></code> operator which helps to execute augmentations in data pipeline. As shown in the figure below, the <code class="docutils literal notranslate"><span class="pre">map</span></code> operator contains 3 transformations: <code class="docutils literal notranslate"><span class="pre">Resize</span></code>, <code class="docutils literal notranslate"><span class="pre">Crop</span></code>, and <code class="docutils literal notranslate"><span class="pre">HWC2CHW</span></code>. When the pipeline starts, the <code class="docutils literal notranslate"><span class="pre">map</span></code> operator will apply these transformations to data in sequence.</p>
<p><img alt="pipelinemode1" src="../_images/pipeline_mode_en.jpeg" /></p>
<p>Although the data pipeline can process input data quickly, the code of defining pipeline seems heavy while sometimes users just want to focus on the data transformations and perform them on small-scale data. In this case, data pipeline is not necessary.</p>
<p>Therefore, MindSpore provides a lightweight data processing way to execute these data augmentations, called <code class="docutils literal notranslate"><span class="pre">Eager</span> <span class="pre">mode</span></code>.</p>
<p>In <code class="docutils literal notranslate"><span class="pre">Eager</span> <span class="pre">mode</span></code>, the execution of data augmentations will not rely on the <code class="docutils literal notranslate"><span class="pre">map</span></code> operator but can be called directly as callable functions. The code will be simpler since the results are obtained immediately. It is recommended to be used in lightweight scenarios such as small data enhancement experiments and model inference.</p>
<p><img alt="eagermode1" src="../_images/eager_mode_en.jpeg" /></p>
<p>MindSpore currently supports executing various data augmentations in <code class="docutils literal notranslate"><span class="pre">Eager</span> <span class="pre">mode</span></code>, as shown below. For more details, please refer to the API documentation.</p>
<ul class="simple">
<li><p><a class="reference external" href="https://www.mindspore.cn/docs/en/r1.7/api_python/mindspore.dataset.vision.html">vision module</a></p>
<ul>
<li><p>Submodule c_transforms, an image enhancement operator based on OpenCV.</p></li>
<li><p>Submodule py_transforms, an image enhancement operator based on Pillow.</p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://www.mindspore.cn/docs/en/r1.7/api_python/mindspore.dataset.text.html#mindspore-dataset-text-transforms">text module</a></p>
<ul>
<li><p>Submodule transforms, text processing operators.</p></li>
</ul>
</li>
<li><p><a class="reference external" href="https://www.mindspore.cn/docs/en/r1.7/api_python/mindspore.dataset.transforms.html">transforms module</a></p>
<ul>
<li><p>Submodule c_transforms, a general-purpose data enhancement operator based on C++.</p></li>
<li><p>Submodule py_transforms, a general-purpose data augmentation operator based on Python.</p></li>
</ul>
</li>
</ul>
<section id="example">
<h2>example<a class="headerlink" href="#example" title="Permalink to this headline"></a></h2>
<p>The following example introduces how to execute data augmentations in <code class="docutils literal notranslate"><span class="pre">Eager</span> <span class="pre">mode</span></code>.</p>
<blockquote>
<div><p>To use <code class="docutils literal notranslate"><span class="pre">Eager</span> <span class="pre">mode</span></code>, just treat the data augmentations as an executable function and call them directly.</p>
</div></blockquote>
<section id="data-preparation">
<h3>data preparation<a class="headerlink" href="#data-preparation" title="Permalink to this headline"></a></h3>
<p>Download the image and save it to the specified location.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">os</span>
<span class="kn">import</span> <span class="nn">requests</span>

<span class="n">requests</span><span class="o">.</span><span class="n">packages</span><span class="o">.</span><span class="n">urllib3</span><span class="o">.</span><span class="n">disable_warnings</span><span class="p">()</span>

<span class="k">def</span> <span class="nf">download_dataset</span><span class="p">(</span><span class="n">dataset_url</span><span class="p">,</span> <span class="n">path</span><span class="p">):</span>
    <span class="n">filename</span> <span class="o">=</span> <span class="n">dataset_url</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s2">&quot;/&quot;</span><span class="p">)[</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">save_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">path</span><span class="p">,</span> <span class="n">filename</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">save_path</span><span class="p">):</span>
        <span class="k">return</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">exists</span><span class="p">(</span><span class="n">path</span><span class="p">):</span>
        <span class="n">os</span><span class="o">.</span><span class="n">makedirs</span><span class="p">(</span><span class="n">path</span><span class="p">)</span>
    <span class="n">res</span> <span class="o">=</span> <span class="n">requests</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">dataset_url</span><span class="p">,</span> <span class="n">stream</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">verify</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="n">save_path</span><span class="p">,</span> <span class="s2">&quot;wb&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">chunk</span> <span class="ow">in</span> <span class="n">res</span><span class="o">.</span><span class="n">iter_content</span><span class="p">(</span><span class="n">chunk_size</span><span class="o">=</span><span class="mi">512</span><span class="p">):</span>
            <span class="k">if</span> <span class="n">chunk</span><span class="p">:</span>
                <span class="n">f</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">chunk</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;The </span><span class="si">{}</span><span class="s2"> file is downloaded and saved in the path </span><span class="si">{}</span><span class="s2"> after processing&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">basename</span><span class="p">(</span><span class="n">dataset_url</span><span class="p">),</span> <span class="n">path</span><span class="p">))</span>

<span class="n">download_dataset</span><span class="p">(</span><span class="s2">&quot;https://obs.dualstack.cn-north-4.myhuaweicloud.com/mindspore-website/notebook/datasets/banana.jpg&quot;</span><span class="p">,</span> <span class="s2">&quot;.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="vision">
<h3>vision<a class="headerlink" href="#vision" title="Permalink to this headline"></a></h3>
<p>This example will mix the <code class="docutils literal notranslate"><span class="pre">c_tranforms</span></code> and <code class="docutils literal notranslate"><span class="pre">py_transforms</span></code> operators from the <code class="docutils literal notranslate"><span class="pre">vision</span></code> module to transform a given image.</p>
<p>You only need to focus on what data augmentations have to use, not any code for the data pipeline.</p>
<p>The Eager mode of the vision operator supports <code class="docutils literal notranslate"><span class="pre">numpy.array</span></code> or <code class="docutils literal notranslate"><span class="pre">PIL.Image</span></code> type data as input parameters.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">mindspore.dataset.vision.c_transforms</span> <span class="k">as</span> <span class="nn">C</span>
<span class="kn">import</span> <span class="nn">mindspore.dataset.vision.py_transforms</span> <span class="k">as</span> <span class="nn">P</span>

<span class="n">img_ori</span> <span class="o">=</span> <span class="n">Image</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;banana.jpg&quot;</span><span class="p">)</span><span class="o">.</span><span class="n">convert</span><span class="p">(</span><span class="s2">&quot;RGB&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Image.type: </span><span class="si">{}</span><span class="s2">, Image.shape: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">img_ori</span><span class="p">),</span> <span class="n">img_ori</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>

<span class="c1"># Define a Resize op from c_transform and execute it immediately</span>
<span class="n">op1</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">Resize</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">320</span><span class="p">))</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">op1</span><span class="p">(</span><span class="n">img_ori</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Image.type: </span><span class="si">{}</span><span class="s2">, Image.shape: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">img</span><span class="p">),</span> <span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>

<span class="c1"># Define a CenterCrop op from c_transform and execute it immediately</span>
<span class="n">op2</span> <span class="o">=</span> <span class="n">C</span><span class="o">.</span><span class="n">CenterCrop</span><span class="p">((</span><span class="mi">280</span><span class="p">,</span> <span class="mi">280</span><span class="p">))</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">op2</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Image.type: </span><span class="si">{}</span><span class="s2">, Image.shape: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">img</span><span class="p">),</span> <span class="n">img</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>

<span class="c1"># Define a Pad op from py_transform and execute it immediately</span>
<span class="c1"># Before calling Pad, you need to call ToPIL()</span>
<span class="n">op3</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">ToPIL</span><span class="p">()</span>
<span class="n">op4</span> <span class="o">=</span> <span class="n">P</span><span class="o">.</span><span class="n">Pad</span><span class="p">(</span><span class="mi">40</span><span class="p">)</span>
<span class="n">img</span> <span class="o">=</span> <span class="n">op4</span><span class="p">(</span><span class="n">op3</span><span class="p">(</span><span class="n">img</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Image.type: </span><span class="si">{}</span><span class="s2">, Image.shape: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="nb">type</span><span class="p">(</span><span class="n">img</span><span class="p">),</span> <span class="n">img</span><span class="o">.</span><span class="n">size</span><span class="p">))</span>

<span class="c1"># Show the result</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">1</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img_ori</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;original image&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplot</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">img</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;transformed image&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
<p>The output is as follows:</p>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Image.type: &lt;class &#39;PIL.Image.Image&#39;&gt;, Image.shape: (356, 200)
Image.type: &lt;class &#39;numpy.ndarray&#39;&gt;, Image.shape: (320, 570, 3)
Image.type: &lt;class &#39;numpy.ndarray&#39;&gt;, Image.shape: (280, 280, 3)
Image.type: &lt;class &#39;PIL.Image.Image&#39;&gt;, Image.shape: (360, 360)
</pre></div>
</div>
<p>The following shows the processed image.</p>
<p><img alt="eager_mode" src="../_images/eager_mode.png" /></p>
<p>Augmentation operators that support to be run in Eager Mode are listed as follows: <a class="reference external" href="https://www.mindspore.cn/docs/en/r1.7/api_python/mindspore.dataset.transforms.html">mindspore.dataset.transforms</a>, <a class="reference external" href="https://www.mindspore.cn/docs/en/r1.7/api_python/mindspore.dataset.vision.html">mindspore.dataset.vision</a>, <a class="reference external" href="https://www.mindspore.cn/docs/en/r1.7/api_python/mindspore.dataset.text.html#mindspore-dataset-text-transforms">mindspore.dataset.text.transforms</a>.</p>
</section>
<section id="text">
<h3>text<a class="headerlink" href="#text" title="Permalink to this headline"></a></h3>
<p>This example will transform the given text using the <code class="docutils literal notranslate"><span class="pre">tranforms</span></code> operator in the <code class="docutils literal notranslate"><span class="pre">text</span></code> module.</p>
<p>Eager mode of the text operator supports <code class="docutils literal notranslate"><span class="pre">numpy.array</span></code> type data as input parameters.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mindspore.dataset.text.transforms</span> <span class="k">as</span> <span class="nn">text</span>
<span class="kn">from</span> <span class="nn">mindspore</span> <span class="kn">import</span> <span class="n">dtype</span> <span class="k">as</span> <span class="n">mstype</span>

<span class="c1"># Define a WhitespaceTokenizer op and execute it immediately</span>
<span class="n">txt</span> <span class="o">=</span> <span class="s2">&quot;Welcome to Beijing !&quot;</span>
<span class="n">txt</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">WhitespaceTokenizer</span><span class="p">()(</span><span class="n">txt</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Tokenize result: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">txt</span><span class="p">))</span>

<span class="c1"># Define a ToNumber op and execute it immediately</span>
<span class="n">txt</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;123456&quot;</span><span class="p">]</span>
<span class="n">to_number</span> <span class="o">=</span> <span class="n">text</span><span class="o">.</span><span class="n">ToNumber</span><span class="p">(</span><span class="n">mstype</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="n">txt</span> <span class="o">=</span> <span class="n">to_number</span><span class="p">(</span><span class="n">txt</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;ToNumber result: </span><span class="si">{}</span><span class="s2">, type: </span><span class="si">{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">txt</span><span class="p">,</span> <span class="nb">type</span><span class="p">(</span><span class="n">txt</span><span class="p">[</span><span class="mi">0</span><span class="p">])))</span>
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Tokenize result: [&#39;Welcome&#39; &#39;to&#39; &#39;Beijing&#39; &#39;!&#39;]
ToNumber result: [123456], type: &lt;class &#39;numpy.int32&#39;&gt;
</pre></div>
</div>
</section>
<section id="transforms">
<h3>transforms<a class="headerlink" href="#transforms" title="Permalink to this headline"></a></h3>
<p>This example will transform the given data using the operators of <code class="docutils literal notranslate"><span class="pre">c_tranforms</span></code> in the <code class="docutils literal notranslate"><span class="pre">transforms</span></code> module.</p>
<p>Eager mode of transforms operator supports <code class="docutils literal notranslate"><span class="pre">numpy.array</span></code> type data as input parameters.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">mindspore.dataset.transforms.c_transforms</span> <span class="k">as</span> <span class="nn">trans</span>

<span class="c1"># Define a Fill op and execute it immediately</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">])</span>
<span class="n">fill</span> <span class="o">=</span> <span class="n">trans</span><span class="o">.</span><span class="n">Fill</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">data</span> <span class="o">=</span> <span class="n">fill</span><span class="p">(</span><span class="n">data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Fill result: &quot;</span><span class="p">,</span> <span class="n">data</span><span class="p">)</span>

<span class="c1"># Define a OneHot op and execute it immediately</span>
<span class="n">label</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
<span class="n">onehot</span> <span class="o">=</span> <span class="n">trans</span><span class="o">.</span><span class="n">OneHot</span><span class="p">(</span><span class="n">num_classes</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
<span class="n">label</span> <span class="o">=</span> <span class="n">onehot</span><span class="p">(</span><span class="n">label</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;OneHot result: &quot;</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-text notranslate"><div class="highlight"><pre><span></span>Fill result:  [0 0 0 0 0]
OneHot result:  [0 0 1 0 0]
</pre></div>
</div>
</section>
</section>
</section>


           </div>
           
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="augment.html" class="btn btn-neutral float-left" title="Auto Augmentation" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="cache.html" class="btn btn-neutral float-right" title="Single-Node Tensor Cache" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, MindSpore.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   
</body>
</html>