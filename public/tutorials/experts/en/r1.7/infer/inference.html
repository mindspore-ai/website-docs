

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Inference Model Overview &mdash; MindSpore master documentation</title>
  

  
   
  <link rel="stylesheet" href="../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
  
  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
        <script src="../_static/jquery.js"></script>
        <script src="../_static/underscore.js"></script>
        <script src="../_static/doctools.js"></script>
        <script src="../_static/language_data.js"></script>
        
        
        <script type="text/x-mathjax-config">MathJax.Hub.Config({"tex2jax": {"inlineMath": [["\\(", "\\)"]], "displayMath": [["\\[", "\\]"]], "processRefs": false, "processEnvironments": false}})</script>
    
    <script type="text/javascript" src="../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Inference on a GPU" href="cpu_gpu_mindir.html" />
    <link rel="prev" title="Custom Operators (Custom based)" href="../operation/op_custom.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../index.html" class="icon icon-home" alt="Documentation Home"> MindSpore
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Data Processing</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../dataset/augment.html">Auto Augmentation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dataset/eager.html">Lightweight Data Processing</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dataset/cache.html">Single-Node Tensor Cache</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dataset/optimize.html">Optimizing the Data Processing</a></li>
</ul>
<p class="caption"><span class="caption-text">Operator Execution</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../operation/op_classification.html">Operators Classification</a></li>
<li class="toctree-l1"><a class="reference internal" href="../operation/op_overload.html">Operation Overloading</a></li>
<li class="toctree-l1"><a class="reference internal" href="../operation/op_ascend.html">Custom Operators (Ascend)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../operation/op_custom.html">Custom Operators (Custom based)</a></li>
</ul>
<p class="caption"><span class="caption-text">Model Inference</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">Inference Model Overview</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#model-files">Model Files</a></li>
<li class="toctree-l2"><a class="reference internal" href="#inference-execution">Inference Execution</a></li>
<li class="toctree-l2"><a class="reference internal" href="#introduction-to-mindir">Introduction to MindIR</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="cpu_gpu_mindir.html">Inference on a GPU</a></li>
<li class="toctree-l1"><a class="reference internal" href="ascend_910_mindir.html">Inference on the Ascend 910 AI processor</a></li>
<li class="toctree-l1"><a class="reference internal" href="ascend_310_mindir.html">Inference Using the MindIR Model on Ascend 310 AI Processors</a></li>
<li class="toctree-l1"><a class="reference internal" href="ascend_310_air.html">Inference on the Ascend 310 AI Processor</a></li>
</ul>
<p class="caption"><span class="caption-text">Debugging and Tuning</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../debug/mindir.html">Reading IR</a></li>
<li class="toctree-l1"><a class="reference internal" href="../debug/dump.html">Using Dump in the Graph Mode</a></li>
<li class="toctree-l1"><a class="reference internal" href="../debug/custom_debug.html">Custom Debugging Information</a></li>
<li class="toctree-l1"><a class="reference internal" href="../debug/op_compilation.html">Incremental Operator Build</a></li>
<li class="toctree-l1"><a class="reference internal" href="../debug/auto_tune.html">AutoTune</a></li>
<li class="toctree-l1"><a class="reference internal" href="../debug/dataset_autotune.html">Dataset AutoTune for Dataset Pipeline</a></li>
</ul>
<p class="caption"><span class="caption-text">Distributed Parallel</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../parallel/introduction.html">Distributed Parallel Training Mode</a></li>
<li class="toctree-l1"><a class="reference internal" href="../parallel/train_ascend.html">Parallel Distributed Training Example (Ascend)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../parallel/train_gpu.html">Distributed Parallel Training Example (GPU)</a></li>
<li class="toctree-l1"><a class="reference internal" href="../parallel/distributed_inference.html">Distributed Inference</a></li>
<li class="toctree-l1"><a class="reference internal" href="../parallel/save_load.html">Saving and Loading Models in Hybrid Parallel Mode</a></li>
</ul>
<p class="caption"><span class="caption-text">Advanced Features</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../others/mixed_precision.html">Enabling Mixed Precision</a></li>
<li class="toctree-l1"><a class="reference internal" href="../others/gradient_accumulation.html">Gradient Accumulation Algorithm</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">MindSpore</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Inference Model Overview</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../_sources/infer/inference.md.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<div class="section" id="inference-model-overview">
<h1>Inference Model Overview<a class="headerlink" href="#inference-model-overview" title="Permalink to this headline">¶</a></h1>
<p><a href="https://gitee.com/mindspore/docs/blob/r1.7/tutorials/experts/source_en/infer/inference.md" target="_blank"><img src="https://mindspore-website.obs.cn-north-4.myhuaweicloud.com/website-images/r1.7/resource/_static/logo_source_en.png"></a></p>
<p>MindSpore can execute inference tasks on different hardware platforms based on trained models.</p>
<div class="section" id="model-files">
<h2>Model Files<a class="headerlink" href="#model-files" title="Permalink to this headline">¶</a></h2>
<p>MindSpore can save two types of data: training parameters and network models that contain parameter information.</p>
<ul class="simple">
<li><p>Training parameters are stored in the checkpoint format.</p></li>
<li><p>Network models are stored in the MindIR, AIR, or ONNX format.</p></li>
</ul>
<p>Basic concepts and application scenarios of these formats are as follows:</p>
<ul class="simple">
<li><p>Checkpoint</p>
<ul>
<li><p>Checkpoint uses the Protocol Buffers format and stores all network parameter values.</p></li>
<li><p>It is generally used to resume training after a training task is interrupted or executes a fine-tune task after training.</p></li>
</ul>
</li>
<li><p>MindSpore IR (MindIR)</p>
<ul>
<li><p>MindIR is a graph-based function-like IR of MindSpore and defines scalable graph structures and operator IRs.</p></li>
<li><p>It eliminates model differences between different backends and is generally used to perform inference tasks across hardware platforms.</p></li>
</ul>
</li>
<li><p>Open Neural Network Exchange (ONNX)</p>
<ul>
<li><p>ONNX is an open format built to represent machine learning models.</p></li>
<li><p>It is generally used to transfer models between different frameworks or used on the inference engine (<a class="reference external" href="https://docs.nvidia.com/deeplearning/tensorrt/python_api/index.html">TensorRT</a>).</p></li>
<li><p>At present, mindspire only supports the export of ONNX model, and does not support loading onnx model for inference. Currently, the models supported for export are resnet50, yolov3_ darknet53, YOLOv4 and BERT. These models can be used on <a class="reference external" href="https://onnxruntime.ai/">ONNX Runtime</a>.</p></li>
</ul>
</li>
<li><p>Ascend Intermediate Representation (AIR)</p>
<ul>
<li><p>AIR is an open file format defined by Huawei for machine learning.</p></li>
<li><p>It adapts to Huawei AI processors well and is generally used to execute inference tasks on Ascend 310.</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="inference-execution">
<h2>Inference Execution<a class="headerlink" href="#inference-execution" title="Permalink to this headline">¶</a></h2>
<p>Inference can be classified into the following two modes based on the application environment:</p>
<ol>
<li><p>Local inference</p>
<p>Load a checkpoint file generated during network training and call the <code class="docutils literal notranslate"><span class="pre">model.predict</span></code> API for inference and validation.</p>
</li>
<li><p>Cross-platform inference</p>
<p>Use a network definition and a checkpoint file, call the <code class="docutils literal notranslate"><span class="pre">export</span></code> API to export a model file, and perform inference on different platforms. Currently, MindIR, ONNX, and AIR (on only Ascend AI Processors) models can be exported. For details, see <a class="reference external" href="https://www.mindspore.cn/tutorials/en/r1.7/advanced/train/save.html">Saving Models</a>.</p>
</li>
</ol>
</div>
<div class="section" id="introduction-to-mindir">
<h2>Introduction to MindIR<a class="headerlink" href="#introduction-to-mindir" title="Permalink to this headline">¶</a></h2>
<p>MindSpore defines logical network structures and operator attributes through a unified IR, and decouples model files in MindIR format from hardware platforms to implement one-time training and multiple-time deployment.</p>
<ol>
<li><p>Overview</p>
<p>As a unified model file of MindSpore, MindIR stores network structures and weight parameter values. In addition, it can be deployed on the on-cloud Serving and the on-device Lite platforms to execute inference tasks.</p>
<p>A MindIR file supports the deployment of multiple hardware forms.</p>
<ul class="simple">
<li><p>On-cloud deployment and inference on Serving: After MindSpore trains and generates a MindIR model file, the file can be directly sent to MindSpore Serving for loading and inference. No additional model conversion is required. This ensures that models on different hardware such as Ascend, GPU, and CPU are unified.</p></li>
<li><p>On-device inference and deployment on Lite: MindIR can be directly used for Lite deployment. In addition, to meet the lightweight requirements on devices, the model miniaturization and conversion functions are provided. An original MindIR model file can be converted from the Protocol Buffers format to the FlatBuffers format for storage, and the network structure is lightweight to better meet the performance and memory requirements on devices.</p></li>
</ul>
</li>
<li><p>Application Scenarios</p>
<p>Use a network definition and a checkpoint file to export a MindIR model file, and then execute inference based on different requirements, for example, <a class="reference external" href="https://www.mindspore.cn/tutorials/experts/en/r1.7/infer/ascend_310_mindir.html">Inference Using the MindIR Model on Ascend 310 AI Processors</a>, <a class="reference external" href="https://www.mindspore.cn/serving/docs/en/r1.7/serving_example.html">MindSpore Serving-based Inference Service Deployment</a>, and <a class="reference external" href="https://www.mindspore.cn/lite/docs/en/r1.7/index.html">Inference on Devices</a>.</p>
</li>
</ol>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="cpu_gpu_mindir.html" class="btn btn-neutral float-right" title="Inference on a GPU" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="../operation/op_custom.html" class="btn btn-neutral float-left" title="Custom Operators (Custom based)" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2022, MindSpore.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   
	<script async="async" src="https://cdn.bootcss.com/mathjax/2.7.0/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>
</body>
</html>