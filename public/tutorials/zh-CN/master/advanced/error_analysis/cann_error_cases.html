<!DOCTYPE html>
<html class="writer-html5" lang="zh-CN" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>CANN常见错误分析 &mdash; MindSpore master documentation</title><script>;(()=>{const e=localStorage.getItem("ms-theme"),t=window.matchMedia("(prefers-color-scheme: dark)").matches;(e?"dark"===e:t)&&document.documentElement.setAttribute("data-o-theme","dark")})();</script><link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script><script src="../../_static/jquery.js"></script>
        <script src="../../_static/js/theme.js"></script><script src="../../_static/underscore.js"></script><script src="../../_static/doctools.js"></script><script src="../../_static/translations.js"></script><script crossorigin="anonymous" integrity="sha256-1fEPhSsRKlFKGfK3eO710tEweHh1fwokU5wFGDHO+vg=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="IR文件分析" href="mindir.html" />
    <link rel="prev" title="网络构建与训练常见错误分析" href="mindrt_debug.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="../../index.html" class="icon icon-home"> MindSpore
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">初学教程</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../beginner/introduction.html">基本介绍</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../beginner/quick_start.html">快速入门</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../beginner/tensor.html">张量 Tensor</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../beginner/dataset.html">数据集 Dataset</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../beginner/transforms.html">数据变换 Transforms</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../beginner/model.html">网络构建</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../beginner/autograd.html">函数式自动微分</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../beginner/train.html">模型训练</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../beginner/save_load.html">保存与加载</a></li>
<li class="toctree-l1"><a class="reference internal" href="../../beginner/accelerate_with_static_graph.html">使用静态图加速</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">进阶教程</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../model.html">高阶封装：Model</a></li>
<li class="toctree-l1"><a class="reference internal" href="../modules.html">模型模块自定义</a></li>
<li class="toctree-l1"><a class="reference internal" href="../dataset.html">高级数据处理</a></li>
<li class="toctree-l1"><a class="reference internal" href="../derivation.html">高级自动微分</a></li>
<li class="toctree-l1"><a class="reference internal" href="../static_graph_expert_programming.html">静态图高级编程技巧</a></li>
<li class="toctree-l1"><a class="reference internal" href="../mixed_precision.html">自动混合精度</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="../error_analysis.html">报错分析</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="error_scenario_analysis.html">错误分析</a></li>
<li class="toctree-l2"><a class="reference internal" href="minddata_debug.html">数据处理调试方法与常见问题分析</a></li>
<li class="toctree-l2"><a class="reference internal" href="mindrt_debug.html">网络构建与训练常见错误分析</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">CANN常见错误分析</a></li>
<li class="toctree-l2"><a class="reference internal" href="mindir.html">IR文件分析</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">MindSpore</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
          <li><a href="../error_analysis.html">报错分析</a> &raquo;</li>
      <li>CANN常见错误分析</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../../_sources/advanced/error_analysis/cann_error_cases.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section class="tex2jax_ignore mathjax_ignore" id="cann常见错误分析">
<h1>CANN常见错误分析<a class="headerlink" href="#cann常见错误分析" title="Permalink to this headline"></a></h1>
<p><a class="reference external" href="https://gitee.com/mindspore/docs/blob/master/tutorials/source_zh_cn/advanced/error_analysis/cann_error_cases.md"><img alt="查看源文件" src="https://mindspore-website.obs.cn-north-4.myhuaweicloud.com/website-images/master/resource/_static/logo_source.svg" /></a>  </p>
<p>本文主要介绍用户常见的CANN错误处理方法。在遇到CANN错误时，MindSpore的日志可能不足以分析相关错误，可以通过设置以下两个环境变量来打印CANN的日志以更好地分析错误：</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="nb">export</span><span class="w"> </span><span class="nv">ASCEND_GLOBAL_LOG_LEVEL</span><span class="o">=</span><span class="m">1</span><span class="w">        </span><span class="c1"># CANN日志级别，0为debug，1为info，2为warning，3为error</span>
<span class="nb">export</span><span class="w"> </span><span class="nv">ASCEND_SLOG_PRINT_TO_STDOUT</span><span class="o">=</span><span class="m">1</span><span class="w">    </span><span class="c1"># 配置开启日志打屏</span>
</pre></div>
</div>
<p>更多CANN错误以及日志设置可以搜索查询<a class="reference external" href="https://www.hiascend.com/zh/document">昇腾社区CANN文档</a>的<code class="docutils literal notranslate"><span class="pre">故障处理流程</span></code>章节。</p>
<section id="aicore算子编译问题">
<h2>AICORE算子编译问题<a class="headerlink" href="#aicore算子编译问题" title="Permalink to this headline"></a></h2>
<p>AICORE算子编译错误根据不同模块会以<code class="docutils literal notranslate"><span class="pre">E5</span></code>~<code class="docutils literal notranslate"><span class="pre">EB</span></code>开头，其中<code class="docutils literal notranslate"><span class="pre">E5</span></code>~<code class="docutils literal notranslate"><span class="pre">E8</span></code>错误码AICORE算子编译过程中一些校验报错，用户可以根据报错信息先尝试自行检查修正，而<code class="docutils literal notranslate"><span class="pre">E9</span></code>~<code class="docutils literal notranslate"><span class="pre">EB</span></code>错误码是TBE编译前后端报的错，一般来说报错就意味着算子规格TBE还不支持，可以从报错日志中获取具体信息。下面可以看一些具体的AICORE算子编译失败问题：</p>
<section id="e80000-stridedslicegradd输入值非法">
<h3>E80000: StridedSliceGradD输入值非法<a class="headerlink" href="#e80000-stridedslicegradd输入值非法" title="Permalink to this headline"></a></h3>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span>[WARNING] CORE(51545,ffff8ba74480,python):2019-07-25-19:17:35.411.770 [mindspore/core/ir/anf_extends.cc:66] fullname_with_scope] Input 0 of cnode is not a value node, its type is CNode.
[WARNING] DEVICE(51545,ffff8ba74480,python):2019-07-25-19:17:41.850.324 [mindspore/ccsrc/runtime/hardware/ascend/ascend_graph_optimization.cc:255] SelectKernel] There are 2 node/nodes used raise precision to selected the kernel!
[CRITICAL] KERNEL(51545,ffff8ba74480,python):2019-07-25-19:17:54.525.980 [mindspore/ccsrc/backend/kernel_compiler/tbe/tbe_kernel_compile.cc:494] QueryProcess] Single op compile failed, op: strided_slice_grad_d_1157509189447431479_0
except_msg: 2019-07-25 19:17:54.522852: Query except_msg:Traceback (most recent call last):
  File &quot;/home/miniconda3/envs/ci/lib/python3.7/site-packages/te_fusion/parallel_compilation.py&quot;, line 1453, in run
    op_name=self._op_name)
  File &quot;/home/miniconda3/envs/ci/lib/python3.7/site-packages/te_fusion/fusion_manager.py&quot;, line 1283, in build_single_op
    compile_info = call_op()
  File &quot;/home/miniconda3/envs/ci/lib/python3.7/site-packages/te_fusion/fusion_manager.py&quot;, line 1271, in call_op
    opfunc(*inputs, *outputs, *new_attrs, **kwargs)
  File &quot;/home/miniconda3/envs/ci/lib/python3.7/site-packages/tbe/common/utils/para_check.py&quot;, line 545, in _in_wrapper
    return func(*args, **kwargs)
  File &quot;/usr/local/Ascend/opp/op_impl/built-in/ai_core/tbe/impl/strided_slice_grad_d.py&quot;, line 1101, in strided_slice_grad_d
    _check_shape_parameter(shape, shape_dy, begin_shape, end_shape, stride_shape)
  File &quot;/usr/local/Ascend/opp/op_impl/built-in/ai_core/tbe/impl/strided_slice_grad_d.py&quot;, line 996, in _check_shape_parameter
    &quot;1&quot;, str(strides_i))
  File &quot;/home/miniconda3/envs/ci/lib/python3.7/site-packages/te/utils/error_manager/error_manager_vector.py&quot;, line 40, in raise_err_input_value_invalid
    return raise_err_input_value_invalid(op_name, param_name, excepted_value, real_value)
  File &quot;/home/miniconda3/envs/ci/lib/python3.7/site-packages/tbe/common/utils/errormgr/error_manager_vector.py&quot;, line 41, in raise_err_input_value_invalid
    raise RuntimeError(args_dict, msg)
RuntimeError: ({&#39;errCode&#39;: &#39;E80000&#39;, &#39;op_name&#39;: &#39;strided_slice_grad_d&#39;, &#39;param_name&#39;: &#39;strides[0]&#39;, &#39;excepted_value&#39;: &#39;1&#39;, &#39;real_value&#39;: &#39;2&#39;}, &#39;In op[strided_slice_grad_d], the parameter[strides[0]] should be , but actually is [2].&#39;)

The function call stack:
In file /home/miniconda3/envs/ci/lib/python3.7/site-packages/mindspore/ops/_grad_experimental/grad_array_ops.py(700)/        dx = input_grad(dout, x_shape, begin, end, strides)/
Corresponding forward node candidate:
- In file /home/miniconda3/envs/ci/lib/python3.7/site-packages/mindspore/ops/composite/multitype_ops/_compile_utils.py(306)/        return P.StridedSlice(begin_mask, end_mask, 0, 0, 0)(data, begin_strides, end_strides, step_strides)/
  In file /home/jenkins/models/official/cv/lenet/src/lenet.py(61)/        y = x[0::2] #切分操作，x.shape=(32,10) y.shape=(32)，导致降维/
  In file /home/miniconda3/envs/ci/lib/python3.7/site-packages/mindspore/train/amp.py(126)/            out = self._backbone(data)/
  In file /home/miniconda3/envs/ci/lib/python3.7/site-packages/mindspore/nn/wrap/loss_scale.py(332)/        loss = self.network(*inputs)/
  In file /home/miniconda3/envs/ci/lib/python3.7/site-packages/mindspore/train/dataset_helper.py(95)/        return self.network(*outputs)/
</pre></div>
</div>
<p>从上述错误码的报错信息中可以看到，StridedSliceGradD算子的参数strides中的第一个数据预期应该是1，但是实际得到的是2，故而报错。用户可以根据IR图来确认出错的算子信息，并修正strides参数。</p>
</section>
<section id="e80012-reducesum算子输入维度过高">
<h3>E80012: ReduceSum算子输入维度过高<a class="headerlink" href="#e80012-reducesum算子输入维度过高" title="Permalink to this headline"></a></h3>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span>RuntimeError: ({&#39;errCode&#39;: &#39;E80012&#39;, &#39;op_name&#39;: &#39;reduce_sum_d&#39;, &#39;param_name&#39;: &#39;x&#39;, &#39;min_value&#39;: 0, &#39;max_value&#39;: 8, &#39;real_value&#39;: 10}, &#39;In op, the num of dimensions of input/output[x] should be in the range of [0, 8], but actually is [10].&#39;)
</pre></div>
</div>
<p>从上述错误码的报错信息中可以看到，ReduceSum算子的输入和输出最高只支持8维的数据，但是实际遇到了10维的数据，故而报错。用户可以通过修改网络脚本来避免对ReduceSum输入10维的数据，从而规避这个错误。</p>
</section>
<section id="e80029-assign算子shape不一致问题">
<h3>E80029: Assign算子shape不一致问题<a class="headerlink" href="#e80029-assign算子shape不一致问题" title="Permalink to this headline"></a></h3>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span>RuntimeError: ({&#39;errCode&#39;: &#39;E80029&#39;, &#39;op_name&#39;: &#39;assign&#39;, &#39;param_name1&#39;: &#39;ref&#39;, &#39;param_name2&#39;: &#39;value&#39;, &#39;error_detail&#39;: &#39;Shape of ref and value should be same&#39;}, &#39;In op[assign], the shape of inputs[ref][value] are invalid, [Shape of ref and value should be same].&#39;)
</pre></div>
</div>
<p>Assign算子的逻辑是使用第二个输入（即value）对第一个输入的parameter（即ref）进行赋值操作，从上述错误码的报错信息中可以看到，这两个输入预期shape应该一致，但是实际并不一致，故而报错。用户可以根据IR图来确认出错的算子，并修正Assign算子的输入。</p>
</section>
<section id="eb0000-transpose规格不支持">
<h3>EB0000: Transpose规格不支持<a class="headerlink" href="#eb0000-transpose规格不支持" title="Permalink to this headline"></a></h3>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span>[ERROR] KERNEL(1062,fffe557fa160,python):2021-10-11-22:37:53.881.210 [mindspore/ccsrc/backend/kernel_compiler/tbe/tbe_kernel_parallel_build.cc:99] TbeOpParallelBuild] task compile Failed, task id:3, cause:TBEException:ERROR:

Traceback (most recent call last):
  File &quot;/usr/local/python3.7/lib/python3.7/site-packages/mindspore/_extends/parallel_compile/tbe_compiler/compiler.py&quot;, line 155, in build_op
    optune_opt_list=op_tune_list)
  File &quot;/usr/local/Ascend/nnae/latest/fwkacllib/python/site-packages/te_fusion/fusion_manager.py&quot;, line 1258, in build_single_op
    compile_info = call_op()
  File &quot;/usr/local/Ascend/nnae/latest/fwkacllib/python/site-packages/te_fusion/fusion_manager.py&quot;, line 1246, in call_op
    opfunc(*inputs, *outputs, *attrs, **kwargs)
  File &quot;/usr/local/Ascend/nnae/latest/fwkacllib/python/site-packages/tbe/common/utils/para_check.py&quot;, line 539, in _in_wrapper
    return func(*args, **kwargs)
  File &quot;/usr/local/Ascend/nnae/latest/opp/op_impl/built-in/ai_core/tbe/impl/transpose_d.py&quot;, line 24644, in transpose_d
    tvm.build(sch, tensor_list, &quot;cce&quot;, name=kernel_name)
  File &quot;/usr/local/Ascend/nnae/5.0.T301/fwkacllib/python/site-packages/te/tvm/build_module.py&quot;, line 799, in build
    build_cce(inputs, args, target, target_host, name, rules, binds, evaluates)
  File &quot;/usr/local/Ascend/nnae/5.0.T301/fwkacllib/python/site-packages/te/tvm/cce_build_module.py&quot;, line 855, in build_cce
    cce_lower(inputs, args, name, binds=binds, evaluates=evaluates, rule=rules)
  File &quot;/usr/local/Ascend/nnae/5.0.T301/fwkacllib/python/site-packages/te/tvm/cce_build_module.py&quot;, line 50, in wrapper
    r = fn(*args, **kw)
  File &quot;/usr/local/Ascend/nnae/5.0.T301/fwkacllib/python/site-packages/te/tvm/cce_build_module.py&quot;, line 404, in cce_lower
    arg_list, cfg, evaluates, inputs_num, rule)
  File &quot;/usr/local/Ascend/nnae/5.0.T301/fwkacllib/python/site-packages/te/tvm/cce_build_module.py&quot;, line 146, in cce_static_lower
    stmt = ir_pass.StorageRewriteCCE(stmt)
  File &quot;/usr/local/Ascend/nnae/5.0.T301/fwkacllib/python/site-packages/te/tvm/_ffi/_ctypes/function.py&quot;, line 209, in __call__
    raise get_last_ffi_error()
tvm._ffi.base.TVMError: Traceback (most recent call last):
  [bt] (5) /usr/local/Ascend/nnae/5.0.T301/fwkacllib/lib64/libtvm.so(TVMFuncCall+0x70) [0xffffa0ccd5a8]
  [bt] (4) /usr/local/Ascend/nnae/5.0.T301/fwkacllib/lib64/libtvm.so(std::_Function_handler&lt;void (tvm::runtime::TVMArgs, tvm::runtime::TVMRetValue*), void tvm::runtime::TypedPackedFunc&lt;tvm::Stmt (tvm::Stmt)&gt;::AssignTypedLambda&lt;tvm::Stmt (*)(tvm::Stmt)&gt;(tvm::Stmt (*)(tvm::Stmt))::{lambda(tvm::runtime::TVMArgs const&amp;, tvm::runtime::TVMRetValue*)#1}&gt;::_M_invoke(std::_Any_data const&amp;, tvm::runtime::TVMArgs&amp;&amp;, tvm::runtime::TVMRetValue*&amp;&amp;)+0x5c) [0xffff9ffb69fc]
  [bt] (3) /usr/local/Ascend/nnae/5.0.T301/fwkacllib/lib64/libtvm.so(tvm::ir::StorageRewriteCCE(tvm::Stmt)+0x590) [0xffffa09753d0]
  [bt] (2) /usr/local/Ascend/nnae/5.0.T301/fwkacllib/lib64/libtvm.so(+0x1d40658) [0xffffa0974658]
  [bt] (1) /usr/local/Ascend/nnae/5.0.T301/fwkacllib/lib64/libtvm.so(+0x1d61844) [0xffffa0995844]
  [bt] (0) /usr/local/Ascend/nnae/5.0.T301/fwkacllib/lib64/libtvm.so(tvm_dmlc::LogMessageFatal::~LogMessageFatal()+0x4c) [0xffff9ff6602c]
  File &quot;storage_rewrite_cce.cc&quot;, line 840

TVMError: [EB0000] Check failed: need_nbits &lt;= info-&gt;max_num_bits (4194304 vs. 2097152) : data_ub exceed bound of memory: local.UB ! Current IR Stmt:copy_ubuf_to_gm(tvm_access_ptr(0h, res, ((i0*263168) + (blockIdx.x*1024)), 1024, 2, 1, 2048, 1, 2048, 2048), tvm_access_ptr(0h, data_ub, (i0*1024), 1024, 1, 1, 2048, 1, 2048, 2048), 0, 1, 64, 0, 0)

input_args: {&quot;SocInfo&quot;: {&quot;autoTilingMode&quot;: &quot;NO_TUNE&quot;, &quot;coreNum&quot;: &quot;&quot;, &quot;coreType&quot;: &quot;&quot;, &quot;l1Fusion&quot;: &quot;false&quot;, &quot;l2Fusion&quot;: &quot;false&quot;, &quot;l2Mode&quot;: &quot;2&quot;, &quot;op_debug_level&quot;: &quot;&quot;, &quot;op_impl_mode&quot;: &quot;&quot;, &quot;op_impl_mode_list&quot;: [], &quot;socVersion&quot;: &quot;Ascend910&quot;}, &quot;impl_path&quot;: &quot;&quot;, &quot;op_info&quot;: {&quot;Type&quot;: &quot;Transpose&quot;, &quot;attr_desc&quot;: [[0, 2, 1, 3]], &quot;attrs&quot;: [{&quot;name&quot;: &quot;perm&quot;, &quot;valid&quot;: true, &quot;value&quot;: [0, 2, 1, 3]}], &quot;full_name&quot;: &quot;Default/encode_image-EncodeImage/visual-ViT/body-Transformer/layers-SequentialCell/0-SequentialCell/0-ResidualCell/cell-SequentialCell/1-AttentionWithMask/Transpose-op662&quot;, &quot;gen_model&quot;: &quot;single&quot;, &quot;graph_id&quot;: 0, &quot;inputs&quot;: [[{&quot;addr_type&quot;: 0, &quot;dtype&quot;: &quot;float16&quot;, &quot;format&quot;: &quot;NCHW&quot;, &quot;name&quot;: &quot;x_0&quot;, &quot;ori_format&quot;: &quot;NCHW&quot;, &quot;ori_shape&quot;: [256, 16, 257, 64], &quot;param_type&quot;: &quot;required&quot;, &quot;range&quot;: [[256, 256], [16, 16], [257, 257], [64, 64]], &quot;shape&quot;: [256, 16, 257, 64], &quot;valid&quot;: true}]], &quot;is_dynamic_shape&quot;: false, &quot;kernel_name&quot;: &quot;Transpose_4779120815397556904_6&quot;, &quot;module_name&quot;: &quot;impl.transpose_d&quot;, &quot;name&quot;: &quot;transpose_d&quot;, &quot;op_tune_list&quot;: &quot;ALL&quot;, &quot;op_tune_switch&quot;: &quot;on&quot;, &quot;outputs&quot;: [[{&quot;addr_type&quot;: 0, &quot;dtype&quot;: &quot;float16&quot;, &quot;format&quot;: &quot;NCHW&quot;, &quot;name&quot;: &quot;y&quot;, &quot;ori_format&quot;: &quot;NCHW&quot;, &quot;ori_shape&quot;: [256, 257, 16, 64], &quot;param_type&quot;: &quot;required&quot;, &quot;range&quot;: [[256, 256], [257, 257], [16, 16], [64, 64]], &quot;shape&quot;: [256, 257, 16, 64], &quot;valid&quot;: true}]], &quot;pass_list&quot;: &quot;ALL&quot;, &quot;py_module_path&quot;: &quot;/usr/local/Ascend/opp/op_impl/built-in/ai_core/tbe&quot;, &quot;rl_tune_list&quot;: &quot;ALL&quot;, &quot;rl_tune_switch&quot;: &quot;on&quot;, &quot;socVersion&quot;: &quot;Ascend910&quot;}, &quot;platform&quot;: &quot;TBE&quot;, &quot;reset_op_info&quot;: [{&quot;type&quot;: &quot;clear_vector&quot;, &quot;bin_path&quot;: &quot;./kernel_meta/vector_random_buff.o&quot;, &quot;kernel_name&quot;: &quot;vector_random_buff&quot;}, {&quot;type&quot;: &quot;clear_cube&quot;, &quot;bin_path&quot;: &quot;./kernel_meta/cube_random_buff.o&quot;, &quot;kernel_name&quot;: &quot;cube_random_buff&quot;}]} trace:
In file /cache/user-job-dir/mindspore_clip_20210923/msvision/backbone/clip.py(380)/        out = self.transpose(out, (0, 2, 1, 3))/
In file /usr/local/python3.7/lib/python3.7/site-packages/mindspore/nn/layer/container.py(236)/        for cell in self.cell_list:/
In file /cache/user-job-dir/mindspore_clip_20210923/msvision/backbone/vit.py(105)/        return self.cell(x, **kwargs) + x/
In file /usr/local/python3.7/lib/python3.7/site-packages/mindspore/nn/layer/container.py(236)/        for cell in self.cell_list:/
In file /usr/local/python3.7/lib/python3.7/site-packages/mindspore/nn/layer/container.py(236)/        for cell in self.cell_list:/
In file /cache/user-job-dir/mindspore_clip_20210923/msvision/backbone/vit.py(427)/        return self.layers(x)/
In file /cache/user-job-dir/mindspore_clip_20210923/msvision/backbone/vit.py(232)/        x = self.body(x)/
In file /cache/user-job-dir/mindspore_clip_20210923/msvision/backbone/clip.py(562)/        return self.visual(image)/
In file /cache/user-job-dir/mindspore_clip_20210923/msvision/backbone/clip.py(635)/        image_features = self.encode_image(image)/
</pre></div>
</div>
<p>从上述错误码的报错信息中可以看到，这个transpose算子的规格不支持，其做内存拷贝指令时数据超过了限制。针对此类问题，用户可以到<a class="reference external" href="https://gitee.com/mindspore">MindSpore社区</a>提交issue获取帮助。</p>
</section>
</section>
<section id="aicore算子执行问题">
<h2>AICORE算子执行问题<a class="headerlink" href="#aicore算子执行问题" title="Permalink to this headline"></a></h2>
<section id="ez9999-aicore算子执行失败">
<h3>EZ9999: AICORE算子执行失败<a class="headerlink" href="#ez9999-aicore算子执行失败" title="Permalink to this headline"></a></h3>
<p>一般AICORE算子执行失败会报<code class="docutils literal notranslate"><span class="pre">EZ9999</span></code>错误，同时MindSpore侧会有<code class="docutils literal notranslate"><span class="pre">Call</span> <span class="pre">rt</span> <span class="pre">api</span> <span class="pre">rtStreamSynchronize</span> <span class="pre">failed</span></code>的报错日志，根据错误码日志可能明确执行失败的算子，如下述报错场景是Add算子执行失败：</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">EXCEPTION</span><span class="p">]</span><span class="w"> </span><span class="n">GE</span><span class="p">(</span><span class="mi">118114</span><span class="p">,</span><span class="n">ffff4effd1e0</span><span class="p">,</span><span class="n">python</span><span class="p">)</span><span class="o">:</span><span class="mi">2021-09-11-16</span><span class="o">:</span><span class="mi">48</span><span class="o">:</span><span class="mf">31.511.063</span><span class="w"> </span><span class="p">[</span><span class="n">mindspore</span><span class="o">/</span><span class="n">ccsrc</span><span class="o">/</span><span class="n">runtime</span><span class="o">/</span><span class="n">device</span><span class="o">/</span><span class="n">ascend</span><span class="o">/</span><span class="n">ge_runtime</span><span class="o">/</span><span class="n">runtime_model</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">233</span><span class="p">]</span><span class="w"> </span><span class="n">Run</span><span class="p">]</span><span class="w"> </span><span class="n">Call</span><span class="w"> </span><span class="n">rt</span><span class="w"> </span><span class="n">api</span><span class="w"> </span><span class="n">rtStreamSynchronize</span><span class="w"> </span><span class="n">failed</span><span class="p">,</span><span class="w"> </span><span class="n">ret</span><span class="o">:</span><span class="w"> </span><span class="mi">507011</span>
<span class="p">[</span><span class="n">WARNING</span><span class="p">]</span><span class="w"> </span><span class="n">DEVICE</span><span class="p">(</span><span class="mi">118114</span><span class="p">,</span><span class="n">ffff4effd1e0</span><span class="p">,</span><span class="n">python</span><span class="p">)</span><span class="o">:</span><span class="mi">2021-09-11-16</span><span class="o">:</span><span class="mi">48</span><span class="o">:</span><span class="mf">31.511.239</span><span class="w"> </span><span class="p">[</span><span class="n">mindspore</span><span class="o">/</span><span class="n">ccsrc</span><span class="o">/</span><span class="n">runtime</span><span class="o">/</span><span class="n">device</span><span class="o">/</span><span class="n">ascend</span><span class="o">/</span><span class="n">ascend_kernel_runtime</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">662</span><span class="p">]</span><span class="w"> </span><span class="n">GetDumpPath</span><span class="p">]</span><span class="w"> </span><span class="n">MS_OM_PATH</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">null</span><span class="p">,</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">dump</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="n">local</span><span class="w"> </span><span class="n">path</span><span class="p">,</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">rank_id</span><span class="o">/</span><span class="n">node_dump</span><span class="o">/</span><span class="p">...</span>
<span class="p">[</span><span class="n">ERROR</span><span class="p">]</span><span class="w"> </span><span class="n">DEVICE</span><span class="p">(</span><span class="mi">118114</span><span class="p">,</span><span class="n">ffff4effd1e0</span><span class="p">,</span><span class="n">python</span><span class="p">)</span><span class="o">:</span><span class="mi">2021-09-11-16</span><span class="o">:</span><span class="mi">48</span><span class="o">:</span><span class="mf">31.511.290</span><span class="w"> </span><span class="p">[</span><span class="n">mindspore</span><span class="o">/</span><span class="n">ccsrc</span><span class="o">/</span><span class="n">runtime</span><span class="o">/</span><span class="n">device</span><span class="o">/</span><span class="n">ascend</span><span class="o">/</span><span class="n">ascend_kernel_runtime</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">679</span><span class="p">]</span><span class="w"> </span><span class="n">DumpTaskExceptionInfo</span><span class="p">]</span><span class="w"> </span><span class="n">Task</span><span class="w"> </span><span class="n">fail</span><span class="w"> </span><span class="n">infos</span><span class="w"> </span><span class="n">task_id</span><span class="o">:</span><span class="w"> </span><span class="mi">13</span><span class="p">,</span><span class="w"> </span><span class="n">stream_id</span><span class="o">:</span><span class="w"> </span><span class="mi">14</span><span class="p">,</span><span class="w"> </span><span class="n">tid</span><span class="o">:</span><span class="w"> </span><span class="mi">118198</span><span class="p">,</span><span class="w"> </span><span class="n">device_id</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">retcode</span><span class="o">:</span><span class="w"> </span><span class="mi">507011</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">model</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="n">failed</span><span class="p">)</span>
<span class="p">[</span><span class="n">ERROR</span><span class="p">]</span><span class="w"> </span><span class="n">DEVICE</span><span class="p">(</span><span class="mi">118114</span><span class="p">,</span><span class="n">ffff4effd1e0</span><span class="p">,</span><span class="n">python</span><span class="p">)</span><span class="o">:</span><span class="mi">2021-09-11-16</span><span class="o">:</span><span class="mi">48</span><span class="o">:</span><span class="mf">31.511.460</span><span class="w"> </span><span class="p">[</span><span class="n">mindspore</span><span class="o">/</span><span class="n">ccsrc</span><span class="o">/</span><span class="n">runtime</span><span class="o">/</span><span class="n">device</span><span class="o">/</span><span class="n">ascend</span><span class="o">/</span><span class="n">ascend_kernel_runtime</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">688</span><span class="p">]</span><span class="w"> </span><span class="n">DumpTaskExceptionInfo</span><span class="p">]</span><span class="w"> </span><span class="n">Dump</span><span class="w"> </span><span class="n">node</span><span class="w"> </span><span class="p">(</span><span class="n">Default</span><span class="o">/</span><span class="n">Add</span><span class="o">-</span><span class="n">op8</span><span class="p">)</span><span class="w"> </span><span class="n">task</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">input</span><span class="o">/</span><span class="n">output</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">to</span><span class="o">:</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">rank_0</span><span class="o">/</span><span class="n">node_dump</span><span class="w"> </span><span class="n">trace</span><span class="o">:</span>
<span class="n">In</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">miniconda3</span><span class="o">/</span><span class="n">envs</span><span class="o">/</span><span class="n">ci</span><span class="o">/</span><span class="n">lib</span><span class="o">/</span><span class="n">python3</span><span class="mf">.7</span><span class="o">/</span><span class="n">site</span><span class="o">-</span><span class="n">packages</span><span class="o">/</span><span class="n">mindspore</span><span class="o">/</span><span class="n">ops</span><span class="o">/</span><span class="n">composite</span><span class="o">/</span><span class="n">multitype_ops</span><span class="o">/</span><span class="n">add_impl</span><span class="p">.</span><span class="n">py</span><span class="p">(</span><span class="mi">212</span><span class="p">)</span><span class="o">/</span><span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">F</span><span class="p">.</span><span class="n">add</span><span class="p">(</span><span class="n">x</span><span class="p">,</span><span class="w"> </span><span class="n">y</span><span class="p">)</span><span class="o">/</span>
<span class="n">In</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="k">try</span><span class="p">.</span><span class="n">py</span><span class="p">(</span><span class="mi">19</span><span class="p">)</span><span class="o">/</span><span class="w">        </span><span class="n">z</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">x</span><span class="w"> </span><span class="o">+</span><span class="w"> </span><span class="n">z</span><span class="w"> </span><span class="o">/</span>
<span class="p">[</span><span class="n">EXCEPTION</span><span class="p">]</span><span class="w"> </span><span class="n">SESSION</span><span class="p">(</span><span class="mi">118114</span><span class="p">,</span><span class="n">ffff4effd1e0</span><span class="p">,</span><span class="n">python</span><span class="p">)</span><span class="o">:</span><span class="mi">2021-09-11-16</span><span class="o">:</span><span class="mi">48</span><span class="o">:</span><span class="mf">31.524.043</span><span class="w"> </span><span class="p">[</span><span class="n">mindspore</span><span class="o">/</span><span class="n">ccsrc</span><span class="o">/</span><span class="n">backend</span><span class="o">/</span><span class="n">session</span><span class="o">/</span><span class="n">ascend_session</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">1456</span><span class="p">]</span><span class="w"> </span><span class="n">Execute</span><span class="p">]</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">task</span><span class="w"> </span><span class="n">error</span><span class="o">!</span>
<span class="p">[</span><span class="n">ERROR</span><span class="p">]</span><span class="w"> </span><span class="n">SESSION</span><span class="p">(</span><span class="mi">118114</span><span class="p">,</span><span class="n">ffff4effd1e0</span><span class="p">,</span><span class="n">python</span><span class="p">)</span><span class="o">:</span><span class="mi">2021-09-11-16</span><span class="o">:</span><span class="mi">48</span><span class="o">:</span><span class="mf">31.524.162</span><span class="w"> </span><span class="p">[</span><span class="n">mindspore</span><span class="o">/</span><span class="n">ccsrc</span><span class="o">/</span><span class="n">backend</span><span class="o">/</span><span class="n">session</span><span class="o">/</span><span class="n">ascend_session</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">1857</span><span class="p">]</span><span class="w"> </span><span class="n">ReportErrorMessage</span><span class="p">]</span><span class="w"> </span><span class="n">Ascend</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">occurred</span><span class="p">,</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">message</span><span class="o">:</span>
<span class="nl">EZ9999</span><span class="p">:</span><span class="w"> </span><span class="n">Inner</span><span class="w"> </span><span class="n">Error</span><span class="o">!</span>
<span class="w">        </span><span class="n">The</span><span class="w"> </span><span class="n">device</span><span class="p">(</span><span class="mi">3</span><span class="p">),</span><span class="w"> </span><span class="n">core</span><span class="w"> </span><span class="n">list</span><span class="p">[</span><span class="mi">0-0</span><span class="p">],</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">code</span><span class="w"> </span><span class="n">is</span><span class="o">:</span><span class="p">[</span><span class="n">FUNC</span><span class="o">:</span><span class="n">ProcessCoreErrorInfo</span><span class="p">][</span><span class="kt">FILE</span><span class="o">:</span><span class="n">device_error_proc</span><span class="p">.</span><span class="n">cc</span><span class="p">][</span><span class="n">LINE</span><span class="o">:</span><span class="mi">461</span><span class="p">]</span>
<span class="w">        </span><span class="n">coreId</span><span class="p">(</span><span class="w"> </span><span class="mi">0</span><span class="p">)</span><span class="o">:</span><span class="w">        </span><span class="mh">0x800000</span><span class="w">    </span><span class="p">[</span><span class="n">FUNC</span><span class="o">:</span><span class="n">ProcessCoreErrorInfo</span><span class="p">][</span><span class="kt">FILE</span><span class="o">:</span><span class="n">device_error_proc</span><span class="p">.</span><span class="n">cc</span><span class="p">][</span><span class="n">LINE</span><span class="o">:</span><span class="mi">472</span><span class="p">]</span>
<span class="w">        </span><span class="n">Aicore</span><span class="w"> </span><span class="n">kernel</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="n">failed</span><span class="p">,</span><span class="w"> </span><span class="n">device_id</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">stream_id</span><span class="o">=</span><span class="mi">14</span><span class="p">,</span><span class="w"> </span><span class="n">report_stream_id</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span><span class="w"> </span><span class="n">task_id</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span><span class="w"> </span><span class="n">fault</span><span class="w"> </span><span class="n">kernel_name</span><span class="o">=</span><span class="n">add_13570952190744021808_0__kernel0</span><span class="p">,</span><span class="w"> </span><span class="n">func_name</span><span class="o">=</span><span class="n">add_13570952190744021808_0__kernel0</span><span class="p">,</span><span class="w"> </span><span class="n">program</span><span class="w"> </span><span class="n">id</span><span class="o">=</span><span class="mi">8</span><span class="p">,</span><span class="w"> </span><span class="n">hash</span><span class="o">=</span><span class="mi">14046644073217913723</span><span class="p">[</span><span class="n">FUNC</span><span class="o">:</span><span class="n">GetError</span><span class="p">][</span><span class="kt">FILE</span><span class="o">:</span><span class="n">stream</span><span class="p">.</span><span class="n">cc</span><span class="p">][</span><span class="n">LINE</span><span class="o">:</span><span class="mi">701</span><span class="p">]</span>
<span class="w">        </span><span class="n">Stream</span><span class="w"> </span><span class="n">synchronize</span><span class="w"> </span><span class="n">failed</span><span class="p">,</span><span class="w"> </span><span class="n">stream</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0xffff441cc970</span><span class="p">[</span><span class="n">FUNC</span><span class="o">:</span><span class="n">ReportError</span><span class="p">][</span><span class="kt">FILE</span><span class="o">:</span><span class="n">logger</span><span class="p">.</span><span class="n">cc</span><span class="p">][</span><span class="n">LINE</span><span class="o">:</span><span class="mi">566</span><span class="p">]</span>
<span class="w">        </span><span class="n">rtStreamSynchronize</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="n">failed</span><span class="p">,</span><span class="w"> </span><span class="n">reason</span><span class="o">=</span><span class="p">[</span><span class="n">the</span><span class="w"> </span><span class="n">model</span><span class="w"> </span><span class="n">stream</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="n">failed</span><span class="p">][</span><span class="n">FUNC</span><span class="o">:</span><span class="n">ReportError</span><span class="p">][</span><span class="kt">FILE</span><span class="o">:</span><span class="n">error_message_manage</span><span class="p">.</span><span class="n">cc</span><span class="p">][</span><span class="n">LINE</span><span class="o">:</span><span class="mi">566</span><span class="p">]</span>

<span class="n">Traceback</span><span class="w"> </span><span class="p">(</span><span class="n">most</span><span class="w"> </span><span class="n">recent</span><span class="w"> </span><span class="n">call</span><span class="w"> </span><span class="n">last</span><span class="p">)</span><span class="o">:</span>
<span class="w">  </span><span class="n">File</span><span class="w"> </span><span class="s">&quot;try.py&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="mi">34</span><span class="p">,</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="o">&lt;</span><span class="k">module</span><span class="o">&gt;</span>
<span class="w">    </span><span class="n">output_1</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">net</span><span class="p">(</span><span class="n">Tensor</span><span class="p">(</span><span class="n">x1</span><span class="p">),</span><span class="w"> </span><span class="n">Tensor</span><span class="p">(</span><span class="n">x1</span><span class="p">))</span>
<span class="w">  </span><span class="n">File</span><span class="w"> </span><span class="s">&quot;/home/miniconda3/envs/ci/lib/python3.7/site-packages/mindspore/nn/cell.py&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="mi">391</span><span class="p">,</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">__call__</span>
<span class="w">    </span><span class="n">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">compile_and_run</span><span class="p">(</span><span class="o">*</span><span class="n">inputs</span><span class="p">)</span>
<span class="w">  </span><span class="n">File</span><span class="w"> </span><span class="s">&quot;/home/miniconda3/envs/ci/lib/python3.7/site-packages/mindspore/nn/cell.py&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="mi">671</span><span class="p">,</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">compile_and_run</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">_cell_graph_executor</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">new_inputs</span><span class="p">,</span><span class="w"> </span><span class="n">phase</span><span class="o">=</span><span class="n">self</span><span class="p">.</span><span class="n">phase</span><span class="p">)</span>
<span class="w">  </span><span class="n">File</span><span class="w"> </span><span class="s">&quot;/home/miniconda3/envs/ci/lib/python3.7/site-packages/mindspore/common/api.py&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="mi">599</span><span class="p">,</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">__call__</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="n">phase</span><span class="o">=</span><span class="n">phase</span><span class="p">)</span>
<span class="w">  </span><span class="n">File</span><span class="w"> </span><span class="s">&quot;/home/miniconda3/envs/ci/lib/python3.7/site-packages/mindspore/common/api.py&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="mi">627</span><span class="p">,</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">run</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_exec_pip</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="n">phase</span><span class="o">=</span><span class="n">phase_real</span><span class="p">)</span>
<span class="w">  </span><span class="n">File</span><span class="w"> </span><span class="s">&quot;/home/miniconda3/envs/ci/lib/python3.7/site-packages/mindspore/common/api.py&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="mi">77</span><span class="p">,</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">wrapper</span>
<span class="w">    </span><span class="n">results</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fn</span><span class="p">(</span><span class="o">*</span><span class="n">arg</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="w">  </span><span class="n">File</span><span class="w"> </span><span class="s">&quot;/home/miniconda3/envs/ci/lib/python3.7/site-packages/mindspore/common/api.py&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="mi">610</span><span class="p">,</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">_exec_pip</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_graph_executor</span><span class="p">(</span><span class="n">args_list</span><span class="p">,</span><span class="w"> </span><span class="n">phase</span><span class="p">)</span>
<span class="nl">RuntimeError</span><span class="p">:</span><span class="w"> </span><span class="n">mindspore</span><span class="o">/</span><span class="n">ccsrc</span><span class="o">/</span><span class="n">backend</span><span class="o">/</span><span class="n">session</span><span class="o">/</span><span class="n">ascend_session</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">1456</span><span class="w"> </span><span class="n">Execute</span><span class="p">]</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">task</span><span class="w"> </span><span class="n">error</span><span class="o">!</span>
</pre></div>
</div>
<p>AICORE算子执行失败，可能是数据输入不匹配、访问越界、计算溢出等问题，也有可能是算子本身代码问题。针对此类问题用户可以通过日志和dump数据先自行排查，构造单算子用例进行定位，若无法定位出问题可以到<a class="reference external" href="https://gitee.com/mindspore">MindSpore社区</a>提交issue获取帮助。</p>
</section>
</section>
<section id="aicpu算子执行问题">
<h2>AICPU算子执行问题<a class="headerlink" href="#aicpu算子执行问题" title="Permalink to this headline"></a></h2>
<p>AICPU算子问题错误以<code class="docutils literal notranslate"><span class="pre">E3</span></code>开头。</p>
<section id="e39999-aicpu算子执行失败">
<h3>E39999: AICPU算子执行失败<a class="headerlink" href="#e39999-aicpu算子执行失败" title="Permalink to this headline"></a></h3>
<p>一般AICPU算子执行失败会报<code class="docutils literal notranslate"><span class="pre">E39999</span></code>错误，同时MindSpore侧会有<code class="docutils literal notranslate"><span class="pre">Call</span> <span class="pre">rt</span> <span class="pre">api</span> <span class="pre">rtStreamSynchronize</span> <span class="pre">failed</span></code>的报错日志，根据错误码日志可能明确执行失败的算子，如下述报错场景：</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">ERROR</span><span class="p">]</span><span class="w"> </span><span class="n">RUNTIME</span><span class="p">(</span><span class="mi">150840</span><span class="p">,</span><span class="n">python</span><span class="p">)</span><span class="o">:</span><span class="mi">2021-09-14-09</span><span class="o">:</span><span class="mi">26</span><span class="o">:</span><span class="mf">01.014.355</span><span class="w"> </span><span class="p">[</span><span class="n">engine</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">914</span><span class="p">]</span><span class="mi">150900</span><span class="w"> </span><span class="n">ReportExceptProc</span><span class="o">:</span><span class="n">Task</span><span class="w"> </span><span class="n">exception</span><span class="o">!</span><span class="w"> </span><span class="n">device_id</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">stream_id</span><span class="o">=</span><span class="mi">117</span><span class="p">,</span><span class="w"> </span><span class="n">task_id</span><span class="o">=</span><span class="mi">23</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span><span class="w"> </span><span class="n">retCode</span><span class="o">=</span><span class="mh">0x91</span><span class="p">.</span>
<span class="p">[</span><span class="n">ERROR</span><span class="p">]</span><span class="w"> </span><span class="n">RUNTIME</span><span class="p">(</span><span class="mi">150840</span><span class="p">,</span><span class="n">python</span><span class="p">)</span><span class="o">:</span><span class="mi">2021-09-14-09</span><span class="o">:</span><span class="mi">26</span><span class="o">:</span><span class="mf">01.014.485</span><span class="w"> </span><span class="p">[</span><span class="n">task</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">600</span><span class="p">]</span><span class="mi">150900</span><span class="w"> </span><span class="n">PrintAicpuErrorInfo</span><span class="o">:</span><span class="n">Aicpu</span><span class="w"> </span><span class="n">kernel</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="n">failed</span><span class="p">,</span><span class="w"> </span><span class="n">device_id</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">stream_id</span><span class="o">=</span><span class="mi">116</span><span class="p">,</span><span class="w"> </span><span class="n">task_id</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">fault</span><span class="w"> </span><span class="n">so_name</span><span class="o">=</span><span class="n">libaicpu_kernels</span><span class="p">.</span><span class="n">so</span><span class="p">,</span><span class="w"> </span><span class="n">fault</span><span class="w"> </span><span class="n">kernel_name</span><span class="o">=</span><span class="n">GetNext</span><span class="p">,</span><span class="w"> </span><span class="n">fault</span><span class="w"> </span><span class="n">op_name</span><span class="o">=</span><span class="p">,</span><span class="w"> </span><span class="n">extend_info</span><span class="o">=</span><span class="p">.</span>
<span class="p">[</span><span class="n">ERROR</span><span class="p">]</span><span class="w"> </span><span class="n">RUNTIME</span><span class="p">(</span><span class="mi">150840</span><span class="p">,</span><span class="n">python</span><span class="p">)</span><span class="o">:</span><span class="mi">2021-09-14-09</span><span class="o">:</span><span class="mi">26</span><span class="o">:</span><span class="mf">01.014.498</span><span class="w"> </span><span class="p">[</span><span class="n">task</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">2292</span><span class="p">]</span><span class="mi">150900</span><span class="w"> </span><span class="n">ReportErrorInfo</span><span class="o">:</span><span class="n">model</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="n">retCode</span><span class="o">=</span><span class="mh">0x91</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="n">the</span><span class="w"> </span><span class="n">model</span><span class="w"> </span><span class="n">stream</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="n">failed</span><span class="p">].</span>
<span class="p">[</span><span class="n">ERROR</span><span class="p">]</span><span class="w"> </span><span class="n">RUNTIME</span><span class="p">(</span><span class="mi">150840</span><span class="p">,</span><span class="n">python</span><span class="p">)</span><span class="o">:</span><span class="mi">2021-09-14-09</span><span class="o">:</span><span class="mi">26</span><span class="o">:</span><span class="mf">01.014.506</span><span class="w"> </span><span class="p">[</span><span class="n">task</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">2269</span><span class="p">]</span><span class="mi">150900</span><span class="w"> </span><span class="n">PrintErrorInfo</span><span class="o">:</span><span class="n">model</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="n">task</span><span class="w"> </span><span class="n">failed</span><span class="p">,</span><span class="w"> </span><span class="n">device_id</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">model</span><span class="w"> </span><span class="n">stream_id</span><span class="o">=</span><span class="mi">117</span><span class="p">,</span><span class="w"> </span><span class="n">model</span><span class="w"> </span><span class="n">task_id</span><span class="o">=</span><span class="mi">23</span><span class="p">,</span><span class="w"> </span><span class="n">model_id</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span><span class="w"> </span><span class="n">first_task_id</span><span class="o">=</span><span class="mi">65535</span>
<span class="p">[</span><span class="n">ERROR</span><span class="p">]</span><span class="w"> </span><span class="n">RUNTIME</span><span class="p">(</span><span class="mi">150840</span><span class="p">,</span><span class="n">python</span><span class="p">)</span><span class="o">:</span><span class="mi">2021-09-14-09</span><span class="o">:</span><span class="mi">26</span><span class="o">:</span><span class="mf">01.014.548</span><span class="w"> </span><span class="p">[</span><span class="n">stream</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">693</span><span class="p">]</span><span class="mi">150900</span><span class="w"> </span><span class="n">GetError</span><span class="o">:</span><span class="n">Stream</span><span class="w"> </span><span class="n">Synchronize</span><span class="w"> </span><span class="n">failed</span><span class="p">,</span><span class="w"> </span><span class="n">stream_id</span><span class="o">=</span><span class="mi">117</span><span class="w"> </span><span class="n">retCode</span><span class="o">=</span><span class="mh">0x91</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="n">the</span><span class="w"> </span><span class="n">model</span><span class="w"> </span><span class="n">stream</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="n">failed</span><span class="p">].</span>
<span class="p">[</span><span class="n">ERROR</span><span class="p">]</span><span class="w"> </span><span class="n">RUNTIME</span><span class="p">(</span><span class="mi">150840</span><span class="p">,</span><span class="n">python</span><span class="p">)</span><span class="o">:</span><span class="mi">2021-09-14-09</span><span class="o">:</span><span class="mi">26</span><span class="o">:</span><span class="mf">01.014.594</span><span class="w"> </span><span class="p">[</span><span class="n">logger</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">285</span><span class="p">]</span><span class="mi">150900</span><span class="w"> </span><span class="n">StreamSynchronize</span><span class="o">:</span><span class="n">Stream</span><span class="w"> </span><span class="n">synchronize</span><span class="w"> </span><span class="n">failed</span><span class="p">,</span><span class="w"> </span><span class="n">stream</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0xffff1c182e70</span>
<span class="p">[</span><span class="n">ERROR</span><span class="p">]</span><span class="w"> </span><span class="n">RUNTIME</span><span class="p">(</span><span class="mi">150840</span><span class="p">,</span><span class="n">python</span><span class="p">)</span><span class="o">:</span><span class="mi">2021-09-14-09</span><span class="o">:</span><span class="mi">26</span><span class="o">:</span><span class="mf">01.014.622</span><span class="w"> </span><span class="p">[</span><span class="n">api_c</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">581</span><span class="p">]</span><span class="mi">150900</span><span class="w"> </span><span class="n">rtStreamSynchronize</span><span class="o">:</span><span class="n">ErrCode</span><span class="o">=</span><span class="mi">507011</span><span class="p">,</span><span class="w"> </span><span class="n">desc</span><span class="o">=</span><span class="p">[</span><span class="n">the</span><span class="w"> </span><span class="n">model</span><span class="w"> </span><span class="n">stream</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="n">failed</span><span class="p">],</span><span class="w"> </span><span class="n">InnerCode</span><span class="o">=</span><span class="mh">0x7150050</span>
<span class="p">[</span><span class="n">ERROR</span><span class="p">]</span><span class="w"> </span><span class="n">RUNTIME</span><span class="p">(</span><span class="mi">150840</span><span class="p">,</span><span class="n">python</span><span class="p">)</span><span class="o">:</span><span class="mi">2021-09-14-09</span><span class="o">:</span><span class="mi">26</span><span class="o">:</span><span class="mf">01.014.633</span><span class="w"> </span><span class="p">[</span><span class="n">error_message_manage</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">41</span><span class="p">]</span><span class="mi">150900</span><span class="w"> </span><span class="n">ReportFuncErrorReason</span><span class="o">:</span><span class="n">rtStreamSynchronize</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="n">failed</span><span class="p">,</span><span class="w"> </span><span class="n">reason</span><span class="o">=</span><span class="p">[</span><span class="n">the</span><span class="w"> </span><span class="n">model</span><span class="w"> </span><span class="n">stream</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="n">failed</span><span class="p">]</span>
<span class="p">[</span><span class="n">EXCEPTION</span><span class="p">]</span><span class="w"> </span><span class="n">GE</span><span class="p">(</span><span class="mi">150840</span><span class="p">,</span><span class="n">ffff2effd1e0</span><span class="p">,</span><span class="n">python</span><span class="p">)</span><span class="o">:</span><span class="mi">2021-09-14-09</span><span class="o">:</span><span class="mi">26</span><span class="o">:</span><span class="mf">01.014.680</span><span class="w"> </span><span class="p">[</span><span class="n">mindspore</span><span class="o">/</span><span class="n">ccsrc</span><span class="o">/</span><span class="n">runtime</span><span class="o">/</span><span class="n">device</span><span class="o">/</span><span class="n">ascend</span><span class="o">/</span><span class="n">ge_runtime</span><span class="o">/</span><span class="n">runtime_model</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">233</span><span class="p">]</span><span class="w"> </span><span class="n">Run</span><span class="p">]</span><span class="w"> </span><span class="n">Call</span><span class="w"> </span><span class="n">rt</span><span class="w"> </span><span class="n">api</span><span class="w"> </span><span class="n">rtStreamSynchronize</span><span class="w"> </span><span class="n">failed</span><span class="p">,</span><span class="w"> </span><span class="n">ret</span><span class="o">:</span><span class="w"> </span><span class="mi">507011</span>
<span class="p">[</span><span class="n">WARNING</span><span class="p">]</span><span class="w"> </span><span class="n">DEVICE</span><span class="p">(</span><span class="mi">150840</span><span class="p">,</span><span class="n">ffff2effd1e0</span><span class="p">,</span><span class="n">python</span><span class="p">)</span><span class="o">:</span><span class="mi">2021-09-14-09</span><span class="o">:</span><span class="mi">26</span><span class="o">:</span><span class="mf">01.015.138</span><span class="w"> </span><span class="p">[</span><span class="n">mindspore</span><span class="o">/</span><span class="n">ccsrc</span><span class="o">/</span><span class="n">runtime</span><span class="o">/</span><span class="n">device</span><span class="o">/</span><span class="n">ascend</span><span class="o">/</span><span class="n">ascend_kernel_runtime</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">668</span><span class="p">]</span><span class="w"> </span><span class="n">GetDumpPath</span><span class="p">]</span><span class="w"> </span><span class="n">MS_OM_PATH</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">null</span><span class="p">,</span><span class="w"> </span><span class="n">so</span><span class="w"> </span><span class="n">dump</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="n">local</span><span class="w"> </span><span class="n">path</span><span class="p">,</span><span class="w"> </span><span class="n">as</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">rank_id</span><span class="o">/</span><span class="n">node_dump</span><span class="o">/</span><span class="p">...</span>
<span class="p">[</span><span class="n">ERROR</span><span class="p">]</span><span class="w"> </span><span class="n">DEVICE</span><span class="p">(</span><span class="mi">150840</span><span class="p">,</span><span class="n">ffff2effd1e0</span><span class="p">,</span><span class="n">python</span><span class="p">)</span><span class="o">:</span><span class="mi">2021-09-14-09</span><span class="o">:</span><span class="mi">26</span><span class="o">:</span><span class="mf">01.015.177</span><span class="w"> </span><span class="p">[</span><span class="n">mindspore</span><span class="o">/</span><span class="n">ccsrc</span><span class="o">/</span><span class="n">runtime</span><span class="o">/</span><span class="n">device</span><span class="o">/</span><span class="n">ascend</span><span class="o">/</span><span class="n">ascend_kernel_runtime</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">685</span><span class="p">]</span><span class="w"> </span><span class="n">DumpTaskExceptionInfo</span><span class="p">]</span><span class="w"> </span><span class="n">Task</span><span class="w"> </span><span class="n">fail</span><span class="w"> </span><span class="n">infos</span><span class="w"> </span><span class="n">task_id</span><span class="o">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">stream_id</span><span class="o">:</span><span class="w"> </span><span class="mi">116</span><span class="p">,</span><span class="w"> </span><span class="n">tid</span><span class="o">:</span><span class="w"> </span><span class="mi">150900</span><span class="p">,</span><span class="w"> </span><span class="n">device_id</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">retcode</span><span class="o">:</span><span class="w"> </span><span class="mi">507011</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">model</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="n">failed</span><span class="p">)</span>
<span class="p">[</span><span class="n">ERROR</span><span class="p">]</span><span class="w"> </span><span class="n">DEVICE</span><span class="p">(</span><span class="mi">150840</span><span class="p">,</span><span class="n">ffff2effd1e0</span><span class="p">,</span><span class="n">python</span><span class="p">)</span><span class="o">:</span><span class="mi">2021-09-14-09</span><span class="o">:</span><span class="mi">26</span><span class="o">:</span><span class="mf">01.015.357</span><span class="w"> </span><span class="p">[</span><span class="n">mindspore</span><span class="o">/</span><span class="n">ccsrc</span><span class="o">/</span><span class="n">runtime</span><span class="o">/</span><span class="n">device</span><span class="o">/</span><span class="n">ascend</span><span class="o">/</span><span class="n">ascend_kernel_runtime</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">694</span><span class="p">]</span><span class="w"> </span><span class="n">DumpTaskExceptionInfo</span><span class="p">]</span><span class="w"> </span><span class="n">Dump</span><span class="w"> </span><span class="n">node</span><span class="w"> </span><span class="p">(</span><span class="n">Default</span><span class="o">/</span><span class="n">GetNext</span><span class="o">-</span><span class="n">op1</span><span class="p">)</span><span class="w"> </span><span class="n">task</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">input</span><span class="o">/</span><span class="n">output</span><span class="w"> </span><span class="n">data</span><span class="w"> </span><span class="n">to</span><span class="o">:</span><span class="w"> </span><span class="p">.</span><span class="o">/</span><span class="n">rank_0</span><span class="o">/</span><span class="n">node_dump</span><span class="w"> </span><span class="n">trace</span><span class="o">:</span>
<span class="n">In</span><span class="w"> </span><span class="n">file</span><span class="w"> </span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">jenkins</span><span class="o">/</span><span class="n">solution_test</span><span class="o">/</span><span class="n">remaining</span><span class="o">/</span><span class="n">common</span><span class="o">/</span><span class="n">features</span><span class="o">/</span><span class="n">dataset_base</span><span class="p">.</span><span class="n">py</span><span class="p">(</span><span class="mi">1023</span><span class="p">)</span><span class="o">/</span><span class="w">        </span><span class="n">getnext_input</span><span class="p">,</span><span class="w"> </span><span class="n">_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">get_next</span><span class="p">()</span><span class="o">/</span>

<span class="p">[</span><span class="n">EXCEPTION</span><span class="p">]</span><span class="w"> </span><span class="n">SESSION</span><span class="p">(</span><span class="mi">150840</span><span class="p">,</span><span class="n">ffff2effd1e0</span><span class="p">,</span><span class="n">python</span><span class="p">)</span><span class="o">:</span><span class="mi">2021-09-14-09</span><span class="o">:</span><span class="mi">26</span><span class="o">:</span><span class="mf">01.060.662</span><span class="w"> </span><span class="p">[</span><span class="n">mindspore</span><span class="o">/</span><span class="n">ccsrc</span><span class="o">/</span><span class="n">backend</span><span class="o">/</span><span class="n">session</span><span class="o">/</span><span class="n">ascend_session</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">1456</span><span class="p">]</span><span class="w"> </span><span class="n">Execute</span><span class="p">]</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">task</span><span class="w"> </span><span class="n">error</span><span class="o">!</span>
<span class="p">[</span><span class="n">ERROR</span><span class="p">]</span><span class="w"> </span><span class="n">SESSION</span><span class="p">(</span><span class="mi">150840</span><span class="p">,</span><span class="n">ffff2effd1e0</span><span class="p">,</span><span class="n">python</span><span class="p">)</span><span class="o">:</span><span class="mi">2021-09-14-09</span><span class="o">:</span><span class="mi">26</span><span class="o">:</span><span class="mf">01.060.809</span><span class="w"> </span><span class="p">[</span><span class="n">mindspore</span><span class="o">/</span><span class="n">ccsrc</span><span class="o">/</span><span class="n">backend</span><span class="o">/</span><span class="n">session</span><span class="o">/</span><span class="n">ascend_session</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">1857</span><span class="p">]</span><span class="w"> </span><span class="n">ReportErrorMessage</span><span class="p">]</span><span class="w"> </span><span class="n">Ascend</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">occurred</span><span class="p">,</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">message</span><span class="o">:</span>
<span class="nl">E39999</span><span class="p">:</span><span class="w"> </span><span class="n">Inner</span><span class="w"> </span><span class="n">Error</span><span class="o">!</span>
<span class="w">        </span><span class="n">Aicpu</span><span class="w"> </span><span class="n">kernel</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="n">failed</span><span class="p">,</span><span class="w"> </span><span class="n">device_id</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">stream_id</span><span class="o">=</span><span class="mi">116</span><span class="p">,</span><span class="w"> </span><span class="n">task_id</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">fault</span><span class="w"> </span><span class="n">so_name</span><span class="o">=</span><span class="n">libaicpu_kernels</span><span class="p">.</span><span class="n">so</span><span class="p">,</span><span class="w"> </span><span class="n">fault</span><span class="w"> </span><span class="n">kernel_name</span><span class="o">=</span><span class="n">GetNext</span><span class="p">,</span><span class="w"> </span><span class="n">fault</span><span class="w"> </span><span class="n">op_name</span><span class="o">=</span><span class="p">,</span><span class="w"> </span><span class="n">extend_info</span><span class="o">=</span><span class="p">[</span><span class="n">FUNC</span><span class="o">:</span><span class="n">GetError</span><span class="p">][</span><span class="kt">FILE</span><span class="o">:</span><span class="n">stream</span><span class="p">.</span><span class="n">cc</span><span class="p">][</span><span class="n">LINE</span><span class="o">:</span><span class="mi">701</span><span class="p">]</span>
<span class="w">        </span><span class="n">Stream</span><span class="w"> </span><span class="n">synchronize</span><span class="w"> </span><span class="n">failed</span><span class="p">,</span><span class="w"> </span><span class="n">stream</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="mh">0xffff1c182e70</span><span class="p">[</span><span class="n">FUNC</span><span class="o">:</span><span class="n">ReportError</span><span class="p">][</span><span class="kt">FILE</span><span class="o">:</span><span class="n">logger</span><span class="p">.</span><span class="n">cc</span><span class="p">][</span><span class="n">LINE</span><span class="o">:</span><span class="mi">566</span><span class="p">]</span>
<span class="w">        </span><span class="n">rtStreamSynchronize</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="n">failed</span><span class="p">,</span><span class="w"> </span><span class="n">reason</span><span class="o">=</span><span class="p">[</span><span class="n">the</span><span class="w"> </span><span class="n">model</span><span class="w"> </span><span class="n">stream</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="n">failed</span><span class="p">][</span><span class="n">FUNC</span><span class="o">:</span><span class="n">ReportError</span><span class="p">][</span><span class="kt">FILE</span><span class="o">:</span><span class="n">error_message_manage</span><span class="p">.</span><span class="n">cc</span><span class="p">][</span><span class="n">LINE</span><span class="o">:</span><span class="mi">566</span><span class="p">]</span>

<span class="n">INFO</span><span class="w"> </span><span class="mi">2021-09-14</span><span class="w"> </span><span class="mi">09</span><span class="o">:</span><span class="mi">26</span><span class="o">:</span><span class="mo">01</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">root</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">test_ms_cifar10_tdt_consume_beyond_produce_more_RDR</span><span class="p">.</span><span class="n">py</span><span class="o">:</span><span class="n">test_run</span><span class="o">:</span><span class="mi">50</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">when</span><span class="w"> </span><span class="n">dataset</span><span class="w"> </span><span class="n">batch</span><span class="w"> </span><span class="n">num</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">less</span><span class="w"> </span><span class="n">than</span><span class="w"> </span><span class="n">train</span><span class="w"> </span><span class="n">loop</span><span class="p">,</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">msg</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">mindspore</span><span class="o">/</span><span class="n">ccsrc</span><span class="o">/</span><span class="n">backend</span><span class="o">/</span><span class="n">session</span><span class="o">/</span><span class="n">ascend_session</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">1456</span><span class="w"> </span><span class="n">Execute</span><span class="p">]</span><span class="w"> </span><span class="n">run</span><span class="w"> </span><span class="n">task</span><span class="w"> </span><span class="n">error</span><span class="o">!</span>
</pre></div>
</div>
<p>AICPU算子执行失败，可能是数据输入不匹配、访问越界、AICPU线程挂死等问题，也有可能是算子本身代码问题。针对此类问题用户可以通过日志和dump数据先自行排查，构造单算子用例进行定位，若无法定位出问题可以到<a class="reference external" href="https://gitee.com/mindspore">MindSpore社区</a>提交issue获取帮助。</p>
</section>
</section>
<section id="runtime常见问题">
<h2>runtime常见问题<a class="headerlink" href="#runtime常见问题" title="Permalink to this headline"></a></h2>
<p>Runtime模块对上承接MindSpore、ACL、GE、HCCL的调用，对下通过Driver模块对NPU上的各个模块进行调度，Runtime模块的错误码以<code class="docutils literal notranslate"><span class="pre">EE</span></code>开头。</p>
<section id="ee9999-hbm显存分配失败">
<h3>EE9999: HBM显存分配失败<a class="headerlink" href="#ee9999-hbm显存分配失败" title="Permalink to this headline"></a></h3>
<p>当框架申请的HBM显存超过Device剩余显存时，就会报<code class="docutils literal notranslate"><span class="pre">halMemAlloc</span> <span class="pre">failed</span></code>错误，如下述错误场景所示：</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">EXCEPTION</span><span class="p">]</span><span class="w"> </span><span class="n">DEVICE</span><span class="p">(</span><span class="mi">170414</span><span class="p">,</span><span class="n">fffe397fa1e0</span><span class="p">,</span><span class="n">python</span><span class="p">)</span><span class="o">:</span><span class="mi">2021-09-13-15</span><span class="o">:</span><span class="mi">29</span><span class="o">:</span><span class="mf">07.465.388</span><span class="w"> </span><span class="p">[</span><span class="n">mindspore</span><span class="o">/</span><span class="n">ccsrc</span><span class="o">/</span><span class="n">runtime</span><span class="o">/</span><span class="n">device</span><span class="o">/</span><span class="n">ascend</span><span class="o">/</span><span class="n">ascend_memory_manager</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">62</span><span class="p">]</span><span class="w"> </span><span class="n">MallocDeviceMemory</span><span class="p">]</span><span class="w"> </span><span class="n">Malloc</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">memory</span><span class="w"> </span><span class="n">failed</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="p">[</span><span class="mi">32212254720</span><span class="p">],</span><span class="w"> </span><span class="n">ret</span><span class="p">[</span><span class="mi">207001</span><span class="p">],</span><span class="w"> </span><span class="n">Device</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">processes</span><span class="w"> </span><span class="n">occupying</span><span class="w"> </span><span class="k">this</span><span class="w"> </span><span class="n">card</span><span class="p">,</span><span class="w"> </span><span class="n">check</span><span class="w"> </span><span class="n">as</span><span class="o">:</span><span class="w"> </span><span class="n">ps</span><span class="w"> </span><span class="o">-</span><span class="n">ef</span><span class="o">|</span><span class="n">grep</span><span class="w"> </span><span class="n">python</span>
<span class="p">[</span><span class="n">ERROR</span><span class="p">]</span><span class="w"> </span><span class="n">DEVICE</span><span class="p">(</span><span class="mi">170414</span><span class="p">,</span><span class="n">fffe397fa1e0</span><span class="p">,</span><span class="n">python</span><span class="p">)</span><span class="o">:</span><span class="mi">2021-09-13-15</span><span class="o">:</span><span class="mi">29</span><span class="o">:</span><span class="mf">07.466.049</span><span class="w"> </span><span class="p">[</span><span class="n">mindspore</span><span class="o">/</span><span class="n">ccsrc</span><span class="o">/</span><span class="n">runtime</span><span class="o">/</span><span class="n">device</span><span class="o">/</span><span class="n">ascend</span><span class="o">/</span><span class="n">ascend_kernel_runtime</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">375</span><span class="p">]</span><span class="w"> </span><span class="n">Init</span><span class="p">]</span><span class="w"> </span><span class="n">Ascend</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">occurred</span><span class="p">,</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">message</span><span class="o">:</span>
<span class="nl">EE9999</span><span class="p">:</span><span class="w"> </span><span class="n">Inner</span><span class="w"> </span><span class="n">Error</span><span class="o">!</span>
<span class="w">        </span><span class="p">[</span><span class="n">driver</span><span class="w"> </span><span class="n">interface</span><span class="p">]</span><span class="w"> </span><span class="n">halMemAlloc</span><span class="w"> </span><span class="n">failed</span><span class="o">:</span><span class="w"> </span><span class="n">device_id</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="mi">32212254720</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">env_type</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">drvRetCode</span><span class="o">=</span><span class="mi">6</span><span class="o">!</span><span class="p">[</span><span class="n">FUNC</span><span class="o">:</span><span class="n">ReportError</span><span class="p">][</span><span class="kt">FILE</span><span class="o">:</span><span class="n">npu_driver</span><span class="p">.</span><span class="n">cc</span><span class="p">][</span><span class="n">LINE</span><span class="o">:</span><span class="mi">568</span><span class="p">]</span>
<span class="w">        </span><span class="p">[</span><span class="n">driver</span><span class="w"> </span><span class="n">interface</span><span class="p">]</span><span class="w"> </span><span class="n">halMemAlloc</span><span class="w"> </span><span class="n">failed</span><span class="o">:</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="mi">32212254720</span><span class="p">,</span><span class="w"> </span><span class="n">deviceId</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">env_type</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">drvRetCode</span><span class="o">=</span><span class="mi">6</span><span class="o">!</span><span class="p">[</span><span class="n">FUNC</span><span class="o">:</span><span class="n">ReportError</span><span class="p">][</span><span class="kt">FILE</span><span class="o">:</span><span class="n">npu_driver</span><span class="p">.</span><span class="n">cc</span><span class="p">][</span><span class="n">LINE</span><span class="o">:</span><span class="mi">568</span><span class="p">]</span>
<span class="w">        </span><span class="n">DevMemAlloc</span><span class="w"> </span><span class="n">huge</span><span class="w"> </span><span class="n">page</span><span class="w"> </span><span class="n">failed</span><span class="o">:</span><span class="w"> </span><span class="n">deviceId</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="mi">32212254720</span><span class="p">,</span><span class="w"> </span><span class="n">retCode</span><span class="o">=</span><span class="mi">117571606</span><span class="o">!</span><span class="p">[</span><span class="n">FUNC</span><span class="o">:</span><span class="n">ReportError</span><span class="p">][</span><span class="kt">FILE</span><span class="o">:</span><span class="n">npu_driver</span><span class="p">.</span><span class="n">cc</span><span class="p">][</span><span class="n">LINE</span><span class="o">:</span><span class="mi">566</span><span class="p">]</span>
<span class="w">        </span><span class="n">Device</span><span class="w"> </span><span class="n">malloc</span><span class="w"> </span><span class="n">failed</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="o">=</span><span class="mi">32212254720</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="mf">2.</span><span class="p">[</span><span class="n">FUNC</span><span class="o">:</span><span class="n">ReportError</span><span class="p">][</span><span class="kt">FILE</span><span class="o">:</span><span class="n">logger</span><span class="p">.</span><span class="n">cc</span><span class="p">][</span><span class="n">LINE</span><span class="o">:</span><span class="mi">566</span><span class="p">]</span>
<span class="w">        </span><span class="n">rtMalloc</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="n">failed</span><span class="p">,</span><span class="w"> </span><span class="n">reason</span><span class="o">=</span><span class="p">[</span><span class="n">driver</span><span class="w"> </span><span class="n">error</span><span class="o">:</span><span class="n">out</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">memory</span><span class="p">][</span><span class="n">FUNC</span><span class="o">:</span><span class="n">ReportError</span><span class="p">][</span><span class="kt">FILE</span><span class="o">:</span><span class="n">error_message_manage</span><span class="p">.</span><span class="n">cc</span><span class="p">][</span><span class="n">LINE</span><span class="o">:</span><span class="mi">566</span><span class="p">]</span>

<span class="n">Traceback</span><span class="w"> </span><span class="p">(</span><span class="n">most</span><span class="w"> </span><span class="n">recent</span><span class="w"> </span><span class="n">call</span><span class="w"> </span><span class="n">last</span><span class="p">)</span><span class="o">:</span>
<span class="w">  </span><span class="n">File</span><span class="w"> </span><span class="s">&quot;train.py&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="mi">298</span><span class="p">,</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="o">&lt;</span><span class="k">module</span><span class="o">&gt;</span>
<span class="w">    </span><span class="n">train_net</span><span class="p">()</span>
<span class="w">  </span><span class="n">File</span><span class="w"> </span><span class="s">&quot;/home/jenkins/solution_test/remaining/test_scripts/fmea_multi_task/scripts/train/src/model_utils/moxing_adapter.py&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="mi">104</span><span class="p">,</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">wrapped_func</span>
<span class="w">    </span><span class="n">run_func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="w">  </span><span class="n">File</span><span class="w"> </span><span class="s">&quot;train.py&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="mi">292</span><span class="p">,</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">train_net</span>
<span class="w">    </span><span class="n">sink_size</span><span class="o">=</span><span class="n">dataset</span><span class="p">.</span><span class="n">get_dataset_size</span><span class="p">(),</span><span class="w"> </span><span class="n">dataset_sink_mode</span><span class="o">=</span><span class="n">dataset_sink_mode</span><span class="p">)</span>
<span class="w">  </span><span class="n">File</span><span class="w"> </span><span class="s">&quot;/home/miniconda3/envs/ci/lib/python3.7/site-packages/mindspore/train/model.py&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="mi">715</span><span class="p">,</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">train</span>
<span class="w">    </span><span class="n">sink_size</span><span class="o">=</span><span class="n">sink_size</span><span class="p">)</span>
<span class="w">  </span><span class="n">File</span><span class="w"> </span><span class="s">&quot;/home/miniconda3/envs/ci/lib/python3.7/site-packages/mindspore/train/model.py&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="mi">500</span><span class="p">,</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">_train</span>
<span class="w">    </span><span class="n">self</span><span class="p">.</span><span class="n">_train_dataset_sink_process</span><span class="p">(</span><span class="n">epoch</span><span class="p">,</span><span class="w"> </span><span class="n">train_dataset</span><span class="p">,</span><span class="w"> </span><span class="n">list_callback</span><span class="p">,</span><span class="w"> </span><span class="n">cb_params</span><span class="p">,</span><span class="w"> </span><span class="n">sink_size</span><span class="p">)</span>
<span class="w">  </span><span class="n">File</span><span class="w"> </span><span class="s">&quot;/home/miniconda3/envs/ci/lib/python3.7/site-packages/mindspore/train/model.py&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="mi">553</span><span class="p">,</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">_train_dataset_sink_process</span>
<span class="w">    </span><span class="n">dataset_helper</span><span class="o">=</span><span class="n">dataset_helper</span><span class="p">)</span>
<span class="w">  </span><span class="n">File</span><span class="w"> </span><span class="s">&quot;/home/miniconda3/envs/ci/lib/python3.7/site-packages/mindspore/train/model.py&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="mi">345</span><span class="p">,</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">_exec_preprocess</span>
<span class="w">    </span><span class="n">dataset_helper</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">DatasetHelper</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span><span class="w"> </span><span class="n">dataset_sink_mode</span><span class="p">,</span><span class="w"> </span><span class="n">sink_size</span><span class="p">,</span><span class="w"> </span><span class="n">epoch_num</span><span class="p">)</span>
<span class="w">  </span><span class="n">File</span><span class="w"> </span><span class="s">&quot;/home/miniconda3/envs/ci/lib/python3.7/site-packages/mindspore/train/dataset_helper.py&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="mi">245</span><span class="p">,</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">__init__</span>
<span class="w">    </span><span class="n">self</span><span class="p">.</span><span class="n">iter</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">iterclass</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span><span class="w"> </span><span class="n">sink_size</span><span class="p">,</span><span class="w"> </span><span class="n">epoch_num</span><span class="p">)</span>
<span class="w">  </span><span class="n">File</span><span class="w"> </span><span class="s">&quot;/home/miniconda3/envs/ci/lib/python3.7/site-packages/mindspore/train/dataset_helper.py&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="mi">393</span><span class="p">,</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">__init__</span>
<span class="w">    </span><span class="n">super</span><span class="p">().</span><span class="n">__init__</span><span class="p">(</span><span class="n">dataset</span><span class="p">,</span><span class="w"> </span><span class="n">sink_size</span><span class="p">,</span><span class="w"> </span><span class="n">epoch_num</span><span class="p">)</span>
<span class="w">  </span><span class="n">File</span><span class="w"> </span><span class="s">&quot;/home/miniconda3/envs/ci/lib/python3.7/site-packages/mindspore/train/dataset_helper.py&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="mi">300</span><span class="p">,</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">__init__</span>
<span class="w">    </span><span class="n">create_data_info_queue</span><span class="o">=</span><span class="n">create_data_info_queue</span><span class="p">)</span>
<span class="w">  </span><span class="n">File</span><span class="w"> </span><span class="s">&quot;/home/miniconda3/envs/ci/lib/python3.7/site-packages/mindspore/train/_utils.py&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="mi">73</span><span class="p">,</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">_exec_datagraph</span>
<span class="w">    </span><span class="n">phase</span><span class="o">=</span><span class="n">phase</span><span class="p">)</span>
<span class="w">  </span><span class="n">File</span><span class="w"> </span><span class="s">&quot;/home/miniconda3/envs/ci/lib/python3.7/site-packages/mindspore/common/api.py&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="mi">470</span><span class="p">,</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">init_dataset</span>
<span class="w">    </span><span class="n">phase</span><span class="o">=</span><span class="n">phase</span><span class="p">)</span><span class="o">:</span>
<span class="nl">RuntimeError</span><span class="p">:</span><span class="w"> </span><span class="n">mindspore</span><span class="o">/</span><span class="n">ccsrc</span><span class="o">/</span><span class="n">runtime</span><span class="o">/</span><span class="n">device</span><span class="o">/</span><span class="n">ascend</span><span class="o">/</span><span class="n">ascend_memory_manager</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">62</span><span class="w"> </span><span class="n">MallocDeviceMemory</span><span class="p">]</span><span class="w"> </span><span class="n">Malloc</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">memory</span><span class="w"> </span><span class="n">failed</span><span class="p">,</span><span class="w"> </span><span class="n">size</span><span class="p">[</span><span class="mi">32212254720</span><span class="p">],</span><span class="w"> </span><span class="n">ret</span><span class="p">[</span><span class="mi">207001</span><span class="p">],</span><span class="w"> </span><span class="n">Device</span><span class="w"> </span><span class="mi">6</span><span class="w"> </span><span class="n">may</span><span class="w"> </span><span class="n">be</span><span class="w"> </span><span class="n">other</span><span class="w"> </span><span class="n">processes</span><span class="w"> </span><span class="n">occupying</span><span class="w"> </span><span class="k">this</span><span class="w"> </span><span class="n">card</span><span class="p">,</span><span class="w"> </span><span class="n">check</span><span class="w"> </span><span class="n">as</span><span class="o">:</span><span class="w"> </span><span class="n">ps</span><span class="w"> </span><span class="o">-</span><span class="n">ef</span><span class="o">|</span><span class="n">grep</span><span class="w"> </span><span class="n">python</span>
</pre></div>
</div>
<p>遇到此类报错，可以先排查跑程序的卡是否已经被其他程序占用。目前MindSpore在Ascend环境上同一Device（即同一张卡）只支持同时跑一个程序，在Atlas训练系列产品训练服务器上执行程序时会一次性申请32212254720KB（即30GB）的显存，故若报错信息中显示申请失败的显存大小为32212254720，则很有可能是该Device已经被其他程序占用，导致新程序申请显存失败。遇到这个问题只需确认卡未被其他程序占用后重新启动程序即可。若报错信息中显示申请失败的显存大小不为32212254720，而是其他任意数字，则可能是网络模型太大，超过了Device的显存（Atlas训练系列产品服务器为32GB），可以考虑改小batchsize、对网络模型进行优化或者使用模型并行等手段来作训练。</p>
<p>另外，当前MindSpore在程序初始化时会对Device的剩余HBM显存做校验，若剩余HBM显存小于总量的一半，就会报以下错误提示卡被占用：</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span>[CRITICAL] DEVICE(164104,ffff841795d0,python):2022-12-01-03:58:52.033.238 [mindspore/ccsrc/runtime/device/kernel_runtime.cc:124] LockRuntime] The pointer[stream] is null.
[ERROR] DEVICE(164104,ffff841795d0,python):2022-12-01-03:58:52.033.355 [mindspore/ccsrc/runtime/device/kernel_runtime_manager.cc:138] WaitTaskFinishOnDevice] SyncStream failed, exception:The pointer[stream] is null.

----------------------------------------------------
- C++ Call Stack: (For framework developers)
----------------------------------------------------
mindspore/ccsrc/runtime/device/kernel_runtime.cc:124 LockRuntime

Traceback (most recent call last):
  File &quot;train.py&quot;, line 377, in &lt;module&gt;
    train_net()
  File &quot;/home/jenkins/workspace/TDT_deployment/solution_test/remaining/test_scripts/mindspore/reliability/fmea/business/process/multitask/test_ms_fmea_multi_task_1p_1p_0001_2_GRAPH_MODE/scripts/train/src/model_utils/moxing_adapter.py&quot;, line 104, in wrapped_func
    run_func(*args, **kwargs)
  File &quot;train.py&quot;, line 370, in train_net
    sink_size=dataset.get_dataset_size(), dataset_sink_mode=dataset_sink_mode)
  File &quot;/home/miniconda3/envs/ci/lib/python3.7/site-packages/mindspore/train/model.py&quot;, line 1052, in train
    initial_epoch=initial_epoch)
  File &quot;/home/miniconda3/envs/ci/lib/python3.7/site-packages/mindspore/train/model.py&quot;, line 98, in wrapper
    func(self, *args, **kwargs)
  File &quot;/home/miniconda3/envs/ci/lib/python3.7/site-packages/mindspore/train/model.py&quot;, line 614, in _train
    cb_params, sink_size, initial_epoch, valid_infos)
  File &quot;/home/miniconda3/envs/ci/lib/python3.7/site-packages/mindspore/train/model.py&quot;, line 673, in _train_dataset_sink_process
    dataset_helper=dataset_helper)
  File &quot;/home/miniconda3/envs/ci/lib/python3.7/site-packages/mindspore/train/model.py&quot;, line 427, in _exec_preprocess
    dataset_helper = DatasetHelper(dataset, dataset_sink_mode, sink_size, epoch_num)
  File &quot;/home/miniconda3/envs/ci/lib/python3.7/site-packages/mindspore/train/dataset_helper.py&quot;, line 335, in __init__
    self.iter = iterclass(dataset, sink_size, epoch_num)
  File &quot;/home/miniconda3/envs/ci/lib/python3.7/site-packages/mindspore/train/dataset_helper.py&quot;, line 530, in __init__
    super().__init__(dataset, sink_size, epoch_num)
  File &quot;/home/miniconda3/envs/ci/lib/python3.7/site-packages/mindspore/train/dataset_helper.py&quot;, line 429, in __init__
    create_data_info_queue=create_data_info_queue)
  File &quot;/home/miniconda3/envs/ci/lib/python3.7/site-packages/mindspore/train/_utils.py&quot;, line 74, in _exec_datagraph
    phase=phase)
  File &quot;/home/miniconda3/envs/ci/lib/python3.7/site-packages/mindspore/common/api.py&quot;, line 1264, in init_dataset
    need_run=need_run):
RuntimeError: Ascend kernel runtime initialization failed. The details refer to &#39;Ascend Error Message&#39;.

----------------------------------------------------
- Framework Error Message:
----------------------------------------------------
Malloc device memory failed, free memory size is less than half of total memory size.Device 0 Device HBM total size:34359738368 Device HBM free size:2140602368 may be other processes occupying this card, check as: ps -ef|grep python
</pre></div>
</div>
</section>
<section id="ee9999-runtime-task执行失败">
<h3>EE9999: Runtime task执行失败<a class="headerlink" href="#ee9999-runtime-task执行失败" title="Permalink to this headline"></a></h3>
<p>runtime的算子或者task一般和控制流有关，比如event wait、send、recv等。当runtime的task执行失败时，就会报<code class="docutils literal notranslate"><span class="pre">EE9999</span> <span class="pre">Task</span> <span class="pre">execute</span> <span class="pre">failed</span></code>错误，如下所示：</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">CRITICAL</span><span class="p">]</span><span class="w"> </span><span class="n">DEVICE</span><span class="p">(</span><span class="mi">160186</span><span class="p">,</span><span class="n">fffd5affd0f0</span><span class="p">,</span><span class="n">python</span><span class="p">)</span><span class="o">:</span><span class="mi">2023</span><span class="mo">-01</span><span class="mi">-10-09</span><span class="o">:</span><span class="mi">15</span><span class="o">:</span><span class="mf">46.798.038</span><span class="w"> </span><span class="p">[</span><span class="n">mindspore</span><span class="o">/</span><span class="n">ccsrc</span><span class="o">/</span><span class="n">plugin</span><span class="o">/</span><span class="n">device</span><span class="o">/</span><span class="n">ascend</span><span class="o">/</span><span class="n">hal</span><span class="o">/</span><span class="n">device</span><span class="o">/</span><span class="n">ascend_data_queue</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">291</span><span class="p">]</span><span class="w"> </span><span class="n">ParseType</span><span class="p">]</span><span class="w"> </span><span class="n">Got</span><span class="w"> </span><span class="n">unsupported</span><span class="w"> </span><span class="n">acl</span><span class="w"> </span><span class="n">datatype</span><span class="o">:</span><span class="w"> </span><span class="mi">-1</span>
<span class="p">[</span><span class="n">ERROR</span><span class="p">]</span><span class="w"> </span><span class="n">MD</span><span class="p">(</span><span class="mi">160186</span><span class="p">,</span><span class="n">fffd5affd0f0</span><span class="p">,</span><span class="n">python</span><span class="p">)</span><span class="o">:</span><span class="mi">2023</span><span class="mo">-01</span><span class="mi">-10-09</span><span class="o">:</span><span class="mi">15</span><span class="o">:</span><span class="mf">46.798.688</span><span class="w"> </span><span class="p">[</span><span class="n">mindspore</span><span class="o">/</span><span class="n">ccsrc</span><span class="o">/</span><span class="n">minddata</span><span class="o">/</span><span class="n">dataset</span><span class="o">/</span><span class="n">util</span><span class="o">/</span><span class="n">task</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">75</span><span class="p">]</span><span class="w"> </span><span class="k">operator</span><span class="p">()]</span><span class="w"> </span><span class="n">Unexpected</span><span class="w"> </span><span class="n">error</span><span class="p">.</span><span class="w"> </span><span class="n">Got</span><span class="w"> </span><span class="n">unsupported</span><span class="w"> </span><span class="n">acl</span><span class="w"> </span><span class="n">datatype</span><span class="o">:</span><span class="w"> </span><span class="mi">-1</span>

<span class="o">----------------------------------------------------</span>
<span class="o">-</span><span class="w"> </span><span class="n">C</span><span class="o">++</span><span class="w"> </span><span class="n">Call</span><span class="w"> </span><span class="n">Stack</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="n">For</span><span class="w"> </span><span class="n">framework</span><span class="w"> </span><span class="n">developers</span><span class="p">)</span>
<span class="o">----------------------------------------------------</span>
<span class="n">mindspore</span><span class="o">/</span><span class="n">ccsrc</span><span class="o">/</span><span class="n">plugin</span><span class="o">/</span><span class="n">device</span><span class="o">/</span><span class="n">ascend</span><span class="o">/</span><span class="n">hal</span><span class="o">/</span><span class="n">device</span><span class="o">/</span><span class="n">ascend_data_queue</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">291</span><span class="w"> </span><span class="n">ParseType</span>

<span class="n">Line</span><span class="w"> </span><span class="n">of</span><span class="w"> </span><span class="n">code</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">74</span>
<span class="nl">File</span><span class="w">         </span><span class="p">:</span><span class="w"> </span><span class="n">mindspore</span><span class="o">/</span><span class="n">ccsrc</span><span class="o">/</span><span class="n">minddata</span><span class="o">/</span><span class="n">dataset</span><span class="o">/</span><span class="n">util</span><span class="o">/</span><span class="n">task</span><span class="p">.</span><span class="n">cc</span>

<span class="p">[</span><span class="n">ERROR</span><span class="p">]</span><span class="w"> </span><span class="n">MD</span><span class="p">(</span><span class="mi">160186</span><span class="p">,</span><span class="n">fffd5affd0f0</span><span class="p">,</span><span class="n">python</span><span class="p">)</span><span class="o">:</span><span class="mi">2023</span><span class="mo">-01</span><span class="mi">-10-09</span><span class="o">:</span><span class="mi">15</span><span class="o">:</span><span class="mf">46.798.741</span><span class="w"> </span><span class="p">[</span><span class="n">mindspore</span><span class="o">/</span><span class="n">ccsrc</span><span class="o">/</span><span class="n">minddata</span><span class="o">/</span><span class="n">dataset</span><span class="o">/</span><span class="n">util</span><span class="o">/</span><span class="n">task_manager</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">222</span><span class="p">]</span><span class="w"> </span><span class="n">InterruptMaster</span><span class="p">]</span><span class="w"> </span><span class="n">Task</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">terminated</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">err</span><span class="w"> </span><span class="n">msg</span><span class="w"> </span><span class="p">(</span><span class="n">more</span><span class="w"> </span><span class="n">details</span><span class="w"> </span><span class="n">are</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">info</span><span class="w"> </span><span class="n">level</span><span class="w"> </span><span class="n">logs</span><span class="p">)</span><span class="o">:</span><span class="w"> </span><span class="n">Unexpected</span><span class="w"> </span><span class="n">error</span><span class="p">.</span><span class="w"> </span><span class="n">Got</span><span class="w"> </span><span class="n">unsupported</span><span class="w"> </span><span class="n">acl</span><span class="w"> </span><span class="n">datatype</span><span class="o">:</span><span class="w"> </span><span class="mi">-1</span>

<span class="n">INFO</span><span class="w"> </span><span class="mi">2023</span><span class="mo">-01</span><span class="mi">-10</span><span class="w"> </span><span class="mi">09</span><span class="o">:</span><span class="mi">15</span><span class="o">:</span><span class="mi">46</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">train</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">dataset_func</span><span class="p">.</span><span class="n">py</span><span class="o">:</span><span class="n">op_network_with_create_dict_iterator</span><span class="o">:</span><span class="mi">302</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Iter</span><span class="w"> </span><span class="n">Num</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">0</span>
<span class="n">INFO</span><span class="w"> </span><span class="mi">2023</span><span class="mo">-01</span><span class="mi">-10</span><span class="w"> </span><span class="mi">09</span><span class="o">:</span><span class="mi">15</span><span class="o">:</span><span class="mi">46</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">train</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">dataset_func</span><span class="p">.</span><span class="n">py</span><span class="o">:</span><span class="n">op_network_with_create_dict_iterator</span><span class="o">:</span><span class="mi">302</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Iter</span><span class="w"> </span><span class="n">Num</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">0</span>
<span class="n">INFO</span><span class="w"> </span><span class="mi">2023</span><span class="mo">-01</span><span class="mi">-10</span><span class="w"> </span><span class="mi">09</span><span class="o">:</span><span class="mi">15</span><span class="o">:</span><span class="mi">46</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">train</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">dataset_func</span><span class="p">.</span><span class="n">py</span><span class="o">:</span><span class="n">op_network_with_create_dict_iterator</span><span class="o">:</span><span class="mi">302</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Iter</span><span class="w"> </span><span class="n">Num</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">0</span>
<span class="n">INFO</span><span class="w"> </span><span class="mi">2023</span><span class="mo">-01</span><span class="mi">-10</span><span class="w"> </span><span class="mi">09</span><span class="o">:</span><span class="mi">15</span><span class="o">:</span><span class="mi">46</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">train</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">dataset_func</span><span class="p">.</span><span class="n">py</span><span class="o">:</span><span class="n">op_network_with_create_dict_iterator</span><span class="o">:</span><span class="mi">302</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Iter</span><span class="w"> </span><span class="n">Num</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">0</span>
<span class="n">INFO</span><span class="w"> </span><span class="mi">2023</span><span class="mo">-01</span><span class="mi">-10</span><span class="w"> </span><span class="mi">09</span><span class="o">:</span><span class="mi">15</span><span class="o">:</span><span class="mi">46</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">train</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">dataset_func</span><span class="p">.</span><span class="n">py</span><span class="o">:</span><span class="n">op_network_with_create_dict_iterator</span><span class="o">:</span><span class="mi">302</span><span class="w"> </span><span class="o">-</span><span class="w"> </span><span class="n">Iter</span><span class="w"> </span><span class="n">Num</span><span class="w"> </span><span class="o">:</span><span class="w"> </span><span class="mi">0</span>
<span class="p">[</span><span class="n">ERROR</span><span class="p">]</span><span class="w"> </span><span class="n">RUNTIME</span><span class="p">(</span><span class="mi">160186</span><span class="p">,</span><span class="n">python</span><span class="p">)</span><span class="o">:</span><span class="mi">2023</span><span class="mo">-01</span><span class="mi">-10-09</span><span class="o">:</span><span class="mi">25</span><span class="o">:</span><span class="mf">45.322.063</span><span class="w"> </span><span class="p">[</span><span class="n">engine</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">1263</span><span class="p">]</span><span class="mi">163618</span><span class="w"> </span><span class="n">ReportExceptProc</span><span class="o">:</span><span class="n">Task</span><span class="w"> </span><span class="n">exception</span><span class="o">!</span><span class="w"> </span><span class="n">device_id</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">stream_id</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span><span class="w"> </span><span class="n">task_id</span><span class="o">=</span><span class="mi">43</span><span class="p">,</span><span class="w"> </span><span class="n">type</span><span class="o">=</span><span class="mi">13</span><span class="p">,</span><span class="w"> </span><span class="n">retCode</span><span class="o">=</span><span class="mh">0x91</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="n">the</span><span class="w"> </span><span class="n">model</span><span class="w"> </span><span class="n">stream</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="n">failed</span><span class="p">].</span>
<span class="p">[</span><span class="n">ERROR</span><span class="p">]</span><span class="w"> </span><span class="n">RUNTIME</span><span class="p">(</span><span class="mi">160186</span><span class="p">,</span><span class="n">python</span><span class="p">)</span><span class="o">:</span><span class="mi">2023</span><span class="mo">-01</span><span class="mi">-10-09</span><span class="o">:</span><span class="mi">25</span><span class="o">:</span><span class="mf">45.323.519</span><span class="w"> </span><span class="p">[</span><span class="n">task</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">92</span><span class="p">]</span><span class="mi">163618</span><span class="w"> </span><span class="n">PrintErrorInfo</span><span class="o">:</span><span class="n">Task</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="n">failed</span><span class="p">,</span><span class="w"> </span><span class="n">base</span><span class="w"> </span><span class="n">info</span><span class="o">:</span><span class="w"> </span><span class="n">device_id</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">stream_id</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">task_id</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">flip_num</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">task_type</span><span class="o">=</span><span class="mf">3.</span>
<span class="p">[</span><span class="n">ERROR</span><span class="p">]</span><span class="w"> </span><span class="n">RUNTIME</span><span class="p">(</span><span class="mi">160186</span><span class="p">,</span><span class="n">python</span><span class="p">)</span><span class="o">:</span><span class="mi">2023</span><span class="mo">-01</span><span class="mi">-10-09</span><span class="o">:</span><span class="mi">25</span><span class="o">:</span><span class="mf">45.323.542</span><span class="w"> </span><span class="p">[</span><span class="n">task</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">3239</span><span class="p">]</span><span class="mi">163618</span><span class="w"> </span><span class="n">ReportErrorInfo</span><span class="o">:</span><span class="n">model</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="n">error</span><span class="p">,</span><span class="w"> </span><span class="n">retCode</span><span class="o">=</span><span class="mh">0x91</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="n">the</span><span class="w"> </span><span class="n">model</span><span class="w"> </span><span class="n">stream</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="n">failed</span><span class="p">].</span>
<span class="p">[</span><span class="n">ERROR</span><span class="p">]</span><span class="w"> </span><span class="n">RUNTIME</span><span class="p">(</span><span class="mi">160186</span><span class="p">,</span><span class="n">python</span><span class="p">)</span><span class="o">:</span><span class="mi">2023</span><span class="mo">-01</span><span class="mi">-10-09</span><span class="o">:</span><span class="mi">25</span><span class="o">:</span><span class="mf">45.323.553</span><span class="w"> </span><span class="p">[</span><span class="n">task</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">3210</span><span class="p">]</span><span class="mi">163618</span><span class="w"> </span><span class="n">PrintErrorInfo</span><span class="o">:</span><span class="n">model</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="n">task</span><span class="w"> </span><span class="n">failed</span><span class="p">,</span><span class="w"> </span><span class="n">device_id</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">model</span><span class="w"> </span><span class="n">stream_id</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span><span class="w"> </span><span class="n">model</span><span class="w"> </span><span class="n">task_id</span><span class="o">=</span><span class="mi">43</span><span class="p">,</span><span class="w"> </span><span class="n">flip_num</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">model_id</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span><span class="w"> </span><span class="n">first_task_id</span><span class="o">=</span><span class="mi">65535</span>
<span class="p">[</span><span class="n">ERROR</span><span class="p">]</span><span class="w"> </span><span class="n">RUNTIME</span><span class="p">(</span><span class="mi">160186</span><span class="p">,</span><span class="n">python</span><span class="p">)</span><span class="o">:</span><span class="mi">2023</span><span class="mo">-01</span><span class="mi">-10-09</span><span class="o">:</span><span class="mi">25</span><span class="o">:</span><span class="mf">45.323.578</span><span class="w"> </span><span class="p">[</span><span class="n">callback</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">91</span><span class="p">]</span><span class="mi">163618</span><span class="w"> </span><span class="n">Notify</span><span class="o">:</span><span class="n">notify</span><span class="w"> </span><span class="p">[</span><span class="n">HCCL</span><span class="p">]</span><span class="w"> </span><span class="n">task</span><span class="w"> </span><span class="n">fail</span><span class="w"> </span><span class="n">start</span><span class="p">.</span><span class="n">notify</span><span class="w"> </span><span class="n">taskid</span><span class="o">:</span><span class="mi">3</span><span class="w"> </span><span class="n">streamid</span><span class="o">:</span><span class="mi">2</span><span class="w"> </span><span class="n">retcode</span><span class="o">:</span><span class="mi">507011</span>
<span class="p">[</span><span class="n">ERROR</span><span class="p">]</span><span class="w"> </span><span class="n">RUNTIME</span><span class="p">(</span><span class="mi">160186</span><span class="p">,</span><span class="n">python</span><span class="p">)</span><span class="o">:</span><span class="mi">2023</span><span class="mo">-01</span><span class="mi">-10-09</span><span class="o">:</span><span class="mi">25</span><span class="o">:</span><span class="mf">45.324.653</span><span class="w"> </span><span class="p">[</span><span class="n">callback</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">91</span><span class="p">]</span><span class="mi">163618</span><span class="w"> </span><span class="n">Notify</span><span class="o">:</span><span class="n">notify</span><span class="w"> </span><span class="p">[</span><span class="n">MindSpore</span><span class="p">]</span><span class="w"> </span><span class="n">task</span><span class="w"> </span><span class="n">fail</span><span class="w"> </span><span class="n">start</span><span class="p">.</span><span class="n">notify</span><span class="w"> </span><span class="n">taskid</span><span class="o">:</span><span class="mi">3</span><span class="w"> </span><span class="n">streamid</span><span class="o">:</span><span class="mi">2</span><span class="w"> </span><span class="n">retcode</span><span class="o">:</span><span class="mi">507011</span>
<span class="p">[</span><span class="n">ERROR</span><span class="p">]</span><span class="w"> </span><span class="n">RUNTIME</span><span class="p">(</span><span class="mi">160186</span><span class="p">,</span><span class="n">python</span><span class="p">)</span><span class="o">:</span><span class="mi">2023</span><span class="mo">-01</span><span class="mi">-10-09</span><span class="o">:</span><span class="mi">25</span><span class="o">:</span><span class="mf">45.324.699</span><span class="w"> </span><span class="p">[</span><span class="n">stream</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">1041</span><span class="p">]</span><span class="mi">163618</span><span class="w"> </span><span class="n">GetError</span><span class="o">:</span><span class="n">Stream</span><span class="w"> </span><span class="n">Synchronize</span><span class="w"> </span><span class="n">failed</span><span class="p">,</span><span class="w"> </span><span class="n">stream_id</span><span class="o">=</span><span class="mi">17</span><span class="p">,</span><span class="w"> </span><span class="n">retCode</span><span class="o">=</span><span class="mh">0x91</span><span class="p">,</span><span class="w"> </span><span class="p">[</span><span class="n">the</span><span class="w"> </span><span class="n">model</span><span class="w"> </span><span class="n">stream</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="n">failed</span><span class="p">].</span>
<span class="p">[</span><span class="n">ERROR</span><span class="p">]</span><span class="w"> </span><span class="n">RUNTIME</span><span class="p">(</span><span class="mi">160186</span><span class="p">,</span><span class="n">python</span><span class="p">)</span><span class="o">:</span><span class="mi">2023</span><span class="mo">-01</span><span class="mi">-10-09</span><span class="o">:</span><span class="mi">25</span><span class="o">:</span><span class="mf">45.324.711</span><span class="w"> </span><span class="p">[</span><span class="n">stream</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">1044</span><span class="p">]</span><span class="mi">163618</span><span class="w"> </span><span class="n">GetError</span><span class="o">:</span><span class="n">report</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">module_type</span><span class="o">=</span><span class="mi">7</span><span class="p">,</span><span class="w"> </span><span class="n">module_name</span><span class="o">=</span><span class="n">EE9999</span>
<span class="p">[</span><span class="n">ERROR</span><span class="p">]</span><span class="w"> </span><span class="n">RUNTIME</span><span class="p">(</span><span class="mi">160186</span><span class="p">,</span><span class="n">python</span><span class="p">)</span><span class="o">:</span><span class="mi">2023</span><span class="mo">-01</span><span class="mi">-10-09</span><span class="o">:</span><span class="mi">25</span><span class="o">:</span><span class="mf">45.324.720</span><span class="w"> </span><span class="p">[</span><span class="n">stream</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">1044</span><span class="p">]</span><span class="mi">163618</span><span class="w"> </span><span class="n">GetError</span><span class="o">:</span><span class="n">Task</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="n">failed</span><span class="p">,</span><span class="w"> </span><span class="n">base</span><span class="w"> </span><span class="n">info</span><span class="o">:</span><span class="w"> </span><span class="n">device_id</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">stream_id</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">task_id</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">flip_num</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">task_type</span><span class="o">=</span><span class="mf">3.</span>
<span class="p">[</span><span class="n">ERROR</span><span class="p">]</span><span class="w"> </span><span class="n">RUNTIME</span><span class="p">(</span><span class="mi">160186</span><span class="p">,</span><span class="n">python</span><span class="p">)</span><span class="o">:</span><span class="mi">2023</span><span class="mo">-01</span><span class="mi">-10-09</span><span class="o">:</span><span class="mi">25</span><span class="o">:</span><span class="mf">45.324.788</span><span class="w"> </span><span class="p">[</span><span class="n">logger</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">314</span><span class="p">]</span><span class="mi">163618</span><span class="w"> </span><span class="n">StreamSynchronize</span><span class="o">:</span><span class="n">Stream</span><span class="w"> </span><span class="n">synchronize</span><span class="w"> </span><span class="n">failed</span>
<span class="p">[</span><span class="n">ERROR</span><span class="p">]</span><span class="w"> </span><span class="n">RUNTIME</span><span class="p">(</span><span class="mi">160186</span><span class="p">,</span><span class="n">python</span><span class="p">)</span><span class="o">:</span><span class="mi">2023</span><span class="mo">-01</span><span class="mi">-10-09</span><span class="o">:</span><span class="mi">25</span><span class="o">:</span><span class="mf">45.324.830</span><span class="w"> </span><span class="p">[</span><span class="n">api_c</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">721</span><span class="p">]</span><span class="mi">163618</span><span class="w"> </span><span class="n">rtStreamSynchronize</span><span class="o">:</span><span class="n">ErrCode</span><span class="o">=</span><span class="mi">507011</span><span class="p">,</span><span class="w"> </span><span class="n">desc</span><span class="o">=</span><span class="p">[</span><span class="n">the</span><span class="w"> </span><span class="n">model</span><span class="w"> </span><span class="n">stream</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="n">failed</span><span class="p">],</span><span class="w"> </span><span class="n">InnerCode</span><span class="o">=</span><span class="mh">0x7150050</span>
<span class="p">[</span><span class="n">ERROR</span><span class="p">]</span><span class="w"> </span><span class="n">RUNTIME</span><span class="p">(</span><span class="mi">160186</span><span class="p">,</span><span class="n">python</span><span class="p">)</span><span class="o">:</span><span class="mi">2023</span><span class="mo">-01</span><span class="mi">-10-09</span><span class="o">:</span><span class="mi">25</span><span class="o">:</span><span class="mf">45.324.841</span><span class="w"> </span><span class="p">[</span><span class="n">error_message_manage</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">49</span><span class="p">]</span><span class="mi">163618</span><span class="w"> </span><span class="n">FuncErrorReason</span><span class="o">:</span><span class="n">report</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">module_type</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">module_name</span><span class="o">=</span><span class="n">EE8888</span>
<span class="p">[</span><span class="n">ERROR</span><span class="p">]</span><span class="w"> </span><span class="n">RUNTIME</span><span class="p">(</span><span class="mi">160186</span><span class="p">,</span><span class="n">python</span><span class="p">)</span><span class="o">:</span><span class="mi">2023</span><span class="mo">-01</span><span class="mi">-10-09</span><span class="o">:</span><span class="mi">25</span><span class="o">:</span><span class="mf">45.324.855</span><span class="w"> </span><span class="p">[</span><span class="n">error_message_manage</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">49</span><span class="p">]</span><span class="mi">163618</span><span class="w"> </span><span class="n">FuncErrorReason</span><span class="o">:</span><span class="n">rtStreamSynchronize</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="n">failed</span><span class="p">,</span><span class="w"> </span><span class="n">reason</span><span class="o">=</span><span class="p">[</span><span class="n">the</span><span class="w"> </span><span class="n">model</span><span class="w"> </span><span class="n">stream</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="n">failed</span><span class="p">]</span>
<span class="p">[</span><span class="n">CRITICAL</span><span class="p">]</span><span class="w"> </span><span class="n">GE</span><span class="p">(</span><span class="mi">160186</span><span class="p">,</span><span class="n">fffdf7fff0f0</span><span class="p">,</span><span class="n">python</span><span class="p">)</span><span class="o">:</span><span class="mi">2023</span><span class="mo">-01</span><span class="mi">-10-09</span><span class="o">:</span><span class="mi">25</span><span class="o">:</span><span class="mf">45.337.038</span><span class="w"> </span><span class="p">[</span><span class="n">mindspore</span><span class="o">/</span><span class="n">ccsrc</span><span class="o">/</span><span class="n">plugin</span><span class="o">/</span><span class="n">device</span><span class="o">/</span><span class="n">ascend</span><span class="o">/</span><span class="n">hal</span><span class="o">/</span><span class="n">device</span><span class="o">/</span><span class="n">ge_runtime</span><span class="o">/</span><span class="n">runtime_model</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">241</span><span class="p">]</span><span class="w"> </span><span class="n">Run</span><span class="p">]</span><span class="w"> </span><span class="n">Call</span><span class="w"> </span><span class="n">rt</span><span class="w"> </span><span class="n">api</span><span class="w"> </span><span class="n">rtStreamSynchronize</span><span class="w"> </span><span class="n">failed</span><span class="p">,</span><span class="w"> </span><span class="n">ret</span><span class="o">:</span><span class="w"> </span><span class="mi">507011</span>
<span class="p">[</span><span class="n">ERROR</span><span class="p">]</span><span class="w"> </span><span class="n">DEVICE</span><span class="p">(</span><span class="mi">160186</span><span class="p">,</span><span class="n">fffdf7fff0f0</span><span class="p">,</span><span class="n">python</span><span class="p">)</span><span class="o">:</span><span class="mi">2023</span><span class="mo">-01</span><span class="mi">-10-09</span><span class="o">:</span><span class="mi">25</span><span class="o">:</span><span class="mf">45.337.259</span><span class="w"> </span><span class="p">[</span><span class="n">mindspore</span><span class="o">/</span><span class="n">ccsrc</span><span class="o">/</span><span class="n">plugin</span><span class="o">/</span><span class="n">device</span><span class="o">/</span><span class="n">ascend</span><span class="o">/</span><span class="n">hal</span><span class="o">/</span><span class="n">device</span><span class="o">/</span><span class="n">ascend_kernel_runtime</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">761</span><span class="p">]</span><span class="w"> </span><span class="n">DumpTaskExceptionInfo</span><span class="p">]</span><span class="w"> </span><span class="n">Task</span><span class="w"> </span><span class="n">fail</span><span class="w"> </span><span class="n">infos</span><span class="w"> </span><span class="n">task_id</span><span class="o">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">stream_id</span><span class="o">:</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">tid</span><span class="o">:</span><span class="w"> </span><span class="mi">160186</span><span class="p">,</span><span class="w"> </span><span class="n">device_id</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">retcode</span><span class="o">:</span><span class="w"> </span><span class="mi">507011</span><span class="w"> </span><span class="p">(</span><span class="w"> </span><span class="n">model</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="n">failed</span><span class="p">)</span>
<span class="p">[</span><span class="n">CRITICAL</span><span class="p">]</span><span class="w"> </span><span class="n">DEVICE</span><span class="p">(</span><span class="mi">160186</span><span class="p">,</span><span class="n">fffdf7fff0f0</span><span class="p">,</span><span class="n">python</span><span class="p">)</span><span class="o">:</span><span class="mi">2023</span><span class="mo">-01</span><span class="mi">-10-09</span><span class="o">:</span><span class="mi">25</span><span class="o">:</span><span class="mf">45.337.775</span><span class="w"> </span><span class="p">[</span><span class="n">mindspore</span><span class="o">/</span><span class="n">ccsrc</span><span class="o">/</span><span class="n">plugin</span><span class="o">/</span><span class="n">device</span><span class="o">/</span><span class="n">ascend</span><span class="o">/</span><span class="n">hal</span><span class="o">/</span><span class="n">hardware</span><span class="o">/</span><span class="n">ascend_graph_executor</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">214</span><span class="p">]</span><span class="w"> </span><span class="n">RunGraph</span><span class="p">]</span><span class="w"> </span><span class="n">Run</span><span class="w"> </span><span class="n">task</span><span class="w"> </span><span class="n">error</span><span class="o">!</span><span class="n">Ascend</span><span class="w"> </span><span class="n">Error</span><span class="w"> </span><span class="n">Message</span><span class="o">:</span><span class="n">EE9999</span><span class="o">:</span><span class="w"> </span><span class="n">Inner</span><span class="w"> </span><span class="n">Error</span><span class="p">,</span><span class="w"> </span><span class="n">Please</span><span class="w"> </span><span class="n">contact</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="n">engineer</span><span class="o">!</span>
<span class="n">EE9999</span><span class="w">  </span><span class="n">Task</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="n">failed</span><span class="p">,</span><span class="w"> </span><span class="n">base</span><span class="w"> </span><span class="n">info</span><span class="o">:</span><span class="w"> </span><span class="n">device_id</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">stream_id</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">task_id</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">flip_num</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">task_type</span><span class="o">=</span><span class="mf">3.</span><span class="p">[</span><span class="n">FUNC</span><span class="o">:</span><span class="n">GetError</span><span class="p">][</span><span class="kt">FILE</span><span class="o">:</span><span class="n">stream</span><span class="p">.</span><span class="n">cc</span><span class="p">][</span><span class="n">LINE</span><span class="o">:</span><span class="mi">1044</span><span class="p">]</span>
<span class="w">        </span><span class="n">TraceBack</span><span class="w"> </span><span class="p">(</span><span class="n">most</span><span class="w"> </span><span class="n">recent</span><span class="w"> </span><span class="n">call</span><span class="w"> </span><span class="n">last</span><span class="p">)</span><span class="o">:</span>
<span class="w">        </span><span class="n">rtStreamSynchronize</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="n">failed</span><span class="p">,</span><span class="w"> </span><span class="n">reason</span><span class="o">=</span><span class="p">[</span><span class="n">the</span><span class="w"> </span><span class="n">model</span><span class="w"> </span><span class="n">stream</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="n">failed</span><span class="p">][</span><span class="n">FUNC</span><span class="o">:</span><span class="n">FuncErrorReason</span><span class="p">][</span><span class="kt">FILE</span><span class="o">:</span><span class="n">error_message_manage</span><span class="p">.</span><span class="n">cc</span><span class="p">][</span><span class="n">LINE</span><span class="o">:</span><span class="mi">49</span><span class="p">]</span>

<span class="p">[</span><span class="n">WARNING</span><span class="p">]</span><span class="w"> </span><span class="n">MD</span><span class="p">(</span><span class="mi">160186</span><span class="p">,</span><span class="n">ffff9339d010</span><span class="p">,</span><span class="n">python</span><span class="p">)</span><span class="o">:</span><span class="mi">2023</span><span class="mo">-01</span><span class="mi">-10-09</span><span class="o">:</span><span class="mi">25</span><span class="o">:</span><span class="mf">45.342.881</span><span class="w"> </span><span class="p">[</span><span class="n">mindspore</span><span class="o">/</span><span class="n">ccsrc</span><span class="o">/</span><span class="n">minddata</span><span class="o">/</span><span class="n">dataset</span><span class="o">/</span><span class="n">engine</span><span class="o">/</span><span class="n">datasetops</span><span class="o">/</span><span class="n">data_queue_op</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">93</span><span class="p">]</span><span class="w"> </span><span class="o">~</span><span class="n">DataQueueOp</span><span class="p">]</span><span class="w"> </span><span class="n">preprocess_batch</span><span class="o">:</span><span class="w"> </span><span class="mi">10</span><span class="p">;</span><span class="w"> </span><span class="n">batch_queue</span><span class="o">:</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">;</span><span class="w"> </span><span class="n">push_start_time</span><span class="o">:</span><span class="w"> </span><span class="mi">2023</span><span class="mo">-01</span><span class="mi">-10-09</span><span class="o">:</span><span class="mi">15</span><span class="o">:</span><span class="mf">46.739.740</span><span class="p">,</span><span class="w"> </span><span class="mi">2023</span><span class="mo">-01</span><span class="mi">-10-09</span><span class="o">:</span><span class="mi">15</span><span class="o">:</span><span class="mf">46.748.507</span><span class="p">,</span><span class="w"> </span><span class="mi">2023</span><span class="mo">-01</span><span class="mi">-10-09</span><span class="o">:</span><span class="mi">15</span><span class="o">:</span><span class="mf">46.772.387</span><span class="p">,</span><span class="w"> </span><span class="mi">2023</span><span class="mo">-01</span><span class="mi">-10-09</span><span class="o">:</span><span class="mi">15</span><span class="o">:</span><span class="mf">46.772.965</span><span class="p">,</span><span class="w"> </span><span class="mi">2023</span><span class="mo">-01</span><span class="mi">-10-09</span><span class="o">:</span><span class="mi">15</span><span class="o">:</span><span class="mf">46.775.373</span><span class="p">,</span><span class="w"> </span><span class="mi">2023</span><span class="mo">-01</span><span class="mi">-10-09</span><span class="o">:</span><span class="mi">15</span><span class="o">:</span><span class="mf">46.779.644</span><span class="p">,</span><span class="w"> </span><span class="mi">2023</span><span class="mo">-01</span><span class="mi">-10-09</span><span class="o">:</span><span class="mi">15</span><span class="o">:</span><span class="mf">46.787.036</span><span class="p">,</span><span class="w"> </span><span class="mi">2023</span><span class="mo">-01</span><span class="mi">-10-09</span><span class="o">:</span><span class="mi">15</span><span class="o">:</span><span class="mf">46.791.382</span><span class="p">,</span><span class="w"> </span><span class="mi">2023</span><span class="mo">-01</span><span class="mi">-10-09</span><span class="o">:</span><span class="mi">15</span><span class="o">:</span><span class="mf">46.795.615</span><span class="p">,</span><span class="w"> </span><span class="mi">2023</span><span class="mo">-01</span><span class="mi">-10-09</span><span class="o">:</span><span class="mi">15</span><span class="o">:</span><span class="mf">46.797.560</span><span class="p">;</span><span class="w"> </span><span class="n">push_end_time</span><span class="o">:</span><span class="w"> </span><span class="mi">2023</span><span class="mo">-01</span><span class="mi">-10-09</span><span class="o">:</span><span class="mi">15</span><span class="o">:</span><span class="mf">46.742.372</span><span class="p">,</span><span class="w"> </span><span class="mi">2023</span><span class="mo">-01</span><span class="mi">-10-09</span><span class="o">:</span><span class="mi">15</span><span class="o">:</span><span class="mf">46.749.065</span><span class="p">,</span><span class="w"> </span><span class="mi">2023</span><span class="mo">-01</span><span class="mi">-10-09</span><span class="o">:</span><span class="mi">15</span><span class="o">:</span><span class="mf">46.772.929</span><span class="p">,</span><span class="w"> </span><span class="mi">2023</span><span class="mo">-01</span><span class="mi">-10-09</span><span class="o">:</span><span class="mi">15</span><span class="o">:</span><span class="mf">46.773.347</span><span class="p">,</span><span class="w"> </span><span class="mi">2023</span><span class="mo">-01</span><span class="mi">-10-09</span><span class="o">:</span><span class="mi">15</span><span class="o">:</span><span class="mf">46.775.811</span><span class="p">,</span><span class="w"> </span><span class="mi">2023</span><span class="mo">-01</span><span class="mi">-10-09</span><span class="o">:</span><span class="mi">15</span><span class="o">:</span><span class="mf">46.780.110</span><span class="p">,</span><span class="w"> </span><span class="mi">2023</span><span class="mo">-01</span><span class="mi">-10-09</span><span class="o">:</span><span class="mi">15</span><span class="o">:</span><span class="mf">46.787.544</span><span class="p">,</span><span class="w"> </span><span class="mi">2023</span><span class="mo">-01</span><span class="mi">-10-09</span><span class="o">:</span><span class="mi">15</span><span class="o">:</span><span class="mf">46.791.876</span><span class="p">,</span><span class="w"> </span><span class="mi">2023</span><span class="mo">-01</span><span class="mi">-10-09</span><span class="o">:</span><span class="mi">15</span><span class="o">:</span><span class="mf">46.796.089</span><span class="p">,</span><span class="w"> </span><span class="mi">2023</span><span class="mo">-01</span><span class="mi">-10-09</span><span class="o">:</span><span class="mi">15</span><span class="o">:</span><span class="mf">46.797.952</span><span class="p">.</span>
<span class="p">[</span><span class="n">TRACE</span><span class="p">]</span><span class="w"> </span><span class="n">HCCL</span><span class="p">(</span><span class="mi">160186</span><span class="p">,</span><span class="n">python</span><span class="p">)</span><span class="o">:</span><span class="mi">2023</span><span class="mo">-01</span><span class="mi">-10-09</span><span class="o">:</span><span class="mi">25</span><span class="o">:</span><span class="mf">45.806.979</span><span class="w"> </span><span class="p">[</span><span class="n">status</span><span class="o">:</span><span class="n">stop</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="n">hcom</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">336</span><span class="p">][</span><span class="n">hccl</span><span class="mi">-160186-0-1673313336</span><span class="o">-</span><span class="n">hccl_world_group</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="n">hcom</span><span class="w"> </span><span class="n">destroy</span><span class="w"> </span><span class="n">complete</span><span class="p">,</span><span class="n">take</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="p">[</span><span class="mi">86560</span><span class="p">]</span><span class="n">us</span><span class="p">,</span><span class="w"> </span><span class="n">rankNum</span><span class="p">[</span><span class="mi">8</span><span class="p">],</span><span class="w"> </span><span class="n">rank</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="n">Traceback</span><span class="w"> </span><span class="p">(</span><span class="n">most</span><span class="w"> </span><span class="n">recent</span><span class="w"> </span><span class="n">call</span><span class="w"> </span><span class="n">last</span><span class="p">)</span><span class="o">:</span>
<span class="w">  </span><span class="n">File</span><span class="w"> </span><span class="s">&quot;train.py&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="mi">36</span><span class="p">,</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="o">&lt;</span><span class="k">module</span><span class="o">&gt;</span>
<span class="w">    </span><span class="n">dataset_base</span><span class="p">.</span><span class="n">op_network_with_tdt</span><span class="p">(</span><span class="n">ds</span><span class="p">,</span><span class="w"> </span><span class="n">epoch_num</span><span class="o">=</span><span class="n">beyond_epoch_num</span><span class="p">)</span>
<span class="w">  </span><span class="n">File</span><span class="w"> </span><span class="s">&quot;/home/jenkins/solution_test/common/ms_aw/function/data_processing/dataset_func.py&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="mi">375</span><span class="p">,</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">op_network_with_tdt</span>
<span class="w">    </span><span class="n">assert_iter_num</span><span class="o">=</span><span class="n">assert_iter_num</span><span class="p">)</span>
<span class="w">  </span><span class="n">File</span><span class="w"> </span><span class="s">&quot;/home/jenkins/solution_test/common/ms_aw/function/data_processing/dataset_func.py&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="mi">301</span><span class="p">,</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">op_network_with_create_dict_iterator</span>
<span class="w">    </span><span class="n">_</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">network</span><span class="p">()[</span><span class="mi">0</span><span class="p">]</span>
<span class="w">  </span><span class="n">File</span><span class="w"> </span><span class="s">&quot;/home/miniconda3/envs/ci/lib/python3.7/site-packages/mindspore/nn/cell.py&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="mi">618</span><span class="p">,</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">__call__</span>
<span class="w">    </span><span class="n">out</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">compile_and_run</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">)</span>
<span class="w">  </span><span class="n">File</span><span class="w"> </span><span class="s">&quot;/home/miniconda3/envs/ci/lib/python3.7/site-packages/mindspore/nn/cell.py&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="mi">1007</span><span class="p">,</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">compile_and_run</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">_cell_graph_executor</span><span class="p">(</span><span class="n">self</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">new_inputs</span><span class="p">,</span><span class="w"> </span><span class="n">phase</span><span class="o">=</span><span class="n">self</span><span class="p">.</span><span class="n">phase</span><span class="p">)</span>
<span class="w">  </span><span class="n">File</span><span class="w"> </span><span class="s">&quot;/home/miniconda3/envs/ci/lib/python3.7/site-packages/mindspore/common/api.py&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="mi">1192</span><span class="p">,</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">__call__</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">run</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="n">phase</span><span class="o">=</span><span class="n">phase</span><span class="p">)</span>
<span class="w">  </span><span class="n">File</span><span class="w"> </span><span class="s">&quot;/home/miniconda3/envs/ci/lib/python3.7/site-packages/mindspore/common/api.py&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="mi">1229</span><span class="p">,</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">run</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_exec_pip</span><span class="p">(</span><span class="n">obj</span><span class="p">,</span><span class="w"> </span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="n">phase</span><span class="o">=</span><span class="n">phase_real</span><span class="p">)</span>
<span class="w">  </span><span class="n">File</span><span class="w"> </span><span class="s">&quot;/home/miniconda3/envs/ci/lib/python3.7/site-packages/mindspore/common/api.py&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="mi">98</span><span class="p">,</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">wrapper</span>
<span class="w">    </span><span class="n">results</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">fn</span><span class="p">(</span><span class="o">*</span><span class="n">arg</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="w">  </span><span class="n">File</span><span class="w"> </span><span class="s">&quot;/home/miniconda3/envs/ci/lib/python3.7/site-packages/mindspore/common/api.py&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="mi">1211</span><span class="p">,</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">_exec_pip</span>
<span class="w">    </span><span class="k">return</span><span class="w"> </span><span class="n">self</span><span class="p">.</span><span class="n">_graph_executor</span><span class="p">(</span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="n">phase</span><span class="p">)</span>
<span class="nl">RuntimeError</span><span class="p">:</span><span class="w"> </span><span class="n">Run</span><span class="w"> </span><span class="n">task</span><span class="w"> </span><span class="n">error</span><span class="o">!</span>

<span class="o">----------------------------------------------------</span>
<span class="o">-</span><span class="w"> </span><span class="n">Ascend</span><span class="w"> </span><span class="n">Error</span><span class="w"> </span><span class="n">Message</span><span class="o">:</span>
<span class="o">----------------------------------------------------</span>
<span class="nl">EE9999</span><span class="p">:</span><span class="w"> </span><span class="n">Inner</span><span class="w"> </span><span class="n">Error</span><span class="p">,</span><span class="w"> </span><span class="n">Please</span><span class="w"> </span><span class="n">contact</span><span class="w"> </span><span class="n">support</span><span class="w"> </span><span class="n">engineer</span><span class="o">!</span>
<span class="n">EE9999</span><span class="w">  </span><span class="n">Task</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="n">failed</span><span class="p">,</span><span class="w"> </span><span class="n">base</span><span class="w"> </span><span class="n">info</span><span class="o">:</span><span class="w"> </span><span class="n">device_id</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">stream_id</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span><span class="w"> </span><span class="n">task_id</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span><span class="w"> </span><span class="n">flip_num</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span><span class="w"> </span><span class="n">task_type</span><span class="o">=</span><span class="mf">3.</span><span class="p">[</span><span class="n">FUNC</span><span class="o">:</span><span class="n">GetError</span><span class="p">][</span><span class="kt">FILE</span><span class="o">:</span><span class="n">stream</span><span class="p">.</span><span class="n">cc</span><span class="p">][</span><span class="n">LINE</span><span class="o">:</span><span class="mi">1044</span><span class="p">]</span>
<span class="w">        </span><span class="n">TraceBack</span><span class="w"> </span><span class="p">(</span><span class="n">most</span><span class="w"> </span><span class="n">recent</span><span class="w"> </span><span class="n">call</span><span class="w"> </span><span class="n">last</span><span class="p">)</span><span class="o">:</span>
<span class="w">        </span><span class="n">rtStreamSynchronize</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="n">failed</span><span class="p">,</span><span class="w"> </span><span class="n">reason</span><span class="o">=</span><span class="p">[</span><span class="n">the</span><span class="w"> </span><span class="n">model</span><span class="w"> </span><span class="n">stream</span><span class="w"> </span><span class="n">execute</span><span class="w"> </span><span class="n">failed</span><span class="p">][</span><span class="n">FUNC</span><span class="o">:</span><span class="n">FuncErrorReason</span><span class="p">][</span><span class="kt">FILE</span><span class="o">:</span><span class="n">error_message_manage</span><span class="p">.</span><span class="n">cc</span><span class="p">][</span><span class="n">LINE</span><span class="o">:</span><span class="mi">49</span><span class="p">]</span>

<span class="o">----------------------------------------------------</span>
<span class="o">-</span><span class="w"> </span><span class="n">C</span><span class="o">++</span><span class="w"> </span><span class="n">Call</span><span class="w"> </span><span class="n">Stack</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="n">For</span><span class="w"> </span><span class="n">framework</span><span class="w"> </span><span class="n">developers</span><span class="p">)</span>
<span class="o">----------------------------------------------------</span>
<span class="n">mindspore</span><span class="o">/</span><span class="n">ccsrc</span><span class="o">/</span><span class="n">plugin</span><span class="o">/</span><span class="n">device</span><span class="o">/</span><span class="n">ascend</span><span class="o">/</span><span class="n">hal</span><span class="o">/</span><span class="n">hardware</span><span class="o">/</span><span class="n">ascend_graph_executor</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">214</span><span class="w"> </span><span class="n">RunGraph</span>
</pre></div>
</div>
<p>一般此类错误有可能是GetNext取数据超时或者控制流、流分配等框架问题。用户可以先自行排查一下是否是GetNext取数据超时导致的问题，以下一些原因可能会导致GetNext取数据超时：</p>
<ol class="arabic simple">
<li><p>用户脚本中消费数据量大于生产数据量。</p></li>
<li><p>在执行多卡分布式程序时，其中某张卡的进程挂了可能会导致其他卡取数据超时。</p></li>
</ol>
<p>如果排查后不是GetNext取数据超时的问题，用户可以到<a class="reference external" href="https://gitee.com/mindspore">MindSpore社区</a>提交issue获取帮助。</p>
</section>
<section id="ee1001-device-id设置错误">
<h3>EE1001: device id设置错误<a class="headerlink" href="#ee1001-device-id设置错误" title="Permalink to this headline"></a></h3>
<p>用户可以通过环境变量DEVICE_ID或者在context中设置device_id来指定自己的程序跑在哪张卡上，如果device id设置不合理，则有可能会报<code class="docutils literal notranslate"><span class="pre">EE1001</span></code>错误，如下述错误场景，服务器中一共只有8张卡，可供选择的device id范围为[0, 8)，而用户错误设置了device_id=8：</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span>Traceback (most recent call last):
  File &quot;train.py&quot;, line 379, in &lt;module&gt;
    train_net()
  File &quot;/home/jenkins/ResNet/scripts/train/src/model_utils/moxing_adapter.py&quot;, line 104, in wrapped_func
    run_func(*args, **kwargs)
  File &quot;train.py&quot;, line 312, in train_net
    net = resnet(class_num=config.class_num)
  File &quot;/home/jenkins/ResNet/scripts/train/src/resnet.py&quot;, line 561, in resnet50
    class_num)
  File &quot;/home/jenkins/ResNet/scripts/train/src/resnet.py&quot;, line 381, in __init__
    super(ResNet, self).__init__()
  File &quot;/home/miniconda3/envs/ci/lib/python3.7/site-packages/mindspore/nn/cell.py&quot;, line 118, in __init__
    init_pipeline()
RuntimeError: Device 8 call rtSetDevice failed, ret[107001]. The details refer to &#39;Ascend Error Message&#39;.

----------------------------------------------------
- Ascend Error Message:
----------------------------------------------------
EE1001: The argument is invalid.Reason: Set device failed, invalid device, set device=8, valid device range is [0, 8)
        TraceBack (most recent call last):
        rtSetDevice execute failed, reason=[device id error][FUNC:FuncErrorReason][FILE:error_message_manage.cc][LINE:49]

(Please search &quot;Ascend Error Message&quot; at https://www.mindspore.cn for error code description)
</pre></div>
</div>
<p>遇到此类问题，根据错误日志排查device id的设置即可。</p>
</section>
</section>
<section id="hcclhccp常见问题">
<h2>HCCL&amp;HCCP常见问题<a class="headerlink" href="#hcclhccp常见问题" title="Permalink to this headline"></a></h2>
<p>HCCL(Huawei Collective Communication Library)是华为集合通信库，提供了深度学习训练场景中服务器间高性能集合通信功能，其通信过程分为如下三个阶段：</p>
<ol class="arabic simple">
<li><p>通信初始化：获取必要的集合通信参数配置并初始化网络设备。初始化阶段不涉及不同设备之前的交互。</p></li>
<li><p>建立通信连接：建立socket连接并交换通信两端的通信参数和内存信息。建立通信连接阶段，HCCL会根据用户提供的集群信息结合网络拓扑与其他卡进行建链并交换用于通信的参数信息。如果在建链超时时间阈值（MindSpore默认设置600s，可通过环境变量HCCL_CONNECT_TIMEOUT配置）内未得到其他卡的及时响应，会上报建链超时错误并退出训练。</p></li>
<li><p>执行通信操作：通过Notify同步设备执行状态，传递内存数据。通信操作执行阶段，HCCL会根据通信算法编排NOTIFY/SDMA等task并通过runtime下发给昇腾设备task调度器，设备根据编排信息调度并执行task。其中Notify类task用于卡间同步，Notify wait会阻塞task流执行直到对应的Notify record到达，以确保后续的通信操作执行时彼此的内存处于ready状态。</p></li>
</ol>
<p>HCCL&amp;HCCP的错误码以<code class="docutils literal notranslate"><span class="pre">EI</span></code>和<code class="docutils literal notranslate"><span class="pre">EJ</span></code>开头，在整个通信过程中，集群中出现的单卡问题、通信链路问题均可能会导致集群出现大量的超时错误，因此在定位集群通信问题时需要收集整个集群的日志信息，锁定问题出现的位置。</p>
<section id="ei0006-socket建链超时">
<h3>EI0006: socket建链超时<a class="headerlink" href="#ei0006-socket建链超时" title="Permalink to this headline"></a></h3>
<p>当socker建链超时时，会报<code class="docutils literal notranslate"><span class="pre">EI0006</span></code>错误码，同时MindSpore日志会出现<code class="docutils literal notranslate"><span class="pre">Distribute</span> <span class="pre">Task</span> <span class="pre">Failed</span></code>的报错，说明集群出现socket建链超时错误，如下述日志所示：</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span>[ERROR] ASCENDCL(83434,python):2022-11-30-23:31:08.729.325 [tensor_data_transfer.cpp:899]89062 acltdtSendTensor: [Push][Data]failed to send, tdt result = -1, device is 1, name is 62576f78-70c2-11ed-b633-000132214e48
[WARNING] DEVICE(83434,fffcf1ffb1e0,python):2022-11-30-23:31:08.986.720 [mindspore/ccsrc/plugin/device/ascend/hal/device/ascend_data_queue.cc:257] Push] Device queue thread had been interrupted by TdtHandle::DestroyHandle, you can ignore the above error: &#39;failed to send...&#39;. In this scenario, the training ends first without using all epoch(s) data, and the data preprocessing is blocked by the data transmission channel on the device side. So we force the data transmission channel to stop.
[WARNING] MD(83434,ffff852cf5d0,python):2022-11-30-23:31:08.999.090 [mindspore/ccsrc/minddata/dataset/engine/datasetops/data_queue_op.cc:93] ~DataQueueOp] preprocess_batch: 49; batch_queue: 0, 0, 0, 0, 0, 0, 0, 0, 0, 64; push_start_time: 2022-11-30-23:19:41.234.869, 2022-11-30-23:19:41.273.919, 2022-11-30-23:19:41.333.753, 2022-11-30-23:19:41.415.529, 2022-11-30-23:19:41.479.177, 2022-11-30-23:19:41.557.576, 2022-11-30-23:19:41.605.967, 2022-11-30-23:19:41.682.957, 2022-11-30-23:19:41.719.645, 2022-11-30-23:19:41.785.832; push_end_time: 2022-11-30-23:19:41.245.668, 2022-11-30-23:19:41.284.989, 2022-11-30-23:19:41.344.248, 2022-11-30-23:19:41.430.124, 2022-11-30-23:19:41.491.263, 2022-11-30-23:19:41.569.235, 2022-11-30-23:19:41.624.471, 2022-11-30-23:19:41.700.708, 2022-11-30-23:19:41.735.413, 2022-11-30-23:31:08.986.853.
[TRACE] HCCL(83434,python):2022-11-30-23:31:10.455.138 [status:stop] [hcom.cc:264][hccl-83434-0-1669821563-hccl_world_group][1]hcom destroy complete,take time [323391]us, rankNum[8], rank[1]
Traceback (most recent call last):
  File &quot;train.py&quot;, line 377, in &lt;module&gt;
    train_net()
  File &quot;/home/jenkins/solution_test/remaining/test_scripts/process/train_parallel1/src/model_utils/moxing_adapter.py&quot;, line 104, in wrapped_func
    run_func(*args, **kwargs)
  File &quot;train.py&quot;, line 370, in train_net
    sink_size=100, dataset_sink_mode=dataset_sink_mode)
  File &quot;/home/miniconda3/envs/ci/lib/python3.7/site-packages/mindspore/train/model.py&quot;, line 1052, in train
    initial_epoch=initial_epoch)
  File &quot;/home/miniconda3/envs/ci/lib/python3.7/site-packages/mindspore/train/model.py&quot;, line 98, in wrapper
    func(self, *args, **kwargs)
  File &quot;/home/miniconda3/envs/ci/lib/python3.7/site-packages/mindspore/train/model.py&quot;, line 614, in _train
    cb_params, sink_size, initial_epoch, valid_infos)
  File &quot;/home/miniconda3/envs/ci/lib/python3.7/site-packages/mindspore/train/model.py&quot;, line 692, in _train_dataset_sink_process
    outputs = train_network(*inputs)
  File &quot;/home/miniconda3/envs/ci/lib/python3.7/site-packages/mindspore/nn/cell.py&quot;, line 627, in __call__
    out = self.compile_and_run(*args)
  File &quot;/home/miniconda3/envs/ci/lib/python3.7/site-packages/mindspore/nn/cell.py&quot;, line 945, in compile_and_run
    self.compile(*inputs)
  File &quot;/home/miniconda3/envs/ci/lib/python3.7/site-packages/mindspore/nn/cell.py&quot;, line 919, in compile
    jit_config_dict=self._jit_config_dict)
  File &quot;/home/miniconda3/envs/ci/lib/python3.7/site-packages/mindspore/common/api.py&quot;, line 1347, in compile
    result = self._graph_executor.compile(obj, args_list, phase, self._use_vm_mode())
RuntimeError: Preprocess failed before run graph 1. The details refer to &#39;Ascend Error Message&#39;.

----------------------------------------------------
- Ascend Error Message:
----------------------------------------------------
EI0006: Getting socket times out. Reason: 1. The remote does not initiate a connect request. some NPUs in the cluster are abnormal.    2. The remote does not initiate a connect request because the collective communication operator is started too late or is not started by some NPU in the cluster.    3. The communication link is disconnected. (For example, the IP addresses are not on the same network segment or the TLS configurations are inconsistent.)
        Solution: 1. Check the rank service processes with other errors or no errors in the cluster.2. If this error is reported for all NPUs, check whether the time difference between the earliest and latest errors is greater than the connect timeout interval (120s by default). If so, adjust the timeout interval by using the HCCL_CONNECT_TIMEOUT environment variable.3. Check the connectivity of the communication link between nodes. (For details, see the TLS command and HCCN connectivity check examples.)

(Please search &quot;Ascend Error Message&quot; at https://www.mindspore.cn for error code description)

----------------------------------------------------
- Framework Error Message: (For framework developers)
----------------------------------------------------
Distribute Task Failed,
error msg: davinci_model : load task fail, return ret: 1343225860
</pre></div>
</div>
<p>如日志中所说，socket建链超时常见的的原因有：</p>
<ol class="arabic simple">
<li><p>部分卡未执行到正确的建链阶段，在之前已出错；</p></li>
<li><p>部分卡被某些耗时较长的任务阻塞，在超过600秒（可通过HCCL_CONNECT_TIMEOUT配置）后才执行到对应阶段；</p></li>
<li><p>节点间通信链路不通或者不稳定。</p></li>
</ol>
<p>在收集了集群所有卡的INFO日志（包括CANN日志）后，可以按照以下步骤进行排查：</p>
<ol class="arabic">
<li><p>检查所有卡的报错日志，若有卡未报socket建链超时错误，可以通过日志时间检查判断此卡是否存在业务进程报错退出、卡死或core宕机的情况导致集群socket建链超时，然后转单卡问题定位；</p></li>
<li><p>若所有卡均上报socket建链超时错误，则检查各卡的错误日志中最早和最晚的时间差异是否超过超时阈值，若超过阈值请定位报错时间最晚的rank执行阻塞原因或者调整超时阈值（MindSpore默认设置为600秒，通过环境变量HCCL_CONNECT_TIMEOUT设置）；</p></li>
<li><p>检查集群中是否存在Device网口通信链路不通的情况，比较常见的原因：</p>
<p>a. IP不在同一网段或子网掩码配置存在问题；</p>
<p>b. IP冲突，集群中存在IP相同的两个rank；</p>
<p>c. 各rank的TLS(安全增强)设置不一致。</p>
</li>
</ol>
</section>
<section id="ei0002-notify-wait超时">
<h3>EI0002: notify wait超时<a class="headerlink" href="#ei0002-notify-wait超时" title="Permalink to this headline"></a></h3>
<p>常见于执行阶段，HCCL算子的task会在指定集群的每个Device上执行，并通过notify进行状态同步，若任何一张卡或者通信链路在执行前/中发生异常，则会导致集群同步失败，剩余卡会出现notify wait超时，报<code class="docutils literal notranslate"><span class="pre">EI0002</span></code>错误，如下所示：</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span>[ERROR] ASCENDCL(162844,python):2022-12-01-00:26:58.086.834 [tensor_data_transfer.cpp:899]168498 acltdtSendTensor: [Push][Data]failed to send, tdt result = -1, device is 1, name is 1393be34-70ca-11ed-9be5-000132214e48
[WARNING] DEVICE(162844,fffce77fe1e0,python):2022-12-01-00:26:58.388.563 [mindspore/ccsrc/plugin/device/ascend/hal/device/ascend_data_queue.cc:257] Push] Device queue thread had been interrupted by TdtHandle::DestroyHandle, you can ignore the above error: &#39;failed to send...&#39;. In this scenario, the training ends first without using all epoch(s) data, and the data preprocessing is blocked by the data transmission channel on the device side. So we force the data transmission channel to stop.
[CRITICAL] DEVICE(162844,fffd6cff91e0,python):2022-12-01-00:26:58.399.787 [mindspore/ccsrc/plugin/device/ascend/hal/hardware/ascend_graph_executor.cc:240] RunGraph] Run task for graph:kernel_graph_1 error! The details refer to &#39;Ascend Error Message&#39;.Ascend Error Message:EI0002: The wait execution of the Notify register times out. Reason: The Notify register has not received the Notify record from remote rank [0].base information: [streamID:[14], taskID[4], taskType[Notify Wait], tag[HcomAllReduce_6629421139219749105_0].] task information: [notify id:[0x0000000100000058], stage:[ffffffff], remote rank:[0].
there are(is) 1 abnormal device(s):
        serverId[10.*.*.*], deviceId[0], Heartbeat Lost Occurred, Possible Reason: 1. Process has exited, 2. Network Disconnected
]
        Possible Cause: 1. An exception occurs during the execution on some NPUs in the cluster. As a result, collective communication operation failed.2. The execution speed on some NPU in the cluster is too slow to complete a communication operation within the timeout interval. (default 1800s, You can set the interval by using HCCL_EXEC_TIMEOUT.)3. The number of training samples of each NPU is inconsistent.4. Packet loss or other connectivity problems occur on the communication link.
        Solution: 1. If this error is reported on part of these ranks, check other ranks to see whether other errors have been reported earlier.2. If this error is reported for all ranks, check whether the error reporting time is consistent (the maximum difference must not exceed 1800s). If not, locate the cause or adjust the locate the cause or set the HCCL_EXEC_TIMEOUT environment variable to a larger value.3. Check whether the completion queue element (CQE) of the error exists in the plog(grep -rn &#39;error cqe&#39;). If so, check the network connection status. (For details, see the TLS command and HCCN connectivity check examples.)4. Ensure that the number of training samples of each NPU is consistent.
        TraceBack (most recent call last):
        Notify wait execute failed, device_id=1, stream_id=14, task_id=4, flip_num=0, notify_id=11[FUNC:GetError][FILE:stream.cc][LINE:921]
        rtStreamSynchronize execute failed, reason=[the model stream execute failed][FUNC:FuncErrorReason][FILE:error_message_manage.cc][LINE:49]

(Please search &quot;Ascend Error Message&quot; at https://www.mindspore.cn for error code description)
[WARNING] MD(162844,fffce77fe1e0,python):2022-12-01-00:26:58.399.793 [mindspore/ccsrc/minddata/dataset/engine/datasetops/data_queue_op.cc:257] SendDataToAscend] Thread has already been terminated.
malloc_consolidate(): invalid chunk size
</pre></div>
</div>
<p>如日志中所说，notify wait超时常见的的原因有：</p>
<ol class="arabic simple">
<li><p>部分卡未能成功执行到notify同步阶段，在之前已出错；</p></li>
<li><p>部分卡被某些耗时较长的任务阻塞，在超过1800秒（可通过HCCL_EXEC_TIMEOUT配置）后才执行到对应阶段；</p></li>
<li><p>网络模型等原因导致某些卡间的task执行序列不一致；</p></li>
<li><p>节点间通信链路不稳定。</p></li>
</ol>
<p>在收集了集群所有卡的INFO日志（包括CANN日志）后，可以按照以下步骤进行排查：</p>
<ol class="arabic simple">
<li><p>检查所有卡的报错日志，若有卡未报notify wait超时错误，可以通过日志时间检查判断此卡是否存在业务进程报错退出、卡死或core宕机的情况导致集群notify wait超时，然后转单卡问题定位；</p></li>
<li><p>若所有卡均上报notify wait超时错误，则检查各卡的错误日志中最早和最晚的时间差异是否超过超时阈值，若超过阈值请定位报错时间最晚的rank执行阻塞原因（如save checkpoint）或者调整超时阈值（默认为1800秒，通过环境变量HCCL_EXEC_TIMEOUT设置）；</p></li>
<li><p>检查集群中是否存在Device网口通信链路不稳定的情况，排查所有卡的Device侧日志，若存在error cqe的打印且时间位于业务区间内，则请定位网络丢包的原因。</p></li>
</ol>
</section>
<section id="ei0004-非法ranktable配置">
<h3>EI0004: 非法ranktable配置<a class="headerlink" href="#ei0004-非法ranktable配置" title="Permalink to this headline"></a></h3>
<p>用户需要通过ranktable文件来配置分布式训练需要的多机多卡信息以供HCCL初始化，若相关ranktable配置非法，则会报<code class="docutils literal notranslate"><span class="pre">EI0004</span></code>错误，如下述报错场景，ranktable中重复设置了两个device_id为1，导致配置非法：</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">WARNING</span><span class="p">]</span><span class="w"> </span><span class="n">HCCL_ADPT</span><span class="p">(</span><span class="mi">89999</span><span class="p">,</span><span class="n">ffffa5a47010</span><span class="p">,</span><span class="n">python</span><span class="p">)</span><span class="o">:</span><span class="mi">2023</span><span class="mo">-01</span><span class="mi">-16-20</span><span class="o">:</span><span class="mi">43</span><span class="o">:</span><span class="mf">48.480.465</span><span class="w"> </span><span class="p">[</span><span class="n">mindspore</span><span class="o">/</span><span class="n">ccsrc</span><span class="o">/</span><span class="n">plugin</span><span class="o">/</span><span class="n">device</span><span class="o">/</span><span class="n">ascend</span><span class="o">/</span><span class="n">hal</span><span class="o">/</span><span class="n">hccl_adapter</span><span class="o">/</span><span class="n">hccl_adapter</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">47</span><span class="p">]</span><span class="w"> </span><span class="n">GenHcclOptions</span><span class="p">]</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="n">environment</span><span class="w"> </span><span class="n">variable</span><span class="w"> </span><span class="n">DEPLOY_MODE</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="n">set</span><span class="p">.</span><span class="w"> </span><span class="n">Now</span><span class="w"> </span><span class="n">set</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="k">default</span><span class="w"> </span><span class="n">value</span><span class="w"> </span><span class="mi">0</span>

<span class="n">Traceback</span><span class="w"> </span><span class="p">(</span><span class="n">most</span><span class="w"> </span><span class="n">recent</span><span class="w"> </span><span class="n">call</span><span class="w"> </span><span class="n">last</span><span class="p">)</span><span class="o">:</span>
<span class="w">  </span><span class="n">File</span><span class="w"> </span><span class="s">&quot;train.py&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="mi">379</span><span class="p">,</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="o">&lt;</span><span class="k">module</span><span class="o">&gt;</span>
<span class="w">    </span><span class="n">train_net</span><span class="p">()</span>
<span class="w">  </span><span class="n">File</span><span class="w"> </span><span class="s">&quot;/home/jenkins/ResNet/scripts/train_parallel0/src/model_utils/moxing_adapter.py&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="mi">104</span><span class="p">,</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">wrapped_func</span>
<span class="w">    </span><span class="n">run_func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="w">  </span><span class="n">File</span><span class="w"> </span><span class="s">&quot;train.py&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="mi">305</span><span class="p">,</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">train_net</span>
<span class="w">    </span><span class="n">set_parameter</span><span class="p">()</span>
<span class="w">  </span><span class="n">File</span><span class="w"> </span><span class="s">&quot;train.py&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="mi">151</span><span class="p">,</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">set_parameter</span>
<span class="w">    </span><span class="n">init</span><span class="p">()</span>
<span class="w">  </span><span class="n">File</span><span class="w"> </span><span class="s">&quot;/home/miniconda3/envs/ci/lib/python3.7/site-packages/mindspore/communication/management.py&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="mi">161</span><span class="p">,</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">init</span>
<span class="w">    </span><span class="n">init_hccl</span><span class="p">()</span>
<span class="nl">RuntimeError</span><span class="p">:</span><span class="w"> </span><span class="n">Ascend</span><span class="w"> </span><span class="n">collective</span><span class="w"> </span><span class="n">communication</span><span class="w"> </span><span class="n">initialization</span><span class="w"> </span><span class="n">failed</span><span class="p">.</span>

<span class="o">----------------------------------------------------</span>
<span class="o">-</span><span class="w"> </span><span class="n">Ascend</span><span class="w"> </span><span class="n">Error</span><span class="w"> </span><span class="n">Message</span><span class="o">:</span>
<span class="o">----------------------------------------------------</span>
<span class="nl">EI0004</span><span class="p">:</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="n">ranktable</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">invalid</span><span class="p">,</span><span class="n">Reason</span><span class="o">:</span><span class="p">[</span><span class="n">The</span><span class="w"> </span><span class="n">ranktable</span><span class="w"> </span><span class="n">config</span><span class="w"> </span><span class="n">devId</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">inconsistent</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">local</span><span class="w"> </span><span class="n">devId</span><span class="p">.].</span><span class="w"> </span><span class="n">Please</span><span class="w"> </span><span class="n">check</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">configured</span><span class="w"> </span><span class="n">ranktable</span><span class="p">.</span><span class="w"> </span><span class="p">[{</span><span class="s">&quot;server_count&quot;</span><span class="o">:</span><span class="s">&quot;1&quot;</span><span class="p">,</span><span class="s">&quot;server_list&quot;</span><span class="o">:</span><span class="p">[{</span><span class="s">&quot;device&quot;</span><span class="o">:</span><span class="p">[{</span><span class="s">&quot;device_id&quot;</span><span class="o">:</span><span class="s">&quot;1&quot;</span><span class="p">,</span><span class="s">&quot;device_ip&quot;</span><span class="o">:</span><span class="s">&quot;192.168.100.101&quot;</span><span class="p">,</span><span class="s">&quot;rank_id&quot;</span><span class="o">:</span><span class="s">&quot;0&quot;</span><span class="p">},{</span><span class="s">&quot;device_id&quot;</span><span class="o">:</span><span class="s">&quot;1&quot;</span><span class="p">,</span><span class="s">&quot;device_ip&quot;</span><span class="o">:</span><span class="s">&quot;192.168.101.101&quot;</span><span class="p">,</span><span class="s">&quot;rank_id&quot;</span><span class="o">:</span><span class="s">&quot;1&quot;</span><span class="p">},{</span><span class="s">&quot;device_id&quot;</span><span class="o">:</span><span class="s">&quot;2&quot;</span><span class="p">,</span><span class="s">&quot;device_ip&quot;</span><span class="o">:</span><span class="s">&quot;192.168.102.101&quot;</span><span class="p">,</span><span class="s">&quot;rank_id&quot;</span><span class="o">:</span><span class="s">&quot;2&quot;</span><span class="p">},{</span><span class="s">&quot;device_id&quot;</span><span class="o">:</span><span class="s">&quot;3&quot;</span><span class="p">,</span><span class="s">&quot;device_ip&quot;</span><span class="o">:</span><span class="s">&quot;192.168.103.101&quot;</span><span class="p">,</span><span class="s">&quot;rank_id&quot;</span><span class="o">:</span><span class="s">&quot;3&quot;</span><span class="p">},{</span><span class="s">&quot;device_id&quot;</span><span class="o">:</span><span class="s">&quot;4&quot;</span><span class="p">,</span><span class="s">&quot;device_ip&quot;</span><span class="o">:</span><span class="s">&quot;192.168.100.102&quot;</span><span class="p">,</span><span class="s">&quot;rank_id&quot;</span><span class="o">:</span><span class="s">&quot;4&quot;</span><span class="p">},{</span><span class="s">&quot;device_id&quot;</span><span class="o">:</span><span class="s">&quot;5&quot;</span><span class="p">,</span><span class="s">&quot;device_ip&quot;</span><span class="o">:</span><span class="s">&quot;192.168.101.102&quot;</span><span class="p">,</span><span class="s">&quot;rank_id&quot;</span><span class="o">:</span><span class="s">&quot;5&quot;</span><span class="p">},{</span><span class="s">&quot;device_id&quot;</span><span class="o">:</span><span class="s">&quot;6&quot;</span><span class="p">,</span><span class="s">&quot;device_ip&quot;</span><span class="o">:</span><span class="s">&quot;192.168.102.102&quot;</span><span class="p">,</span><span class="s">&quot;rank_id&quot;</span><span class="o">:</span><span class="s">&quot;6&quot;</span><span class="p">},{</span><span class="s">&quot;device_id&quot;</span><span class="o">:</span><span class="s">&quot;7&quot;</span><span class="p">,</span><span class="s">&quot;device_ip&quot;</span><span class="o">:</span><span class="s">&quot;192.168.103.102&quot;</span><span class="p">,</span><span class="s">&quot;rank_id&quot;</span><span class="o">:</span><span class="s">&quot;7&quot;</span><span class="p">}],</span><span class="s">&quot;host_nic_ip&quot;</span><span class="o">:</span><span class="s">&quot;reserve&quot;</span><span class="p">,</span><span class="s">&quot;server_id&quot;</span><span class="o">:</span><span class="s">&quot;10.*.*.*&quot;</span><span class="p">}],</span><span class="s">&quot;status&quot;</span><span class="o">:</span><span class="s">&quot;completed&quot;</span><span class="p">,</span><span class="s">&quot;version&quot;</span><span class="o">:</span><span class="s">&quot;1.0&quot;</span><span class="p">}]</span>
<span class="w">        </span><span class="nl">Solution</span><span class="p">:</span><span class="w"> </span><span class="n">Try</span><span class="w"> </span><span class="n">again</span><span class="w"> </span><span class="n">with</span><span class="w"> </span><span class="n">a</span><span class="w"> </span><span class="n">valid</span><span class="w"> </span><span class="n">cluster</span><span class="w"> </span><span class="n">configuration</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">ranktable</span><span class="w"> </span><span class="n">file</span><span class="p">.</span><span class="w"> </span><span class="n">Ensure</span><span class="w"> </span><span class="n">that</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">configuration</span><span class="w"> </span><span class="n">matches</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">operating</span><span class="w"> </span><span class="n">environment</span><span class="p">.</span>

<span class="p">(</span><span class="n">Please</span><span class="w"> </span><span class="n">search</span><span class="w"> </span><span class="s">&quot;Ascend Error Message&quot;</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">https</span><span class="o">:</span><span class="c1">//www.mindspore.cn for error code description)</span>

<span class="o">----------------------------------------------------</span>
<span class="o">-</span><span class="w"> </span><span class="n">Framework</span><span class="w"> </span><span class="n">Error</span><span class="w"> </span><span class="n">Message</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="n">For</span><span class="w"> </span><span class="n">framework</span><span class="w"> </span><span class="n">developers</span><span class="p">)</span>
<span class="o">----------------------------------------------------</span>
<span class="n">Init</span><span class="w"> </span><span class="n">hccl</span><span class="w"> </span><span class="n">graph</span><span class="w"> </span><span class="n">adapter</span><span class="w"> </span><span class="n">failed</span><span class="p">.</span>

<span class="o">----------------------------------------------------</span>
<span class="o">-</span><span class="w"> </span><span class="n">C</span><span class="o">++</span><span class="w"> </span><span class="n">Call</span><span class="w"> </span><span class="n">Stack</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="n">For</span><span class="w"> </span><span class="n">framework</span><span class="w"> </span><span class="n">developers</span><span class="p">)</span>
<span class="o">----------------------------------------------------</span>
<span class="n">mindspore</span><span class="o">/</span><span class="n">ccsrc</span><span class="o">/</span><span class="n">plugin</span><span class="o">/</span><span class="n">device</span><span class="o">/</span><span class="n">ascend</span><span class="o">/</span><span class="n">hal</span><span class="o">/</span><span class="n">hardware</span><span class="o">/</span><span class="n">ascend_collective_comm_lib</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">112</span><span class="w"> </span><span class="n">Initialize</span>
<span class="n">mindspore</span><span class="o">/</span><span class="n">ccsrc</span><span class="o">/</span><span class="n">plugin</span><span class="o">/</span><span class="n">device</span><span class="o">/</span><span class="n">ascend</span><span class="o">/</span><span class="n">hal</span><span class="o">/</span><span class="n">hccl_adapter</span><span class="o">/</span><span class="n">hccl_adapter</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">402</span><span class="w"> </span><span class="n">InitKernelInfoStore</span>
</pre></div>
</div>
<p>遇到此类报错，根据报错日志对ranktable配置文件进行修正即可。</p>
</section>
<section id="ei0005-卡间通信参数不一致">
<h3>EI0005: 卡间通信参数不一致<a class="headerlink" href="#ei0005-卡间通信参数不一致" title="Permalink to this headline"></a></h3>
<p>当卡间通信参数不一致，比如卡间用于AllReduce的输入shape大小不一致时，就会报<code class="docutils literal notranslate"><span class="pre">EI0005</span></code>错误，如下述报错场景，有个名为count的parameter在卡间通信时大小不一致：</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span>[WARNING] HCCL_ADPT(50288,ffff8fec4010,python):2023-01-16-20:37:22.585.027 [mindspore/ccsrc/plugin/device/ascend/hal/hccl_adapter/hccl_adapter.cc:47] GenHcclOptions] The environment variable DEPLOY_MODE is not set. Now set to default value 0
[WARNING] MD(50288,fffe35f4b0f0,python):2023-01-16-20:38:57.747.318 [mindspore/ccsrc/minddata/dataset/engine/datasetops/source/generator_op.cc:198] operator()] Bad performance attention, it takes more than 25 seconds to generator.__next__ new row, which might cause `GetNext` timeout problem when sink_mode=True. You can increase the parameter num_parallel_workers in GeneratorDataset / optimize the efficiency of obtaining samples in the user-defined generator function.
dataset length:  848
data pre-process time is 0.2904245853424072

Traceback (most recent call last):
  File &quot;e2e_feed_dev.py&quot;, line 294, in &lt;module&gt;
    run()
  File &quot;e2e_feed_dev.py&quot;, line 277, in run
    label_indices, label_values)
  File &quot;/home/miniconda3/envs/ci/lib/python3.7/site-packages/mindspore/nn/cell.py&quot;, line 626, in __call__
    out = self.compile_and_run(*args)
  File &quot;/home/miniconda3/envs/ci/lib/python3.7/site-packages/mindspore/nn/cell.py&quot;, line 945, in compile_and_run
    self.compile(*inputs)
  File &quot;/home/miniconda3/envs/ci/lib/python3.7/site-packages/mindspore/nn/cell.py&quot;, line 919, in compile
    jit_config_dict=self._jit_config_dict)
  File &quot;/home/miniconda3/envs/ci/lib/python3.7/site-packages/mindspore/common/api.py&quot;, line 1337, in compile
    result = self._graph_executor.compile(obj, args_list, phase, self._use_vm_mode())
RuntimeError: Preprocess failed before run graph 0. The details refer to &#39;Ascend Error Message&#39;.

----------------------------------------------------
- Ascend Error Message:
----------------------------------------------------
EI0005: The arguments for collective communication are inconsistent between ranks: tag [HcomAllReduce_6629421139219749105_0], parameter [count], local [9556480], remote [9555712]
        Solution: Check whether the training script and ranktable of each NPU are consistent.

(Please search &quot;Ascend Error Message&quot; at https://www.mindspore.cn for error code description)

----------------------------------------------------
- Framework Error Message: (For framework developers)
----------------------------------------------------
Distribute Task Failed,
error msg: davinci_model : load task fail, return ret: 1343225860

----------------------------------------------------
- C++ Call Stack: (For framework developers)
----------------------------------------------------
mindspore/ccsrc/plugin/device/ascend/hal/hardware/ascend_kernel_executor.cc:206 PreprocessBeforeRunGraph
mindspore/ccsrc/plugin/device/ascend/hal/device/ascend_kernel_runtime.cc:578 LoadTask
mindspore/ccsrc/plugin/device/ascend/hal/device/ge_runtime/task/hccl_task.cc:104 Distribute
</pre></div>
</div>
<p>遇到此类报错，可通过日志和IR图确认出错的通信参数，并在网络脚本中予以修正。</p>
</section>
<section id="ej0001-hccp初始化失败">
<h3>EJ0001: HCCP初始化失败<a class="headerlink" href="#ej0001-hccp初始化失败" title="Permalink to this headline"></a></h3>
<p>HCCP进程负责实现通信功能，HCCL可以调用HCCP的接口进行通信。HCCP初始化失败会报<code class="docutils literal notranslate"><span class="pre">EJ0001</span></code>错误，比如以下场景，当上一个八卡训练任务还未结束时就在同一服务器启动新的八卡训练任务就会导致初始化失败，需要等之前的八卡训练任务结束后才能启动新的八卡训练任务。</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">ERROR</span><span class="p">]</span><span class="w"> </span><span class="n">HCCL</span><span class="p">(</span><span class="mi">17381</span><span class="p">,</span><span class="n">python</span><span class="p">)</span><span class="o">:</span><span class="mi">2022-12</span><span class="mo">-01-03</span><span class="o">:</span><span class="mo">02</span><span class="o">:</span><span class="mf">29.001.054</span><span class="w"> </span><span class="p">[</span><span class="n">network_manager</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">64</span><span class="p">][</span><span class="n">hccl</span><span class="mi">-17381-0-1669834948</span><span class="o">-</span><span class="n">hccl_world_group</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="n">call</span><span class="w"> </span><span class="n">trace</span><span class="o">:</span><span class="w"> </span><span class="n">ret</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="mi">7</span>
<span class="p">[</span><span class="n">ERROR</span><span class="p">]</span><span class="w"> </span><span class="n">HCCL</span><span class="p">(</span><span class="mi">17381</span><span class="p">,</span><span class="n">python</span><span class="p">)</span><span class="o">:</span><span class="mi">2022-12</span><span class="mo">-01-03</span><span class="o">:</span><span class="mo">02</span><span class="o">:</span><span class="mf">29.001.066</span><span class="w"> </span><span class="p">[</span><span class="n">hccl_impl_base</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">239</span><span class="p">][</span><span class="n">hccl</span><span class="mi">-17381-0-1669834948</span><span class="o">-</span><span class="n">hccl_world_group</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="n">call</span><span class="w"> </span><span class="n">trace</span><span class="o">:</span><span class="w"> </span><span class="n">ret</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="mi">7</span>
<span class="p">[</span><span class="n">ERROR</span><span class="p">]</span><span class="w"> </span><span class="n">HCCL</span><span class="p">(</span><span class="mi">17381</span><span class="p">,</span><span class="n">python</span><span class="p">)</span><span class="o">:</span><span class="mi">2022-12</span><span class="mo">-01-03</span><span class="o">:</span><span class="mo">02</span><span class="o">:</span><span class="mf">29.001.076</span><span class="w"> </span><span class="p">[</span><span class="n">hccl_impl</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">731</span><span class="p">][</span><span class="n">hccl</span><span class="mi">-17381-0-1669834948</span><span class="o">-</span><span class="n">hccl_world_group</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="n">call</span><span class="w"> </span><span class="n">trace</span><span class="o">:</span><span class="w"> </span><span class="n">ret</span><span class="w"> </span><span class="o">-&gt;</span><span class="w"> </span><span class="mi">7</span>
<span class="p">[</span><span class="n">ERROR</span><span class="p">]</span><span class="w"> </span><span class="n">HCCL</span><span class="p">(</span><span class="mi">17381</span><span class="p">,</span><span class="n">python</span><span class="p">)</span><span class="o">:</span><span class="mi">2022-12</span><span class="mo">-01-03</span><span class="o">:</span><span class="mo">02</span><span class="o">:</span><span class="mf">29.001.104</span><span class="w"> </span><span class="p">[</span><span class="n">hccl_comm</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">100</span><span class="p">][</span><span class="n">hccl</span><span class="mi">-17381-0-1669834948</span><span class="o">-</span><span class="n">hccl_world_group</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">HcclComm</span><span class="p">][</span><span class="n">Init</span><span class="p">]</span><span class="n">errNo</span><span class="p">[</span><span class="mh">0x0000000005000007</span><span class="p">]</span><span class="w"> </span><span class="n">hccl</span><span class="w"> </span><span class="n">initialize</span><span class="w"> </span><span class="n">failed</span>
<span class="p">[</span><span class="n">ERROR</span><span class="p">]</span><span class="w"> </span><span class="n">HCCL</span><span class="p">(</span><span class="mi">17381</span><span class="p">,</span><span class="n">python</span><span class="p">)</span><span class="o">:</span><span class="mi">2022-12</span><span class="mo">-01-03</span><span class="o">:</span><span class="mo">02</span><span class="o">:</span><span class="mf">29.001.116</span><span class="w"> </span><span class="p">[</span><span class="n">hcom</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">80</span><span class="p">][</span><span class="n">hccl</span><span class="mi">-17381-0-1669834948</span><span class="o">-</span><span class="n">hccl_world_group</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">Init</span><span class="p">][</span><span class="n">Result</span><span class="p">]</span><span class="n">errNo</span><span class="p">[</span><span class="mh">0x0000000005010007</span><span class="p">]</span><span class="w"> </span><span class="n">hcclComm</span><span class="w"> </span><span class="n">init</span><span class="w"> </span><span class="n">error</span>
<span class="p">[</span><span class="n">ERROR</span><span class="p">]</span><span class="w"> </span><span class="n">HCCL</span><span class="p">(</span><span class="mi">17381</span><span class="p">,</span><span class="n">python</span><span class="p">)</span><span class="o">:</span><span class="mi">2022-12</span><span class="mo">-01-03</span><span class="o">:</span><span class="mo">02</span><span class="o">:</span><span class="mf">29.001.129</span><span class="w"> </span><span class="p">[</span><span class="n">hcom</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">94</span><span class="p">][</span><span class="n">hccl</span><span class="mi">-17381-0-1669834948</span><span class="o">-</span><span class="n">hccl_world_group</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">Init</span><span class="p">][</span><span class="n">Result</span><span class="p">]</span><span class="n">hcom</span><span class="w"> </span><span class="n">init</span><span class="w"> </span><span class="n">failed</span><span class="p">,</span><span class="w"> </span><span class="n">rankNum</span><span class="p">[</span><span class="mi">8</span><span class="p">],</span><span class="w"> </span><span class="n">rank</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="n">server</span><span class="p">[</span><span class="mf">10.</span><span class="o">*</span><span class="p">.</span><span class="o">*</span><span class="p">.</span><span class="o">*</span><span class="p">],</span><span class="w"> </span><span class="n">device</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span><span class="w"> </span><span class="k">return</span><span class="p">[</span><span class="mi">83951623</span><span class="p">]</span>
<span class="p">[</span><span class="n">TRACE</span><span class="p">]</span><span class="w"> </span><span class="n">HCCL</span><span class="p">(</span><span class="mi">17381</span><span class="p">,</span><span class="n">python</span><span class="p">)</span><span class="o">:</span><span class="mi">2022-12</span><span class="mo">-01-03</span><span class="o">:</span><span class="mo">02</span><span class="o">:</span><span class="mf">29.001.628</span><span class="w"> </span><span class="p">[</span><span class="n">status</span><span class="o">:</span><span class="n">stop</span><span class="p">]</span><span class="w"> </span><span class="p">[</span><span class="n">hcom</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">264</span><span class="p">][</span><span class="n">hccl</span><span class="mi">-17381-0-1669834948</span><span class="o">-</span><span class="n">hccl_world_group</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span><span class="n">hcom</span><span class="w"> </span><span class="n">destroy</span><span class="w"> </span><span class="n">complete</span><span class="p">,</span><span class="n">take</span><span class="w"> </span><span class="n">time</span><span class="w"> </span><span class="p">[</span><span class="mi">486</span><span class="p">]</span><span class="n">us</span><span class="p">,</span><span class="w"> </span><span class="n">rankNum</span><span class="p">[</span><span class="mi">8</span><span class="p">],</span><span class="w"> </span><span class="n">rank</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
<span class="p">[</span><span class="n">ERROR</span><span class="p">]</span><span class="w"> </span><span class="n">HCCL</span><span class="p">(</span><span class="mi">17381</span><span class="p">,</span><span class="n">python</span><span class="p">)</span><span class="o">:</span><span class="mi">2022-12</span><span class="mo">-01-03</span><span class="o">:</span><span class="mo">02</span><span class="o">:</span><span class="mf">29.001.645</span><span class="w"> </span><span class="p">[</span><span class="n">hcom</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">190</span><span class="p">][</span><span class="n">hccl</span><span class="mi">-17381-0-1669834948</span><span class="o">-</span><span class="n">hccl_world_group</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">HcomInitByFile</span><span class="p">]</span><span class="n">errNo</span><span class="p">[</span><span class="mh">0x0000000005000007</span><span class="p">]</span><span class="w"> </span><span class="n">rankTablePath</span><span class="p">[</span><span class="o">/</span><span class="n">ms_test</span><span class="o">/</span><span class="n">workspace</span><span class="o">/</span><span class="n">config</span><span class="o">/</span><span class="n">hccl_8p</span><span class="p">.</span><span class="n">json</span><span class="p">]</span><span class="w"> </span><span class="n">identify</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="w"> </span><span class="n">hcom</span><span class="w"> </span><span class="n">init</span><span class="w"> </span><span class="n">failed</span><span class="p">.</span>
<span class="p">[</span><span class="n">ERROR</span><span class="p">]</span><span class="w"> </span><span class="n">HCCL</span><span class="p">(</span><span class="mi">17381</span><span class="p">,</span><span class="n">python</span><span class="p">)</span><span class="o">:</span><span class="mi">2022-12</span><span class="mo">-01-03</span><span class="o">:</span><span class="mo">02</span><span class="o">:</span><span class="mf">29.001.662</span><span class="w"> </span><span class="p">[</span><span class="n">hcom_plugin</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">202</span><span class="p">][</span><span class="n">hccl</span><span class="mi">-17381-0-1669834948</span><span class="o">-</span><span class="n">hccl_world_group</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">Init</span><span class="p">][</span><span class="n">HcomPlugin</span><span class="p">]</span><span class="n">errNo</span><span class="p">[</span><span class="mh">0x0000000005010007</span><span class="p">]</span><span class="w"> </span><span class="n">Initialize</span><span class="o">:</span><span class="w"> </span><span class="n">HcomInitByFile</span><span class="w"> </span><span class="n">failed</span><span class="p">.</span>
<span class="p">[</span><span class="n">ERROR</span><span class="p">]</span><span class="w"> </span><span class="n">HCCL</span><span class="p">(</span><span class="mi">17381</span><span class="p">,</span><span class="n">python</span><span class="p">)</span><span class="o">:</span><span class="mi">2022-12</span><span class="mo">-01-03</span><span class="o">:</span><span class="mo">02</span><span class="o">:</span><span class="mf">29.001.675</span><span class="w"> </span><span class="p">[</span><span class="n">hcom_plugin</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">61</span><span class="p">][</span><span class="n">hccl</span><span class="mi">-17381-0-1669834948</span><span class="o">-</span><span class="n">hccl_world_group</span><span class="p">][</span><span class="mi">0</span><span class="p">][</span><span class="n">Initialize</span><span class="p">][</span><span class="n">Plugin</span><span class="p">]</span><span class="n">Initialize</span><span class="w"> </span><span class="n">Hcom</span><span class="w"> </span><span class="n">failed</span>
<span class="p">[</span><span class="n">CRITICAL</span><span class="p">]</span><span class="w"> </span><span class="n">HCCL_ADPT</span><span class="p">(</span><span class="mi">17381</span><span class="p">,</span><span class="n">ffff890145d0</span><span class="p">,</span><span class="n">python</span><span class="p">)</span><span class="o">:</span><span class="mi">2022-12</span><span class="mo">-01-03</span><span class="o">:</span><span class="mo">02</span><span class="o">:</span><span class="mf">29.001.753</span><span class="w"> </span><span class="p">[</span><span class="n">mindspore</span><span class="o">/</span><span class="n">ccsrc</span><span class="o">/</span><span class="n">plugin</span><span class="o">/</span><span class="n">device</span><span class="o">/</span><span class="n">ascend</span><span class="o">/</span><span class="n">hal</span><span class="o">/</span><span class="n">hccl_adapter</span><span class="o">/</span><span class="n">hccl_adapter</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">402</span><span class="p">]</span><span class="w"> </span><span class="n">InitKernelInfoStore</span><span class="p">]</span><span class="w"> </span><span class="n">Init</span><span class="w"> </span><span class="n">hccl</span><span class="w"> </span><span class="n">graph</span><span class="w"> </span><span class="n">adapter</span><span class="w"> </span><span class="n">failed</span><span class="p">.</span>
<span class="p">[</span><span class="n">CRITICAL</span><span class="p">]</span><span class="w"> </span><span class="n">DEVICE</span><span class="p">(</span><span class="mi">17381</span><span class="p">,</span><span class="n">ffff890145d0</span><span class="p">,</span><span class="n">python</span><span class="p">)</span><span class="o">:</span><span class="mi">2022-12</span><span class="mo">-01-03</span><span class="o">:</span><span class="mo">02</span><span class="o">:</span><span class="mf">29.002.576</span><span class="w"> </span><span class="p">[</span><span class="n">mindspore</span><span class="o">/</span><span class="n">ccsrc</span><span class="o">/</span><span class="n">plugin</span><span class="o">/</span><span class="n">device</span><span class="o">/</span><span class="n">ascend</span><span class="o">/</span><span class="n">hal</span><span class="o">/</span><span class="n">hardware</span><span class="o">/</span><span class="n">ascend_collective_comm_lib</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">112</span><span class="p">]</span><span class="w"> </span><span class="n">Initialize</span><span class="p">]</span><span class="w"> </span><span class="n">Ascend</span><span class="w"> </span><span class="n">collective</span><span class="w"> </span><span class="n">communication</span><span class="w"> </span><span class="n">initialization</span><span class="w"> </span><span class="n">failed</span><span class="p">.</span><span class="n">Ascend</span><span class="w"> </span><span class="n">Error</span><span class="w"> </span><span class="n">Message</span><span class="o">:</span><span class="n">EJ0001</span><span class="o">:</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">initialize</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">HCCP</span><span class="w"> </span><span class="n">process</span><span class="p">.</span><span class="w"> </span><span class="n">Reason</span><span class="o">:</span><span class="w"> </span><span class="n">Maybe</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">last</span><span class="w"> </span><span class="n">training</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">running</span><span class="p">.</span>
<span class="w">        </span><span class="nl">Solution</span><span class="p">:</span><span class="w"> </span><span class="n">Wait</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="mi">10</span><span class="n">s</span><span class="w"> </span><span class="n">after</span><span class="w"> </span><span class="n">killing</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">last</span><span class="w"> </span><span class="n">training</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">again</span><span class="p">.</span>
<span class="w">        </span><span class="n">TraceBack</span><span class="w"> </span><span class="p">(</span><span class="n">most</span><span class="w"> </span><span class="n">recent</span><span class="w"> </span><span class="n">call</span><span class="w"> </span><span class="n">last</span><span class="p">)</span><span class="o">:</span>
<span class="w">        </span><span class="n">tsd</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">wait</span><span class="w"> </span><span class="n">response</span><span class="w"> </span><span class="n">fail</span><span class="p">,</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">response</span><span class="w"> </span><span class="n">code</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="w"> </span><span class="n">unknown</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">error</span><span class="p">.[</span><span class="n">FUNC</span><span class="o">:</span><span class="n">WaitRsp</span><span class="p">][</span><span class="kt">FILE</span><span class="o">:</span><span class="n">process_mode_manager</span><span class="p">.</span><span class="n">cpp</span><span class="p">][</span><span class="n">LINE</span><span class="o">:</span><span class="mi">233</span><span class="p">]</span>

<span class="p">(</span><span class="n">Please</span><span class="w"> </span><span class="n">search</span><span class="w"> </span><span class="s">&quot;Ascend Error Message&quot;</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">https</span><span class="o">:</span><span class="c1">//www.mindspore.cn for error code description)Framework Error Message:Init hccl graph adapter failed.</span>

<span class="o">----------------------------------------------------</span>
<span class="o">-</span><span class="w"> </span><span class="n">C</span><span class="o">++</span><span class="w"> </span><span class="n">Call</span><span class="w"> </span><span class="n">Stack</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="n">For</span><span class="w"> </span><span class="n">framework</span><span class="w"> </span><span class="n">developers</span><span class="p">)</span>
<span class="o">----------------------------------------------------</span>
<span class="n">mindspore</span><span class="o">/</span><span class="n">ccsrc</span><span class="o">/</span><span class="n">plugin</span><span class="o">/</span><span class="n">device</span><span class="o">/</span><span class="n">ascend</span><span class="o">/</span><span class="n">hal</span><span class="o">/</span><span class="n">hccl_adapter</span><span class="o">/</span><span class="n">hccl_adapter</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">402</span><span class="w"> </span><span class="n">InitKernelInfoStore</span>

<span class="p">[</span><span class="n">CRITICAL</span><span class="p">]</span><span class="w"> </span><span class="n">DEVICE</span><span class="p">(</span><span class="mi">17381</span><span class="p">,</span><span class="n">ffff890145d0</span><span class="p">,</span><span class="n">python</span><span class="p">)</span><span class="o">:</span><span class="mi">2022-12</span><span class="mo">-01-03</span><span class="o">:</span><span class="mo">02</span><span class="o">:</span><span class="mf">29.011.280</span><span class="w"> </span><span class="p">[</span><span class="n">mindspore</span><span class="o">/</span><span class="n">ccsrc</span><span class="o">/</span><span class="n">runtime</span><span class="o">/</span><span class="n">device</span><span class="o">/</span><span class="n">kernel_runtime</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">124</span><span class="p">]</span><span class="w"> </span><span class="n">LockRuntime</span><span class="p">]</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="n">pointer</span><span class="p">[</span><span class="n">stream</span><span class="p">]</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">null</span><span class="p">.</span>
<span class="p">[</span><span class="n">ERROR</span><span class="p">]</span><span class="w"> </span><span class="n">DEVICE</span><span class="p">(</span><span class="mi">17381</span><span class="p">,</span><span class="n">ffff890145d0</span><span class="p">,</span><span class="n">python</span><span class="p">)</span><span class="o">:</span><span class="mi">2022-12</span><span class="mo">-01-03</span><span class="o">:</span><span class="mo">02</span><span class="o">:</span><span class="mf">29.011.608</span><span class="w"> </span><span class="p">[</span><span class="n">mindspore</span><span class="o">/</span><span class="n">ccsrc</span><span class="o">/</span><span class="n">runtime</span><span class="o">/</span><span class="n">device</span><span class="o">/</span><span class="n">kernel_runtime_manager</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">138</span><span class="p">]</span><span class="w"> </span><span class="n">WaitTaskFinishOnDevice</span><span class="p">]</span><span class="w"> </span><span class="n">SyncStream</span><span class="w"> </span><span class="n">failed</span><span class="p">,</span><span class="w"> </span><span class="n">exception</span><span class="o">:</span><span class="n">The</span><span class="w"> </span><span class="n">pointer</span><span class="p">[</span><span class="n">stream</span><span class="p">]</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">null</span><span class="p">.</span>

<span class="o">----------------------------------------------------</span>
<span class="o">-</span><span class="w"> </span><span class="n">C</span><span class="o">++</span><span class="w"> </span><span class="n">Call</span><span class="w"> </span><span class="n">Stack</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="n">For</span><span class="w"> </span><span class="n">framework</span><span class="w"> </span><span class="n">developers</span><span class="p">)</span>
<span class="o">----------------------------------------------------</span>
<span class="n">mindspore</span><span class="o">/</span><span class="n">ccsrc</span><span class="o">/</span><span class="n">runtime</span><span class="o">/</span><span class="n">device</span><span class="o">/</span><span class="n">kernel_runtime</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">124</span><span class="w"> </span><span class="n">LockRuntime</span>


<span class="p">[</span><span class="n">ERROR</span><span class="p">]</span><span class="w"> </span><span class="n">RUNTIME</span><span class="p">(</span><span class="mi">17381</span><span class="p">,</span><span class="n">python</span><span class="p">)</span><span class="o">:</span><span class="mi">2022-12</span><span class="mo">-01-03</span><span class="o">:</span><span class="mo">02</span><span class="o">:</span><span class="mf">29.091.105</span><span class="w"> </span><span class="p">[</span><span class="n">engine</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">1044</span><span class="p">]</span><span class="mi">17901</span><span class="w"> </span><span class="n">ReportStatusFailProc</span><span class="o">:</span><span class="n">Device</span><span class="w"> </span><span class="n">status</span><span class="w"> </span><span class="n">failure</span><span class="p">,</span><span class="w"> </span><span class="n">ret</span><span class="o">=</span><span class="mi">118554641</span><span class="p">,</span><span class="n">start</span><span class="w"> </span><span class="n">exception</span><span class="w"> </span><span class="n">CallBack</span><span class="p">.</span>
<span class="p">[</span><span class="n">ERROR</span><span class="p">]</span><span class="w"> </span><span class="n">DRV</span><span class="p">(</span><span class="mi">17381</span><span class="p">,</span><span class="n">python</span><span class="p">)</span><span class="o">:</span><span class="mi">2022-12</span><span class="mo">-01-03</span><span class="o">:</span><span class="mo">02</span><span class="o">:</span><span class="mf">29.391.021</span><span class="w"> </span><span class="p">[</span><span class="n">ascend</span><span class="p">][</span><span class="n">curpid</span><span class="o">:</span><span class="w"> </span><span class="mi">17381</span><span class="p">,</span><span class="w"> </span><span class="mi">17381</span><span class="p">][</span><span class="n">drv</span><span class="p">][</span><span class="n">tsdrv</span><span class="p">][</span><span class="n">share_log_read</span><span class="w"> </span><span class="mi">552</span><span class="p">]</span><span class="n">hdc</span><span class="w"> </span><span class="n">connect</span><span class="w"> </span><span class="n">down</span><span class="p">,</span><span class="w"> </span><span class="n">devid</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">fid</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">tsid</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">hdc</span><span class="w"> </span><span class="n">connect</span><span class="w"> </span><span class="n">down</span><span class="p">,</span><span class="w"> </span><span class="n">devid</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">fid</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span><span class="w"> </span><span class="n">tsid</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
<span class="n">Traceback</span><span class="w"> </span><span class="p">(</span><span class="n">most</span><span class="w"> </span><span class="n">recent</span><span class="w"> </span><span class="n">call</span><span class="w"> </span><span class="n">last</span><span class="p">)</span><span class="o">:</span>
<span class="w">  </span><span class="n">File</span><span class="w"> </span><span class="s">&quot;train.py&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="mi">377</span><span class="p">,</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="o">&lt;</span><span class="k">module</span><span class="o">&gt;</span>
<span class="w">    </span><span class="n">train_net</span><span class="p">()</span>
<span class="w">  </span><span class="n">File</span><span class="w"> </span><span class="s">&quot;/home/jenkins/workspace/TDT_deployment/solution_test/remaining/test_scripts/mindspore/reliability/fmea/business/process/multitask/test_ms_fmea_multi_task_two_8p_0001_2_GRAPH_MODE/scripts/train_parallel0/src/model_utils/moxing_adapter.py&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="mi">104</span><span class="p">,</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">wrapped_func</span>
<span class="w">    </span><span class="n">run_func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="w">  </span><span class="n">File</span><span class="w"> </span><span class="s">&quot;train.py&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="mi">304</span><span class="p">,</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">train_net</span>
<span class="w">    </span><span class="n">set_parameter</span><span class="p">()</span>
<span class="w">  </span><span class="n">File</span><span class="w"> </span><span class="s">&quot;train.py&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="mi">151</span><span class="p">,</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">set_parameter</span>
<span class="w">    </span><span class="n">init</span><span class="p">()</span>
<span class="w">  </span><span class="n">File</span><span class="w"> </span><span class="s">&quot;/home/miniconda3/envs/ci/lib/python3.7/site-packages/mindspore/communication/management.py&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="mi">152</span><span class="p">,</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">init</span>
<span class="w">    </span><span class="n">init_hccl</span><span class="p">()</span>
<span class="nl">RuntimeError</span><span class="p">:</span><span class="w"> </span><span class="n">Ascend</span><span class="w"> </span><span class="n">collective</span><span class="w"> </span><span class="n">communication</span><span class="w"> </span><span class="n">initialization</span><span class="w"> </span><span class="n">failed</span><span class="p">.</span>

<span class="o">----------------------------------------------------</span>
<span class="o">-</span><span class="w"> </span><span class="n">Ascend</span><span class="w"> </span><span class="n">Error</span><span class="w"> </span><span class="n">Message</span><span class="o">:</span>
<span class="o">----------------------------------------------------</span>
<span class="nl">EJ0001</span><span class="p">:</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">initialize</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">HCCP</span><span class="w"> </span><span class="n">process</span><span class="p">.</span><span class="w"> </span><span class="n">Reason</span><span class="o">:</span><span class="w"> </span><span class="n">Maybe</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">last</span><span class="w"> </span><span class="n">training</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">running</span><span class="p">.</span>
<span class="w">        </span><span class="nl">Solution</span><span class="p">:</span><span class="w"> </span><span class="n">Wait</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="mi">10</span><span class="n">s</span><span class="w"> </span><span class="n">after</span><span class="w"> </span><span class="n">killing</span><span class="w"> </span><span class="n">the</span><span class="w"> </span><span class="n">last</span><span class="w"> </span><span class="n">training</span><span class="w"> </span><span class="n">process</span><span class="w"> </span><span class="k">and</span><span class="w"> </span><span class="k">try</span><span class="w"> </span><span class="n">again</span><span class="p">.</span>
<span class="w">        </span><span class="n">TraceBack</span><span class="w"> </span><span class="p">(</span><span class="n">most</span><span class="w"> </span><span class="n">recent</span><span class="w"> </span><span class="n">call</span><span class="w"> </span><span class="n">last</span><span class="p">)</span><span class="o">:</span>
<span class="w">        </span><span class="n">tsd</span><span class="w"> </span><span class="n">client</span><span class="w"> </span><span class="n">wait</span><span class="w"> </span><span class="n">response</span><span class="w"> </span><span class="n">fail</span><span class="p">,</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">response</span><span class="w"> </span><span class="n">code</span><span class="p">[</span><span class="mi">1</span><span class="p">].</span><span class="w"> </span><span class="n">unknown</span><span class="w"> </span><span class="n">device</span><span class="w"> </span><span class="n">error</span><span class="p">.[</span><span class="n">FUNC</span><span class="o">:</span><span class="n">WaitRsp</span><span class="p">][</span><span class="kt">FILE</span><span class="o">:</span><span class="n">process_mode_manager</span><span class="p">.</span><span class="n">cpp</span><span class="p">][</span><span class="n">LINE</span><span class="o">:</span><span class="mi">233</span><span class="p">]</span>

<span class="p">(</span><span class="n">Please</span><span class="w"> </span><span class="n">search</span><span class="w"> </span><span class="s">&quot;Ascend Error Message&quot;</span><span class="w"> </span><span class="n">at</span><span class="w"> </span><span class="n">https</span><span class="o">:</span><span class="c1">//www.mindspore.cn for error code description)</span>

<span class="o">----------------------------------------------------</span>
<span class="o">-</span><span class="w"> </span><span class="n">Framework</span><span class="w"> </span><span class="n">Error</span><span class="w"> </span><span class="n">Message</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="n">For</span><span class="w"> </span><span class="n">framework</span><span class="w"> </span><span class="n">developers</span><span class="p">)</span>
<span class="o">----------------------------------------------------</span>
<span class="n">Init</span><span class="w"> </span><span class="n">hccl</span><span class="w"> </span><span class="n">graph</span><span class="w"> </span><span class="n">adapter</span><span class="w"> </span><span class="n">failed</span><span class="p">.</span>

<span class="o">----------------------------------------------------</span>
<span class="o">-</span><span class="w"> </span><span class="n">C</span><span class="o">++</span><span class="w"> </span><span class="n">Call</span><span class="w"> </span><span class="n">Stack</span><span class="o">:</span><span class="w"> </span><span class="p">(</span><span class="n">For</span><span class="w"> </span><span class="n">framework</span><span class="w"> </span><span class="n">developers</span><span class="p">)</span>
<span class="o">----------------------------------------------------</span>
<span class="n">mindspore</span><span class="o">/</span><span class="n">ccsrc</span><span class="o">/</span><span class="n">plugin</span><span class="o">/</span><span class="n">device</span><span class="o">/</span><span class="n">ascend</span><span class="o">/</span><span class="n">hal</span><span class="o">/</span><span class="n">hardware</span><span class="o">/</span><span class="n">ascend_collective_comm_lib</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">112</span><span class="w"> </span><span class="n">Initialize</span>
<span class="n">mindspore</span><span class="o">/</span><span class="n">ccsrc</span><span class="o">/</span><span class="n">plugin</span><span class="o">/</span><span class="n">device</span><span class="o">/</span><span class="n">ascend</span><span class="o">/</span><span class="n">hal</span><span class="o">/</span><span class="n">hccl_adapter</span><span class="o">/</span><span class="n">hccl_adapter</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">402</span><span class="w"> </span><span class="n">InitKernelInfoStore</span>
</pre></div>
</div>
<p>遇到此类报错，根据日志的初始化错误原因及解决方案进行解决即可。</p>
</section>
</section>
<section id="profiling常见问题">
<h2>profiling常见问题<a class="headerlink" href="#profiling常见问题" title="Permalink to this headline"></a></h2>
<p>profiling问题错误码以<code class="docutils literal notranslate"><span class="pre">EK</span></code>开头。</p>
<section id="ek0001-非法参数问题">
<h3>EK0001: 非法参数问题<a class="headerlink" href="#ek0001-非法参数问题" title="Permalink to this headline"></a></h3>
<p>当CANN的profiling模块接口遇到非法参数时会报<code class="docutils literal notranslate"><span class="pre">EK0001</span></code>错误。对用户来说，最常见的非法参数错误就是profiling的路径设置不对，比如下述报错：</p>
<div class="highlight-c++ notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">ERROR</span><span class="p">]</span><span class="w"> </span><span class="n">PROFILER</span><span class="p">(</span><span class="mi">138694</span><span class="p">,</span><span class="n">ffffaa6c8480</span><span class="p">,</span><span class="n">python</span><span class="p">)</span><span class="o">:</span><span class="mi">2022</span><span class="mo">-01</span><span class="mi">-10-14</span><span class="o">:</span><span class="mi">19</span><span class="o">:</span><span class="mf">56.741.053</span><span class="w"> </span><span class="p">[</span><span class="n">mindspore</span><span class="o">/</span><span class="n">ccsrc</span><span class="o">/</span><span class="n">profiler</span><span class="o">/</span><span class="n">device</span><span class="o">/</span><span class="n">ascend</span><span class="o">/</span><span class="n">ascend_profiling</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">51</span><span class="p">]</span><span class="w"> </span><span class="n">ReportErrorMessage</span><span class="p">]</span><span class="w"> </span><span class="n">Ascend</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">occurred</span><span class="p">,</span><span class="w"> </span><span class="n">error</span><span class="w"> </span><span class="n">message</span><span class="o">:</span>
<span class="nl">EK0001</span><span class="p">:</span><span class="w"> </span><span class="n">Path</span><span class="w"> </span><span class="p">[</span><span class="o">/</span><span class="n">ms_test</span><span class="o">/</span><span class="n">ci</span><span class="o">/</span><span class="n">user_scene</span><span class="o">/</span><span class="n">profiler_chinese_中文</span><span class="o">/</span><span class="n">resnet</span><span class="o">/</span><span class="n">scripts</span><span class="o">/</span><span class="n">train</span><span class="o">/</span><span class="n">data</span><span class="o">/</span><span class="n">profiler</span><span class="p">]</span><span class="w"> </span><span class="k">for</span><span class="w"> </span><span class="p">[</span><span class="n">profilerResultPath</span><span class="p">]</span><span class="w"> </span><span class="n">is</span><span class="w"> </span><span class="n">invalid</span><span class="w"> </span><span class="k">or</span><span class="w"> </span><span class="n">does</span><span class="w"> </span><span class="k">not</span><span class="w"> </span><span class="n">exist</span><span class="p">.</span><span class="w"> </span><span class="n">The</span><span class="w"> </span><span class="n">Path</span><span class="w"> </span><span class="n">name</span><span class="w"> </span><span class="n">can</span><span class="w"> </span><span class="n">only</span><span class="w"> </span><span class="n">contain</span><span class="w"> </span><span class="n">A</span><span class="o">-</span><span class="n">Za</span><span class="o">-</span><span class="n">z0</span><span class="mi">-9</span><span class="o">-</span><span class="n">_</span><span class="p">.</span>

<span class="p">[</span><span class="n">CRITICAL</span><span class="p">]</span><span class="w"> </span><span class="n">PROFILER</span><span class="p">(</span><span class="mi">138694</span><span class="p">,</span><span class="n">ffffaa6c8480</span><span class="p">,</span><span class="n">python</span><span class="p">)</span><span class="o">:</span><span class="mi">2022</span><span class="mo">-01</span><span class="mi">-10-14</span><span class="o">:</span><span class="mi">19</span><span class="o">:</span><span class="mf">56.741.123</span><span class="w"> </span><span class="p">[</span><span class="n">mindspore</span><span class="o">/</span><span class="n">ccsrc</span><span class="o">/</span><span class="n">profiler</span><span class="o">/</span><span class="n">device</span><span class="o">/</span><span class="n">ascend</span><span class="o">/</span><span class="n">ascend_profiling</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">79</span><span class="p">]</span><span class="w"> </span><span class="n">InitProfiling</span><span class="p">]</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">call</span><span class="w"> </span><span class="n">aclprofInit</span><span class="w"> </span><span class="n">function</span><span class="p">.</span>

<span class="n">Traceback</span><span class="w"> </span><span class="p">(</span><span class="n">most</span><span class="w"> </span><span class="n">recent</span><span class="w"> </span><span class="n">call</span><span class="w"> </span><span class="n">last</span><span class="p">)</span><span class="o">:</span>
<span class="w">  </span><span class="n">File</span><span class="w"> </span><span class="s">&quot;train.py&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="mi">387</span><span class="p">,</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="o">&lt;</span><span class="k">module</span><span class="o">&gt;</span>
<span class="w">    </span><span class="n">train_net</span><span class="p">()</span>
<span class="w">  </span><span class="n">File</span><span class="w"> </span><span class="s">&quot;/ms_test/ci/user_scene/profiler_chinese_中文/resnet/scripts/train/src/model_utils/moxing_adapter.py&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="mi">104</span><span class="p">,</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">wrapped_func</span>
<span class="w">    </span><span class="n">run_func</span><span class="p">(</span><span class="o">*</span><span class="n">args</span><span class="p">,</span><span class="w"> </span><span class="o">**</span><span class="n">kwargs</span><span class="p">)</span>
<span class="w">  </span><span class="n">File</span><span class="w"> </span><span class="s">&quot;train.py&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="mi">325</span><span class="p">,</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">train_net</span>
<span class="w">    </span><span class="n">profiler</span><span class="w"> </span><span class="o">=</span><span class="w"> </span><span class="n">Profiler</span><span class="p">()</span>
<span class="w">  </span><span class="n">File</span><span class="w"> </span><span class="s">&quot;/home/miniconda3/envs/ci/lib/python3.7/site-packages/mindspore/profiler/profiling.py&quot;</span><span class="p">,</span><span class="w"> </span><span class="n">line</span><span class="w"> </span><span class="mi">195</span><span class="p">,</span><span class="w"> </span><span class="n">in</span><span class="w"> </span><span class="n">__init__</span>
<span class="w">    </span><span class="n">self</span><span class="p">.</span><span class="n">_ascend_profiler</span><span class="p">.</span><span class="n">init</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">_output_path</span><span class="p">,</span><span class="w"> </span><span class="kt">int</span><span class="p">(</span><span class="n">self</span><span class="p">.</span><span class="n">_dev_id</span><span class="p">),</span><span class="w"> </span><span class="n">profiling_options</span><span class="p">)</span>
<span class="nl">RuntimeError</span><span class="p">:</span><span class="w"> </span><span class="n">mindspore</span><span class="o">/</span><span class="n">ccsrc</span><span class="o">/</span><span class="n">profiler</span><span class="o">/</span><span class="n">device</span><span class="o">/</span><span class="n">ascend</span><span class="o">/</span><span class="n">ascend_profiling</span><span class="p">.</span><span class="n">cc</span><span class="o">:</span><span class="mi">79</span><span class="w"> </span><span class="n">InitProfiling</span><span class="p">]</span><span class="w"> </span><span class="n">Failed</span><span class="w"> </span><span class="n">to</span><span class="w"> </span><span class="n">call</span><span class="w"> </span><span class="n">aclprofInit</span><span class="w"> </span><span class="n">function</span><span class="p">.</span>
</pre></div>
</div>
<p>从ERROR日志的CANN报错信息中可以获知，profiling的路径字符只能包含<code class="docutils literal notranslate"><span class="pre">A-Za-z0-9-_</span></code>，而上述报错中的profiling路径中含有<code class="docutils literal notranslate"><span class="pre">中文</span></code>两字，导致路径非法报错，从而导致profiling初始化失败。遇到此类问题，根据报错信息改正profiling路径或者其他参数即可。</p>
</section>
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="mindrt_debug.html" class="btn btn-neutral float-left" title="网络构建与训练常见错误分析" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="mindir.html" class="btn btn-neutral float-right" title="IR文件分析" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright MindSpore.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 
</body>
</html>