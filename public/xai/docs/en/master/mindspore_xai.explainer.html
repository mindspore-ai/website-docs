<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>mindspore_xai.explainer &mdash; MindSpore master documentation</title><script>;(()=>{const e=localStorage.getItem("ms-theme"),t=window.matchMedia("(prefers-color-scheme: dark)").matches;(e?"dark"===e:t)&&document.documentElement.setAttribute("data-o-theme","dark")})();</script><link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script><script src="_static/jquery.js"></script>
        <script src="_static/js/theme.js"></script><script src="_static/underscore.js"></script><script src="_static/doctools.js"></script><script>window.MathJax = {"options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script><script async="async" src="https://mindspore-website.obs.cn-north-4.myhuaweicloud.com/mathjax/MathJax-3.2.2/es5/tex-mml-chtml.js"></script>
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="mindspore_xai.benchmark" href="mindspore_xai.benchmark.html" />
    <link rel="prev" title="Using TB-Net Whitebox Recommendation Model" href="using_tbnet.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
            <a href="index.html" class="icon icon-home"> MindSpore
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Installation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">MindSpore XAI Installation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Guide</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="using_cv_explainers.html">Using CV Explainers</a></li>
<li class="toctree-l1"><a class="reference internal" href="using_cv_benchmarks.html">Using CV Benchmarks</a></li>
<li class="toctree-l1"><a class="reference internal" href="using_tabular_explainers.html">Using Tabular Explainers</a></li>
<li class="toctree-l1"><a class="reference internal" href="using_tabsim.html">Using TabSim Data Simulator</a></li>
<li class="toctree-l1"><a class="reference internal" href="using_tbnet.html">Using TB-Net Whitebox Recommendation Model</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API References</span></p>
<ul class="current">
<li class="toctree-l1 current"><a class="current reference internal" href="#">mindspore_xai.explainer</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindspore_xai.benchmark.html">mindspore_xai.benchmark</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindspore_xai.tool.html">mindspore_xai.tool</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindspore_xai.visual.html">mindspore_xai.visual</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">FAQ</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="troubleshoot.html">Troubleshooting</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">MindSpore</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>mindspore_xai.explainer</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/mindspore_xai.explainer.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="module-mindspore_xai.explainer">
<span id="mindspore-xai-explainer"></span><h1>mindspore_xai.explainer<a class="headerlink" href="#module-mindspore_xai.explainer" title="Permalink to this headline"></a></h1>
<p>Deep neural network explainers.</p>
<dl class="py class">
<dt class="sig sig-object py" id="mindspore_xai.explainer.Deconvolution">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_xai.explainer.</span></span><span class="sig-name descname"><span class="pre">Deconvolution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">network</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_xai/explainer/backprop/modified_relu.html#Deconvolution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_xai.explainer.Deconvolution" title="Permalink to this definition"></a></dt>
<dd><p>Provides Deconvolution explanation method.</p>
<p>Deconvolution method is a modified version of Gradient method. For the original ReLU operation in the network to be
explained, Deconvolution modifies the propagation rule from directly backpropagating gradients to backpropagating
positive gradients.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The parsed <cite>network</cite> will be set to eval mode through <cite>network.set_grad(False)</cite> and <cite>network.set_train(False)</cite>.
If you want to train the <cite>network</cite> afterwards, please reset it back to training mode through the opposite
operations. To use <cite>Deconvolution</cite>, the <cite>ReLU</cite> operations in the network must be implemented with
<cite>mindspore.nn.Cell</cite> object rather than <cite>mindspore.ops.Operations.ReLU</cite>. Otherwise, the results will not be
correct.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>network</strong> (<em>Cell</em>) – The black-box model to be explained.</p>
</dd>
</dl>
<dl class="simple">
<dt>Inputs:</dt><dd><ul class="simple">
<li><p><strong>inputs</strong> (Tensor) - The input data to be explained, a 4D tensor of shape <span class="math notranslate nohighlight">\((N, C, H, W)\)</span>.</p></li>
<li><p><strong>targets</strong> (Tensor, int, tuple, list) - The label of interest. It should be a 1D or scalar tensor, or an
integer, or a tuple/list of integers. If it is a 1D tensor, tuple or list, its length should be the same as
<cite>inputs</cite>.</p></li>
<li><p><strong>ret</strong> (str, optional): The return object type. <code class="docutils literal notranslate"><span class="pre">'tensor'</span></code> means returns a Tensor object, <code class="docutils literal notranslate"><span class="pre">'image'</span></code>
means return a PIL.Image.Image list. Default: <code class="docutils literal notranslate"><span class="pre">'tensor'</span></code>.</p></li>
<li><p><strong>show</strong> (bool, optional): Show the saliency images, <code class="docutils literal notranslate"><span class="pre">None</span></code> means automatically show the saliency images
if it is running on JupyterLab. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
</ul>
</dd>
<dt>Outputs:</dt><dd><p>Tensor, a 4D tensor of shape <span class="math notranslate nohighlight">\((N, 1, H, W)\)</span>. Or list[list[PIL.Image.Image]], the
normalized saliency images if <cite>ret</cite> was set to <code class="docutils literal notranslate"><span class="pre">'image'</span></code>.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/library/exceptions.html#TypeError" title="(in Python v3.8)"><strong>TypeError</strong></a> – Be raised for any argument or input type problem.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/library/exceptions.html#ValueError" title="(in Python v3.8)"><strong>ValueError</strong></a> – Be raised for any input value problem.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Supported Platforms:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">Ascend</span></code> <code class="docutils literal notranslate"><span class="pre">GPU</span></code></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mindspore</span> <span class="k">as</span> <span class="nn">ms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore</span> <span class="kn">import</span> <span class="n">set_context</span><span class="p">,</span> <span class="n">PYNATIVE_MODE</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_xai.explainer</span> <span class="kn">import</span> <span class="n">Deconvolution</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># only PYNATIVE_MODE is supported</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">set_context</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="n">PYNATIVE_MODE</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># The detail of LeNet5 is shown in models.official.cv.lenet.src.lenet.py</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">net</span> <span class="o">=</span> <span class="n">LeNet5</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">num_channel</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">deconvolution</span> <span class="o">=</span> <span class="n">Deconvolution</span><span class="p">(</span><span class="n">net</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># parse data and the target label to be explained and get the saliency map</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inputs</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">),</span> <span class="n">ms</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">label</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">saliency</span> <span class="o">=</span> <span class="n">deconvolution</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">saliency</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(1, 1, 32, 32)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_xai.explainer.GradCAM">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_xai.explainer.</span></span><span class="sig-name descname"><span class="pre">GradCAM</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">network</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">''</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_xai/explainer/backprop/gradcam.html#GradCAM"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_xai.explainer.GradCAM" title="Permalink to this definition"></a></dt>
<dd><p>Provides GradCAM explanation method.</p>
<p><cite>GradCAM</cite> generates saliency map at intermediate layer. The attribution is obtained as:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}\alpha_k^c = \frac{1}{Z} \sum_i \sum_j \frac{\partial{y^c}}{\partial{A_{i,j}^k}}\\attribution = ReLU(\sum_k \alpha_k^c A^k)\end{aligned}\end{align} \]</div>
<p>For more details, please refer to the original paper: <a class="reference external" href="https://openaccess.thecvf.com/content_ICCV_2017/papers/Selvaraju_Grad-CAM_Visual_Explanations_ICCV_2017_paper.pdf">GradCAM</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The parsed <cite>network</cite> will be set to eval mode through <cite>network.set_grad(False)</cite> and <cite>network.set_train(False)</cite>.
If you want to train the <cite>network</cite> afterwards, please reset it back to training mode through the opposite
operations.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>network</strong> (<em>Cell</em>) – The black-box model to be explained.</p></li>
<li><p><strong>layer</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a><em>, </em><em>optional</em>) – The layer name to generate the explanation, usually chosen as the last convolutional
layer for better practice. If it is <code class="docutils literal notranslate"><span class="pre">''</span></code>, the explanation will be generated at the input layer.
Default: <code class="docutils literal notranslate"><span class="pre">''</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Inputs:</dt><dd><ul class="simple">
<li><p><strong>inputs</strong> (Tensor) - The input data to be explained, a 4D tensor of shape <span class="math notranslate nohighlight">\((N, C, H, W)\)</span>.</p></li>
<li><p><strong>targets</strong> (Tensor, int, tuple, list) - The label of interest. It should be a 1D or scalar tensor, or an
integer, or a tuple/list of integers. If it is a 1D tensor, tuple or list, its length should be <span class="math notranslate nohighlight">\(N\)</span>.</p></li>
<li><p><strong>ret</strong> (str, optional): The return object type. <code class="docutils literal notranslate"><span class="pre">'tensor'</span></code> means returns a Tensor object, <code class="docutils literal notranslate"><span class="pre">'image'</span></code>
means return a PIL.Image.Image list. Default: <code class="docutils literal notranslate"><span class="pre">'tensor'</span></code>.</p></li>
<li><p><strong>show</strong> (bool, optional): Show the saliency images, <code class="docutils literal notranslate"><span class="pre">None</span></code> means automatically show the saliency images
if it is running on JupyterLab. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
</ul>
</dd>
<dt>Outputs:</dt><dd><p>Tensor, a 4D tensor of shape <span class="math notranslate nohighlight">\((N, 1, H, W)\)</span>, saliency maps. Or list[list[PIL.Image.Image]], the
normalized saliency images if <cite>ret</cite> was set to <code class="docutils literal notranslate"><span class="pre">'image'</span></code>.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/library/exceptions.html#TypeError" title="(in Python v3.8)"><strong>TypeError</strong></a> – Be raised for any argument or input type problem.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/library/exceptions.html#ValueError" title="(in Python v3.8)"><strong>ValueError</strong></a> – Be raised for any input value problem.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Supported Platforms:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">Ascend</span></code> <code class="docutils literal notranslate"><span class="pre">GPU</span></code></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mindspore</span> <span class="k">as</span> <span class="nn">ms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_xai.explainer</span> <span class="kn">import</span> <span class="n">GradCAM</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore</span> <span class="kn">import</span> <span class="n">set_context</span><span class="p">,</span> <span class="n">PYNATIVE_MODE</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># only PYNATIVE_MODE is supported</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">set_context</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="n">PYNATIVE_MODE</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># The detail of LeNet5 is shown in models.official.cv.lenet.src.lenet.py</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">net</span> <span class="o">=</span> <span class="n">LeNet5</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">num_channel</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># specify a layer name to generate explanation, usually the layer can be set as the last conv layer.</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">layer_name</span> <span class="o">=</span> <span class="s1">&#39;conv2&#39;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># init GradCAM with a trained network and specify the layer to obtain attribution</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gradcam</span> <span class="o">=</span> <span class="n">GradCAM</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="n">layer</span><span class="o">=</span><span class="n">layer_name</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inputs</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">),</span> <span class="n">ms</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">label</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">saliency</span> <span class="o">=</span> <span class="n">gradcam</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">saliency</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(1, 1, 32, 32)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_xai.explainer.Gradient">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_xai.explainer.</span></span><span class="sig-name descname"><span class="pre">Gradient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">network</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_xai/explainer/backprop/gradient.html#Gradient"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_xai.explainer.Gradient" title="Permalink to this definition"></a></dt>
<dd><p>Provides Gradient explanation method.</p>
<p>Gradient is the simplest attribution method which uses the naive gradients of outputs w.r.t inputs as the
explanation.</p>
<div class="math notranslate nohighlight">
\[attribution = \frac{\partial{y}}{\partial{x}}\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The parsed <cite>network</cite> will be set to eval mode through <cite>network.set_grad(False)</cite> and <cite>network.set_train(False)</cite>.
If you want to train the <cite>network</cite> afterwards, please reset it back to training mode through the opposite
operations.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>network</strong> (<em>Cell</em>) – The black-box model to be explained.</p>
</dd>
</dl>
<dl class="simple">
<dt>Inputs:</dt><dd><ul class="simple">
<li><p><strong>inputs</strong> (Tensor) - The input data to be explained, a 4D tensor of shape <span class="math notranslate nohighlight">\((N, C, H, W)\)</span>.</p></li>
<li><p><strong>targets</strong> (Tensor, int, tuple, list) - The label of interest. It should be a 1D or scalar tensor, or an
integer, or a tuple/list of integers. If it is a 1D tensor, tuple or list, its length should be <span class="math notranslate nohighlight">\(N\)</span>.</p></li>
<li><p><strong>ret</strong> (str, optional): The return object type. <code class="docutils literal notranslate"><span class="pre">'tensor'</span></code> means returns a Tensor object, <code class="docutils literal notranslate"><span class="pre">'image'</span></code>
means return a PIL.Image.Image list. Default: <code class="docutils literal notranslate"><span class="pre">'tensor'</span></code>.</p></li>
<li><p><strong>show</strong> (bool, optional): Show the saliency images, <code class="docutils literal notranslate"><span class="pre">None</span></code> means automatically show the saliency images
if it is running on JupyterLab. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
</ul>
</dd>
<dt>Outputs:</dt><dd><p>Tensor, a 4D tensor of shape <span class="math notranslate nohighlight">\((N, 1, H, W)\)</span>, saliency maps. Or list[list[PIL.Image.Image]], the
normalized saliency images if <cite>ret</cite> was set to <code class="docutils literal notranslate"><span class="pre">'image'</span></code>.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/library/exceptions.html#TypeError" title="(in Python v3.8)"><strong>TypeError</strong></a> – Be raised for any argument or input type problem.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/library/exceptions.html#ValueError" title="(in Python v3.8)"><strong>ValueError</strong></a> – Be raised for any input value problem.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Supported Platforms:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">Ascend</span></code> <code class="docutils literal notranslate"><span class="pre">GPU</span></code></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mindspore</span> <span class="k">as</span> <span class="nn">ms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore</span> <span class="kn">import</span> <span class="n">set_context</span><span class="p">,</span> <span class="n">PYNATIVE_MODE</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_xai.explainer</span> <span class="kn">import</span> <span class="n">Gradient</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">set_context</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="n">PYNATIVE_MODE</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># The detail of LeNet5 is shown in models.official.cv.lenet.src.lenet.py</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">net</span> <span class="o">=</span> <span class="n">LeNet5</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">num_channel</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gradient</span> <span class="o">=</span> <span class="n">Gradient</span><span class="p">(</span><span class="n">net</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inputs</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">),</span> <span class="n">ms</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">label</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">saliency</span> <span class="o">=</span> <span class="n">gradient</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">saliency</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(1, 1, 32, 32)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_xai.explainer.GuidedBackprop">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_xai.explainer.</span></span><span class="sig-name descname"><span class="pre">GuidedBackprop</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">network</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_xai/explainer/backprop/modified_relu.html#GuidedBackprop"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_xai.explainer.GuidedBackprop" title="Permalink to this definition"></a></dt>
<dd><p>Provides Guided-Backpropagation explanation method.</p>
<p>Guided-Backpropagation method is an extension of Gradient method. On top of the original ReLU operation in the
network to be explained, Guided-Backpropagation introduces another ReLU operation to filter out the negative
gradients during backpropagation.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The parsed <cite>network</cite> will be set to eval mode through <cite>network.set_grad(False)</cite> and <cite>network.set_train(False)</cite>.
If you want to train the <cite>network</cite> afterwards, please reset it back to training mode through the opposite
operations. To use <cite>GuidedBackprop</cite>, the <cite>ReLU</cite> operations in the network must be implemented with
<cite>mindspore.nn.Cell</cite> object rather than <cite>mindspore.ops.Operations.ReLU</cite>. Otherwise, the results will not be
correct.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>network</strong> (<em>Cell</em>) – The black-box model to be explained.</p>
</dd>
</dl>
<dl class="simple">
<dt>Inputs:</dt><dd><ul class="simple">
<li><p><strong>inputs</strong> (Tensor) - The input data to be explained, a 4D tensor of shape <span class="math notranslate nohighlight">\((N, C, H, W)\)</span>.</p></li>
<li><p><strong>targets</strong> (Tensor, int, tuple, list) - The label of interest. It should be a 1D or scalar tensor, or an
integer, or an tuple/list of integers. If it is a 1D tensor, tuple or list, its length should be <span class="math notranslate nohighlight">\(N\)</span>.</p></li>
<li><p><strong>ret</strong> (str, optional): The return object type. <code class="docutils literal notranslate"><span class="pre">'tensor'</span></code> means returns a Tensor object, <code class="docutils literal notranslate"><span class="pre">'image'</span></code>
means return a PIL.Image.Image list. Default: <code class="docutils literal notranslate"><span class="pre">'tensor'</span></code>.</p></li>
<li><p><strong>show</strong> (bool, optional): Show the saliency images, <code class="docutils literal notranslate"><span class="pre">None</span></code> means automatically show the saliency images
if it is running on JupyterLab. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
</ul>
</dd>
<dt>Outputs:</dt><dd><p>Tensor, a 4D tensor of shape <span class="math notranslate nohighlight">\((N, 1, H, W)\)</span>, saliency maps. Or list[list[PIL.Image.Image]], the
normalized saliency images if <cite>ret</cite> was set to <code class="docutils literal notranslate"><span class="pre">'image'</span></code>.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/library/exceptions.html#TypeError" title="(in Python v3.8)"><strong>TypeError</strong></a> – Be raised for any argument or input type problem.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/library/exceptions.html#ValueError" title="(in Python v3.8)"><strong>ValueError</strong></a> – Be raised for any input value problem.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Supported Platforms:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">Ascend</span></code> <code class="docutils literal notranslate"><span class="pre">GPU</span></code></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mindspore</span> <span class="k">as</span> <span class="nn">ms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_xai.explainer</span> <span class="kn">import</span> <span class="n">GuidedBackprop</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore</span> <span class="kn">import</span> <span class="n">set_context</span><span class="p">,</span> <span class="n">PYNATIVE_MODE</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># only PYNATIVE_MODE is supported</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">set_context</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="n">PYNATIVE_MODE</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># The detail of LeNet5 is shown in model_zoo.official.cv.lenet.src.lenet.py</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">net</span> <span class="o">=</span> <span class="n">LeNet5</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">num_channel</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">gbp</span> <span class="o">=</span> <span class="n">GuidedBackprop</span><span class="p">(</span><span class="n">net</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># feed data and the target label to be explained and get the saliency map</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inputs</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">),</span> <span class="n">ms</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">label</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">saliency</span> <span class="o">=</span> <span class="n">gbp</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">saliency</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(1, 1, 32, 32)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_xai.explainer.LIMETabular">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_xai.explainer.</span></span><span class="sig-name descname"><span class="pre">LIMETabular</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">train_feat_stats</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">categorical_features_indexes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_perturbs</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_xai/explainer/perturb/lime.html#LIMETabular"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_xai.explainer.LIMETabular" title="Permalink to this definition"></a></dt>
<dd><p>Provides Lime Tabular explanation method.</p>
<p>Explains predictions on tabular (i.e. matrix) data. For numerical features, perturb them by sampling from a
Normal(0,1) and doing the inverse operation of mean-centering and scaling, according to the means and stds in the
training data. For categorical features, perturb by sampling according to the training distribution, and making a
binary feature that is 1 when the value is the same as the instance being explained.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>predictor</strong> (<em>Cell</em><em>, </em><em>Callable</em>) – The black-box model to be explained, should be a <cite>Cell</cite> object or function. For
classification model, it accepts a 2D array/tensor of shape <span class="math notranslate nohighlight">\((N, K)\)</span> as input and outputs a 2D
array/tensor of shape <span class="math notranslate nohighlight">\((N, L)\)</span>. For regression model, it accepts a 2D array/tensor of shape
<span class="math notranslate nohighlight">\((N, K)\)</span> as input and outputs a 1D array/tensor of shape <span class="math notranslate nohighlight">\((N)\)</span>.</p></li>
<li><p><strong>train_feat_stats</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – a dict object having the details of training data statistics. The stats can be
generated using static method LIMETabular.to_feat_stats(training_data).</p></li>
<li><p><strong>feature_names</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em>, </em><em>optional</em>) – list of names (strings) corresponding to the columns in the training data.
Default: <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>categorical_features_indexes</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em>, </em><em>optional</em>) – list of indices (ints) corresponding to the categorical columns,
their values MUST be integers. Other columns will be considered continuous. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>class_names</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em>, </em><em>optional</em>) – list of class names, ordered according to whatever the classifier is using. If
not present, class names will be ‘0’, ‘1’, … Default: <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>num_perturbs</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>optional</em>) – size of the neighborhood to learn the linear model. Default: <code class="docutils literal notranslate"><span class="pre">5000</span></code>.</p></li>
<li><p><strong>max_features</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>optional</em>) – Maximum number of features present in explanation. Default: <code class="docutils literal notranslate"><span class="pre">10</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Inputs:</dt><dd><ul class="simple">
<li><p><strong>inputs</strong> (Tensor, numpy.ndarray) - The input data to be explained, a 2D float tensor or 2D float
numpy array of shape <span class="math notranslate nohighlight">\((N, K)\)</span>.</p></li>
<li><p><strong>targets</strong> (Tensor, numpy.ndarray, list, int, optional) - The labels of interest to be explained. When
<cite>targets</cite> is an integer, all the inputs will generate attribution map w.r.t this integer. When <cite>targets</cite> is a
tensor, numpy array or list, it should be of shape <span class="math notranslate nohighlight">\((N, L)\)</span> (L being the number of labels for each
sample), <span class="math notranslate nohighlight">\((N,)\)</span> or <span class="math notranslate nohighlight">\(()\)</span>. For regression model, this parameter will be ignored. Default: <code class="docutils literal notranslate"><span class="pre">0</span></code>.</p></li>
<li><p><strong>show</strong> (bool, optional): Show the explanation figures, <code class="docutils literal notranslate"><span class="pre">None</span></code> means automatically show the explanation
figures if it is running on JupyterLab. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
</ul>
</dd>
<dt>Outputs:</dt><dd><p>list[list[list[(str, float)]]], a 3-dimension list of tuple. The first dimension represents inputs.
The second dimension represents targets. The third dimension represents features.
The tuple represents feature description and weight.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/library/exceptions.html#TypeError" title="(in Python v3.8)"><strong>TypeError</strong></a> – Be raised for any argument or input type problem.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/library/exceptions.html#ValueError" title="(in Python v3.8)"><strong>ValueError</strong></a> – Be raised for any input value problem.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Supported Platforms:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">Ascend</span></code> <code class="docutils literal notranslate"><span class="pre">GPU</span></code></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mindspore</span> <span class="k">as</span> <span class="nn">ms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mindspore.nn</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_xai.explainer</span> <span class="kn">import</span> <span class="n">LIMETabular</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Linear classification model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">LinearNet</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Cell</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_inputs</span><span class="p">,</span> <span class="n">num_class</span><span class="p">):</span>
<span class="gp">... </span>        <span class="nb">super</span><span class="p">(</span><span class="n">LinearNet</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">fc</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">num_inputs</span><span class="p">,</span> <span class="n">num_class</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="n">nn</span><span class="o">.</span><span class="n">Softmax</span><span class="p">())</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">construct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="gp">... </span>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fc</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">net</span> <span class="o">=</span> <span class="n">LinearNet</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># use iris data as example</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feature_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;sepal length (cm)&#39;</span><span class="p">,</span> <span class="s1">&#39;sepal width (cm)&#39;</span><span class="p">,</span> <span class="s1">&#39;petal length (cm)&#39;</span><span class="p">,</span> <span class="s1">&#39;petal width (cm)&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">class_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;setosa&#39;</span><span class="p">,</span> <span class="s1">&#39;versicolor&#39;</span><span class="p">,</span> <span class="s1">&#39;virginica&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">train</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">ms</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">stats</span> <span class="o">=</span> <span class="n">LIMETabular</span><span class="o">.</span><span class="n">to_feat_stats</span><span class="p">(</span><span class="n">train</span><span class="p">,</span> <span class="n">feature_names</span><span class="o">=</span><span class="n">feature_names</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">lime</span> <span class="o">=</span> <span class="n">LIMETabular</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="n">stats</span><span class="p">,</span> <span class="n">feature_names</span><span class="o">=</span><span class="n">feature_names</span><span class="p">,</span> <span class="n">class_names</span><span class="o">=</span><span class="n">class_names</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inputs</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">ms</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">targets</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]],</span> <span class="n">ms</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">exps</span> <span class="o">=</span> <span class="n">lime</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">targets</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># output is a 3-dimension list of tuple</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">((</span><span class="nb">len</span><span class="p">(</span><span class="n">exps</span><span class="p">),</span> <span class="nb">len</span><span class="p">(</span><span class="n">exps</span><span class="p">[</span><span class="mi">0</span><span class="p">]),</span> <span class="nb">len</span><span class="p">(</span><span class="n">exps</span><span class="p">[</span><span class="mi">0</span><span class="p">][</span><span class="mi">0</span><span class="p">])))</span>
<span class="go">(2, 2, 4)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mindspore_xai.explainer.LIMETabular.load_feat_stats">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">load_feat_stats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_xai/explainer/perturb/lime.html#LIMETabular.load_feat_stats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_xai.explainer.LIMETabular.load_feat_stats" title="Permalink to this definition"></a></dt>
<dd><p>Load feature stats from disk.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><p><strong>file</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a><em>, </em><em>Path</em><em>, </em><em>IOBase</em>) – File path or stream.</p>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>dict, training data stats</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_xai.explainer.LIMETabular.save_feat_stats">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">save_feat_stats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">stats</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_xai/explainer/perturb/lime.html#LIMETabular.save_feat_stats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_xai.explainer.LIMETabular.save_feat_stats" title="Permalink to this definition"></a></dt>
<dd><p>Save feature stats to disk.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>stats</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#dict" title="(in Python v3.8)"><em>dict</em></a>) – training data stats.</p></li>
<li><p><strong>file</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a><em>, </em><em>Path</em><em>, </em><em>IOBase</em>) – File path or stream.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_xai.explainer.LIMETabular.to_feat_stats">
<em class="property"><span class="pre">static</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">to_feat_stats</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">categorical_features_indexes</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_xai/explainer/perturb/lime.html#LIMETabular.to_feat_stats"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_xai.explainer.LIMETabular.to_feat_stats" title="Permalink to this definition"></a></dt>
<dd><p>Convert features to feature stats.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>features</strong> (<em>Tensor</em><em>, </em><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><em>numpy.ndarray</em></a>) – training data.</p></li>
<li><p><strong>feature_names</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em>, </em><em>optional</em>) – feature names. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>categorical_features_indexes</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em>, </em><em>optional</em>) – list of indices (ints) corresponding to the categorical
columns, their values MUST be integers. Other columns will be considered continuous. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>dict, training data stats</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_xai.explainer.Occlusion">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_xai.explainer.</span></span><span class="sig-name descname"><span class="pre">Occlusion</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">network</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">perturbation_per_eval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_xai/explainer/perturb/occlusion.html#Occlusion"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_xai.explainer.Occlusion" title="Permalink to this definition"></a></dt>
<dd><p>Provides Occlusion explanation method.</p>
<p>Occlusion uses a sliding window to replace the pixels with a reference value (e.g. constant value), and computes
the output difference w.r.t the original output. The output difference caused by perturbed pixels are assigned as
feature importance to those pixels. For pixels involved in multiple sliding windows, the feature importance is the
averaged differences from multiple sliding windows.</p>
<p>For more details, please refer to the original paper via:
<a class="reference external" href="https://arxiv.org/abs/1311.2901">Visualizing and Understanding Convolutional Networks</a>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Currently only single sample (<span class="math notranslate nohighlight">\(N=1\)</span>) at each call is supported.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>network</strong> (<em>Cell</em>) – The black-box model to be explained.</p></li>
<li><p><strong>activation_fn</strong> (<em>Cell</em>) – The activation layer that transforms logits to prediction probabilities. For
single label classification tasks, <cite>nn.Softmax</cite> is usually applied. As for multi-label classification
tasks, <cite>nn.Sigmoid</cite> is usually be applied. Users can also pass their own customized <cite>activation_fn</cite> as long
as when combining this function with network, the final output is the probability of the input.</p></li>
<li><p><strong>perturbation_per_eval</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>optional</em>) – Number of perturbations for each inference during inferring the
perturbed samples. Within the memory capacity, usually the larger this number is, the faster the
explanation is obtained. Default: <code class="docutils literal notranslate"><span class="pre">32</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Inputs:</dt><dd><ul class="simple">
<li><p><strong>inputs</strong> (Tensor) - The input data to be explained, a 4D tensor of shape <span class="math notranslate nohighlight">\((N, C, H, W)\)</span>.</p></li>
<li><p><strong>targets</strong> (Tensor, int, tuple, list) - The label of interest. It should be a 1D or scalar tensor, or an
integer, or a tuple/list of integers. If it is a 1D tensor, tuple or list, its length should be <span class="math notranslate nohighlight">\(N\)</span>.</p></li>
<li><p><strong>ret</strong> (str, optional): The return object type. <code class="docutils literal notranslate"><span class="pre">'tensor'</span></code> means returns a Tensor object, <code class="docutils literal notranslate"><span class="pre">'image'</span></code>
means return a PIL.Image.Image list. Default: <code class="docutils literal notranslate"><span class="pre">'tensor'</span></code>.</p></li>
<li><p><strong>show</strong> (bool, optional): Show the saliency images, <code class="docutils literal notranslate"><span class="pre">None</span></code> means automatically show the saliency images
if it is running on JupyterLab. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
</ul>
</dd>
<dt>Outputs:</dt><dd><p>Tensor, a 4D tensor of shape <span class="math notranslate nohighlight">\((N, 1, H, W)\)</span>, saliency maps. Or list[list[PIL.Image.Image]], the
normalized saliency images if <cite>ret</cite> was set to <code class="docutils literal notranslate"><span class="pre">'image'</span></code>.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/library/exceptions.html#TypeError" title="(in Python v3.8)"><strong>TypeError</strong></a> – Be raised for any argument or input type problem.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/library/exceptions.html#ValueError" title="(in Python v3.8)"><strong>ValueError</strong></a> – Be raised for any input value problem.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Supported Platforms:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">Ascend</span></code> <code class="docutils literal notranslate"><span class="pre">GPU</span></code></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mindspore</span> <span class="k">as</span> <span class="nn">ms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_xai.explainer</span> <span class="kn">import</span> <span class="n">Occlusion</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore</span> <span class="kn">import</span> <span class="n">set_context</span><span class="p">,</span> <span class="n">PYNATIVE_MODE</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">set_context</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="n">PYNATIVE_MODE</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># The detail of LeNet5 is shown in models.official.cv.lenet.src.lenet.py</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">net</span> <span class="o">=</span> <span class="n">LeNet5</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">num_channel</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># initialize Occlusion explainer with the pretrained model and activation function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">activation_fn</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Softmax</span><span class="p">()</span> <span class="c1"># softmax layer is applied to transform logits to probabilities</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">occlusion</span> <span class="o">=</span> <span class="n">Occlusion</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="n">activation_fn</span><span class="o">=</span><span class="n">activation_fn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">input_x</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">),</span> <span class="n">ms</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">label</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([</span><span class="mi">1</span><span class="p">],</span> <span class="n">ms</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">saliency</span> <span class="o">=</span> <span class="n">occlusion</span><span class="p">(</span><span class="n">input_x</span><span class="p">,</span> <span class="n">label</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">saliency</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(1, 1, 32, 32)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_xai.explainer.PseudoLinearCoef">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_xai.explainer.</span></span><span class="sig-name descname"><span class="pre">PseudoLinearCoef</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_classes</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stepwise</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threshold</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">monte_carlo</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">riemann</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">batch_size</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">2000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-09</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_xai/explainer/neighbor/pseudo_linear_coef.html#PseudoLinearCoef"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_xai.explainer.PseudoLinearCoef" title="Permalink to this definition"></a></dt>
<dd><p>Pseudo Linear Coefficients (PLC) for classifiers.</p>
<p>PLC is a global attribution method, it is a measure of feature sensitivities around the classifier’s decision
boundaries from the data distribution’s point of view.</p>
<p>PLC of class A:</p>
<div class="math notranslate nohighlight">
\[\vec{R}(A)=\int \vec{S}(A,nearest_{A}(x),x)p_{\neg A}(x)dx\]</div>
<p>PLC of class A (target class) relative to class B (view point class), it is called Relative PLC:</p>
<div class="math notranslate nohighlight">
\[\vec{R}(A,B)=\int \vec{S}(A,nearest_{A}(x),x)p_{B}(x)dx\]</div>
<p>Where:</p>
<div class="math notranslate nohighlight">
\[ \begin{align}\begin{aligned}nearest_A(x):=\underset{g\in G}{argmin}(\left \| g-x \right \|)\text{ }s.t.\text{ } g\neq x,f_A(g)
\geq \xi\\\begin{split}\vec{S}(A,a,x)=\left\{\begin{matrix}
\vec{0} &amp; \text{if }f_A(x)\geq \xi \\
\frac{a-x}{\left \| a-x \right \|} &amp; \text{if }f_A(\cdot )\text{ is a step function}\\
\frac{(a-x)(f_{A}(a)-f_A(x))}{\left \| a-x \right \|^{2}\int_{0}^{1}h(f_A(u(t)))dt} &amp; \text{else}
\end{matrix}\right.\end{split}\end{aligned}\end{align} \]</div>
<div class="math notranslate nohighlight">
\[u(t)=ta+(1-t)x\]</div>
<div class="math notranslate nohighlight">
\[h(f_{A})=-f_{A}log_2(f_{A})-(1-f_A)log_2(1-f_A)\]</div>
<p><span class="math notranslate nohighlight">\(G\)</span> is the universal sample set, <span class="math notranslate nohighlight">\(f_A(\cdot )\)</span> is the predicted probability of class A,
<span class="math notranslate nohighlight">\(\xi\)</span> is the decision threshold (usually 0.5). <span class="math notranslate nohighlight">\(p_{\neg A}\)</span> and <span class="math notranslate nohighlight">\(p_{B}\)</span> are the PDF of
sample’s distribution of non A class(es) and class B representatively. Beware that the ground truth labels take
no part in PLC, a sample’s classes are determined by the classifier.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If <cite>predictor</cite> is a function, <cite>stepwise</cite> is <cite>False</cite> and it is running in graph mode then
<cite>predictor</cite> must complies with the
<a class="reference external" href="https://mindspore.cn/docs/en/master/note/static_graph_syntax_support.html">static graph syntax</a>. PLC may
not be accurate if there are many samples classified to more than one class.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>predictor</strong> (<em>Cell</em><em>, </em><em>Callable</em>) – The classifier <span class="math notranslate nohighlight">\(f(\cdot )\)</span> to be explained, it must take an input tensor
with shape <span class="math notranslate nohighlight">\((N, K)\)</span> and output a probability tensor with shape <span class="math notranslate nohighlight">\((N, L)\)</span>. <span class="math notranslate nohighlight">\(K\)</span> is the
number of features. Both input and output tensors should have dtype <cite>ms.float32</cite> or <cite>ms.float64</cite> .</p></li>
<li><p><strong>num_classes</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a>) – The number of classes <span class="math notranslate nohighlight">\(L\)</span>.</p></li>
<li><p><strong>class_names</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a><em>]</em><em>, </em><a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a><em>]</em><em>, </em><em>optional</em>) – List/tuple of class names, ordered according to whatever the
classifier is using. If not present, class names will be ‘Class 0’, ‘Class 1’, … Default: <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>feature_names</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a><em>]</em><em>, </em><a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a><em>]</em><em>, </em><em>optional</em>) – List/tuple of feature names corresponding to the columns in
the training data. If not present, feature names will be ‘feature 0’, ‘feature 1’, …
Default: <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>stepwise</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a><em>, </em><em>optional</em>) – Set to <code class="docutils literal notranslate"><span class="pre">True</span></code> if <cite>predictor</cite> outputs 0s and 1s only. Default: <cite>False</cite>.</p></li>
<li><p><strong>threshold</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a><em>, </em><em>optional</em>) – Decision threshold <span class="math notranslate nohighlight">\(\xi\)</span> of classification. Default: <code class="docutils literal notranslate"><span class="pre">0.5</span></code>.</p></li>
<li><p><strong>monte_carlo</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>optional</em>) – The number of Monte Carlo samples for computing the integrals <span class="math notranslate nohighlight">\(\vec{R}\)</span>.
Default: <code class="docutils literal notranslate"><span class="pre">1000</span></code>. Higher the number more lengthy and accurate the computation.</p></li>
<li><p><strong>riemann</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>optional</em>) – The number of Riemann sum partitions for computing the integrals
<span class="math notranslate nohighlight">\(\int_{0}^{1}h(f_A(u(t)))dt\)</span>. Default: <code class="docutils literal notranslate"><span class="pre">1000</span></code>. Higher the number more lengthy and accurate the
computation.</p></li>
<li><p><strong>batch_size</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>optional</em>) – Batch size for <cite>predictor</cite> when finding nearest neighbors. Default: <code class="docutils literal notranslate"><span class="pre">2000</span></code>.</p></li>
<li><p><strong>eps</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a><em>, </em><em>optional</em>) – Degree of tolerance. This value must be greater than 0. Default: <code class="docutils literal notranslate"><span class="pre">1e-9</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Inputs:</dt><dd><ul class="simple">
<li><p><strong>features</strong> (Tensor) - The universal sample set <span class="math notranslate nohighlight">\(G\)</span>. Practically, it is often the training set or
its random subset. The shape must be <span class="math notranslate nohighlight">\((|G|, K)\)</span>, <span class="math notranslate nohighlight">\(|G|\)</span> is the total number of samples. The
input tensor should have dtype <cite>ms.float32</cite> or <cite>ms.float64</cite> .</p></li>
<li><p><strong>max_classes</strong> (int, optional)- Maximum number of classes to be shown. Default: <code class="docutils literal notranslate"><span class="pre">5</span></code>.</p></li>
<li><p><strong>max_features</strong> (int, optional) - Maximum number of features to be shown. Default: <code class="docutils literal notranslate"><span class="pre">5</span></code>.</p></li>
<li><p><strong>show</strong> (bool, optional) - Show the explanation figures, <code class="docutils literal notranslate"><span class="pre">None</span></code> means automatically show
the explanation figures if it is running on JupyterLab. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
</ul>
</dd>
<dt>Outputs:</dt><dd><ul class="simple">
<li><p><strong>plc</strong> (Tensor) - Pseudo Linear Coefficients in shape of <span class="math notranslate nohighlight">\((L, K)\)</span>.</p></li>
<li><p><strong>relative plc</strong> (Tensor) - Relative Pseudo Linear Coefficients in shape of <span class="math notranslate nohighlight">\((L, L, K)\)</span>. The first
<span class="math notranslate nohighlight">\(L\)</span> axis is for the target classes and the second one is for the view point classes.</p></li>
</ul>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/library/exceptions.html#TypeError" title="(in Python v3.8)"><strong>TypeError</strong></a> – Be raised for any argument or input type problem.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/library/exceptions.html#ValueError" title="(in Python v3.8)"><strong>ValueError</strong></a> – Be raised for any input value problem.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/library/exceptions.html#AttributeError" title="(in Python v3.8)"><strong>AttributeError</strong></a> – Be raised for underlying is missing any required attribute.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Supported Platforms:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">Ascend</span></code> <code class="docutils literal notranslate"><span class="pre">GPU</span></code> <code class="docutils literal notranslate"><span class="pre">CPU</span></code></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mindspore</span> <span class="k">as</span> <span class="nn">ms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore</span> <span class="kn">import</span> <span class="n">nn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore</span> <span class="kn">import</span> <span class="n">ops</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_xai.explainer</span> <span class="kn">import</span> <span class="n">PseudoLinearCoef</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">Classifier</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Cell</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">construct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="gp">... </span>        <span class="n">y</span> <span class="o">=</span> <span class="n">ops</span><span class="o">.</span><span class="n">Zeros</span><span class="p">()((</span><span class="n">x</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="mi">3</span><span class="p">),</span> <span class="n">ms</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">... </span>        <span class="n">y</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">=</span> <span class="o">-</span><span class="n">x</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span><span class="p">[:</span> <span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.5</span>
<span class="gp">... </span>        <span class="n">y</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">=</span>  <span class="n">x</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span><span class="p">[:</span> <span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.5</span>
<span class="gp">... </span>        <span class="n">y</span><span class="p">[:,</span> <span class="mi">2</span><span class="p">]</span> <span class="o">=</span>  <span class="n">x</span><span class="p">[:,</span> <span class="mi">0</span><span class="p">]</span> <span class="o">+</span> <span class="n">x</span><span class="p">[:,</span> <span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="n">x</span><span class="p">[:</span> <span class="p">,</span><span class="mi">2</span><span class="p">]</span> <span class="o">-</span> <span class="mf">0.5</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="n">ops</span><span class="o">.</span><span class="n">Sigmoid</span><span class="p">()(</span><span class="n">y</span> <span class="o">*</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">classifier</span> <span class="o">=</span> <span class="n">Classifier</span><span class="p">()</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">explainer</span> <span class="o">=</span> <span class="n">PseudoLinearCoef</span><span class="p">(</span><span class="n">classifier</span><span class="p">,</span> <span class="n">num_classes</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">features</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">uniform</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">10000</span><span class="p">,</span> <span class="mi">5</span><span class="p">)),</span> <span class="n">dtype</span><span class="o">=</span><span class="n">ms</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>  <span class="c1"># 5 features</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plc</span><span class="p">,</span> <span class="n">relative_plc</span> <span class="o">=</span> <span class="n">explainer</span><span class="p">(</span><span class="n">features</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">plc</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="go">(3, 5)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="nb">str</span><span class="p">(</span><span class="n">relative_plc</span><span class="o">.</span><span class="n">shape</span><span class="p">))</span>
<span class="go">(3, 3, 5)</span>
</pre></div>
</div>
<dl class="py method">
<dt class="sig sig-object py" id="mindspore_xai.explainer.PseudoLinearCoef.normalize">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">normalize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">plc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">per_vector</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">eps</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">1e-09</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_xai/explainer/neighbor/pseudo_linear_coef.html#PseudoLinearCoef.normalize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_xai.explainer.PseudoLinearCoef.normalize" title="Permalink to this definition"></a></dt>
<dd><p>Normalize Pseudo Linear Coefficients to range [-1, 1].</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Normalizing PLC from unnormalized features may lead to misleading results.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>plc</strong> (<em>Tensor</em>) – The PLC or Relative PLC to be normalized.</p></li>
<li><p><strong>per_vector</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#bool" title="(in Python v3.8)"><em>bool</em></a><em>, </em><em>optional</em>) – Normalize within each <span class="math notranslate nohighlight">\(\vec{R}\)</span> vector. Default: <code class="docutils literal notranslate"><span class="pre">False</span></code>.</p></li>
<li><p><strong>eps</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#float" title="(in Python v3.8)"><em>float</em></a><em>, </em><em>optional</em>) – Degree of tolerance. This value must be greater than 0. Default: <code class="docutils literal notranslate"><span class="pre">1e-9</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns</dt>
<dd class="field-even"><p>Tensor, the normalized values.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore</span> <span class="kn">import</span> <span class="n">Tensor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_xai.explainer</span> <span class="kn">import</span> <span class="n">PseudoLinearCoef</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plc</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">([[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">PseudoLinearCoef</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">plc</span><span class="p">))</span>
<span class="go">[[ 0.05  0.3   0.4 ]</span>
<span class="go"> [-1.    0.1   0.2 ]</span>
<span class="go"> [ 0.2   0.05 -0.05]]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">PseudoLinearCoef</span><span class="o">.</span><span class="n">normalize</span><span class="p">(</span><span class="n">plc</span><span class="p">,</span> <span class="n">per_vector</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>
<span class="go">[[ 0.125  0.75   1.   ]</span>
<span class="go"> [-1.     0.1    0.2  ]</span>
<span class="go"> [ 1.     0.25  -0.25 ]]</span>
</pre></div>
</div>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="mindspore_xai.explainer.PseudoLinearCoef.plot">
<em class="property"><span class="pre">classmethod</span><span class="w"> </span></em><span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">plc</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_xai/explainer/neighbor/pseudo_linear_coef.html#PseudoLinearCoef.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_xai.explainer.PseudoLinearCoef.plot" title="Permalink to this definition"></a></dt>
<dd><p>Plot the specific bidirectional chart for a PLC or Relative PLC pair.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>plc</strong> (<em>Tensor</em>) – Pseudo Linear Coefficients or Relative Pseudo Linear Coefficients in shape of <span class="math notranslate nohighlight">\((K,)\)</span>.</p></li>
<li><p><strong>title</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a><em>, </em><em>optional</em>) – Chart title. If not present, chart title will not be displayed. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>feature_names</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em>[</em><a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a><em>]</em><em>, </em><a class="reference external" href="https://docs.python.org/library/stdtypes.html#tuple" title="(in Python v3.8)"><em>tuple</em></a><em>[</em><a class="reference external" href="https://docs.python.org/library/stdtypes.html#str" title="(in Python v3.8)"><em>str</em></a><em>]</em><em>, </em><em>optional</em>) – Feature names. If not present, feature names will be
‘feature 0’, ‘feature 1’, … Default: <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>max_features</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>optional</em>) – Maximum number of features to be shown. Default: <code class="docutils literal notranslate"><span class="pre">5</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Raises</dt>
<dd class="field-even"><p><a class="reference external" href="https://docs.python.org/library/exceptions.html#ValueError" title="(in Python v3.8)"><strong>ValueError</strong></a> – Be raised for any input value problem.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore</span> <span class="kn">import</span> <span class="n">Tensor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_xai.explainer</span> <span class="kn">import</span> <span class="n">PseudoLinearCoef</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">plc</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">([[</span><span class="mf">0.1</span><span class="p">,</span> <span class="mf">0.6</span><span class="p">,</span> <span class="mf">0.8</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">PseudoLinearCoef</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">plc</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Chart Title&#39;</span><span class="p">,</span> <span class="n">feature_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;f1&#39;</span><span class="p">,</span><span class="s1">&#39;f2&#39;</span><span class="p">,</span><span class="s1">&#39;f3&#39;</span><span class="p">])</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">relative_plc</span> <span class="o">=</span> <span class="n">Tensor</span><span class="p">([[[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.4</span><span class="p">]],</span> <span class="p">[[</span><span class="mf">0.4</span><span class="p">,</span> <span class="mf">0.1</span><span class="p">,</span> <span class="o">-</span><span class="mf">0.1</span><span class="p">],</span> <span class="p">[</span><span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">,</span> <span class="mf">0.</span><span class="p">]]])</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">PseudoLinearCoef</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">relative_plc</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">1</span><span class="p">],</span> <span class="n">title</span><span class="o">=</span><span class="s1">&#39;Chart Title&#39;</span><span class="p">,</span> <span class="n">feature_names</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;f1&#39;</span><span class="p">,</span><span class="s1">&#39;f2&#39;</span><span class="p">,</span><span class="s1">&#39;f3&#39;</span><span class="p">])</span>
</pre></div>
</div>
</dd></dl>

</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_xai.explainer.RISE">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_xai.explainer.</span></span><span class="sig-name descname"><span class="pre">RISE</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">network</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">perturbation_per_eval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_xai/explainer/perturb/rise.html#RISE"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_xai.explainer.RISE" title="Permalink to this definition"></a></dt>
<dd><p>RISE: Randomized Input Sampling for Explanation of Black-box Model.</p>
<p>RISE is a perturbation-based method that generates attribution maps by sampling on multiple random binary masks.
The original image <span class="math notranslate nohighlight">\(I\)</span> is randomly masked, and then fed into the black-box model to get predictions. The final
attribution map is the weighted sum of these random masks <span class="math notranslate nohighlight">\(M_i\)</span> , with the weights being the corresponding
output on the node of interest:</p>
<div class="math notranslate nohighlight">
\[attribution = \sum_{i}f_c(I\odot M_i)  M_i\]</div>
<p>For more details, please refer to the original paper via: <a class="reference external" href="https://arxiv.org/abs/1806.07421">RISE</a>.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>network</strong> (<em>Cell</em>) – The black-box model to be explained.</p></li>
<li><p><strong>activation_fn</strong> (<em>Cell</em>) – The activation layer that transforms logits to prediction probabilities. For
single label classification tasks, <cite>nn.Softmax</cite> is usually applied. As for multi-label classification
tasks, <cite>nn.Sigmoid</cite> is usually be applied. Users can also pass their own customized <cite>activation_fn</cite> as long
as when combining this function with network, the final output is the probability of the input.</p></li>
<li><p><strong>perturbation_per_eval</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>optional</em>) – Number of perturbations for each inference during inferring the
perturbed samples. Within the memory capacity, usually the larger this number is, the faster the
explanation is obtained. Default: <code class="docutils literal notranslate"><span class="pre">32</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Inputs:</dt><dd><ul class="simple">
<li><p><strong>inputs</strong> (Tensor) - The input data to be explained, a 4D tensor of shape <span class="math notranslate nohighlight">\((N, C, H, W)\)</span>.</p></li>
<li><p><strong>targets</strong> (Tensor, int) - The labels of interest to be explained. When <cite>targets</cite> is an integer,
all of the inputs will generates attribution map w.r.t this integer. When <cite>targets</cite> is a tensor, it
should be of shape <span class="math notranslate nohighlight">\((N, L)\)</span> (L being the number of labels for each sample) or <span class="math notranslate nohighlight">\((N,)\)</span> <span class="math notranslate nohighlight">\(()\)</span>.</p></li>
<li><p><strong>ret</strong> (str, optional): The return object type. <code class="docutils literal notranslate"><span class="pre">'tensor'</span></code> means returns a Tensor object, <code class="docutils literal notranslate"><span class="pre">'image'</span></code>
means return a PIL.Image.Image list. Default: <code class="docutils literal notranslate"><span class="pre">'tensor'</span></code>.</p></li>
<li><p><strong>show</strong> (bool, optional): Show the saliency images, <code class="docutils literal notranslate"><span class="pre">None</span></code> means automatically show the saliency images
if it is running on JupyterLab. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
</ul>
</dd>
<dt>Outputs:</dt><dd><p>Tensor, a 4D tensor of shape <span class="math notranslate nohighlight">\((N, L, H, W)\)</span> when <cite>targets</cite> is a tensor of shape <span class="math notranslate nohighlight">\((N, L)\)</span>, otherwise
a tensor of shape <span class="math notranslate nohighlight">\((N, 1, H, W)\)</span>, saliency maps. Or list[list[PIL.Image.Image]], the normalized saliency
images if <cite>ret</cite> was set to <code class="docutils literal notranslate"><span class="pre">'image'</span></code>.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/library/exceptions.html#TypeError" title="(in Python v3.8)"><strong>TypeError</strong></a> – Be raised for any argument or input type problem.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/library/exceptions.html#ValueError" title="(in Python v3.8)"><strong>ValueError</strong></a> – Be raised for any input value problem.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Supported Platforms:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">Ascend</span></code> <code class="docutils literal notranslate"><span class="pre">GPU</span></code></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mindspore</span> <span class="k">as</span> <span class="nn">ms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_xai.explainer</span> <span class="kn">import</span> <span class="n">RISE</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore</span> <span class="kn">import</span> <span class="n">set_context</span><span class="p">,</span> <span class="n">PYNATIVE_MODE</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">set_context</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="n">PYNATIVE_MODE</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># The detail of LeNet5 is shown in models.official.cv.lenet.src.lenet.py</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">net</span> <span class="o">=</span> <span class="n">LeNet5</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">num_channel</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># initialize RISE explainer with the pretrained model and activation function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">activation_fn</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Softmax</span><span class="p">()</span> <span class="c1"># softmax layer is applied to transform logits to probabilities</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">rise</span> <span class="o">=</span> <span class="n">RISE</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="n">activation_fn</span><span class="o">=</span><span class="n">activation_fn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># given an instance of RISE, saliency map can be generate</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inputs</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">),</span> <span class="n">ms</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># when &#39;targets&#39; is an integer</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">targets</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">saliency</span> <span class="o">=</span> <span class="n">rise</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">targets</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">saliency</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(2, 1, 32, 32)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># &#39;targets&#39; can also be a 2D tensor</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">targets</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([[</span><span class="mi">5</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">]],</span> <span class="n">ms</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">saliency</span> <span class="o">=</span> <span class="n">rise</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">targets</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">saliency</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(2, 1, 32, 32)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_xai.explainer.RISEPlus">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_xai.explainer.</span></span><span class="sig-name descname"><span class="pre">RISEPlus</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">ood_net</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">network</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">activation_fn</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">perturbation_per_eval</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">32</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_xai/explainer/perturb/riseplus.html#RISEPlus"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_xai.explainer.RISEPlus" title="Permalink to this definition"></a></dt>
<dd><p>Provides RISEPlus explanation method.</p>
<p>RISEPlus is a perturbation-based method that generates attribution maps by sampling on multiple random binary
masks. An OoD detector is adopted to produce an ‘inlier score’, estimating the probability that a sample is
generated from the distribution. Then the inlier score is aggregated to the weighted sum of the random masks, with
the weights being the corresponding output on the node of interest:</p>
<div class="math notranslate nohighlight">
\[attribution = \sum_{i}s_if_c(I\odot M_i)  M_i\]</div>
<p>For more details, please refer to the original paper:
<a class="reference external" href="https://arxiv.org/abs/2107.14000">Resisting Out-of-Distribution Data Problem in Perturbation of XAI</a> .</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>ood_net</strong> (<a class="reference internal" href="mindspore_xai.tool.html#mindspore_xai.tool.cv.OoDNet" title="mindspore_xai.tool.cv.OoDNet"><em>OoDNet</em></a>) – The OoD network for generating inlier score.</p></li>
<li><p><strong>network</strong> (<em>Cell</em>) – The black-box model to be explained.</p></li>
<li><p><strong>activation_fn</strong> (<em>Cell</em>) – The activation layer that transforms logits to prediction probabilities. For
single label classification tasks, <cite>nn.Softmax</cite> is usually applied. As for multi-label classification
tasks, <cite>nn.Sigmoid</cite> is usually be applied. Users can also pass their own customized <cite>activation_fn</cite> as
long as when combining this function with network, the final output is the probability of the input.</p></li>
<li><p><strong>perturbation_per_eval</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>optional</em>) – Number of perturbations for each inference during inferring the
perturbed samples. Within the memory capacity, usually the larger this number is, the faster the
explanation is obtained. Default: <code class="docutils literal notranslate"><span class="pre">32</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Inputs:</dt><dd><ul class="simple">
<li><p><strong>inputs</strong> (Tensor) - The input data to be explained, a 4D tensor of shape <span class="math notranslate nohighlight">\((N, C, H, W)\)</span>.</p></li>
<li><p><strong>targets</strong> (Tensor, int) - The labels of interest to be explained. When <cite>targets</cite> is an integer,
all of the inputs will generates attribution map w.r.t this integer. When <cite>targets</cite> is a tensor, it
should be of shape <span class="math notranslate nohighlight">\((N, L)\)</span> (L being the number of labels for each sample) or <span class="math notranslate nohighlight">\((N,)\)</span> <span class="math notranslate nohighlight">\(()\)</span>.</p></li>
<li><p><strong>ret</strong> (str, optional): The return object type. <code class="docutils literal notranslate"><span class="pre">'tensor'</span></code> means returns a Tensor object, <code class="docutils literal notranslate"><span class="pre">'image'</span></code>
means return a PIL.Image.Image list. Default: <code class="docutils literal notranslate"><span class="pre">'tensor'</span></code>.</p></li>
<li><p><strong>show</strong> (bool, optional): Show the saliency images, <code class="docutils literal notranslate"><span class="pre">None</span></code> means automatically show the saliency images
if it is running on JupyterLab. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
</ul>
</dd>
<dt>Outputs:</dt><dd><p>Tensor, a 4D tensor of shape <span class="math notranslate nohighlight">\((N, L, H, W)\)</span> when <cite>targets</cite> is a tensor of shape <span class="math notranslate nohighlight">\((N, L)\)</span>, otherwise
a tensor of shape <span class="math notranslate nohighlight">\((N, 1, H, W)\)</span>, saliency maps. Or list[list[PIL.Image.Image]], the normalized saliency
images if <cite>ret</cite> was set to <code class="docutils literal notranslate"><span class="pre">'image'</span></code>.</p>
</dd>
</dl>
<dl class="field-list simple">
<dt class="field-odd">Raises</dt>
<dd class="field-odd"><ul class="simple">
<li><p><a class="reference external" href="https://docs.python.org/library/exceptions.html#TypeError" title="(in Python v3.8)"><strong>TypeError</strong></a> – Be raised for any argument or input type problem.</p></li>
<li><p><a class="reference external" href="https://docs.python.org/library/exceptions.html#ValueError" title="(in Python v3.8)"><strong>ValueError</strong></a> – Be raised for any input value problem.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Supported Platforms:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">Ascend</span></code> <code class="docutils literal notranslate"><span class="pre">GPU</span></code></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mindspore</span> <span class="k">as</span> <span class="nn">ms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore</span> <span class="kn">import</span> <span class="n">nn</span><span class="p">,</span> <span class="n">set_context</span><span class="p">,</span> <span class="n">PYNATIVE_MODE</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore.common.initializer</span> <span class="kn">import</span> <span class="n">Normal</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_xai.explainer</span> <span class="kn">import</span> <span class="n">RISEPlus</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_xai.tool.cv</span> <span class="kn">import</span> <span class="n">OoDNet</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">MyLeNet5</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Cell</span><span class="p">):</span>
<span class="gp">... </span>   <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_class</span><span class="p">,</span> <span class="n">num_channel</span><span class="p">):</span>
<span class="gp">... </span>       <span class="nb">super</span><span class="p">(</span><span class="n">MyLeNet5</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<span class="gp">...</span>
<span class="gp">... </span>       <span class="c1"># must add the following 2 attributes to your model</span>
<span class="gp">... </span>       <span class="bp">self</span><span class="o">.</span><span class="n">num_features</span> <span class="o">=</span> <span class="mi">84</span> <span class="c1"># no. of features, int</span>
<span class="gp">... </span>       <span class="bp">self</span><span class="o">.</span><span class="n">output_features</span> <span class="o">=</span> <span class="kc">False</span> <span class="c1"># output features flag, bool</span>
<span class="gp">...</span>
<span class="gp">... </span>       <span class="bp">self</span><span class="o">.</span><span class="n">conv1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="n">num_channel</span><span class="p">,</span> <span class="mi">6</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">pad_mode</span><span class="o">=</span><span class="s1">&#39;valid&#39;</span><span class="p">)</span>
<span class="gp">... </span>       <span class="bp">self</span><span class="o">.</span><span class="n">conv2</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Conv2d</span><span class="p">(</span><span class="mi">6</span><span class="p">,</span> <span class="mi">16</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="n">pad_mode</span><span class="o">=</span><span class="s1">&#39;valid&#39;</span><span class="p">)</span>
<span class="gp">... </span>       <span class="bp">self</span><span class="o">.</span><span class="n">relu</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">ReLU</span><span class="p">()</span>
<span class="gp">... </span>       <span class="bp">self</span><span class="o">.</span><span class="n">max_pool2d</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">MaxPool2d</span><span class="p">(</span><span class="n">kernel_size</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">stride</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="gp">... </span>       <span class="bp">self</span><span class="o">.</span><span class="n">flatten</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Flatten</span><span class="p">()</span>
<span class="gp">... </span>       <span class="bp">self</span><span class="o">.</span><span class="n">fc1</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">16</span> <span class="o">*</span> <span class="mi">5</span> <span class="o">*</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">120</span><span class="p">,</span> <span class="n">weight_init</span><span class="o">=</span><span class="n">Normal</span><span class="p">(</span><span class="mf">0.02</span><span class="p">))</span>
<span class="gp">... </span>       <span class="bp">self</span><span class="o">.</span><span class="n">fc2</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="mi">120</span><span class="p">,</span> <span class="bp">self</span><span class="o">.</span><span class="n">num_features</span><span class="p">,</span> <span class="n">weight_init</span><span class="o">=</span><span class="n">Normal</span><span class="p">(</span><span class="mf">0.02</span><span class="p">))</span>
<span class="gp">... </span>       <span class="bp">self</span><span class="o">.</span><span class="n">fc3</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">num_features</span><span class="p">,</span> <span class="n">num_class</span><span class="p">,</span> <span class="n">weight_init</span><span class="o">=</span><span class="n">Normal</span><span class="p">(</span><span class="mf">0.02</span><span class="p">))</span>
<span class="gp">...</span>
<span class="gp">... </span>   <span class="k">def</span> <span class="nf">construct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="gp">... </span>       <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">conv1</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">... </span>       <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">... </span>       <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_pool2d</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">... </span>       <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">conv2</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">... </span>       <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">... </span>       <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">max_pool2d</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">... </span>       <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">flatten</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">... </span>       <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fc1</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="gp">... </span>       <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">relu</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">fc2</span><span class="p">(</span><span class="n">x</span><span class="p">))</span>
<span class="gp">...</span>
<span class="gp">... </span>       <span class="c1"># return the features tensor if output_features is True</span>
<span class="gp">... </span>       <span class="k">if</span> <span class="bp">self</span><span class="o">.</span><span class="n">output_features</span><span class="p">:</span>
<span class="gp">... </span>           <span class="k">return</span> <span class="n">x</span>
<span class="gp">...</span>
<span class="gp">... </span>       <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fc3</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">... </span>       <span class="k">return</span> <span class="n">x</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># only PYNATIVE_MODE is supported</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">set_context</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="n">PYNATIVE_MODE</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># prepare trained classifier</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">net</span> <span class="o">=</span> <span class="n">MyLeNet5</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="n">num_channel</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># prepare OoD network</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">ood_net</span> <span class="o">=</span> <span class="n">OoDNet</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># initialize RISEPlus explainer with the pretrained model and activation function</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">activation_fn</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">nn</span><span class="o">.</span><span class="n">Softmax</span><span class="p">()</span> <span class="c1"># softmax layer is applied to transform logits to probabilities</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">riseplus</span> <span class="o">=</span> <span class="n">RISEPlus</span><span class="p">(</span><span class="n">ood_net</span><span class="p">,</span> <span class="n">net</span><span class="p">,</span> <span class="n">activation_fn</span><span class="o">=</span><span class="n">activation_fn</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># given an instance of RISEPlus, saliency map can be generate</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inputs</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">32</span><span class="p">,</span> <span class="mi">32</span><span class="p">),</span> <span class="n">ms</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># when &#39;targets&#39; is an integer</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">targets</span> <span class="o">=</span> <span class="mi">5</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">saliency</span> <span class="o">=</span> <span class="n">riseplus</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">targets</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">saliency</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(2, 1, 32, 32)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_xai.explainer.SHAPGradient">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_xai.explainer.</span></span><span class="sig-name descname"><span class="pre">SHAPGradient</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">network</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_neighbours</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">200</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_xai/explainer/shap/gradient.html#SHAPGradient"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_xai.explainer.SHAPGradient" title="Permalink to this definition"></a></dt>
<dd><p>Provides SHAP gradient explanation method.</p>
<p>Explains a network using expected gradients (an extension of integrated gradients).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The parsed <cite>network</cite> will be set to eval mode through <cite>network.set_grad(False)</cite> and <cite>network.set_train(False)</cite>.
If you want to train the <cite>network</cite> afterwards, please reset it back to training mode through the opposite
operations.</p>
</div>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>network</strong> (<em>Cell</em>) – The mindspore cell to be explained. For classification, it accepts a 2D tensor of
shape <span class="math notranslate nohighlight">\((N, K)\)</span> as input and outputs a 2D tensor of shape <span class="math notranslate nohighlight">\((N, L)\)</span>. For regression, it
accepts a 2D tensor of shape <span class="math notranslate nohighlight">\((N, K)\)</span> as input and outputs a 1D tensor of
shape <span class="math notranslate nohighlight">\((N)\)</span>.</p></li>
<li><p><strong>features</strong> (<em>Tensor</em>) – 2D tensor of shape <span class="math notranslate nohighlight">\((N, K)\)</span> (N being the number of samples, K being the number of
features). The background dataset to use for integrating out features, accept (whole or part of) training
dataset.</p></li>
<li><p><strong>feature_names</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em>, </em><em>optional</em>) – list of names (strings) corresponding to the columns in the training data.
Default: <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>class_names</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em>, </em><em>optional</em>) – list of class names, ordered according to whatever the classifier is using. If
not present, class names will be ‘0’, ‘1’, … Default: <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>num_neighbours</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>optional</em>) – Number of subsets used for the estimation of the shap values. Default: <code class="docutils literal notranslate"><span class="pre">200</span></code>.</p></li>
<li><p><strong>max_features</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>optional</em>) – Maximum number of features present in explanation. Default: <code class="docutils literal notranslate"><span class="pre">10</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Inputs:</dt><dd><ul class="simple">
<li><p><strong>inputs</strong> (Tensor) - The input data to be explained, a 2D float tensor of shape <span class="math notranslate nohighlight">\((N, K)\)</span>.</p></li>
<li><p><strong>targets</strong> (Tensor, numpy.ndarray, list, int, optional) - The labels of interest to be explained. When
<cite>targets</cite> is an integer, all the inputs will generate attribution map w.r.t this integer. When <cite>targets</cite> is a
tensor or numpy array or list, it should be of shape <span class="math notranslate nohighlight">\((N, L)\)</span> (L being the number of labels for each
sample), <span class="math notranslate nohighlight">\((N,)\)</span> or <span class="math notranslate nohighlight">\(()\)</span>. Default: <code class="docutils literal notranslate"><span class="pre">0</span></code>.</p></li>
<li><p><strong>show</strong> (bool, optional): Show the explanation figures, <code class="docutils literal notranslate"><span class="pre">None</span></code> means automatically show the explanation
figures if it is running on JupyterLab. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
</ul>
</dd>
<dt>Outputs:</dt><dd><p>Tensor, a 3D tensor of shape <span class="math notranslate nohighlight">\((N, L, K)\)</span>. The first dimension represents inputs.
The second dimension represents targets. The third dimension represents feature weight.</p>
</dd>
<dt>Supported Platforms:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">Ascend</span></code> <code class="docutils literal notranslate"><span class="pre">GPU</span></code></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mindspore</span> <span class="k">as</span> <span class="nn">ms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mindspore.nn</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore</span> <span class="kn">import</span> <span class="n">set_context</span><span class="p">,</span> <span class="n">PYNATIVE_MODE</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_xai.explainer</span> <span class="kn">import</span> <span class="n">SHAPGradient</span>
<span class="gp">&gt;&gt;&gt;</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">set_context</span><span class="p">(</span><span class="n">mode</span><span class="o">=</span><span class="n">PYNATIVE_MODE</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Linear classification model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">LinearNet</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Cell</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_inputs</span><span class="p">,</span> <span class="n">num_class</span><span class="p">):</span>
<span class="gp">... </span>        <span class="nb">super</span><span class="p">(</span><span class="n">LinearNet</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">fc</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">num_inputs</span><span class="p">,</span> <span class="n">num_class</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="n">nn</span><span class="o">.</span><span class="n">Softmax</span><span class="p">())</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">construct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="gp">... </span>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fc</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">net</span> <span class="o">=</span> <span class="n">LinearNet</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># use iris data as example</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feature_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;sepal length (cm)&#39;</span><span class="p">,</span> <span class="s1">&#39;sepal width (cm)&#39;</span><span class="p">,</span> <span class="s1">&#39;petal length (cm)&#39;</span><span class="p">,</span> <span class="s1">&#39;petal width (cm)&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">class_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;setosa&#39;</span><span class="p">,</span> <span class="s1">&#39;versicolor&#39;</span><span class="p">,</span> <span class="s1">&#39;virginica&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">training_data</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">ms</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shap</span> <span class="o">=</span> <span class="n">SHAPGradient</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="n">training_data</span><span class="p">,</span> <span class="n">feature_names</span><span class="o">=</span><span class="n">feature_names</span><span class="p">,</span> <span class="n">class_names</span><span class="o">=</span><span class="n">class_names</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inputs</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">ms</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">targets</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]],</span> <span class="n">ms</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">exps</span> <span class="o">=</span> <span class="n">shap</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">targets</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">exps</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(2, 2, 4)</span>
</pre></div>
</div>
</dd></dl>

<dl class="py class">
<dt class="sig sig-object py" id="mindspore_xai.explainer.SHAPKernel">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">mindspore_xai.explainer.</span></span><span class="sig-name descname"><span class="pre">SHAPKernel</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">predictor</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">features</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">feature_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">class_names</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">num_neighbours</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">5000</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_features</span></span><span class="o"><span class="pre">=</span></span><span class="default_value"><span class="pre">10</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="_modules/mindspore_xai/explainer/shap/kernel.html#SHAPKernel"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#mindspore_xai.explainer.SHAPKernel" title="Permalink to this definition"></a></dt>
<dd><p>Provides Kernel SHAP explanation method.</p>
<p>Uses the Kernel SHAP method to explain the output of any function.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters</dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>predictor</strong> (<em>Cell</em><em>, </em><em>Callable</em>) – The black-box model to be explained, should be a <cite>Cell</cite> object or function. For
classification model, it accepts a 2D array/tensor of shape <span class="math notranslate nohighlight">\((N, K)\)</span> as input and outputs a 2D
array/tensor of shape <span class="math notranslate nohighlight">\((N, L)\)</span>. For regression model, it accepts a 2D array/tensor of shape
<span class="math notranslate nohighlight">\((N, K)\)</span> as input and outputs a 1D array/tensor of shape <span class="math notranslate nohighlight">\((N)\)</span>.</p></li>
<li><p><strong>features</strong> (<em>Tensor</em><em>, </em><a class="reference external" href="https://docs.scipy.org/doc/numpy/reference/generated/numpy.ndarray.html#numpy.ndarray" title="(in NumPy v1.17)"><em>numpy.ndarray</em></a>) – 2D tensor or 2D numpy array of shape <span class="math notranslate nohighlight">\((N, K)\)</span> (N being the number of
samples, K being the number of features). The background dataset to use for integrating out features,
accept (whole or part of) training dataset.</p></li>
<li><p><strong>feature_names</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em>, </em><em>optional</em>) – list of names (strings) corresponding to the columns in the training data.
Default: <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>class_names</strong> (<a class="reference external" href="https://docs.python.org/library/stdtypes.html#list" title="(in Python v3.8)"><em>list</em></a><em>, </em><em>optional</em>) – list of class names, ordered according to whatever the classifier is using. If
not present, class names will be ‘0’, ‘1’, … Default: <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
<li><p><strong>num_neighbours</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>optional</em>) – Number of subsets used for the estimation of the shap values. Default: <code class="docutils literal notranslate"><span class="pre">5000</span></code>.</p></li>
<li><p><strong>max_features</strong> (<a class="reference external" href="https://docs.python.org/library/functions.html#int" title="(in Python v3.8)"><em>int</em></a><em>, </em><em>optional</em>) – Maximum number of features present in explanation. Default: <code class="docutils literal notranslate"><span class="pre">10</span></code>.</p></li>
</ul>
</dd>
</dl>
<dl class="simple">
<dt>Inputs:</dt><dd><ul class="simple">
<li><p><strong>inputs</strong> (Tensor, numpy.ndarray) - The input data to be explained, a 2D float tensor or 2D float numpy
array of shape <span class="math notranslate nohighlight">\((N, K)\)</span>.</p></li>
<li><p><strong>targets</strong> (Tensor, numpy.ndarray, list, int, optional) - The labels of interest to be explained. When
<cite>targets</cite> is an integer, all the inputs will generate attribution map w.r.t this integer. When <cite>targets</cite> is a
tensor or numpy array or list, it should be of shape <span class="math notranslate nohighlight">\((N, L)\)</span> (L being the number of labels for each
sample), <span class="math notranslate nohighlight">\((N,)\)</span> or <span class="math notranslate nohighlight">\(()\)</span>. Default: <code class="docutils literal notranslate"><span class="pre">0</span></code>.</p></li>
<li><p><strong>show</strong> (bool, optional): Show the explanation figures, <code class="docutils literal notranslate"><span class="pre">None</span></code> means automatically show the explanation
figures if it is running on JupyterLab. Default: <code class="docutils literal notranslate"><span class="pre">None</span></code>.</p></li>
</ul>
</dd>
<dt>Outputs:</dt><dd><p>Tensor, a 3D tensor of shape <span class="math notranslate nohighlight">\((N, L, K)\)</span>. The first dimension represents inputs.
The second dimension represents targets. The third dimension represents feature weight.</p>
</dd>
<dt>Supported Platforms:</dt><dd><p><code class="docutils literal notranslate"><span class="pre">Ascend</span></code> <code class="docutils literal notranslate"><span class="pre">GPU</span></code></p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="doctest highlight-default notranslate"><div class="highlight"><pre><span></span><span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mindspore</span> <span class="k">as</span> <span class="nn">ms</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">import</span> <span class="nn">mindspore.nn</span> <span class="k">as</span> <span class="nn">nn</span>
<span class="gp">&gt;&gt;&gt; </span><span class="kn">from</span> <span class="nn">mindspore_xai.explainer</span> <span class="kn">import</span> <span class="n">SHAPKernel</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># Linear classification model</span>
<span class="gp">&gt;&gt;&gt; </span><span class="k">class</span> <span class="nc">LinearNet</span><span class="p">(</span><span class="n">nn</span><span class="o">.</span><span class="n">Cell</span><span class="p">):</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">num_inputs</span><span class="p">,</span> <span class="n">num_class</span><span class="p">):</span>
<span class="gp">... </span>        <span class="nb">super</span><span class="p">(</span><span class="n">LinearNet</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="fm">__init__</span><span class="p">()</span>
<span class="gp">... </span>        <span class="bp">self</span><span class="o">.</span><span class="n">fc</span> <span class="o">=</span> <span class="n">nn</span><span class="o">.</span><span class="n">Dense</span><span class="p">(</span><span class="n">num_inputs</span><span class="p">,</span> <span class="n">num_class</span><span class="p">,</span> <span class="n">activation</span><span class="o">=</span><span class="n">nn</span><span class="o">.</span><span class="n">Softmax</span><span class="p">())</span>
<span class="gp">... </span>    <span class="k">def</span> <span class="nf">construct</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">x</span><span class="p">):</span>
<span class="gp">... </span>        <span class="n">x</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">fc</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
<span class="gp">... </span>        <span class="k">return</span> <span class="n">x</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">net</span> <span class="o">=</span> <span class="n">LinearNet</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">3</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="c1"># use iris data as example</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">feature_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;sepal length (cm)&#39;</span><span class="p">,</span> <span class="s1">&#39;sepal width (cm)&#39;</span><span class="p">,</span> <span class="s1">&#39;petal length (cm)&#39;</span><span class="p">,</span> <span class="s1">&#39;petal width (cm)&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">class_names</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;setosa&#39;</span><span class="p">,</span> <span class="s1">&#39;versicolor&#39;</span><span class="p">,</span> <span class="s1">&#39;virginica&#39;</span><span class="p">]</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">training_data</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">ms</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">shap</span> <span class="o">=</span> <span class="n">SHAPKernel</span><span class="p">(</span><span class="n">net</span><span class="p">,</span> <span class="n">training_data</span><span class="p">,</span> <span class="n">feature_names</span><span class="o">=</span><span class="n">feature_names</span><span class="p">,</span> <span class="n">class_names</span><span class="o">=</span><span class="n">class_names</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">inputs</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">2</span><span class="p">,</span> <span class="mi">4</span><span class="p">),</span> <span class="n">ms</span><span class="o">.</span><span class="n">float32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">targets</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">Tensor</span><span class="p">([[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">]],</span> <span class="n">ms</span><span class="o">.</span><span class="n">int32</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="n">exps</span> <span class="o">=</span> <span class="n">shap</span><span class="p">(</span><span class="n">inputs</span><span class="p">,</span> <span class="n">targets</span><span class="p">)</span>
<span class="gp">&gt;&gt;&gt; </span><span class="nb">print</span><span class="p">(</span><span class="n">exps</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
<span class="go">(2, 2, 4)</span>
</pre></div>
</div>
</dd></dl>

</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="using_tbnet.html" class="btn btn-neutral float-left" title="Using TB-Net Whitebox Recommendation Model" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="mindspore_xai.benchmark.html" class="btn btn-neutral float-right" title="mindspore_xai.benchmark" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright MindSpore.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 
</body>
</html>