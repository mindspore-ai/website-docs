

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  <meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Using TB-Net Whitebox Recommendation Model &mdash; MindSpore master documentation</title>
  

  
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
   
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />
  
  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script data-url_root="./" id="documentation_options" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="next" title="mindspore_xai.explainer" href="mindspore_xai.explainer.html" />
    <link rel="prev" title="Using TabSim Data Simulator" href="using_tabsim.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> MindSpore
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption" role="heading"><span class="caption-text">Installation</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="installation.html">MindSpore XAI Installation</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">Guide</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="using_cv_explainers.html">Using CV Explainers</a></li>
<li class="toctree-l1"><a class="reference internal" href="using_cv_benchmarks.html">Using CV Benchmarks</a></li>
<li class="toctree-l1"><a class="reference internal" href="using_tabular_explainers.html">Using Tabular Explainers</a></li>
<li class="toctree-l1"><a class="reference internal" href="using_tabsim.html">Using TabSim Data Simulator</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Using TB-Net Whitebox Recommendation Model</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#what-is-tb-net">What is TB-Net</a></li>
<li class="toctree-l2"><a class="reference internal" href="#preparations">Preparations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#downloading-data-package">Downloading Data Package</a></li>
<li class="toctree-l3"><a class="reference internal" href="#preparing-python-environment">Preparing Python Environment</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#data-pre-processing">Data Pre-processing</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#source-datafile-format">Source Datafile Format</a></li>
<li class="toctree-l3"><a class="reference internal" href="#converting-to-relation-path-data">Converting to Relation Path Data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#relation-path-data-format">Relation Path Data Format</a></li>
<li class="toctree-l3"><a class="reference internal" href="#running-preprocess-py">Running preprocess.py</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#training-and-evaluation">Training and Evaluation</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#running-train-py">Running train.py</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#inference-with-explanations">Inference with Explanations</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#running-infer-py">Running infer.py</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#exporting-trained-model">Exporting Trained Model</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#running-export-py">Running export.py</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="#example-script-arguments-and-model-performance">Example Script Arguments and Model Performance</a></li>
</ul>
</li>
</ul>
<p class="caption" role="heading"><span class="caption-text">API References</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="mindspore_xai.explainer.html">mindspore_xai.explainer</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindspore_xai.benchmark.html">mindspore_xai.benchmark</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindspore_xai.tool.html">mindspore_xai.tool</a></li>
<li class="toctree-l1"><a class="reference internal" href="mindspore_xai.visual.html">mindspore_xai.visual</a></li>
</ul>
<p class="caption" role="heading"><span class="caption-text">FAQ</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="troubleshoot.html">Troubleshooting</a></li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">MindSpore</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
      <li>Using TB-Net Whitebox Recommendation Model</li>
      <li class="wy-breadcrumbs-aside">
            <a href="_sources/using_tbnet.md.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  
<style>
/* CSS overrides for sphinx_rtd_theme */

/* 24px margin */
.nbinput.nblast.container,
.nboutput.nblast.container {
    margin-bottom: 19px;  /* padding has already 5px */
}

/* ... except between code cells! */
.nblast.container + .nbinput.container {
    margin-top: -19px;
}

.admonition > p:before {
    margin-right: 4px;  /* make room for the exclamation icon */
}

/* Fix math alignment, see https://github.com/rtfd/sphinx_rtd_theme/pull/686 */
.math {
    text-align: unset;
}
</style>
<section class="tex2jax_ignore mathjax_ignore" id="using-tb-net-whitebox-recommendation-model">
<h1>Using TB-Net Whitebox Recommendation Model<a class="headerlink" href="#using-tb-net-whitebox-recommendation-model" title="Permalink to this headline"></a></h1>
<p><a href="https://gitee.com/mindspore/docs/blob/master/docs/xai/docs/source_en/using_tbnet.md" target="_blank"><img src="https://mindspore-website.obs.cn-north-4.myhuaweicloud.com/website-images/master/resource/_static/logo_source_en.png"></a></p>
<section id="what-is-tb-net">
<h2>What is TB-Net<a class="headerlink" href="#what-is-tb-net" title="Permalink to this headline"></a></h2>
<p>TB-Net is a white box recommendation model, which constructs subgraphs in knowledge graphs based on the interaction between users and items as well as the features of items, and then calculates paths in the graphs using a bidirectional conduction algorithm. Finally, we can obtain explainable recommendation results.</p>
<p>Paper: Shendi Wang, Haoyang Li, Caleb Chen Cao, Xiao-Hui Li, Ng Ngai Fai, Jianxin Liu, Xun Xue, Hu Song, Jinyu Li, Guangye Gu, Lei Chen. <a class="reference external" href="https://ieeexplore.ieee.org/document/9835387">Tower Bridge Net (TB-Net): Bidirectional Knowledge Graph Aware Embedding Propagation for Explainable Recommender Systems</a></p>
</section>
<section id="preparations">
<h2>Preparations<a class="headerlink" href="#preparations" title="Permalink to this headline"></a></h2>
<section id="downloading-data-package">
<h3>Downloading Data Package<a class="headerlink" href="#downloading-data-package" title="Permalink to this headline"></a></h3>
<p>First of all, we have to download the data package and put it underneath the <code class="docutils literal notranslate"><span class="pre">models/whitebox/tbnet</span></code> directory of a local XAI <a class="reference external" href="https://gitee.com/mindspore/xai">source package</a>:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>wget<span class="w"> </span>https://mindspore-website.obs.myhuaweicloud.com/notebook/datasets/xai/tbnet_data.tar.gz
tar<span class="w"> </span>-xf<span class="w"> </span>tbnet_data.tar.gz

git<span class="w"> </span>clone<span class="w"> </span>https://gitee.com/mindspore/xai.git
mv<span class="w"> </span>data<span class="w"> </span>xai/models/whitebox/tbnet
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">xai/models/whitebox/tbnet/</span></code> files:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>.
└─tbnet
<span class="w">  </span>├─README.md
<span class="w">  </span>├─README_CN.md
<span class="w">  </span>├─data
<span class="w">  </span>│<span class="w"> </span>└─steam<span class="w">                         </span><span class="c1"># Steam user purchase history dataset</span>
<span class="w">  </span>│<span class="w">   </span>├─LICENSE
<span class="w">  </span>│<span class="w">   </span>├─config.json<span class="w">                 </span><span class="c1"># hyper-parameters and training configuration</span>
<span class="w">  </span>│<span class="w">   </span>├─src_infer.csv<span class="w">               </span><span class="c1"># source datafile for inference</span>
<span class="w">  </span>│<span class="w">   </span>├─src_test.csv<span class="w">                </span><span class="c1"># source datafile for evaluation</span>
<span class="w">  </span>│<span class="w">   </span>└─src_train.csv<span class="w">               </span><span class="c1"># source datafile for training</span>
<span class="w">  </span>├─src
<span class="w">  </span>│<span class="w"> </span>├─dataset.py<span class="w">                    </span><span class="c1"># dataset loader</span>
<span class="w">  </span>│<span class="w"> </span>├─embedding.py<span class="w">                  </span><span class="c1"># embedding module</span>
<span class="w">  </span>│<span class="w"> </span>├─metrics.py<span class="w">                    </span><span class="c1"># model metrics</span>
<span class="w">  </span>│<span class="w"> </span>├─path_gen.py<span class="w">                   </span><span class="c1"># data preprocessor</span>
<span class="w">  </span>│<span class="w"> </span>├─recommend.py<span class="w">                  </span><span class="c1"># result aggregator</span>
<span class="w">  </span>│<span class="w"> </span>└─tbnet.py<span class="w">                      </span><span class="c1"># TB-Net architecture</span>
<span class="w">  </span>├─export.py<span class="w">                       </span><span class="c1"># export MINDIR/AIR script</span>
<span class="w">  </span>├─preprocess.py<span class="w">                   </span><span class="c1"># data pre-processing script</span>
<span class="w">  </span>├─eval.py<span class="w">                         </span><span class="c1"># evaluation script</span>
<span class="w">  </span>├─infer.py<span class="w">                        </span><span class="c1"># inference and explaining script</span>
<span class="w">  </span>├─train.py<span class="w">                        </span><span class="c1"># training script</span>
<span class="w">  </span>└─tbnet_config.py<span class="w">                 </span><span class="c1"># configuration reader</span>
</pre></div>
</div>
</section>
<section id="preparing-python-environment">
<h3>Preparing Python Environment<a class="headerlink" href="#preparing-python-environment" title="Permalink to this headline"></a></h3>
<p>TB-Net is part of the XAI package, no extra installation is required besides <a class="reference external" href="https://mindspore.cn/install/en">MindSpore</a> and <a class="reference external" href="https://www.mindspore.cn/xai/docs/en/master/installation.html">XAI</a>. GPUs are supported.</p>
</section>
</section>
<section id="data-pre-processing">
<h2>Data Pre-processing<a class="headerlink" href="#data-pre-processing" title="Permalink to this headline"></a></h2>
<p>The complete example code of this step is <a class="reference external" href="https://gitee.com/mindspore/xai/blob/master/models/whitebox/tbnet/preprocess.py">preprocess.py</a>.</p>
<p>Before training the TB-Net, we have to convert the source datafile to relation path data.</p>
<section id="source-datafile-format">
<h3>Source Datafile Format<a class="headerlink" href="#source-datafile-format" title="Permalink to this headline"></a></h3>
<p>The source datafiles of the steam dataset all share the exact same CSV format with headers:</p>
<p><code class="docutils literal notranslate"><span class="pre">user,item,rating,developer,genre,category,release_year</span></code></p>
<p>The first 3 columns must be present with specific order and meaning:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">user</span></code>: String, user ID, records of the same user must be grouped in consecutive rows in a single file. Splitting the records across different files will give misleading results.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">item</span></code>: String, item ID.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">rating</span></code>: Character, either <code class="docutils literal notranslate"><span class="pre">c</span></code>(user had interactions (e.g. clicked) with the item but not purchased), <code class="docutils literal notranslate"><span class="pre">p</span></code>(user purchased the item) or <code class="docutils literal notranslate"><span class="pre">x</span></code>(other items).</p></li>
</ul>
<p>(Remark: There is no <code class="docutils literal notranslate"><span class="pre">c</span></code> rating item in the steam dataset.)</p>
<p>Since the order and meaning of these columns are fixed, the names do not matter, users may choose other names like <code class="docutils literal notranslate"><span class="pre">uid,iid,act</span></code>, etc.</p>
<p>The later columns <code class="docutils literal notranslate"><span class="pre">developer,genre,category,release_year</span></code> are for the item’s string attribute IDs. Users should decide the column names (i.e. relation names) and keep them consistent in all source datafiles. There must be at least one attribute column with no maximum limit. In some cases, there are more than one values in each attribute, they should be separated by <code class="docutils literal notranslate"><span class="pre">;</span></code>. Leaving the attribute blank means the item has no such attribute.</p>
<p>The content of source datafiles for different purposes are slightly different:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">src_train.csv</span></code>: For training, the numbers of rows of <code class="docutils literal notranslate"><span class="pre">p</span></code> rating and <code class="docutils literal notranslate"><span class="pre">c</span></code> + <code class="docutils literal notranslate"><span class="pre">x</span></code> rating items should be roughly the same by re-sampling, there is no need to list all items in every user.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">src_test.csv</span></code>: For evaluation, very similar to <code class="docutils literal notranslate"><span class="pre">src_train.csv</span></code> but with less amount of data.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">src_infer.csv</span></code>: For inference, must contain data of ONLY ONE user. ALL <code class="docutils literal notranslate"><span class="pre">c</span></code>, <code class="docutils literal notranslate"><span class="pre">p</span></code> and <code class="docutils literal notranslate"><span class="pre">x</span></code> rating items should be listed. In <a class="reference external" href="https://gitee.com/mindspore/xai/blob/master/models/whitebox/tbnet/preprocess.py">preprocess.py</a>, only the <code class="docutils literal notranslate"><span class="pre">c</span></code> and <code class="docutils literal notranslate"><span class="pre">x</span></code> items are put as recommendation candidates in path data.</p></li>
</ul>
</section>
<section id="converting-to-relation-path-data">
<h3>Converting to Relation Path Data<a class="headerlink" href="#converting-to-relation-path-data" title="Permalink to this headline"></a></h3>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">io</span>
<span class="kn">import</span> <span class="nn">json</span>
<span class="kn">from</span> <span class="nn">src.path_gen</span> <span class="kn">import</span> <span class="n">PathGen</span>

<span class="n">path_gen</span> <span class="o">=</span> <span class="n">PathGen</span><span class="p">(</span><span class="n">per_item_paths</span><span class="o">=</span><span class="mi">39</span><span class="p">)</span>

<span class="n">path_gen</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="s2">&quot;./data/steam/src_train.csv&quot;</span><span class="p">,</span> <span class="s2">&quot;./data/steam/train.csv&quot;</span><span class="p">)</span>

<span class="c1"># save id maps for the later use by Recommender for inference</span>
<span class="k">with</span> <span class="n">io</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="s2">&quot;./data/steam/id_maps.json&quot;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;w&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">json</span><span class="o">.</span><span class="n">dump</span><span class="p">(</span><span class="n">path_gen</span><span class="o">.</span><span class="n">id_maps</span><span class="p">(),</span> <span class="n">f</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>

<span class="c1"># treat newly met items and references in src_test.csv and src_infer.csv as unseen entities</span>
<span class="c1"># dummy internal id 0 will be assigned to them</span>
<span class="n">path_gen</span><span class="o">.</span><span class="n">grow_id_maps</span> <span class="o">=</span> <span class="kc">False</span>

<span class="n">path_gen</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="s2">&quot;./data/steam/src_test.csv&quot;</span><span class="p">,</span> <span class="s2">&quot;./data/steam/test.csv&quot;</span><span class="p">)</span>

<span class="c1"># for inference, only take interacted(&#39;c&#39;) and other(&#39;x&#39;) items as candidate items,</span>
<span class="c1"># the purchased(&#39;p&#39;) items won&#39;t be recommended.</span>
<span class="c1"># assume there is only one user in src_infer.csv</span>
<span class="n">path_gen</span><span class="o">.</span><span class="n">subject_ratings</span> <span class="o">=</span> <span class="s2">&quot;cx&quot;</span>

<span class="n">path_gen</span><span class="o">.</span><span class="n">generate</span><span class="p">(</span><span class="s2">&quot;./data/steam/src_infer.csv&quot;</span><span class="p">,</span> <span class="s2">&quot;./data/steam/infer.csv&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p><code class="docutils literal notranslate"><span class="pre">PathGen</span></code> is responsible for converting source datafile into relation path data.</p>
</section>
<section id="relation-path-data-format">
<h3>Relation Path Data Format<a class="headerlink" href="#relation-path-data-format" title="Permalink to this headline"></a></h3>
<p>Relation path data are header-less CSV (all integer values), with columns:</p>
<p><code class="docutils literal notranslate"><span class="pre">&lt;subject</span> <span class="pre">item&gt;,&lt;label&gt;,&lt;relation1&gt;,&lt;reference&gt;,&lt;relation2&gt;,&lt;historical</span> <span class="pre">item&gt;,...</span></code></p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">subject</span> <span class="pre">item</span></code>: Internal id of the sample item for training or the recommendation candidate item for inference.<code class="docutils literal notranslate"><span class="pre">0</span></code> represents unseen items.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">label</span></code>: Ground truth label, <code class="docutils literal notranslate"><span class="pre">0</span></code> - not purchased, <code class="docutils literal notranslate"><span class="pre">1</span></code> - purchased. Ignored when inferencing.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">relation1</span></code>: Internal id of the relation 1 (column name of the subject item’s attribute).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">reference</span></code>: Internal id of the reference entity (the common attribute ID).<code class="docutils literal notranslate"><span class="pre">0</span></code> represents unseen references.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">relation2</span></code>: Internal id of the relation 2 (column name of the historical item’s attribute).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">historical</span> <span class="pre">item</span></code>: Internal id of the historical (<code class="docutils literal notranslate"><span class="pre">c</span></code> or <code class="docutils literal notranslate"><span class="pre">p</span></code> rating) item.<code class="docutils literal notranslate"><span class="pre">0</span></code> represents unseen items.</p></li>
</ul>
<p>The column sequence <code class="docutils literal notranslate"><span class="pre">&lt;relation1&gt;,&lt;reference&gt;,&lt;relation2&gt;,&lt;historical</span> <span class="pre">item&gt;</span></code> is going to repeat <code class="docutils literal notranslate"><span class="pre">per_item_paths</span></code> times in each row.</p>
</section>
<section id="running-preprocess-py">
<h3>Running preprocess.py<a class="headerlink" href="#running-preprocess-py" title="Permalink to this headline"></a></h3>
<p>Have to change the current directory to <code class="docutils literal notranslate"><span class="pre">xai/models/whitebox/tbnet</span></code> first.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>preprocess.py
</pre></div>
</div>
<p>Dataset <code class="docutils literal notranslate"><span class="pre">./data/stream</span></code> will be processed with path data <code class="docutils literal notranslate"><span class="pre">train.csv</span></code>, <code class="docutils literal notranslate"><span class="pre">test.csv</span></code> and <code class="docutils literal notranslate"><span class="pre">infer.csv</span></code> and the source-internal ID maps <code class="docutils literal notranslate"><span class="pre">id_maps.json</span></code> generated in the dataset directory.</p>
</section>
</section>
<section id="training-and-evaluation">
<h2>Training and Evaluation<a class="headerlink" href="#training-and-evaluation" title="Permalink to this headline"></a></h2>
<p>The complete example code of this step is <a class="reference external" href="https://gitee.com/mindspore/xai/blob/master/models/whitebox/tbnet/train.py">train.py</a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">src.tbnet</span> <span class="kn">import</span> <span class="n">TBNet</span><span class="p">,</span> <span class="n">NetWithLossCell</span><span class="p">,</span> <span class="n">TrainStepWrapCell</span><span class="p">,</span> <span class="n">EvalNet</span>
<span class="kn">from</span> <span class="nn">src.dataset</span> <span class="kn">import</span> <span class="n">create_dataset</span>
<span class="kn">from</span> <span class="nn">src.metrics</span> <span class="kn">import</span> <span class="n">AUC</span><span class="p">,</span> <span class="n">ACC</span>

<span class="o">...</span>

<span class="n">train_ds</span> <span class="o">=</span> <span class="n">create_dataset</span><span class="p">(</span><span class="n">train_csv_path</span><span class="p">,</span> <span class="n">cfg</span><span class="o">.</span><span class="n">per_item_paths</span><span class="p">)</span><span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">batch_size</span><span class="p">)</span>
<span class="n">test_ds</span> <span class="o">=</span> <span class="n">create_dataset</span><span class="p">(</span><span class="n">test_csv_path</span><span class="p">,</span> <span class="n">cfg</span><span class="o">.</span><span class="n">per_item_paths</span><span class="p">)</span><span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">batch_size</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;creating TBNet for training...&quot;</span><span class="p">)</span>
<span class="n">network</span> <span class="o">=</span> <span class="n">TBNet</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">num_items</span><span class="p">,</span> <span class="n">cfg</span><span class="o">.</span><span class="n">num_references</span><span class="p">,</span> <span class="n">cfg</span><span class="o">.</span><span class="n">num_relations</span><span class="p">,</span> <span class="n">cfg</span><span class="o">.</span><span class="n">embedding_dim</span><span class="p">)</span>
<span class="n">loss_net</span> <span class="o">=</span> <span class="n">NetWithLossCell</span><span class="p">(</span><span class="n">network</span><span class="p">,</span> <span class="n">cfg</span><span class="o">.</span><span class="n">kge_weight</span><span class="p">,</span> <span class="n">cfg</span><span class="o">.</span><span class="n">node_weight</span><span class="p">,</span> <span class="n">cfg</span><span class="o">.</span><span class="n">l2_weight</span><span class="p">)</span>
<span class="n">train_net</span> <span class="o">=</span> <span class="n">TrainStepWrapCell</span><span class="p">(</span><span class="n">loss_net</span><span class="p">,</span> <span class="n">cfg</span><span class="o">.</span><span class="n">lr</span><span class="p">)</span>
<span class="n">train_net</span><span class="o">.</span><span class="n">set_train</span><span class="p">()</span>
<span class="n">eval_net</span> <span class="o">=</span> <span class="n">EvalNet</span><span class="p">(</span><span class="n">network</span><span class="p">)</span>
<span class="n">time_callback</span> <span class="o">=</span> <span class="n">TimeMonitor</span><span class="p">(</span><span class="n">data_size</span><span class="o">=</span><span class="n">train_ds</span><span class="o">.</span><span class="n">get_dataset_size</span><span class="p">())</span>
<span class="n">loss_callback</span> <span class="o">=</span> <span class="n">MyLossMonitor</span><span class="p">()</span>
<span class="n">model</span> <span class="o">=</span> <span class="n">Model</span><span class="p">(</span><span class="n">network</span><span class="o">=</span><span class="n">train_net</span><span class="p">,</span> <span class="n">eval_network</span><span class="o">=</span><span class="n">eval_net</span><span class="p">,</span> <span class="n">metrics</span><span class="o">=</span><span class="p">{</span><span class="s1">&#39;auc&#39;</span><span class="p">:</span> <span class="n">AUC</span><span class="p">(),</span> <span class="s1">&#39;acc&#39;</span><span class="p">:</span> <span class="n">ACC</span><span class="p">()})</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;training...&quot;</span><span class="p">)</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">epochs</span><span class="p">):</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;===================== Epoch </span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1"> =====================&#39;</span><span class="p">)</span>
    <span class="n">model</span><span class="o">.</span><span class="n">train</span><span class="p">(</span><span class="n">epoch</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">train_dataset</span><span class="o">=</span><span class="n">train_ds</span><span class="p">,</span> <span class="n">callbacks</span><span class="o">=</span><span class="p">[</span><span class="n">time_callback</span><span class="p">,</span> <span class="n">loss_callback</span><span class="p">],</span> <span class="n">dataset_sink_mode</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">train_out</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">train_ds</span><span class="p">,</span> <span class="n">dataset_sink_mode</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="n">test_out</span> <span class="o">=</span> <span class="n">model</span><span class="o">.</span><span class="n">eval</span><span class="p">(</span><span class="n">test_ds</span><span class="p">,</span> <span class="n">dataset_sink_mode</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Train AUC:</span><span class="si">{</span><span class="n">train_out</span><span class="p">[</span><span class="s2">&quot;auc&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> ACC:</span><span class="si">{</span><span class="n">train_out</span><span class="p">[</span><span class="s2">&quot;acc&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">  Test AUC:</span><span class="si">{</span><span class="n">test_out</span><span class="p">[</span><span class="s2">&quot;auc&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1"> ACC:</span><span class="si">{</span><span class="n">test_out</span><span class="p">[</span><span class="s2">&quot;acc&quot;</span><span class="p">]</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>

    <span class="n">ckpt_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">join</span><span class="p">(</span><span class="n">ckpt_dir_path</span><span class="p">,</span> <span class="sa">f</span><span class="s1">&#39;tbnet_epoch</span><span class="si">{</span><span class="n">i</span><span class="si">}</span><span class="s1">.ckpt&#39;</span><span class="p">)</span>
    <span class="n">save_checkpoint</span><span class="p">(</span><span class="n">network</span><span class="p">,</span> <span class="n">ckpt_path</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;checkpoint saved: </span><span class="si">{</span><span class="n">ckpt_path</span><span class="si">}</span><span class="s1">&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>We can see from the above code snap of <a class="reference external" href="https://gitee.com/mindspore/xai/blob/master/models/whitebox/tbnet/train.py">train.py</a> that <code class="docutils literal notranslate"><span class="pre">tbnet.py</span></code>, <code class="docutils literal notranslate"><span class="pre">metrics.py</span></code> and <code class="docutils literal notranslate"><span class="pre">dataset.py</span></code> provides all the classes for training TB-Net like other MindSpore models. It trains with dataset created from <code class="docutils literal notranslate"><span class="pre">./data/steam/train.csv</span></code> and <code class="docutils literal notranslate"><span class="pre">./data/steam/test.csv</span></code> (for evaluation).</p>
<section id="running-train-py">
<h3>Running train.py<a class="headerlink" href="#running-train-py" title="Permalink to this headline"></a></h3>
<p>Have to change the current directory to <code class="docutils literal notranslate"><span class="pre">xai/models/whitebox/tbnet</span></code> first.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>train.py
</pre></div>
</div>
<p>20 epochs will be trained with the steam dataset and checkpoints will be saved to <code class="docutils literal notranslate"><span class="pre">./checkpoints/steam</span></code> for each epoch.</p>
</section>
</section>
<section id="inference-with-explanations">
<h2>Inference with Explanations<a class="headerlink" href="#inference-with-explanations" title="Permalink to this headline"></a></h2>
<p>The complete example code of this step is <a class="reference external" href="https://gitee.com/mindspore/xai/blob/master/models/whitebox/tbnet/infer.py">infer.py</a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">src.tbnet</span> <span class="kn">import</span> <span class="n">TBNet</span>
<span class="kn">from</span> <span class="nn">src.recommend</span> <span class="kn">import</span> <span class="n">Recommender</span>
<span class="kn">from</span> <span class="nn">src.dataset</span> <span class="kn">import</span> <span class="n">create_dataset</span>

<span class="o">...</span>

<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;creating dataset from </span><span class="si">{</span><span class="n">data_path</span><span class="si">}</span><span class="s2">...&quot;</span><span class="p">)</span>
<span class="n">infer_ds</span> <span class="o">=</span> <span class="n">create_dataset</span><span class="p">(</span><span class="n">data_path</span><span class="p">,</span> <span class="n">cfg</span><span class="o">.</span><span class="n">per_item_paths</span><span class="p">)</span>
<span class="n">infer_ds</span> <span class="o">=</span> <span class="n">infer_ds</span><span class="o">.</span><span class="n">batch</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">batch_size</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;inferring...&quot;</span><span class="p">)</span>
<span class="c1"># infer and aggregate results</span>

<span class="k">with</span> <span class="n">io</span><span class="o">.</span><span class="n">open</span><span class="p">(</span><span class="n">id_maps_path</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">,</span> <span class="n">encoding</span><span class="o">=</span><span class="s2">&quot;utf-8&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">f</span><span class="p">:</span>
    <span class="n">id_maps</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">load</span><span class="p">(</span><span class="n">f</span><span class="p">)</span>
<span class="n">recommender</span> <span class="o">=</span> <span class="n">Recommender</span><span class="p">(</span><span class="n">network</span><span class="p">,</span> <span class="n">id_maps</span><span class="p">,</span> <span class="n">args</span><span class="o">.</span><span class="n">items</span><span class="p">)</span>

<span class="k">for</span> <span class="n">item</span><span class="p">,</span> <span class="n">rl1</span><span class="p">,</span> <span class="n">ref</span><span class="p">,</span> <span class="n">rl2</span><span class="p">,</span> <span class="n">hist_item</span><span class="p">,</span> <span class="n">_</span> <span class="ow">in</span> <span class="n">infer_ds</span><span class="p">:</span>
    <span class="c1"># assume there is data of only one user in infer_ds and all items inside are candidates.</span>
    <span class="n">recommender</span><span class="p">(</span><span class="n">item</span><span class="p">,</span> <span class="n">rl1</span><span class="p">,</span> <span class="n">ref</span><span class="p">,</span> <span class="n">rl2</span><span class="p">,</span> <span class="n">hist_item</span><span class="p">)</span>

<span class="c1"># show recommendations with explanations</span>
<span class="n">suggestions</span> <span class="o">=</span> <span class="n">recommender</span><span class="o">.</span><span class="n">suggest</span><span class="p">()</span>
<span class="k">for</span> <span class="n">suggest</span> <span class="ow">in</span> <span class="n">suggestions</span><span class="p">:</span>
    <span class="nb">print</span><span class="p">(</span><span class="s2">&quot;&quot;</span><span class="p">)</span>
    <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;Recommends item:&quot;</span><span class="si">{</span><span class="n">suggest</span><span class="o">.</span><span class="n">item</span><span class="si">}</span><span class="s1">&quot; (score:</span><span class="si">{</span><span class="n">suggest</span><span class="o">.</span><span class="n">score</span><span class="si">}</span><span class="s1">) because:&#39;</span><span class="p">)</span>
    <span class="c1"># show explanations</span>
    <span class="n">explanation</span> <span class="o">=</span> <span class="mi">0</span>
    <span class="k">for</span> <span class="n">path</span> <span class="ow">in</span> <span class="n">suggest</span><span class="o">.</span><span class="n">paths</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">path</span><span class="o">.</span><span class="n">relation1</span> <span class="o">==</span> <span class="n">path</span><span class="o">.</span><span class="n">relation2</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;- it shares the same </span><span class="si">{</span><span class="n">path</span><span class="o">.</span><span class="n">relation1</span><span class="si">}</span><span class="s1">:&quot;</span><span class="si">{</span><span class="n">path</span><span class="o">.</span><span class="n">reference</span><span class="si">}</span><span class="s1">&quot; with user</span><span class="se">\&#39;</span><span class="s1">s &#39;</span>
                  <span class="sa">f</span><span class="s1">&#39;historical item:&quot;</span><span class="si">{</span><span class="n">path</span><span class="o">.</span><span class="n">hist_item</span><span class="si">}</span><span class="s1">&quot;.</span><span class="se">\n</span><span class="s1">  (importance:</span><span class="si">{</span><span class="n">path</span><span class="o">.</span><span class="n">importance</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s1">&#39;- it has </span><span class="si">{</span><span class="n">path</span><span class="o">.</span><span class="n">relation1</span><span class="si">}</span><span class="s1">:&quot;</span><span class="si">{</span><span class="n">path</span><span class="o">.</span><span class="n">reference</span><span class="si">}</span><span class="s1">&quot; while which is </span><span class="si">{</span><span class="n">path</span><span class="o">.</span><span class="n">relation2</span><span class="si">}</span><span class="s1"> &#39;</span>
                  <span class="sa">f</span><span class="s1">&#39;of user</span><span class="se">\&#39;</span><span class="s1">s historical item:&quot;</span><span class="si">{</span><span class="n">path</span><span class="o">.</span><span class="n">hist_item</span><span class="si">}</span><span class="s1">&quot;.</span><span class="se">\n</span><span class="s1">  (importance:</span><span class="si">{</span><span class="n">path</span><span class="o">.</span><span class="n">importance</span><span class="si">}</span><span class="s1">)&#39;</span><span class="p">)</span>
        <span class="n">explanation</span> <span class="o">+=</span> <span class="mi">1</span>
        <span class="k">if</span> <span class="n">explanation</span> <span class="o">&gt;=</span> <span class="n">args</span><span class="o">.</span><span class="n">explanations</span><span class="p">:</span>
            <span class="k">break</span>
</pre></div>
</div>
<p>We can see from the above code snap of <a class="reference external" href="https://gitee.com/mindspore/xai/blob/master/models/whitebox/tbnet/infer.py">infer.py</a> that class <code class="docutils literal notranslate"><span class="pre">Recommender</span></code> aggregates all inference results from TB-Net and gives top-k item recommendations. Each recommended item comes with a sorted list of relation paths beginning from the most important one. All IDs and relation names returned by <code class="docutils literal notranslate"><span class="pre">Recommender</span></code> are from <code class="docutils literal notranslate"><span class="pre">./data/steam/id_maps.json</span></code> that originated from the source datafile <code class="docutils literal notranslate"><span class="pre">./data/steam/src_train.csv</span></code>.</p>
<section id="running-infer-py">
<h3>Running infer.py<a class="headerlink" href="#running-infer-py" title="Permalink to this headline"></a></h3>
<p>Have to change the current directory to <code class="docutils literal notranslate"><span class="pre">xai/models/whitebox/tbnet</span></code> first.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>infer.py<span class="w"> </span>--checkpoint_id<span class="w"> </span><span class="m">19</span>
</pre></div>
</div>
<p>The last checkpoint <code class="docutils literal notranslate"><span class="pre">./checkpoints/steam/tbnet_epoch19.ckpt</span></code> from <span class="xref myst">Running train.py</span> will be used to infer on <code class="docutils literal notranslate"><span class="pre">./data/steam/infer.csv</span></code>. 3 recommended items with 3 relation path explanations each will be given.</p>
</section>
</section>
<section id="exporting-trained-model">
<h2>Exporting Trained Model<a class="headerlink" href="#exporting-trained-model" title="Permalink to this headline"></a></h2>
<p>The complete example code of this step is <a class="reference external" href="https://gitee.com/mindspore/xai/blob/master/models/whitebox/tbnet/export.py">export.py</a>.</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">mindspore</span> <span class="k">as</span> <span class="nn">ms</span>
<span class="kn">from</span> <span class="nn">src.tbnet</span> <span class="kn">import</span> <span class="n">TBNet</span>

<span class="o">...</span>

<span class="n">network</span> <span class="o">=</span> <span class="n">TBNet</span><span class="p">(</span><span class="n">cfg</span><span class="o">.</span><span class="n">num_items</span><span class="p">,</span> <span class="n">cfg</span><span class="o">.</span><span class="n">num_references</span><span class="p">,</span> <span class="n">cfg</span><span class="o">.</span><span class="n">num_relations</span><span class="p">,</span> <span class="n">cfg</span><span class="o">.</span><span class="n">embedding_dim</span><span class="p">)</span>
<span class="n">param_dict</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">load_checkpoint</span><span class="p">(</span><span class="n">ckpt_path</span><span class="p">)</span>
<span class="n">ms</span><span class="o">.</span><span class="n">load_param_into_net</span><span class="p">(</span><span class="n">network</span><span class="p">,</span> <span class="n">param_dict</span><span class="p">)</span>

<span class="n">item</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">1</span><span class="p">,))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">))</span>
<span class="n">rl1</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">cfg</span><span class="o">.</span><span class="n">per_item_paths</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">))</span>
<span class="n">ref</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">cfg</span><span class="o">.</span><span class="n">per_item_paths</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">))</span>
<span class="n">rl2</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">cfg</span><span class="o">.</span><span class="n">per_item_paths</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">))</span>
<span class="n">his</span> <span class="o">=</span> <span class="n">ms</span><span class="o">.</span><span class="n">Tensor</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">((</span><span class="mi">1</span><span class="p">,</span> <span class="n">cfg</span><span class="o">.</span><span class="n">per_item_paths</span><span class="p">))</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">int</span><span class="p">))</span>
<span class="n">inputs</span> <span class="o">=</span> <span class="p">[</span><span class="n">item</span><span class="p">,</span> <span class="n">rl1</span><span class="p">,</span> <span class="n">ref</span><span class="p">,</span> <span class="n">rl2</span><span class="p">,</span> <span class="n">his</span><span class="p">]</span>
<span class="n">file_name</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">realpath</span><span class="p">(</span><span class="n">args</span><span class="o">.</span><span class="n">file_name</span><span class="p">)</span>
<span class="n">ms</span><span class="o">.</span><span class="n">export</span><span class="p">(</span><span class="n">network</span><span class="p">,</span> <span class="o">*</span><span class="n">inputs</span><span class="p">,</span> <span class="n">file_name</span><span class="o">=</span><span class="n">file_name</span><span class="p">,</span> <span class="n">file_format</span><span class="o">=</span><span class="n">args</span><span class="o">.</span><span class="n">file_format</span><span class="p">)</span>
</pre></div>
</div>
<p>The above code snap of <a class="reference external" href="https://gitee.com/mindspore/xai/blob/master/models/whitebox/tbnet/export.py">export.py</a> shows it is straightforward with <a class="reference external" href="https://www.mindspore.cn/docs/en/master/api_python/mindspore/mindspore.export.html#mindspore.export">mindspore.export</a>.</p>
<section id="running-export-py">
<h3>Running export.py<a class="headerlink" href="#running-export-py" title="Permalink to this headline"></a></h3>
<p>Have to change the current directory to <code class="docutils literal notranslate"><span class="pre">xai/models/whitebox/tbnet</span></code> first.</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>python<span class="w"> </span>export.py<span class="w"> </span>--config_path<span class="w"> </span>./data/steam/config.json<span class="w"> </span>--checkpoint_path<span class="w"> </span>./checkpoints/steam/tbnet_epoch19.ckpt
</pre></div>
</div>
<p>The trained model will be exported as <code class="docutils literal notranslate"><span class="pre">./tbnet.mindir</span></code>.</p>
</section>
</section>
<section id="example-script-arguments-and-model-performance">
<h2>Example Script Arguments and Model Performance<a class="headerlink" href="#example-script-arguments-and-model-performance" title="Permalink to this headline"></a></h2>
<p>For the detail descriptions of the example script arguments and model performance, please refer to <a class="reference external" href="https://gitee.com/mindspore/xai/blob/master/models/whitebox/tbnet/README.md#">README.md</a>.</p>
</section>
</section>


           </div>
           
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="using_tabsim.html" class="btn btn-neutral float-left" title="Using TabSim Data Simulator" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="mindspore_xai.explainer.html" class="btn btn-neutral float-right" title="mindspore_xai.explainer" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2022, MindSpore.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   
</body>
</html>